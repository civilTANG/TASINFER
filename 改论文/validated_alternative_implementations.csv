postid,type,questionid,tags,source,content,ce1,ce2,t1,t2
1889627,answer,1888870,"python,numpy",codeblock,https://stackoverflow.com/questions/1889627,"imgarray3 = imgarray.view('B')[:,::4]",imgarray2 = imgarray.astype('B'),0.00364,0.107
2767545,answer,2761645,"python,numpy,python-imaging-library",codeblock,https://stackoverflow.com/questions/2767545,np.array(im_bw.convert('L')).astype(np.uint8),"np.reshape(im_bw.getdata(), im_bw.size)",0.028,0.0573
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,m[:3].T,m[:3].T.tolist(),0.00626,0.18
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,m[:3].T,numpy.asarray(m[:3].T),0.00626,0.0109
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,numpy.asarray(m[:3].T),m[:3].T.tolist(),0.0109,0.18
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,m[:3].T,[p[:3].tolist()for p in numpy.asarray(m.T)],0.00626,0.289
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,m[:3].T.tolist(),[p[:3].tolist()for p in numpy.asarray(m.T)],0.18,0.289
3315974,answer,3315894,"python,optimization,numpy",codeblock,https://stackoverflow.com/questions/3315974,numpy.asarray(m[:3].T),[p[:3].tolist()for p in numpy.asarray(m.T)],0.0109,0.289
3651058,answer,3650194,"python,performance,numpy",sentence,numpy.abs() is slower than abs() because it also handles numpy arrays: it contains additional code that provides this flexibility.,abs(),numpy.abs(),,
5891540,answer,5891523,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/5891540,x.sum(),sum(x),0.0102,4.01
5900729,answer,5891523,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/5900729,x.sum(),sum(x),0.0175,0.0188
5900729,answer,5891523,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/5900729,x.sum(),sum(x),0.0032,0.00444
5900729,answer,5891523,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/5900729,x.sum(),sum(x),0.158,0.165
6042010,comment,5349570,"python,numpy",sentence,a.prod() is slightly faster than np.prod(a),a.prod(),np.prod(a),,
6681416,answer,6681284,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/6681416,"numpy.tile(numpy.array([1, 2, 3]), 1000)","numpy.array([1, 2, 3]* 1000)",0.122,1.85
6681416,answer,6681284,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/6681416,"numpy.array([1, 2, 3]* 3)","numpy.tile(numpy.array([1, 2, 3]), 3)",0.0163,0.037
6696913,answer,6694835,"python,serialization,dictionary,numpy",codeblock,https://stackoverflow.com/questions/6696913,"numpy.array(bitarray.bitarray(a.flat)).reshape(5, 5)","numpy.array(bitstring.ConstBitArray(a.flat)).reshape(5, 5)",0.0199,0.283
6736970,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6736970,np.isnan(np.sum(x)),np.isnan(np.min(x)),0.0973,0.244
6736970,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6736970,np.isnan(np.sum(x)),np.isnan(np.min(x)),0.0959,0.153
6736970,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6736970,np.isnan(np.sum(x)),np.isnan(np.min(x)),0.0958,0.239
6736970,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6736970,np.isnan(np.sum(x)),np.isnan(np.min(x)),0.0959,0.326
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,"isnan(dot(x, x))",isnan(x.min()),0.138,4.47
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,isnan(x.sum()),isnan(x.min()),0.169,0.2
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,"isnan(dot(x, x))",isnan(x.min()),0.134,0.2
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,"isnan(dot(x, x))",isnan(x.sum()),0.134,0.169
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,isnan(x.min()),isnan(x.sum()),4.47,6.44
6739580,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/6739580,"isnan(dot(x, x))",isnan(x.sum()),0.138,6.44
6740606,answer,6740311,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/6740606,"b = np.concatenate((a,c),axis=0)","b = np.vstack((a,c))",0.0133,0.0261
6740606,answer,6740311,"python,arrays,numpy",sentence,"just as a note, on my machine for the sized arrays in the op's question, i find that np.concatenate is about 2x faster than np.vstack",np.concatenate,np.vstack,,
6959641,answer,6959477,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/6959641,"a=np.empty(shape,dtype=dt); a.fill(val)","a=np.tile(val,shape)",0.013,0.102
7196334,answer,7193870,"python,numpy",codeblock,https://stackoverflow.com/questions/7196334,"np.repeat(a,nrows*np.ones(a.shape[0],np.int),0)","np.kron(a,np.ones((nrows,1)))",0.0128,0.117
7196334,answer,7193870,"python,numpy",codeblock,https://stackoverflow.com/questions/7196334,"np.repeat(a,nrows*np.ones(a.shape[0],np.int),0)","np.tile(a,nrows).reshape(nrows*a.shape[0],-1)",0.0128,0.0255
7196334,answer,7193870,"python,numpy",codeblock,https://stackoverflow.com/questions/7196334,"np.tile(a,nrows).reshape(nrows*a.shape[0],-1)","np.kron(a,np.ones((nrows,1)))",0.0255,0.117
7614213,answer,7614084,"python,performance,matrix,numpy,max",codeblock,https://stackoverflow.com/questions/7614213,np.array(matrices).max(axis=0),np.dstack(matrices).max(2),0.0909,0.0926
7614213,answer,7614084,"python,performance,matrix,numpy,max",codeblock,https://stackoverflow.com/questions/7614213,np.dstack(matrices).max(2),np.array(matrices).max(axis=0),111,697
7741976,answer,7741878,"python,numpy",codeblock,https://stackoverflow.com/questions/7741976,"np.sum(np.abs(x)**2,axis=-1)**(1./2)","np.apply_along_axis(np.linalg.norm, 1, x)",0.0183,0.208
7741976,answer,7741878,"python,numpy",codeblock,https://stackoverflow.com/questions/7741976,"np.sum(abs(x), axis=-1)","np.apply_along_axis(lambda row:np.linalg.norm(row,ord=1), 1, x)",0.0109,0.203
7842620,answer,7842157,"python,numpy",codeblock,https://stackoverflow.com/questions/7842620,"a.astype([('x', '<f8'), ('y', '<f8'), ('z', '<f8')]).view('<f8')",np.array(a.tolist()),0.165,0.683
7842620,answer,7842157,"python,numpy",sentence,calling a.astype(...).view(...) is also faster than np.array(a.tolist()):,a.astype(...).view(...),np.array(a.tolist()),,
8124664,answer,7546080,"python,scipy",sentence,"also, numpy#insert is faster than numpy#resize :",numpy#insert,numpy#resize,,
8220925,answer,8220689,"python,numpy",codeblock,https://stackoverflow.com/questions/8220925,"np.fromiter(itertools.izip(A,B,C),dtype=datatype)","np.array(zip(A,B,C),dtype=datatype)",10.7,12.7
8220925,answer,8220689,"python,numpy",codeblock,https://stackoverflow.com/questions/8220925,"np.fromiter(itertools.izip(a,b,c),dtype=datatype)","np.array(zip(a,b,c),dtype=datatype)",0.0158,0.0208
8220925,answer,8220689,"python,numpy",sentence,so np.fromiter appears to be slightly faster than np.array.,np.fromiter,np.array,,
8489498,answer,8486294,"python,numpy",codeblock,https://stackoverflow.com/questions/8489498,"b = np.zeros((a.shape[0],a.shape[1]+1)); b[:,:-1] = a","b = np.hstack((a,np.zeros((a.shape[0],1))))",0.00562,0.0196
8542972,answer,8540568,"python,matlab,numpy,scipy",codeblock,https://stackoverflow.com/questions/8542972,m_2d = sp.empty(x.shape); m_2d[:] = m,"m_2d = sp.tile(m, (len(x), 1))",0.00258,0.0133
8622224,answer,8620521,"python,arrays,performance,optimization,numpy",codeblock,https://stackoverflow.com/questions/8622224,"numpy.concatenate([tab[indices1], tab[indices2], tab[indices3],     tab[indices4]])","numpy.array([tab[indices1], tab[indices2], tab[indices3], tab[indices4]])",0.544,5.11
8622224,answer,8620521,"python,arrays,performance,optimization,numpy",sentence,"third, np.concatenate is about 10 times faster than np.array",np.concatenate,np.array,,
8652969,answer,8652785,"python,numpy",codeblock,https://stackoverflow.com/questions/8652969,"np.sum(x, axis=1)","np.apply_along_axis(np.sum, 1, x)",1.81,3210
8652969,answer,8652785,"python,numpy",codeblock,https://stackoverflow.com/questions/8652969,"np.array([np.sum(x[i,:]) for i in range(x.shape[0])])","np.apply_along_axis(np.sum, 1, x)",712,3210
8652969,answer,8652785,"python,numpy",codeblock,https://stackoverflow.com/questions/8652969,"np.sum(x, axis=1)","np.array([np.sum(x[i,:]) for i in range(x.shape[0])])",1.81,712
8964779,answer,8956832,"python,memory,csv,numpy,scipy",sentence,"genfromtxt is much less efficient than loadtxt (though it handles missing data, whereas loadtxt is more ""lean and mean"", which is why the two functions co-exist).",loadtxt,genfromtxt,,
9184560,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/9184560,np.sqrt(x.dot(x)),np.linalg.norm(x),18.1372,45.0878
9184560,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/9184560,np.sqrt((a*a).sum(axis=1)),[np.linalg.norm(x) for x in a],0.0189,4.23
9702214,answer,9700699,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/9702214,image.sum(axis=1).reshape(shape),np.array([old_rgb_to_something(rgb) for rgb in image]).reshape(shape),192,3030
10366764,answer,10366665,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/10366764,"t + np.roll(t,-1)","t + np.r_[t[1:],t[0]]",0.0172,0.0355
10674608,answer,10674464,"python,arrays,numpy,norm",codeblock,https://stackoverflow.com/questions/10674608,normedA_0 = array([norm(v) for v in A]),"normedA_1 = array(map(norm, A))",16.5,16.9
10674608,answer,10674464,"python,arrays,numpy,norm",codeblock,https://stackoverflow.com/questions/10674608,normedA_4 = (A*A).sum(axis=1)**0.5,normedA_0 = array([norm(v) for v in A]),0.0462,16.5
10674608,answer,10674464,"python,arrays,numpy,norm",codeblock,https://stackoverflow.com/questions/10674608,normedA_4 = (A*A).sum(axis=1)**0.5,"normedA_1 = array(map(norm, A))",0.0462,16.9
10677778,answer,10677542,"python,arrays,numpy,multiplication",codeblock,https://stackoverflow.com/questions/10677778,"np.einsum('ijk,jkl->ijkl',a,b)","a[..., np.newaxis]*b[np.newaxis, ...]",0.00478,0.0122
10677778,answer,10677542,"python,arrays,numpy,multiplication",codeblock,https://stackoverflow.com/questions/10677778,"a[..., np.newaxis]*b[np.newaxis, ...]","np.einsum('ijk,jkl->ijkl',a,b)",16.6,16.6
10677778,answer,10677542,"python,arrays,numpy,multiplication",codeblock,https://stackoverflow.com/questions/10677778,"a[..., np.newaxis]*b[np.newaxis, ...]","np.einsum('ijk,jkl->ijkl',a,b)",2600,3310
10709601,answer,10698858,"python,numpy,python-3.x,range",codeblock,https://stackoverflow.com/questions/10709601,np.arange(size) ** 2,for x in np.arange(size): x ** 2,19.5,1160
10958143,answer,10935629,"python,numpy",codeblock,https://stackoverflow.com/questions/10958143,np.matlib.eye(n),np.matlib.identity(n),0.695,8.78
11017532,answer,11017347,"python,list,numpy",sentence,"also, i'd imagine that a[i,j] is slightly more efficient than a[i][j], but i haven't tested it.","a[i,j]",a[i][j],,
11079590,answer,11078122,"python,numpy",codeblock,https://stackoverflow.com/questions/11079590,"c = signal.fftconvolve(a, numpy.fliplr(numpy.flipud(b)), 'valid')","c = signal.correlate(a, b, 'valid')",6.78,151
11157577,answer,6768245,"python,arrays,numpy,vectorization",sentence,"edit: after some brief benchmarking, i find that vectorize is significantly slower (50%) than frompyfunc for large arrays.",frompyfunc,vectorize,,
11623423,answer,11622692,"python,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/11623423,(1 + a * 0) * numpy.arange(100),"numpy.broadcast_arrays(a, numpy.arange(100))[1]",0.0459,0.0534
11623423,answer,11622692,"python,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/11623423,"b = numpy.ones_like(a, dtype='i8'); b * numpy.arange(100)","numpy.broadcast_arrays(a, numpy.arange(100))[1]",0.0289,0.0534
11623423,answer,11622692,"python,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/11623423,"b = numpy.ones_like(a, dtype='i8'); b * numpy.arange(100)",(1 + a * 0) * numpy.arange(100),0.0289,0.0459
11830636,answer,11830474,"python,numpy",codeblock,https://stackoverflow.com/questions/11830636,"np.vstack((a, b, c)).T.ravel()","np.array((a, b, c)).T.ravel()",0.265,5.24
11830636,answer,11830474,"python,numpy",codeblock,https://stackoverflow.com/questions/11830636,"np.vstack((a, b, c)).T.flatten()","np.array((a, b, c)).T.ravel()",0.268,5.24
11830636,answer,11830474,"python,numpy",codeblock,https://stackoverflow.com/questions/11830636,"np.vstack((a, b, c)).T.ravel()","np.vstack((a, b, c)).T.flatten()",0.265,0.268
11927545,answer,11927484,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/11927545,"a[where(array(map(lambda x: sum(x), a % 2 == 0)) >= N)]","a[where(sum(apply_along_axis(lambda x: x % 2 == 0, 1, a), axis=1) >= 2)]",0.072,0.22
11975241,answer,11975146,"python,numpy",sentence,"wrapping np.zeros(size); a[index] = 1.0 in a function makes only a modest difference, and is still much faster than np.eye:",np.zeros(size); a[index] = 1.0,np.eye,,
11975241,answer,11975146,"python,numpy",codeblock,https://stackoverflow.com/questions/11975241,a = np.zeros(size); a[index] = 1.0,"np.eye(1,size,index)",0.00153,0.00768
12262022,answer,12255179,"python,numpy,pandas,scikit-learn",codeblock,https://stackoverflow.com/questions/12262022,"numpy.fromstring(d, dtype='int8') - 48","numpy.fromiter(d, dtype='int', count=20000)",0.0358,8.57
12451985,answer,12451954,"python,numpy",codeblock,https://stackoverflow.com/questions/12451985,np.count_nonzero(a),(a != 0).sum(),0.000686,0.0135
12611185,answer,12606027,"python,performance,numpy,order,f2py",codeblock,https://stackoverflow.com/questions/12611185,x.sum(axis=1),y.sum(axis=1),1.02,8.09
12611185,answer,12606027,"python,performance,numpy,order,f2py",codeblock,https://stackoverflow.com/questions/12611185,y.sum(axis=0),x.sum(axis=0),1.02,8.03
12668149,answer,12668027,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/12668149,"np.append(p, z,1)","np.c_[a, z]",0.0131,0.0472
12668149,answer,12668027,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/12668149,"np.hstack((p,z))","np.c_[a, z]",0.0208,0.0472
12668149,answer,12668027,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/12668149,"np.append(p, z,1)","np.hstack((p,z))",0.0131,0.0208
12712725,answer,2850743,"python,vector,numpy,normalization",codeblock,https://stackoverflow.com/questions/12712725,"np.sqrt((vectors ** 2).sum(-1))[..., np.newaxis]","np.apply_along_axis(np.linalg.norm, 1, vectors)",0.0138,2.39
12712725,answer,2850743,"python,vector,numpy,normalization",codeblock,https://stackoverflow.com/questions/12712725,"np.sqrt(np.einsum('...i,...i', vectors, vectors))","np.apply_along_axis(np.linalg.norm, 1, vectors)",0.00645,2.39
12712725,answer,2850743,"python,vector,numpy,normalization",codeblock,https://stackoverflow.com/questions/12712725,"np.sqrt(np.einsum('...i,...i', vectors, vectors))","np.sqrt((vectors ** 2).sum(-1))[..., np.newaxis]",0.00645,0.0138
12996105,answer,12995937,"python,arrays,coding-style,numpy,pixel",codeblock,https://stackoverflow.com/questions/12996105,y[b],y[y>200],0.00331,0.00757
12996105,answer,12995937,"python,arrays,coding-style,numpy,pixel",codeblock,https://stackoverflow.com/questions/12996105,"np.array(filter(lambda x:x>200, x))","np.array(filter(lambda x:x>200, y.ravel()))",0.0217,0.0229
12996105,answer,12995937,"python,arrays,coding-style,numpy,pixel",codeblock,https://stackoverflow.com/questions/12996105,y[nb],y[np.where(y>200)],0.00242,0.0103
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,"a=np.repeat(5,(1e4))","a=np.tile(5,[1e4])",0.0817,0.0829
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a.fill(5),a=np.empty(1e4); a[:]=5,0.00585,0.00715
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.ones(1e4)*5,"a=np.tile(5,[1e4])",0.0229,0.0829
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a.fill(5),a=np.ones(1e4)*5,0.00585,0.0229
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a.fill(5),"a=np.repeat(5,(1e4))",0.00585,0.0817
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a.fill(5),"a=np.tile(5,[1e4])",0.00585,0.0829
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a[:]=5,a=np.ones(1e4)*5,0.00715,0.0229
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a[:]=5,"a=np.repeat(5,(1e4))",0.00715,0.0817
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.ones(1e4)*5,"a=np.repeat(5,(1e4))",0.0229,0.0817
13052254,answer,5891410,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/13052254,a=np.empty(1e4); a[:]=5,"a=np.tile(5,[1e4])",0.00715,0.0829
13235413,answer,13235187,"python,numpy,python-2.7",codeblock,https://stackoverflow.com/questions/13235413,"numpy.mod(a, 1.0)",numpy.modf(a)[0],68.3,90.1
13235413,answer,13235187,"python,numpy,python-2.7",codeblock,https://stackoverflow.com/questions/13235413,"numpy.mod(a, 1.0)",a-numpy.trunc(a),68.3,135
13235413,answer,13235187,"python,numpy,python-2.7",codeblock,https://stackoverflow.com/questions/13235413,numpy.modf(a)[0],a-numpy.trunc(a),90.1,135
13252986,answer,13252781,"python,numpy",codeblock,https://stackoverflow.com/questions/13252986,a.flatten(),numpy.concatenate(a),0.00142,0.00226
13252986,answer,13252781,"python,numpy",codeblock,https://stackoverflow.com/questions/13252986,a.ravel(),a.flatten(),0.000468,0.00142
13252986,answer,13252781,"python,numpy",codeblock,https://stackoverflow.com/questions/13252986,a.ravel(),numpy.concatenate(a),0.000468,0.00226
13532135,answer,13531717,"optimization,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/13532135,np.linalg.eig(A),[np.linalg.eig(Ai) for Ai in A],9.65,74.6
13534817,answer,13533719,"python,numpy",codeblock,https://stackoverflow.com/questions/13534817,"foo[rsum<165][:,csum>80]","foo[np.ix_(rsum<165, csum>80)]",0.00966,0.0164
13534817,answer,13533719,"python,numpy",codeblock,https://stackoverflow.com/questions/13534817,"np.multiply.outer(range(1,6),range(1,11))",np.array([[(i+1)*(j+1) for i in range(10)] for j in range(5)]),0.0142,0.0266
13653308,answer,13653030,"python,pandas",codeblock,https://stackoverflow.com/questions/13653308,"pd.DataFrame(zip(a,b), columns=[a.name, b.name])","pd.concat([pd.DataFrame(a),pd.DataFrame(b)], axis=1)",0.362,0.808
13842286,answer,13842088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/13842286,"df.set_value('C', 'x', 10)",df['x']['C'] = 10,0.0029,0.00631
13842286,answer,13842088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/13842286,"df.set_value('C', 'x', 10)","df.at['C', 'x'] = 10",0.0029,0.0092
13842286,answer,13842088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/13842286,df['x']['C'] = 10,"df.at['C', 'x'] = 10",0.00631,0.0092
13884215,answer,13876789,"python,numpy",codeblock,https://stackoverflow.com/questions/13884215,"np.frompyfunc(lambda element: np.amax(np.where(a1 > element)),1,1)(a2,out=np.empty_like(a2))",np.asarray([np.amax(np.where(a1 > element)) for element in a2]),0.123,0.161
13884215,answer,13876789,"python,numpy",codeblock,https://stackoverflow.com/questions/13884215,"np.fromiter((np.amax(np.where(a1 > element)) for element in a2),dtype=int, count=len(a2))",np.asarray([np.amax(np.where(a1 > element)) for element in a2]),0.111,0.161
13884215,answer,13876789,"python,numpy",codeblock,https://stackoverflow.com/questions/13884215,"np.fromiter((np.amax(np.where(a1 > element)) for element in a2),dtype=int, count=len(a2))","np.frompyfunc(lambda element: np.amax(np.where(a1 > element)),1,1)(a2,out=np.empty_like(a2))",0.111,0.123
13923414,answer,13918355,"python,join,merge,pandas,binary-search",codeblock,https://stackoverflow.com/questions/13923414,"C = AA.apply(lambda row: (row[0], x[1], B.ts.values[(B.ts.values >= row['ts']) & (B.index == row['a'])].min()), axis=1)","C = AA.apply(lambda row: (row[0], row[1], B.ix[row[0]].irow(np.searchsorted(B.ts[row[0]], row[2]))), axis=1).set_index(['a', 'b'])",4.32,10.3
14079233,answer,14078818,"python,image,matlab,image-processing,numpy",codeblock,https://stackoverflow.com/questions/14079233,"a=np.empty((5000,5000), dtype='d');  a=a[:, 3000:]","a=np.empty((5000,5000), dtype='d');  a=np.delete(a, np.r_[:3000], 1)",0.0393,404
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m.fill(-1)","m = np.empty((3,3)); m[:] = -1",0.00209,0.00318
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.zeros((3,3)); m.fill(-1)","m = np.zeros((3,3)); m += -1",0.00231,0.0069
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.zeros((3,3)); m += -1","m = np.ones((3,3)); m *= -1",0.0069,0.00949
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m[:] = -1","m = np.zeros((3,3)); m += -1",0.00318,0.0069
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m.fill(-1)","m = np.zeros((3,3)); m.fill(-1)",0.00209,0.00231
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.zeros((3,3)); m.fill(-1)","m = np.empty((3,3)); m[:] = -1",0.00231,0.00318
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m.fill(-1)","m = np.ones((3,3)); m *= -1",0.00209,0.00949
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m.fill(-1)","m = np.zeros((3,3)); m += -1",0.00209,0.0069
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.empty((3,3)); m[:] = -1","m = np.ones((3,3)); m *= -1",0.00318,0.00949
14112342,answer,14112235,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/14112342,"m = np.zeros((3,3)); m.fill(-1)","m = np.ones((3,3)); m *= -1",0.00231,0.00949
14387955,answer,14386822,"python,numpy,indexing,slice",codeblock,https://stackoverflow.com/questions/14387955,"(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)","a[rows][:, cols]",1.56,186
14434100,answer,14433428,"python,numpy,iteration",codeblock,https://stackoverflow.com/questions/14434100,np.log(thing),[math.log(x) for x in thing],3203.94,37742.2
14438767,answer,14438509,"numpy,pandas,pytables",codeblock,https://stackoverflow.com/questions/14438767,"idx = a[:, 1].argsort(kind='quicksort')","idx = a[:, 1].argsort(kind='heapsort')",12.6,21.4
14438767,answer,14438509,"numpy,pandas,pytables",codeblock,https://stackoverflow.com/questions/14438767,"idx = a[:, 1].argsort(kind='mergesort')","idx = a[:, 1].argsort(kind='heapsort')",14.4,21.4
14438767,answer,14438509,"numpy,pandas,pytables",codeblock,https://stackoverflow.com/questions/14438767,"idx = a[:, 1].argsort(kind='quicksort')","idx = a[:, 1].argsort(kind='mergesort')",12.6,14.4
14447750,answer,14447442,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/14447750,"test[2,2]",test[2][2],0.000639,0.0015
14468501,answer,14468158,"python,numpy,concatenation",codeblock,https://stackoverflow.com/questions/14468501,"np.concatenate(([1,2,3,], [4,5,6])).reshape(2,1,1,3)","np.r_['0,4', [1,2,3,], [4,5,6]]",0.0102,0.038
14639568,answer,14639496,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/14639568,a.copy(),b.copy(),0.00251,0.0484
14663198,answer,14663071,"python,arrays,matlab,numpy",codeblock,https://stackoverflow.com/questions/14663198,a = np.empty(300+2); a.fill(2); a[0] = 1; a[-1] = 1,a = 2*np.ones(300+2); a[0] = 1; a[-1] = 1,0.00173,0.00679
14663198,answer,14663071,"python,arrays,matlab,numpy",codeblock,https://stackoverflow.com/questions/14663198,"np.hstack(([1], 2*np.ones(300), [1]))","np.r_[1, 2*np.ones(300), 1]",0.0264,0.0275
14663198,answer,14663071,"python,arrays,matlab,numpy",codeblock,https://stackoverflow.com/questions/14663198,"np.r_[1, 2*np.ones(300), 1]","np.append([1],np.append(2*np.ones(300)[:],[1]))",0.0275,0.0282
14663198,answer,14663071,"python,arrays,matlab,numpy",codeblock,https://stackoverflow.com/questions/14663198,"np.hstack(([1], 2*np.ones(300), [1]))","np.append([1],np.append(2*np.ones(300)[:],[1]))",0.0264,0.0282
14671627,answer,14671013,"python,sorting,numpy,scipy",sentence,"after upgrading to a latest version of scipy as suggested @warrenweckesser in the comments, scipy.stats.rankdata seems to be faster than both scipy.stats.mstats.rankdata and np.searchsorted being the fastet way to do it on larger arrays.",scipy.stats.rankdata,scipy.stats.mstats.rankdata,,
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,"np.einsum('ij,ij->i', np.dot(a, b), a)","np.einsum('ij,jk,ki->i', a, b, a.T)",105,1300
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,"np.einsum('ij,jk,ki->i', a, b, a.T)","np.diag(np.dot(np.dot(a, b), a.T))",1300,5730
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,(a.dot(b) * a).sum(-1),"np.einsum('ij,jk,ki->i', a, b, a.T)",115,1300
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,"np.einsum('ij,ij->i', np.dot(a, b), a)","np.diag(np.dot(np.dot(a, b), a.T))",105,5730
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,"np.einsum('ij,ij->i', np.dot(a, b), a)",(a.dot(b) * a).sum(-1),105,115
14759341,answer,14758283,"python,numpy,scipy,product",codeblock,https://stackoverflow.com/questions/14759341,(a.dot(b) * a).sum(-1),"np.diag(np.dot(np.dot(a, b), a.T))",115,5730
15015979,answer,15015471,"python,numpy",codeblock,https://stackoverflow.com/questions/15015979,"np.einsum('ij, jkl', M, a)","np.dot(M, a.swapaxes(0,1))",60.7,116
15300328,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15300328,"np.tensordot(v, A, axes=(0, 2))","np.apply_along_axis(v.dot, 2, A)",0.0216,0.258
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,a.dot(v),"v.dot(np.rollaxis(a, 2, 1))",0.00243,0.00449
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,a.dot(v),"np.tensordot(v, a, axes=(0, 2))",0.00243,0.0149
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,a.dot(v),"np.einsum('i, jki', v, a)",0.00243,0.00291
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,"v.dot(np.rollaxis(a, 2, 1))","np.tensordot(v, a, axes=(0, 2))",0.00449,0.0149
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,"np.einsum('i, jki', v, a)","v.dot(np.rollaxis(a, 2, 1))",0.00291,0.00449
15302905,answer,15296944,"python,numpy",codeblock,https://stackoverflow.com/questions/15302905,"np.einsum('i, jki', v, a)","np.tensordot(v, a, axes=(0, 2))",0.00291,0.0149
15307757,answer,15307589,"python,numpy,type-conversion,gmp",codeblock,https://stackoverflow.com/questions/15307757,np.sum(b),np.sum(a),0.0239,1.25
15366348,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366348,"np.fromiter(chain.from_iterable(lst*1000), dtype='int')",np.array(list(chain.from_iterable(lst*1000))),1,1.81
15366348,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366348,"np.fromiter(chain.from_iterable(lst*1000), dtype='int')",np.hstack(lst*1000),1,25.2
15366348,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366348,np.array(list(chain.from_iterable(lst*1000))),np.hstack(lst*1000),1.81,25.2
15366351,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366351,"numpy.fromiter(itertools.chain.from_iterable(lst), numpy.int64)",numpy.hstack(lst),0.00376,0.0577
15366351,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366351,"numpy.fromiter(itertools.chain.from_iterable(lst), numpy.int64)",numpy.array(list(itertools.chain.from_iterable(lst))),0.00376,0.0145
15366351,answer,15366053,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/15366351,numpy.array(list(itertools.chain.from_iterable(lst))),numpy.hstack(lst),0.0145,0.0577
15637512,answer,15637336,"python,numpy",codeblock,https://stackoverflow.com/questions/15637512,pd.unique(a),np.unique(a),0.144,0.644
15901591,answer,15901293,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/15901591,"np.bitwise_xor(255, arr, out=arr)","np.subtract(255, arr, out=arr)",7.65,7.69
15943975,answer,15943769,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/15943975,df.shape,df[0].count(),0.00277,0.348
15954970,answer,15953983,"python,numpy",codeblock,https://stackoverflow.com/questions/15954970,np.sort(a),np.unique(a),0.0319,0.0538
15954970,answer,15953983,"python,numpy",codeblock,https://stackoverflow.com/questions/15954970,np.diff(a),np.ediff1d(a),0.00776,0.0152
15954970,answer,15953983,"python,numpy",codeblock,https://stackoverflow.com/questions/15954970,np.min(np.diff(np.sort(a))),np.min(np.ediff1d(np.sort(a))),0.0477,0.0571
16104458,answer,16081797,"python,matrix,numpy,scipy,exponential",codeblock,https://stackoverflow.com/questions/16104458,ddiag = diagonal(d); ddiag[:] = np.exp(ddiag),np.diag(np.exp(np.diag(d))),0.108,52.1
16114400,answer,16114333,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/16114400,np.diag(np.fliplr(array)),np.diag(np.rot90(array)),0.00429,0.00609
16196261,answer,16190745,"numpy,precision",codeblock,https://stackoverflow.com/questions/16196261,np.mean(a),"np.mean(a, dtype=np.float64)",10.9,19.2
16196261,answer,16190745,"numpy,precision",codeblock,https://stackoverflow.com/questions/16196261,"np.mean(a, dtype=np.float64)",np.mean(a.astype(np.float64)),19.2,51
16196261,answer,16190745,"numpy,precision",codeblock,https://stackoverflow.com/questions/16196261,np.mean(a),np.mean(a.astype(np.float64)),10.9,51
16244044,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/16244044,np.argmax(aa>N/2),np.where(aa>N/2)[0][0],0.0523,0.141
16244044,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/16244044,np.argmax(aa>N/2),np.nonzero(aa>N/2)[0][0],0.0523,0.142
16244044,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/16244044,np.where(aa>N/2)[0][0],np.nonzero(aa>N/2)[0][0],0.141,0.142
16385723,answer,16384332,"python,filter,pandas",codeblock,https://stackoverflow.com/questions/16385723,"df[df[""STK_ID""].values == ""A0003""]","df[df[""STK_ID""] == ""A0003""]",210,841
16386935,answer,16384332,"python,filter,pandas",codeblock,https://stackoverflow.com/questions/16386935,"df.groupby(""STK_ID"").get_group(""A0003"")",df[df['STK_ID']=='A0003'],459,626
16460243,answer,14491480,"python,numpy",codeblock,https://stackoverflow.com/questions/16460243,"np.take(lut2, img.flatten(), axis=0).reshape(3,4000,4000,4)","np.take(lut2,img,axis=0)",709,716
16486299,answer,16486252,"python,numpy",codeblock,https://stackoverflow.com/questions/16486299,avgDists.argsort()[::-1][:3],(-avgDists).argsort()[:3],2837.26,4287.98
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(df.sum(), columns=['sum'])",pd.DataFrame({'sum': df.sum()}),7.99,8.3
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(np.sum(df.values, axis=0), columns=['sum'])","pd.DataFrame(df.sum(), columns=['sum'])",0.205,0.356
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(np.sum(df.values, axis=0), columns=['sum'])",pd.DataFrame({'sum': df.sum()}),2.47,8.3
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(df.sum(), columns=['sum'])",pd.DataFrame({'sum': df.sum()}),0.356,0.462
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(np.sum(df.values, axis=0), columns=['sum'])",pd.DataFrame({'sum': df.sum()}),0.205,0.462
16492250,answer,16459217,"python,dataframe,pandas",codeblock,https://stackoverflow.com/questions/16492250,"pd.DataFrame(np.sum(df.values, axis=0), columns=['sum'])","pd.DataFrame(df.sum(), columns=['sum'])",2.47,7.99
16505058,answer,16505000,"python,list,numpy",codeblock,https://stackoverflow.com/questions/16505058,"a[123,456]",a[123][456],0.000234,0.000586
16511309,answer,16511156,"python,numpy,scipy,linear-algebra",codeblock,https://stackoverflow.com/questions/16511309,"np.einsum('...i,...ij,...j->...', vecs, mats, vecs)","np.array([np.dot(np.dot(vecs[i, ...], mats[i, ...]), vecs[i, ...].T) for i in range(N)])",7.02,640
16641346,answer,16639877,"python,pandas,hdf5,pytables",codeblock,https://stackoverflow.com/questions/16641346,"pd.read_hdf('test.h5','df')","pd.read_csv('test.csv',index_col=0)",38,2350
16641346,answer,16639877,"python,pandas,hdf5,pytables",codeblock,https://stackoverflow.com/questions/16641346,"df.to_hdf('test.h5','df',mode='w')","df.to_csv('test.csv',mode='w')",825,12700
16648510,answer,16643695,"python,pandas",codeblock,https://stackoverflow.com/questions/16648510,"df.replace('%','',regex=True).astype('float')/100",df.applymap(lambda x: float(x[:-1]))/100,1.16,1.67
16660243,answer,16660133,"python,pandas",codeblock,https://stackoverflow.com/questions/16660243,"wp.ix[:, :499, :]","wp.ix[:, indices[0:500], :]",0.0652,0.221
16660243,answer,16660133,"python,pandas",codeblock,https://stackoverflow.com/questions/16660243,wpt.ix[:499],"wp.ix[:, :499, :]",0.0375,0.0652
16720504,answer,16719720,"python,performance,matlab,numpy,convolution",sentence,"for 2d arrays, scipy.signal.convolve2d is faster than scipy.signal.convolve.",scipy.signal.convolve2d,scipy.signal.convolve,,
16952046,answer,16929211,"python,numpy",codeblock,https://stackoverflow.com/questions/16952046,aa.sum(),ma.sum(),0.00177,0.0151
16952046,answer,16929211,"python,numpy",codeblock,https://stackoverflow.com/questions/16952046,aa.sum(),ma.sum(),0.00918,0.0229
16952046,answer,16929211,"python,numpy",sentence,"i added some more tests, and it appears that an array is considerably faster than matrix when array/matrices are small, but the difference gets smaller for larger data structures:",array,matrix,,
16952046,answer,16929211,"python,numpy",codeblock,https://stackoverflow.com/questions/16952046,"np.dot(aa, aa.T)",ma * ma.T,0.00172,0.00746
16952046,answer,16929211,"python,numpy",codeblock,https://stackoverflow.com/questions/16952046,ma * ma.T,"np.dot(aa, aa.T)",1.24,1.26
16973510,answer,16970982,"python,arrays,numpy,unique",codeblock,https://stackoverflow.com/questions/16973510,"np.unique(a.view(np.dtype((np.void, a.dtype.itemsize*a.shape[1])))).view(a.dtype).reshape(-1, a.shape[1])","ind = np.lexsort(a.T); a[np.concatenate(([True],np.any(a[ind[1:]]!=a[ind[:-1]],axis=1)))]",3.17,5.93
16973510,answer,16970982,"python,arrays,numpy,unique",codeblock,https://stackoverflow.com/questions/16973510,"np.unique(a.view(np.dtype((np.void, a.dtype.itemsize*a.shape[1])))).view(a.dtype).reshape(-1, a.shape[1])","ind = np.lexsort(a.T); a[np.concatenate(([True],np.any(a[ind[1:]]!=a[ind[:-1]],axis=1)))]",29.9,116
16986775,answer,16986317,"python,numpy",codeblock,https://stackoverflow.com/questions/16986775,"R = np.einsum('ij,kj',A,A)","R = (A[:,np.newaxis,:] * A[np.newaxis,:,:]).sum(2)",54,1210
16986775,answer,16986317,"python,numpy",sentence,"as @jaime pointed out in the comments, np.dot(A,A.T) is also an equivalent formulation of the problem, and can be even faster than the np.einsum solution.","np.dot(A,A.T)",np.einsum,,
17119611,answer,17118350,"python,numpy,indexing",sentence,"note: you could also use np.digitize for this purpose, although it executes a linear rather than a binary search, so for certain input sizes, it can be a lot slower than searchsorted and requires that a be monotonic:",searchsorted,np.digitize,,
17286723,answer,17285691,"optimization,numpy,enumeration",codeblock,https://stackoverflow.com/questions/17286723,"target_map_1 = np.zeros((rows, cols), dtype=np.uint32); target_map_1 = vec_intensity(myarr, target_map_1)","target_map_2 = np.zeros((rows, cols), dtype=np.uint32); target_map_2 = intensity(myarr, target_map_2)",53.1,934
17289855,answer,17288636,"python,datetime,time,group-by,pandas",codeblock,https://stackoverflow.com/questions/17289855,all_data.groupby(lambda x: x.time()).mean(),all_data.groupby(all_data.index.time).mean(),11800,11800
17289855,answer,17288636,"python,datetime,time,group-by,pandas",codeblock,https://stackoverflow.com/questions/17289855,all_data.groupby(all_data.index.time).mean(),all_data.groupby(lambda x: x.time()).mean(),113,215
17291741,answer,17283583,"numpy,hdf5,h5py",codeblock,https://stackoverflow.com/questions/17291741,"repeat_dataset=np.repeat(ref_array, 2*2).reshape((2,2))","empty_dataset=np.empty(2*2,dtype=my_dtype); empty_dataset[:]=ref_array",0.00592,0.00909
17301720,answer,17293667,"python,numpy",codeblock,https://stackoverflow.com/questions/17301720,"compdata2 = np.take(np.exp(sflist[:, None] * t_range), sfcube, axis=0)",compdata = [[np.exp(t_range*sflist[y]) for y in x] for x in sfcube],72.2,1760
17354744,answer,17354439,"python,numpy,slice",codeblock,https://stackoverflow.com/questions/17354744,"for j in np.swapaxes(a, 0, 1): j","for j in np.rollaxis(a, 1): j",0.0267,0.0282
17437801,answer,17437523,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/17437801,"np.einsum('ij,ik->jk', A, B)","np.array([np.outer(A[i], B[i]) for i in xrange(n)]).sum(0)",0.00461,0.169
17437885,answer,17437817,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/17437885,"np.einsum('ij,ji->i', a, b)",np.diagonal(a.dot(b)),7.49,7040
17457946,answer,17457329,pandas,codeblock,https://stackoverflow.com/questions/17457946,df.loc[(df.index % 2).astype(bool)],df.iloc[(df.index % 2).astype(bool)],5.48,5.67
17528702,answer,17527340,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/17528702,"deltas = (a[:, None, :] - b[..., None]).T; inner1d(deltas, deltas)","deltas = a[:, None, :] - b[..., None]; np.einsum('ijk,ijk->jk', deltas, deltas)",145,163
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.append(heights, heights[0])","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.hstack((heights, heights[0:1]))",0.00624,0.00731
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,21)); heights[-1] = heights[0]","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.append(heights, heights[0])",0.00193,0.00624
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,21)); heights[-1] = heights[0]","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.concatenate((heights, heights[0:1]))",0.00193,0.00274
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,21)); heights[-1] = heights[0]","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.hstack((heights, heights[0:1]))",0.00193,0.00731
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.concatenate((heights, heights[0:1]))","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.append(heights, heights[0])",0.00274,0.00624
17578619,answer,17578566,"python,random,numpy,numbers,append",codeblock,https://stackoverflow.com/questions/17578619,"heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.concatenate((heights, heights[0:1]))","heights = np.random.randint(10, size=np.random.randint(1,20)); heights = np.hstack((heights, heights[0:1]))",0.00274,0.00731
17690868,answer,17690738,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/17690868,pd.to_datetime(pd.Series(dates)),pd.Series([pd.to_datetime(date) for date in dates]),5.71,1710
17841486,answer,17840661,"python,arrays,numpy,min",codeblock,https://stackoverflow.com/questions/17841486,a.argmin(axis=0),np.asfortranarray(a).argmin(axis=0),1950,1970
17841486,answer,17840661,"python,arrays,numpy,min",codeblock,https://stackoverflow.com/questions/17841486,a.T.argmin(axis=1),a.argmin(axis=0),1780,1950
17841486,answer,17840661,"python,arrays,numpy,min",codeblock,https://stackoverflow.com/questions/17841486,a.T.argmin(axis=1),np.asfortranarray(a).argmin(axis=0),1780,1970
17982141,answer,17982050,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/17982141,"np.take( levs, k_low )",levs[k_low],0.439,2.3
17983100,answer,17982931,"python,numpy,machine-learning,scikit-learn,mathematical-optimization",codeblock,https://stackoverflow.com/questions/17983100,"mean=nanmean(a,axis=0);index=np.where(np.isnan(a));a[index]=np.take(mean,index[1])","DF=pd.DataFrame(a1);col_means = DF.apply(np.mean, 0);DF.fillna(value=col_means)",1840,5810
17994722,answer,17982931,"python,numpy,machine-learning,scikit-learn,mathematical-optimization",codeblock,https://stackoverflow.com/questions/17994722,"mean=nanmean(a,axis=0);index=np.where(np.isnan(a));a[index]=np.take(mean,index[1])","DF=pd.DataFrame(a1);col_means = DF.apply(np.mean, 0);DF.fillna(value=col_means)",2230,7230
18048719,answer,18048646,"python,numpy",codeblock,https://stackoverflow.com/questions/18048719,np.concatenate(x),np.hstack(x),13.6,40.5
18057209,answer,18049523,"python,performance,function,numpy,performance-testing",codeblock,https://stackoverflow.com/questions/18057209,np.max(aa),max(bb),1.52,31.2
18083122,answer,18082398,"python,pandas",codeblock,https://stackoverflow.com/questions/18083122,"df.apply(lambda x: x.shift(-c.next() + 1), 1)","df.apply(lambda x: x.shift(-x.notnull().argmax()), 1)",0.766,1.08
18084666,answer,18083816,"python,numpy",codeblock,https://stackoverflow.com/questions/18084666,"a=np.arange(1,x.max()+1);np.concatenate([a[:k] for k in x])","a=np.arange(1,x.max()+1);np.hstack([a[:k] for k in x])",998,3030
18084666,answer,18083816,"python,numpy",codeblock,https://stackoverflow.com/questions/18084666,"np.concatenate([np.arange(1,n+1) for n in x])","np.hstack([np.arange(1,n+1) for n in x])",5270,7460
18104992,answer,18104816,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/18104992,"b[:,88].sum()","a[:,88].sum()",0.129,1.88
18207544,answer,8486294,"python,numpy",codeblock,https://stackoverflow.com/questions/18207544,"b = np.zeros((a.shape[0], a.shape[1]+1)); b[:,:-1] = a","b = np.hstack((a, np.zeros((a.shape[0], 1))))",0.00217,0.0075
18207897,answer,877479,"python,arrays,math,numpy",sentence,insert may be slower than append but allows you to fill the whole row/column with one value easily.,append,insert,,
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"np.einsum('...ijk->...i',a)/(a.shape[-1]*a.shape[-2])","a.reshape(11, 25).mean(axis=1)",0.00826,0.0214
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"np.einsum('...ijk->...i',a)/(a.shape[-1]*a.shape[-2])","a.mean(axis=(1,2))",0.00826,0.0194
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"np.einsum('...ijk->...i',a)/(a.shape[-1]*a.shape[-2])","a.reshape(110,2500).mean(axis=1)",0.145,0.307
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"np.einsum('...ijk->...i',a)/(a.shape[-1]*a.shape[-2])","a.mean(axis=(1,2))",0.145,0.308
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"a.mean(axis=(1,2))","a.reshape(11, 25).mean(axis=1)",0.0194,0.0214
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"a.reshape(110,2500).mean(axis=1)","a.mean(axis=(1,2))",0.307,0.308
18358464,answer,18357065,"arrays,numpy,multidimensional-array,slice,mean",codeblock,https://stackoverflow.com/questions/18358464,"np.einsum('ijk->',a)",np.sum(a),0.144,0.293
18365665,answer,18365073,"python,arrays,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/18365665,"np.einsum('i->', a)",np.sum(a),0.0126,0.0165
18365665,answer,18365073,"python,arrays,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/18365665,"np.einsum('ijk->', a)",np.sum(a),1.2,1.23
18365665,answer,18365073,"python,arrays,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/18365665,"np.einsum('i->', a)",np.sum(a),0.103,0.109
18365665,answer,18365073,"python,arrays,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/18365665,"np.einsum('ijk->', a)",np.sum(a),0.00379,0.00733
18365665,answer,18365073,"python,arrays,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/18365665,"np.einsum('i->', a)",np.sum(a),0.00332,0.00684
18420254,answer,18419962,"python,pandas,dataframe,calculated-columns,weighted-average",codeblock,https://stackoverflow.com/questions/18420254,df.dot(weight),(df * weight[0]).sum(1),57.5,125
18420254,answer,18419962,"python,pandas,dataframe,calculated-columns,weighted-average",codeblock,https://stackoverflow.com/questions/18420254,df.dot(weight),(df * weight[0]).sum(1),5.14,41.8
18454118,answer,18453771,"python,numpy",codeblock,https://stackoverflow.com/questions/18454118,"np.einsum('i,i,i->i',x,x,x,out=x)","np.power(x,3,out=x)",111,609
18574551,answer,18572083,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/18574551,"np.repeat(a,N,axis=0)","rows, cols = a.shape;b=np.hstack(N*(a,));b.reshape(N*rows, cols)",3.93,245
18574551,answer,18572083,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/18574551,"np.repeat(a,N,axis=0)","rows, cols = a.shape;b=np.hstack(N*(a,));b.reshape(N*rows, cols)",0.0046,0.257
18644339,answer,3030480,"python,numpy",codeblock,https://stackoverflow.com/questions/18644339,"np.logical_and(a < b, b < c)","np.all([a < b, b < c], 0)",0.00117,0.00506
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[np.random.choice(df.index, 10, replace=False)]",df.loc[np.random.permutation(df.index)[:10]],1360,1380
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[sample(df.index, 10)]",df.loc[np.random.permutation(df.index)[:10]],1.19,1380
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[sample(df.index, 1000)]","df.loc[np.random.choice(df.index, 1000, replace=False)]",14.5,1280
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[sample(df.index, 1000)]",df.loc[np.random.permutation(df.index)[:1000]],14.5,1300
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[sample(df.index, 10)]","df.loc[np.random.choice(df.index, 10, replace=False)]",1.19,1360
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[np.random.choice(df.index, 100000, replace=False)]","df.loc[sample(df.index, 100000)]",1360,1630
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[np.random.choice(df.index, 1000, replace=False)]",df.loc[np.random.permutation(df.index)[:1000]],1280,1300
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,df.loc[np.random.permutation(df.index)[:100000]],"df.loc[sample(df.index, 100000)]",1400,1630
18714869,answer,18713929,"python,numpy,pandas,subsampling",codeblock,https://stackoverflow.com/questions/18714869,"df.loc[np.random.choice(df.index, 100000, replace=False)]",df.loc[np.random.permutation(df.index)[:100000]],1360,1400
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_float32.T,arr_float32)","np.dot(arr_float64.T,arr_float64)",513,969
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_float64.T,arr_float64)","np.dot(arr_int64.T,arr_int64)",969,24700
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_float64.T,arr_float64)","np.dot(arr_int32.T,arr_int32)",969,21300
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_float32.T,arr_float32)","np.dot(arr_int64.T,arr_int64)",513,24700
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_float32.T,arr_float32)","np.dot(arr_int32.T,arr_int32)",513,21300
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.einsum('ij,jk',arr_int32.T,arr_int32)","np.einsum('ij,jk',arr_int64.T,arr_int64)",14100,26000
18746060,answer,18743397,"python,numpy,floating-point,int32",codeblock,https://stackoverflow.com/questions/18746060,"np.dot(arr_int32.T,arr_int32)","np.dot(arr_int64.T,arr_int64)",21300,24700
18766020,answer,18765904,"python,numpy",codeblock,https://stackoverflow.com/questions/18766020,a[a.astype(np.bool)],a[a==1],0.00244,0.00439
18766020,answer,18765904,"python,numpy",codeblock,https://stackoverflow.com/questions/18766020,a[a.astype(np.bool)],a[a==1],56,59.6
18771534,answer,18771236,"python,arrays,string,numpy,indexing",codeblock,https://stackoverflow.com/questions/18771534,np.vectorize(lambda x: x[:3])(lines),lines.view(np.chararray).ljust(3),239,542
18793990,answer,18793771,"python,numpy",codeblock,https://stackoverflow.com/questions/18793990,np.diff(a.view('uint8')),"np.diff(np.array(a, 'uint8'))",2.45,3.42
18793990,answer,18793771,"python,numpy",codeblock,https://stackoverflow.com/questions/18793990,np.diff(a.astype('uint8')),"np.diff(np.array(a, 'uint8'))",3.41,3.42
18793990,answer,18793771,"python,numpy",codeblock,https://stackoverflow.com/questions/18793990,np.diff(a.view('uint8')),np.diff(a.astype('uint8')),2.45,3.41
18855277,answer,18854425,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/18855277,"np.sum(inner1d(a, b.T))",np.sum(a*b.T),1.83,4.85
18855277,answer,18854425,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/18855277,"np.sum(inner1d(a, b.T))",np.trace(a.dot(b)),1.83,34.7
18855277,answer,18854425,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/18855277,np.sum(a*b.T),np.trace(a.dot(b)),4.85,34.7
18856417,answer,18856364,"python,numpy,where,zero",codeblock,https://stackoverflow.com/questions/18856417,(a == 0).sum(),len(a) - numpy.count_nonzero(a),249,326
18876279,answer,18875970,"python,numpy",codeblock,https://stackoverflow.com/questions/18876279,"np.digitize(b,a)",[np.where(a<=x)[0][0] for x in b],0.0481,4.97
18879894,answer,18879782,"python,for-loop,pandas",codeblock,https://stackoverflow.com/questions/18879894,df.reindex(idx),df.loc[idx],0.121,0.147
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df['a'].str.startswith(""t"")","df[df['a'].str.startswith(""t"")]",0.118,0.348
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[[x.startswith('t') for x in df['a']]],df[df['a'].map(lambda x: x.startswith('t'))],0.194,0.304
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[df['a'].map(lambda x: x.startswith('t'))],"df[df['a'].str.startswith(""t"")]",0.304,0.348
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[[x.startswith('t') for x in df['a']]],"df[df['a'].str.startswith(""t"")]",0.194,0.348
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),"df['a'].str.startswith(""t"")",46.6,48.5
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),df[df['a'].map(lambda x: x.startswith('t'))],46.6,47.1
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df['a'].str.startswith(""t"")",df[[x.startswith('t') for x in df['a']]],48.5,52.8
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),"df[df['a'].str.startswith(""t"")]",46.6,49.6
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[df['a'].map(lambda x: x.startswith('t'))],"df['a'].str.startswith(""t"")",47.1,48.5
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[df['a'].map(lambda x: x.startswith('t'))],"df[df['a'].str.startswith(""t"")]",47.1,49.6
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df['a'].str.startswith(""t"")",df[[x.startswith('t') for x in df['a']]],0.118,0.194
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df['a'].str.startswith(""t"")","df[df['a'].str.startswith(""t"")]",48.5,49.6
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[df['a'].map(lambda x: x.startswith('t'))],df[[x.startswith('t') for x in df['a']]],47.1,52.8
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),df[[x.startswith('t') for x in df['a']]],46.6,52.8
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df['a'].str.startswith(""t"")",df[df['a'].map(lambda x: x.startswith('t'))],0.118,0.304
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,"df[df['a'].str.startswith(""t"")]",df[[x.startswith('t') for x in df['a']]],49.6,52.8
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),"df[df['a'].str.startswith(""t"")]",0.0858,0.348
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),"df['a'].str.startswith(""t"")",0.0858,0.118
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),df[df['a'].map(lambda x: x.startswith('t'))],0.0858,0.304
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df['a'].map(lambda x: x.startswith('t')),df[[x.startswith('t') for x in df['a']]],0.0858,0.194
18933101,answer,18932254,"python,pandas",codeblock,https://stackoverflow.com/questions/18933101,df[pd.Series([x.startswith('t') for x in df['a']])],df[np.array([x.startswith('t') for x in df['a']])],37.5,40.7
18938438,answer,18938065,"python,arrays,optimization,numpy,cython",codeblock,https://stackoverflow.com/questions/18938438,np.sum(v_np),sum(v_list),1.62,19.5
19004390,answer,19004118,"python,arrays,numpy",sentence,X[~Z] is faster than X[Z==0]:,X[~Z],X[Z==0],,
19034922,answer,19034631,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/19034922,a=arr.astype(np.complex);a[1:].imag = a[0].real,"np.vstack((arr[0,:], arr[1:,:] + arr[0,:] * 1.j))",0.898,1.77
19034922,answer,19034631,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/19034922,a=arr.astype(np.complex);a[1:].imag = a[0].real,"np.vstack((arr[0,:], arr[1:,:] + arr[0,:] * 1.j))",0.00403,0.0252
19101774,answer,19100540,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/19101774,df.apply(f),"df.applymap(lambda x: round(x, 2))",33.4,2520
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,"np.sum(x - x[:,None], 1)",y = np.array([sum(x - k) for k in x]),0.059,6.86
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,"np.sum(x - x[:,None], 1)",y = np.array([np.sum(x - k) for k in x]),0.059,1.54
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,y = np.array([np.sum(x - k) for k in x]),y = np.array([sum(x - k) for k in x]),17.2,592
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,y = np.array([np.sum(x - k) for k in x]),y = np.array([sum(x - k) for k in x]),1.54,6.86
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,"np.sum(x - x[:,None], 1)",y = np.array([np.sum(x - k) for k in x]),8.67,17.2
19117722,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19117722,"np.sum(x - x[:,None], 1)",y = np.array([sum(x - k) for k in x]),8.67,592
19121271,answer,19117277,"python,loops,numpy,indexing",codeblock,https://stackoverflow.com/questions/19121271,np.sum(x) - x.size * x,"np.sum(x - x[:,None], 1)",0.0165,6.33
19141093,answer,19138505,"python,numpy,matplotlib,pandas,scipy",codeblock,https://stackoverflow.com/questions/19141093,"np.log(1 + r*a[:,None]).mean(1)",[scipy.mean(log(1+a[i]*r)) for i in range(len(a))],0.384,5.47
19145572,answer,19142123,"python,pandas",codeblock,https://stackoverflow.com/questions/19145572,"anno_per_user_perday1 = data1.sum(level=['date','uid']).mean(level='date').anno",daily_users = data2.groupby('date').uid.nunique() ; daily_annotations = data2.groupby('date').count().uid ; anno_per_user_perday2 = daily_annotations / daily_users.map(float),149,387
19259323,answer,19258772,"python,pandas",codeblock,https://stackoverflow.com/questions/19259323,"lhs, rhs = df.align(df.T); res = lhs.add(rhs, fill_value=0).fillna(0)",df.combine_first(df.T).fillna(0),1.27,2.01
19259323,answer,19258772,"python,pandas",codeblock,https://stackoverflow.com/questions/19259323,df.combine_first(df2).fillna(0),"lhs, rhs = df.align(df2); res = lhs.add(rhs, fill_value=0).fillna(0)",2950,4410
19322935,answer,19313936,"python,performance,mongodb,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/19322935,"sps.vstack(csr_vecs, format='csr')","sps.vstack(lil_vecs, format='lil')",722,1340
19329759,answer,19329667,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/19329759,dist_2 = dist_1.prod(axis=1),dist_2 = np.array([i[0]*i[1] for i in dist_1]),0.116,1.35
19347602,answer,19346276,"python,list,for-loop,numpy,append",codeblock,https://stackoverflow.com/questions/19347602,"np.dot(aa, bb)","np.dot(a, b)",0.0034,0.054
19410684,answer,19410629,"python-2.7,pandas,ipython,dataframe",codeblock,https://stackoverflow.com/questions/19410684,df1.loc[idx1.intersection(idx2)],df1.ix[idx1.intersection(idx2)],0.269,0.276
19410684,answer,19410629,"python-2.7,pandas,ipython,dataframe",codeblock,https://stackoverflow.com/questions/19410684,df1.reindex(idx1.intersection(idx2)),df1.loc[idx1.intersection(idx2)],0.186,0.269
19410684,answer,19410629,"python-2.7,pandas,ipython,dataframe",codeblock,https://stackoverflow.com/questions/19410684,df1.reindex(idx1.intersection(idx2)),df1.ix[idx1.intersection(idx2)],0.186,0.276
19480656,answer,19479384,"python,arrays,optimization,numpy",codeblock,https://stackoverflow.com/questions/19480656,"a = np.asfortranarray(np.random.randn(500,400))","a = np.random.randn(500, 400)",0.114,0.599
19480656,answer,19479384,"python,arrays,optimization,numpy",codeblock,https://stackoverflow.com/questions/19480656,"a = np.asfortranarray(np.random.randn(500,400))","a = np.random.randn(500, 400)",0.114,0.272
19480656,answer,19479384,"python,arrays,optimization,numpy",codeblock,https://stackoverflow.com/questions/19480656,"a = np.asfortranarray(np.random.randn(500,400))","a = np.random.randn(500, 400)",0.114,0.269
19490228,answer,19490064,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/19490228,"pd.concat((df1, df2), axis=1).mean(axis=1)","df3 = pd.concat((df1, df2)); df3.groupby(df3.index).mean()",0.524,0.617
19490228,answer,19490064,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/19490228,"pd.merge(df1, df2, left_index=True, right_index=True, how='outer').mean(axis=1)","df3 = pd.concat((df1, df2)); df3.groupby(df3.index).mean()",0.577,0.617
19490228,answer,19490064,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/19490228,"pd.concat((df1, df2), axis=1).mean(axis=1)","pd.merge(df1, df2, left_index=True, right_index=True, how='outer').mean(axis=1)",0.524,0.577
19539585,answer,19539267,"python,arrays,numpy",sentence,"[edit] ok, it seems that use of np.repeat is slower than use of np.zeros(20) + np.nan like in mr e鈥檚 answer:",np.zeros(20) + np.nan,np.repeat,,
19539585,answer,19539267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19539585,np.zeros(10000) + np.nan,"np.repeat(np.nan, 10000)",0.0161,0.0708
19539585,answer,19539267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19539585,"np.append(n, n)","np.hstack((n, n))",0.00556,0.00787
19539585,answer,19539267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19539585,"np.hstack((n, np.zeros(20) + np.nan))","np.append(n, np.repeat(np.nan, 20))",0.0132,0.0154
19539585,answer,19539267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19539585,"np.append(n, np.zeros(20) + np.nan)","np.hstack((n, np.zeros(20) + np.nan))",0.0105,0.0132
19539585,answer,19539267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19539585,"np.append(n, np.zeros(20) + np.nan)","np.append(n, np.repeat(np.nan, 20))",0.0105,0.0154
19688449,answer,19682521,"python,arrays,sorting,numpy",codeblock,https://stackoverflow.com/questions/19688449,"np.argsort(rec, order=['f0'])","np.argsort(rec, order=['f0', 'f1'])",27.9,28.4
19771171,answer,19770361,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19771171,"tmp = (arr == np.array([10,15,30])); (tmp[:,:,0] & tmp[:,:,1] & tmp[:,:,2])","np.all(arr == np.array([10,15,30]), axis=-1)",368,614
19771171,answer,19770361,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/19771171,"np.einsum('ij,ij,ij->ij',tmp[:,:,0] , tmp[:,:,1] , tmp[:,:,2])","np.all(tmp,axis=-1)",38,318
19794741,answer,7741878,"python,numpy",codeblock,https://stackoverflow.com/questions/19794741,"np.sum(np.abs(x)**2,axis=-1)**(1./2)","np.apply_along_axis(np.linalg.norm, 1, x)",2.6,21
19794741,answer,7741878,"python,numpy",codeblock,https://stackoverflow.com/questions/19794741,"np.linalg.norm(x, axis=1)","np.sum(np.abs(x)**2,axis=-1)**(1./2)",1.4,2.6
19794741,answer,7741878,"python,numpy",codeblock,https://stackoverflow.com/questions/19794741,"np.linalg.norm(x, axis=1)","np.apply_along_axis(np.linalg.norm, 1, x)",1.4,21
19836221,answer,19834075,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/19836221,"np.clip(arr, 0, None)",df.clip_lower(0),6.62,12.9
19844160,answer,19841456,"c++,python,performance,csv,pandas",codeblock,https://stackoverflow.com/questions/19844160,"pd.read_hdf('test.h5','df')","read_csv('test.csv',index_col=0)",20.2,948
20038973,answer,20037430,"python,json,pandas",codeblock,https://stackoverflow.com/questions/20038973,l=[ json.loads(l) for l in test.splitlines()]; df = pd.DataFrame(l),"pd.read_json('[%s]' % ','.join(test.splitlines()))",0.282,0.977
20038973,answer,20037430,"python,json,pandas",codeblock,https://stackoverflow.com/questions/20038973,l = [json.loads(l) for l in test_100.splitlines()]; df = pd.DataFrame(l),"pd.read_json('[%s]' % ','.join(test_100.splitlines()))",1.25,1.25
20038973,answer,20037430,"python,json,pandas",codeblock,https://stackoverflow.com/questions/20038973,"pd.read_json('[%s]' % ','.join(test_1000.splitlines()))",l = [json.loads(l) for l in test_1000.splitlines()]; df = pd.DataFrame(l),3.36,9.78
20084843,answer,20083098,"python,performance,pandas,hdf5,pytables",codeblock,https://stackoverflow.com/questions/20084843,"df.to_hdf('test.hdf','df',mode='w',format='table',index=False,chunksize=2000000)","df.to_hdf('test.hdf','df',mode='w',format='table',index=False)",44500,45000
20084895,answer,20084382,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/20084895,Series(df.values.ravel()).unique(),np.unique(df.values.ravel()),137,270
20153474,answer,20149201,"python,performance,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20153474,"np.einsum('ij,jk,ik->i', a, b, c)","np.sum(a[:, :, None] * b[None, :, :] * c[:, None, :], axis=(1, 2))",2.41,12.3
20156773,answer,20149201,"python,performance,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20156773,"np.einsum('im,im->i',A,X)","np.dot(X,C)",163,781
20156773,answer,20149201,"python,performance,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20156773,"np.dot(X,C)","np.einsum('ik,km->im',X,C)",781,1280
20156773,answer,20149201,"python,performance,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20156773,"np.einsum('im,im->i',np.dot(X,C),X)","np.einsum('im,im->i',np.einsum('ik,km->im',X,C),X)",950,1450
20169324,answer,20168881,"python,arrays,numpy,matrix,norm",codeblock,https://stackoverflow.com/questions/20169324,"np.add.reduceat(a.data * a.data, a.indptr[:-1])",a.multiply(a).sum(1),0.0368,0.288
20177478,answer,20175187,"opencv,image-processing,numpy,convolution",codeblock,https://stackoverflow.com/questions/20177478,y = np.transpose(x),y = np.transpose(x).copy(),0.000701,0.00148
20221218,answer,20221181,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/20221218,"a[..., ::-1]","a[:,:,::-1]",0.00106,0.00153
20280866,answer,20279188,"python,pandas",codeblock,https://stackoverflow.com/questions/20280866,g['val1'].sum() / g['val2'].sum(),g.apply(h),0.6,1.79
20370457,answer,20369978,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/20370457,"c = dfL[""path""].str.split("","").apply(Counter); d = pd.DataFrame({n: c.apply(lambda x: x.get(n, 0)) for n in wordlist})","splitted = dfL[""path""].str.split("",""); d = pd.DataFrame({name : splitted.apply(lambda x: x.count(name)) for name in wordlist})",1765.34,2333.29
20370457,answer,20369978,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/20370457,"splitted = dfL[""path""].str.split("",""); d = pd.DataFrame({name : splitted.apply(lambda x: x.count(name)) for name in wordlist})","c = dfL[""path""].str.split("","").apply(Counter); d = pd.DataFrame({n: c.apply(lambda x: x.get(n, 0)) for n in wordlist})",530.542,736.327
20396811,answer,20396497,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20396811,"from __main__ import np, A_list, B_list; np.linalg.solve(A_list, B_list)","from __main__ import np, A, B; np.linalg.solve(A,B)",278.631,43485.2
20396811,answer,20396497,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20396811,"from __main__ import np, A_list, B_list; np.array([np.linalg.solve(A,B) for A, B in zip(A_list, B_list)])","from __main__ import np, A, B; np.linalg.solve(A,B)",8431.87,43485.2
20396811,answer,20396497,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/20396811,"from __main__ import np, A_list, B_list; np.linalg.solve(A_list, B_list)","from __main__ import np, A_list, B_list; np.array([np.linalg.solve(A,B) for A, B in zip(A_list, B_list)])",278.631,8431.87
20400262,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400262,"from __main__ import np, pd, a, b; pd.concat([a, b], ignore_index=True)","from __main__ import np, pd, a, b; a.append(b).reset_index(drop=True)",1020.39,2228.21
20400262,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400262,"from __main__ import np, pd, a, b; pd.Series(np.concatenate([a,b]))","from __main__ import np, pd, a, b; a.append(b).reset_index(drop=True)",613.397,2228.21
20400262,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400262,"from __main__ import np, pd, a, b; pd.Series(np.concatenate([a,b]))","from __main__ import np, pd, a, b; pd.concat([a, b], ignore_index=True)",613.397,1020.39
20400370,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400370,"pd.Series(np.concatenate([a,b]))",a.append(b).reset_index(drop=True),1.05,5.11
20400370,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400370,"pd.Series(np.concatenate([a,b]))","pd.concat([a, b], ignore_index=True)",1.05,1.07
20400370,answer,20400135,"python,pandas",codeblock,https://stackoverflow.com/questions/20400370,"pd.concat([a, b], ignore_index=True)",a.append(b).reset_index(drop=True),1.07,5.11
20401232,answer,20400986,"python,arrays,sorting,numpy,filtering",codeblock,https://stackoverflow.com/questions/20401232,[x.compress(x) for x in LA if x.any()],[x.compress(x) for x in LA if count_nonzero(x)],42.7,45.8
20401232,answer,20400986,"python,arrays,sorting,numpy,filtering",codeblock,https://stackoverflow.com/questions/20401232,[x[x!=0] for x in LA if x.any()],[x.compress(x) for x in LA if x.any()],22.9,42.7
20401232,answer,20400986,"python,arrays,sorting,numpy,filtering",codeblock,https://stackoverflow.com/questions/20401232,[x[x!=0] for x in LA if x.any()],[x.compress(x) for x in LA if count_nonzero(x)],22.9,45.8
20459839,answer,20459536,"python,numpy,pandas,scipy",sentence,"df.values is a numpy array, and accessing values that way is always faster than np.array.",df.values,np.array,,
20461507,answer,20461271,"python,performance,numpy,matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/20461507,"colb = np.copy( B[:,n] ); colb[ n ] = 0; X = np.outer( A[:,n], B[n,:] ); X[:,n] += np.dot( A, colb )","np.dot(A, B)",0.0985,1.39
20694622,answer,20693363,"python,pandas",codeblock,https://stackoverflow.com/questions/20694622,"df.groupby('id', as_index=False).head(2)",df.groupby('id').head(2).reset_index(drop=True),1.76,1.82
20694622,answer,20693363,"python,pandas",codeblock,https://stackoverflow.com/questions/20694622,"df.groupby('id', as_index=False).head(2)",df.groupby('id').head(2).reset_index(drop=True),0.279,1.82
20818530,answer,8486294,"python,numpy",codeblock,https://stackoverflow.com/questions/20818530,"b = np.empty((a.shape[0],a.shape[1]+1)); b[:,:-1] = a; b[:,-1] = np.zeros((a.shape[0],))","b = np.zeros((a.shape[0],a.shape[1]+1)); b[:,:-1] = a",407,492
20895852,answer,20894733,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/20895852,"a[np.in1d(a, [1, 2, 8]).reshape(a.shape)] = 0","np.where(np.in1d(a, [1,2,8]).reshape(a.shape), 0, a)",0.0458,0.0667
20910319,answer,20908754,"python,performance,numpy,outer-join",sentence,the nested einsum is about twice as fast as cross for the largest n tested.,einsum,cross,,
20930910,answer,20915502,"python,numpy,scipy,interpolation,qhull",codeblock,https://stackoverflow.com/questions/20930910,"interpolate(f, vtx, wts)","interpolate(g, vtx, wts)",0.0664,0.067
20930910,answer,20915502,"python,numpy,scipy,interpolation,qhull",codeblock,https://stackoverflow.com/questions/20930910,"interpolate(g, vtx, wts)","spint.griddata(xyz, f, uvw)",0.067,2810
20930910,answer,20915502,"python,numpy,scipy,interpolation,qhull",codeblock,https://stackoverflow.com/questions/20930910,"interpolate(f, vtx, wts)","spint.griddata(xyz, f, uvw)",0.0664,2810
21043717,answer,21043644,"python,arrays,math,numpy,cosine",codeblock,https://stackoverflow.com/questions/21043717,b=np.cos(a),cos_ra = [math.cos(i) for i in a],0.165,0.225
21146167,answer,1550130,"python,matlab,numpy,octave,linear-algebra",codeblock,https://stackoverflow.com/questions/21146167,"c = np.repeat(b[:, newaxis], 100, axis=1)","c = np.array([b,]*100).transpose()",0.347,5.56
21146167,answer,1550130,"python,matlab,numpy,octave,linear-algebra",codeblock,https://stackoverflow.com/questions/21146167,"c = np.repeat(b[:, newaxis], 100, axis=1)","c = np.tile(b[:, newaxis], (1,100))",0.347,0.354
21146167,answer,1550130,"python,matlab,numpy,octave,linear-algebra",codeblock,https://stackoverflow.com/questions/21146167,"c = np.tile(b[:, newaxis], (1,100))","c = np.array([b,]*100).transpose()",0.354,5.56
21172961,answer,21172482,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/21172961,"esum_same = np.einsum('ij,jl->il', lowDimRepresentation, principalComponents)","sameDimRepresentation = (lowDimRepresentation[:, np.newaxis] * principalComponents.T).sum(axis=2)",88.7,1120
21295630,answer,21295334,"python,pandas",codeblock,https://stackoverflow.com/questions/21295630,df.col1.map(len).max(),df.col1.map(lambda x: len(x)).max(),10.1,16.4
21295630,answer,21295334,"python,pandas",codeblock,https://stackoverflow.com/questions/21295630,df.col1.str.len().max(),df.col1.map(lambda x: len(x)).max(),11.7,16.4
21295630,answer,21295334,"python,pandas",codeblock,https://stackoverflow.com/questions/21295630,df.col1.map(len).max(),df.col1.str.len().max(),10.1,11.7
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.sum(myarr >= thresh),"np.size(np.where(np.reshape(myarr,-1) >= thresh))",4.86,61.6
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.count_nonzero(myarr >= thresh),np.sum(myarr >= thresh),473,511
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.count_nonzero(myarr >= thresh),"np.size(np.where(np.reshape(myarr,-1) >= thresh))",473,6070
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.sum(myarr >= thresh),"np.size(np.where(np.reshape(myarr,-1) >= thresh))",511,6070
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.count_nonzero(myarr >= thresh),np.sum(myarr >= thresh),4.45,4.86
21370383,answer,21367595,"python,arrays,performance,numpy,boolean",codeblock,https://stackoverflow.com/questions/21370383,np.count_nonzero(myarr >= thresh),"np.size(np.where(np.reshape(myarr,-1) >= thresh))",4.45,61.6
21410701,answer,21407815,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21410701,np.where(a > 0.5),np.nonzero(a > 0.5),467,470
21410701,answer,21407815,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21410701,np.column_stack(np.where(a > 0.5)),np.transpose(np.nonzero(a > 0.5)),653,2560
21464274,answer,21462214,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/21464274,matrix[0] = row,matrix[0] = row[0],68.7,104
21467608,answer,21467429,"python,pandas",codeblock,https://stackoverflow.com/questions/21467608,"arr = (~df.isnull()).values.astype('int'); pd.DataFrame(np.einsum('ij,ik', arr, arr), columns=df.columns, index=df.columns)",df2 = df.applymap(lambda x: int(not pd.isnull(x)));  df2.T.dot(df2),0.132,1.12
21483009,comment,6431973,"python,numpy",sentence,"copyto(a,b) is faster than the array syntax a[:] = b.","copyto(a,b)",a[:] = b,,
21512343,answer,21512042,"python,indexing,pandas",codeblock,https://stackoverflow.com/questions/21512343,"df.between_time(start_time='01:00', end_time='02:00')",selector=(df.index.hour>=1) & (df.index.hour<2); df[selector],10.2,18.2
21632101,answer,21627787,"python,numpy",codeblock,https://stackoverflow.com/questions/21632101,"M[[1,2,3],:][:, [0,2,3]]","M[np.ix_([1,2,3],[0,2,3])]",0.0109,0.0178
21638812,answer,21637078,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/21638812,"np.einsum('ij,ij->i',a[:,0].reshape(-1,3), norms)","np.sum(a[:,0].reshape(-1,3)*norms,axis=1)",0.325,0.625
21731244,answer,21731029,"python,numpy",codeblock,https://stackoverflow.com/questions/21731244,sum2 = np.sum(np.tril(np.rot90(grid))),"sum1 = np.sum(grid[x,y] for x in xrange(a) for y in xrange(a-x))",0.0904,1.9
21738946,answer,21738882,"python,pandas",codeblock,https://stackoverflow.com/questions/21738946,"y.loc[np.in1d(y['name'], names), 'score'].sum()","y.loc[y['name'].isin(names), 'score'].sum()",0.335,0.413
21778195,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/21778195,data.size - np.count_nonzero(np.isnan(data)),np.count_nonzero(~np.isnan(data)),309,345
21778195,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/21778195,data.size - np.count_nonzero(np.isnan(data)),data.size - np.isnan(data).sum(),309,339
21778195,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/21778195,data.size - np.isnan(data).sum(),np.count_nonzero(~np.isnan(data)),339,345
21835733,answer,21834499,"python,numpy",codeblock,https://stackoverflow.com/questions/21835733,a[b],"take(a.ravel(), nonzero(ravel(b))[0])",12.9,18.7
21838712,answer,21838505,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21838712,(arr.view(dt) == b.view(dt)).reshape(-1),(arr == b).all(axis=1),0.00776,0.0135
21840695,answer,21840670,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/21840695,"np.subtract.outer(a, b)","np.transpose([a]) - np.tile(b, (len(a), 1))",87.8,120
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,C = np.empty(2E4); C[:10000]=A; C[10000:]=5,"C = np.concatenate((A, np.tile(np.array(5),1E4)))",0.0168,0.0921
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,C = np.empty(2E4); C[:10000]=A; C[10000:]=5,"np.concatenate((A,np.ones(1E4)*5))",0.0168,0.0395
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"np.concatenate((A,np.ones(1E4)*5))","C = np.concatenate((A, np.tile(np.array(5),1E4)))",0.0395,0.0921
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"np.concatenate((A,np.ones(1E4)*5))","np.concatenate((A,[5]*10000))",0.0395,1.1
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"C = np.concatenate((A, np.tile(np.array(5),1E4)))","np.concatenate((A,[5]*10000))",0.0921,1.1
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"np.append(A,A)","np.hstack((A,A))",0.019,0.0209
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"np.concatenate((A,A))","np.hstack((A,A))",0.0111,0.0209
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,C = np.empty(2E4); C[:10000]=A; C[10000:]=5,"np.concatenate((A,[5]*10000))",0.0168,1.1
21922328,answer,21922182,"python,arrays,numpy,append",codeblock,https://stackoverflow.com/questions/21922328,"np.concatenate((A,A))","np.append(A,A)",0.0111,0.019
21923587,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21923587,df['B'][df['A'] == 23].values,"df.loc[df['A'] == 23, 'B']",0.813,0.976
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,df['B'][df.A == 23],"df.loc[df.A == 23, 'B']",0.432,0.532
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,df['B'].loc[df.A.values == 23],"df.loc[df.A.values == 23, 'B']",0.197,0.294
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,df['B'].loc[df.A.values == 23],df['B'][df.A == 23],0.197,0.432
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,"df.loc[df.A.values == 23, 'B']",df['B'][df.A == 23],0.294,0.432
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,df['B'].loc[df.A.values == 23],"df.loc[df.A == 23, 'B']",0.197,0.532
21924609,answer,21923524,"python,pandas",codeblock,https://stackoverflow.com/questions/21924609,"df.loc[df.A.values == 23, 'B']","df.loc[df.A == 23, 'B']",0.294,0.532
21931851,answer,21931786,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21931851,"numpy.column_stack((A, A)).flatten()","numpy.tile(A,2).reshape(2,-1).flatten('F')",0.0447,0.129
21931851,answer,21931786,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21931851,"numpy.repeat(A, 2)","numpy.tile(A,2).reshape(2,-1).flatten('F')",0.104,0.129
21931851,answer,21931786,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21931851,"numpy.column_stack((A, A)).flatten()","numpy.repeat(A, 2)",0.0447,0.104
21954565,answer,21931786,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/21954565,"numpy.column_stack((A, A)).ravel()","numpy.repeat(A, 2)",0.0154,0.0539
22083625,answer,22083378,"python,pandas",codeblock,https://stackoverflow.com/questions/22083625,"df.where(df[::-1].cumsum()[::-1], 2)","df.where(df.replace(0, np.nan).bfill(), 2)",1.7,2.34
22083625,answer,22083378,"python,pandas",codeblock,https://stackoverflow.com/questions/22083625,"pd.DataFrame(np.where(np.cumsum(df.values[::-1], 0)[::-1], df.values, 2), df.index)","df.where(df.replace(0, np.nan).bfill(), 2)",0.186,2.34
22083625,answer,22083378,"python,pandas",codeblock,https://stackoverflow.com/questions/22083625,"pd.DataFrame(np.where(np.cumsum(df.values[::-1], 0)[::-1], df.values, 2), df.index)","df.where(df[::-1].cumsum()[::-1], 2)",0.186,1.7
22192423,answer,22191176,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/22192423,s.dropna().index,[i for i in s.index if not np.isnan(s[i])],0.106,34.9
22208838,answer,22208562,"python,pandas",codeblock,https://stackoverflow.com/questions/22208838,"df.loc[df[1].value_counts()[df[1]].values < 10, 1]","df.loc[g[1].transform(lambda x: len(x) < 10).values.astype(bool), 1]",1.57,44.6
22217738,answer,22215554,"python,arrays,numpy,matrix,linear-algebra",codeblock,https://stackoverflow.com/questions/22217738,m.dtype == int and m.min() == 0 and m.max() == 1,np.all((m == 0) | (m == 1)),0.0298,0.0337
22217738,answer,22215554,"python,arrays,numpy,matrix,linear-algebra",codeblock,https://stackoverflow.com/questions/22217738,m.dtype == int and m.min() == 0 and m.max() == 1,np.all((m == 0) | (m == 1)),481,705
22332667,answer,22326882,"python,arrays,optimization,numpy",codeblock,https://stackoverflow.com/questions/22332667,"np.concatenate([x[b:e] for b, e in izip(start, stop)])","np.hstack([x[i:j] for i,j in zip(start, stop)])",119,354
22440456,answer,22440378,numpy,codeblock,https://stackoverflow.com/questions/22440456,bar[foo==0] = invalid,"np.where(foo==0, invalid, foo)",0.0455,0.209
22486776,answer,22485375,"python,pandas",codeblock,https://stackoverflow.com/questions/22486776,"idx = np.zeros(N, dtype='bool'); idx[names] = True; df[idx[df['Name'].values]]",df[df.Name.isin(names)],62.6,178
22486776,answer,22485375,"python,pandas",codeblock,https://stackoverflow.com/questions/22486776,"idx = np.zeros(N, dtype='bool'); idx[names] = True; df[idx[df['Name'].values]]",df[df.Name.isin(names)],9.88,107
22521507,answer,22521414,"python,pandas",codeblock,https://stackoverflow.com/questions/22521507,rdata2.groupby(level=cnames[:2]).filter(lambda grp: grp.groupby(level=['K3']).ngroups == 2),rdata2.groupby(level=cnames[:2]).filter(lambda grp: len(set(grp.index.get_level_values('K3'))) == 2),772,1000
22521507,answer,22521414,"python,pandas",codeblock,https://stackoverflow.com/questions/22521507,rdata2.groupby(level=cnames[:2]).filter(lambda grp: grp.groupby(level=['K3']).ngroups == 2),rdata2.groupby(level=cnames[:2]).filter(lambda grp: len(set(grp.index.get_level_values('K3'))) == 2),11.9,13.4
22521507,answer,22521414,"python,pandas",codeblock,https://stackoverflow.com/questions/22521507,rdata2.groupby(level=cnames[:2]).filter(lambda grp: grp.index.get_level_values('K3').unique().size == 2),rdata2.groupby(level=cnames[:2]).filter(lambda grp: grp.groupby(level=['K3']).ngroups == 2),756,772
22521507,answer,22521414,"python,pandas",codeblock,https://stackoverflow.com/questions/22521507,rdata2.groupby(level=cnames[:2]).filter(lambda grp: grp.index.get_level_values('K3').unique().size == 2),rdata2.groupby(level=cnames[:2]).filter(lambda grp: len(set(grp.index.get_level_values('K3'))) == 2),756,1000
22597805,answer,22597353,"python,numpy,scipy,diagonal",codeblock,https://stackoverflow.com/questions/22597805,sparse.eye(3000),np.eye(3000),0.0795,3.12
22597805,answer,22597353,"python,numpy,scipy,diagonal",codeblock,https://stackoverflow.com/questions/22597805,sparse.eye(3000).dot(sparse.eye(3000)),np.eye(3000).dot(np.eye(3000)),1.11,2800
22674447,answer,22674196,"python,pandas",codeblock,https://stackoverflow.com/questions/22674447,"pd.concat([ Series([r]*len(grp.groups[i])) for i, r in enumerate(grp.tail(1).values) ],ignore_index=True)",grp.transform(lambda x: x.iloc[-1]),123,472
22721540,answer,22720864,"python,numpy,matrix,performance,euclidean-distance",codeblock,https://stackoverflow.com/questions/22721540,abs(z.T-z),"m, n = np.meshgrid(z, z); abs(m-n)",4645.65,22489.6
22721540,answer,22720864,"python,numpy,matrix,performance,euclidean-distance",codeblock,https://stackoverflow.com/questions/22721540,"abs(z[..., np.newaxis] - z)","m, n = np.meshgrid(z, z); abs(m-n)",5049.33,22489.6
22721540,answer,22720864,"python,numpy,matrix,performance,euclidean-distance",codeblock,https://stackoverflow.com/questions/22721540,abs(z.T-z),"abs(z[..., np.newaxis] - z)",4645.65,5049.33
22743022,answer,22740812,"python,python-2.7,math,numpy",codeblock,https://stackoverflow.com/questions/22743022,"np.dot(z**5, np.exp(-z*z / 2))",np.sum(z**5 * np.exp(-z*z / 2)),0.129,0.142
22846215,answer,22845856,"python,pandas",codeblock,https://stackoverflow.com/questions/22846215,df.groupby('value')['timestamp'].last(),df.groupby('value')['timestamp'].tail(1),9.07,16.3
22941522,answer,22941147,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/22941522,"df.to_hdf('test_fixed.hdf', 'test', mode='w')",df.to_records().astype(mytype).tofile('raw_data'),172,283
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.einsum('i,j', a, a)","np.outer(a,a)",0.0119,0.0177
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.outer(a,a)","np.dot(a[:,None],a[None,:])",0.605,1.29
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.dot(a[:,None],a[None,:])","np.einsum('i,j', a, a)",0.011,0.0119
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.einsum('i,j', a, a)","np.dot(a[:,None],a[None,:])",0.359,1.29
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.dot(a[:,None],a[None,:])","np.outer(a,a)",0.011,0.0177
22950320,answer,22949966,"python,numpy",codeblock,https://stackoverflow.com/questions/22950320,"np.einsum('i,j', a, a)","np.outer(a,a)",0.359,0.605
23059343,answer,23055793,"python,pandas",codeblock,https://stackoverflow.com/questions/23059343,"pd.concat([ Series([r]*len(grp.groups[i])) for i, r in enumerate(grp.size().values) ],ignore_index=True)",grp.transform(np.size),135,442
23062735,answer,23062698,"python,pandas",codeblock,https://stackoverflow.com/questions/23062735,df2.loc[~(df2 == 0).all(axis=1)],df2[~df2.isin([0]).all(axis=1)],5.19,50.2
23087309,answer,23078344,"python,pandas",codeblock,https://stackoverflow.com/questions/23087309,"b=pd.Series(0, index=a.index)",b=a.copy(); b[:] = 0,8.8,14.2
23087309,answer,23078344,"python,pandas",codeblock,https://stackoverflow.com/questions/23087309,"b=pd.Series(0, index=a.index)",b=pd.Series(index=a.index).fillna(0),8.8,409
23087309,answer,23078344,"python,pandas",codeblock,https://stackoverflow.com/questions/23087309,b=a.copy(); b[:] = 0,b=pd.Series(index=a.index).fillna(0),14.2,409
23097589,answer,23096417,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/23097589,"x[np.searchsorted(x, 0) :]",x[x >= 0],0.00147,0.0045
23097589,answer,23096417,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/23097589,"x[np.searchsorted(x, 0) :]",x[x >= 0],0.00161,0.00987
23101011,answer,23100450,"python,pandas",codeblock,https://stackoverflow.com/questions/23101011,"pd.rolling_mean(d, window=3, center=True)","d.apply(lambda x: pd.rolling_mean(x, window=3, center=True))",0.281,1.02
23165436,answer,23164619,"python,numpy,scipy,hdf5,h5py",codeblock,https://stackoverflow.com/questions/23165436,d1 = f[u'Acquisition.990'].values()[0][:],d2 = np.array(f[u'Acquisition.990'].values()),0.401,1770
23229224,answer,23228244,"python,numpy",codeblock,https://stackoverflow.com/questions/23229224,"iqr = np.subtract(*np.percentile(x, [75, 25]))","iqr = np.percentile(x, 75) - np.percentile(x, 25)",24.2,33.7
23229224,answer,23228244,"python,numpy",codeblock,https://stackoverflow.com/questions/23229224,"iqr = np.subtract(*np.percentile(x, [75, 25]))","q75, q25 = np.percentile(x, [75 ,25]); iqr = q75 - q25",24.2,24.2
23229224,answer,23228244,"python,numpy",codeblock,https://stackoverflow.com/questions/23229224,"q75, q25 = np.percentile(x, [75 ,25]); iqr = q75 - q25","iqr = np.percentile(x, 75) - np.percentile(x, 25)",24.2,33.7
23250677,answer,23248169,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/23250677,"np.min(np.nonzero(np.hstack((a, 1))))",np.where(a)[0][0] if np.shape(np.where(a)[0])[0] != 0  else np.shape(a)[0],91.1,107
23273115,answer,23272529,"python,pandas",codeblock,https://stackoverflow.com/questions/23273115,"df['a'] = df[['a1','a2','a3']].apply(lambda row: gen_col(row), axis=1)","df.apply(lambda x: test(x, [""a1"", ""a2"", ""a3""], ""a""), 1)",3.24,7.08
23312721,answer,23312675,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/23312721,g2[np.arange(len(g)) != 1],"np.concatenate([g2[:1], g2[2:]])",0.0069,0.0518
23318585,answer,23315486,"python,numpy",sentence,"to do the vector-wise operation you intended, use np.multiply((A1 + offsets) / norms , priorita), it is the same thing as np.matrix(np.array((A1 + offsets) / norms )* np.array(priorita)), but slightly faster, and reads better i think.","np.multiply((A1 + offsets) / norms , priorita)",np.matrix(np.array((A1 + offsets) / norms )* np.array(priorita)),,
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,ar[np.bitwise_or.accumulate(~ar[::-1])[::-1]],ar[:len(ar)-np.argmin(ar[::-1])],0.00363,0.00624
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"np.fromiter(dropwhile(lambda x: x, ar[::-1]), dtype=bool)[::-1]",ar[:len(ar)-np.argmin(ar[::-1])],0.00293,0.00624
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"np.fromiter(dropwhile(lambda x: x, ar[::-1]), dtype=bool)[::-1]",ar[np.bitwise_or.accumulate(~ar[::-1])[::-1]],0.00293,0.00363
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"ar[:-sum(1 for i in takewhile(lambda x: x, reversed(ar)))]",ar[:len(ar)-np.argmin(ar[::-1])],0.00184,0.00624
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"ar[:-sum(1 for i in takewhile(lambda x: x, reversed(ar)))]",ar[np.bitwise_or.accumulate(~ar[::-1])[::-1]],0.00184,0.00363
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"ar[:-sum(1 for i in takewhile(lambda x: x, reversed(ar)))]",ar[:len(ar)-np.where(ar[::-1]==False)[0][0]] if np.where(ar[::-1]==False)[0].size>0 else ar[:0],0.00184,0.00761
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,ar[:len(ar)-np.argmin(ar[::-1])],ar[:len(ar)-np.where(ar[::-1]==False)[0][0]] if np.where(ar[::-1]==False)[0].size>0 else ar[:0],0.00624,0.00761
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,ar[np.bitwise_or.accumulate(~ar[::-1])[::-1]],ar[:len(ar)-np.where(ar[::-1]==False)[0][0]] if np.where(ar[::-1]==False)[0].size>0 else ar[:0],0.00363,0.00761
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"np.fromiter(dropwhile(lambda x: x, ar[::-1]), dtype=bool)[::-1]",ar[:len(ar)-np.where(ar[::-1]==False)[0][0]] if np.where(ar[::-1]==False)[0].size>0 else ar[:0],0.00293,0.00761
23403994,answer,23400191,"python,list,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23403994,"ar[:-sum(1 for i in takewhile(lambda x: x, reversed(ar)))]","np.fromiter(dropwhile(lambda x: x, ar[::-1]), dtype=bool)[::-1]",0.00184,0.00293
23438663,answer,23435782,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23438663,"X[np.arange(len(X)), Y]",np.diag(X.T[Y]),0.0307,20.8
23438663,answer,23435782,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23438663,"np.fromiter((row[index] for row, index in zip(X, Y)), dtype=int)",np.diag(X.T[Y]),1.15,20.8
23438663,answer,23435782,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/23438663,"X[np.arange(len(X)), Y]","np.fromiter((row[index] for row, index in zip(X, Y)), dtype=int)",0.0307,1.15
23529883,answer,23524035,"python,performance,optimization,numpy",sentence,"i think i read once, that np.matrix is slower than the simple wrapper np.asmatrix.",np.asmatrix,np.matrix,,
23540029,answer,9057379,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/23540029,a.ravel(),a.flatten(),0.000412,0.00402
23576322,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/23576322,np.sqrt((a*a).sum(axis=1)),[np.linalg.norm(x) for x in a],0.0156,3.86
23576322,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/23576322,"np.sqrt(np.einsum('ij,ij->i',a,a))",[np.linalg.norm(x) for x in a],0.00871,3.86
23576322,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/23576322,np.sqrt(a.dot(a)),"np.sqrt(np.einsum('i,i', a, a))",0.00373,0.00468
23576322,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/23576322,"np.sqrt(np.einsum('i,i', a, a))",np.sqrt(a.dot(a)),0.0606,0.0808
23576322,answer,9171158,"python,numpy",codeblock,https://stackoverflow.com/questions/23576322,"np.sqrt(np.einsum('ij,ij->i',a,a))",np.sqrt((a*a).sum(axis=1)),0.00871,0.0156
23585898,answer,23585823,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/23585898,df['Sex'] = df['Gender'].map(sex_map),"df['Sex2']=(df.Gender.isin(['Male']).map({True:'M',False:''}) + df.Sex.isin(['M']).map({True:'M',False:''}) + df.Sex.isin(['F']).map({True:'F',False:''})+                df.Gender.isin(['Female']).map({True:'F',False:''}))",0.531,2.38
23585898,answer,23585823,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/23585898,"df.loc[df.Sex.isnull(),'Sex'] = df['Gender'].map(sex_map)","df['Sex2']=(df.Gender.isin(['Male']).map({True:'M',False:''}) + df.Sex.isin(['M']).map({True:'M',False:''}) + df.Sex.isin(['F']).map({True:'F',False:''})+                df.Gender.isin(['Female']).map({True:'F',False:''}))",1.21,2.38
23585898,answer,23585823,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/23585898,df['Sex'] = df['Gender'].map(sex_map),"df.loc[df.Sex.isnull(),'Sex'] = df['Gender'].map(sex_map)",0.531,1.21
23663735,answer,23663623,"python,pandas",codeblock,https://stackoverflow.com/questions/23663735,(df > 0).sum(1),"df.apply(lambda s: (s > 0).sum(), axis=1)",0.319,141
23716325,answer,23716255,"merge,pandas,dataframe",codeblock,https://stackoverflow.com/questions/23716325,df1.set_index('Id').combine_first(df2.set_index('Id')).reset_index(),"pd.concat([df1,df2]).groupby('Id', as_index=False).first()",174,221
23753724,answer,23753476,"python,pandas",codeblock,https://stackoverflow.com/questions/23753724,data['c'] = data['b'].isnull().cumsum().where(data['b'].isnull()),"data.merge(pd.DataFrame({'c':range(1,len(data[data.b.isnull()]) + 1)}, index=data[data.b.isnull()].index),how='left', left_index=True, right_index=True)",0.501,1.31
23768474,answer,23767883,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/23768474,df.loc[df.groupby('respondent').value1.idxmax().values],df[df.groupby('respondent').value1.transform(lambda x: x==x.max())],1.76,2.99
23768474,answer,23767883,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/23768474,df.loc[df.groupby('respondent').value1.idxmax().values],"df.sort(['respondent', 'value1'], ascending=[1,0]).groupby('respondent').head(1)",1.76,4.42
23768474,answer,23767883,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/23768474,df[df.groupby('respondent').value1.transform(lambda x: x==x.max())],"df.sort(['respondent', 'value1'], ascending=[1,0]).groupby('respondent').head(1)",2.99,4.42
23816237,answer,23814517,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/23816237,"np.nonzero(np.in1d(A.view(dt).reshape(-1), B.view(dt).reshape(-1)))[0]","np.nonzero(np.in1d(A.view('i,i').reshape(-1), B.view('i,i').reshape(-1)))[0]",0.0298,0.075
23831562,answer,23831428,"python,numpy",codeblock,https://stackoverflow.com/questions/23831562,big[vals],"arr[np.in1d(arr[:,0], vals), 1]",0.00123,0.0215
23833925,answer,23833763,"python,matplotlib,pandas",codeblock,https://stackoverflow.com/questions/23833925,(df < 1.0).apply(np.count_nonzero),df[df < 1.0 ].count(),0.529,1.47
23833925,answer,23833763,"python,matplotlib,pandas",codeblock,https://stackoverflow.com/questions/23833925,(df < 1.0).sum(),df[df < 1.0 ].count(),0.56,1.47
23833925,answer,23833763,"python,matplotlib,pandas",codeblock,https://stackoverflow.com/questions/23833925,(df < 1.0).apply(np.count_nonzero),(df < 1.0).sum(),0.529,0.56
23842024,answer,23838115,"python,pandas",codeblock,https://stackoverflow.com/questions/23842024,np.nonzero(pd.isnull(df.values).any(1)),df.index[df.isnull().any(1)],0.0858,0.629
23868190,answer,23862429,"python,pandas",codeblock,https://stackoverflow.com/questions/23868190,"df[['year', 'name']].loc[df.groupby('year')['prop'].apply(lambda x: x.argmax())]","df.groupby('year').apply(lambda x: x.sort('prop', ascending=False).iloc[0]['name'])",1.07,2.14
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(arr.T, numpy.asfortranarray(arr), out=cov)","numpy.dot(arr.T, arr, out=cov)",439000,765000
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(numpy.asfortranarray(arr.T), arr, out=cov)","numpy.dot(arr.T, arr, out=cov)",762000,765000
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(arr.T, numpy.asfortranarray(arr), out=cov)","numpy.dot(numpy.asfortranarray(arr.T), arr, out=cov)",439000,762000
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(arr.T, arr)","numpy.dot(numpy.asfortranarray(arr.T), arr)",7.52,7.53
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(arr.T, numpy.asfortranarray(arr))","numpy.dot(arr.T, arr)",5.26,7.52
23910687,answer,23905295,"python,memory,numpy",codeblock,https://stackoverflow.com/questions/23910687,"numpy.dot(arr.T, numpy.asfortranarray(arr))","numpy.dot(numpy.asfortranarray(arr.T), arr)",5.26,7.53
23914036,answer,23905817,"python,numpy",codeblock,https://stackoverflow.com/questions/23914036,"np.bincount(m_idx, weights=n[n_idx], minlength=len(m))","np.add.at(m, m_idx, n[n_idx])",0.00154,0.00949
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_dict)],df[df.ID.isin(l)],0.742,0.771
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.ID.isin(l_series)],0.733,2
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.ID.isin(l)],0.733,0.771
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.ID.isin(l_dict)],0.733,0.742
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df.query('index in @l_series'),93.3,564
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df.query('index in @l'),93.3,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df.query('index in @l_series'),df.query('index in @l'),564,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.ID.isin(l_series)],93.3,541
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_series)],df.query('index in @l_series'),541,564
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_series)],df.query('index in @l'),541,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df.query('index in @l_series'),549,564
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.index.isin(l_series)],93.3,549
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[[x in l_dict for x in df.ID]],df[df.ID.isin(l_dict)],0.203,0.742
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df.query('index in @l'),549,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_series)],df[df.index.isin(l_series)],541,549
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.index.isin(l)],93.3,1120
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df.query('index in @l_series'),df[df.index.isin(l)],564,1120
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l)],df.query('index in @l'),1120,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_series)],df[df.index.isin(l)],541,1120
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df[df.index.isin(l)],549,1120
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df[df.ID.isin(l_series)],529,541
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.apply(lambda x: x in l_dict)],df[df.ID.isin(l_dict)],0.297,0.742
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df.query('index in @l'),529,1140
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.apply(lambda x: x in l_dict)],df[df.ID.isin(l)],0.297,0.771
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[[x in l_dict for x in df.ID]],df[df.ID.apply(lambda x: x in l_dict)],0.203,0.297
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[[x in l_dict for x in df.ID]],df[df.ID.isin(l)],0.203,0.771
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df[df.index.isin(l)],529,1120
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.index.isin(l_series)],df.query('index in @l_series'),529,564
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,"df.join(l_series, how='inner')",df[df.index.isin(l_series)],93.3,529
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[[x in l_dict for x in df.ID]],"df.join(l_series, how='inner')",0.203,0.733
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.apply(lambda x: x in l_dict)],"df.join(l_series, how='inner')",0.297,0.733
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l_dict)],df[df.ID.isin(l_series)],0.742,2
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.isin(l)],df[df.ID.isin(l_series)],0.771,2
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[[x in l_dict for x in df.ID]],df[df.ID.isin(l_series)],0.203,2
23946500,answer,23945493,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/23946500,df[df.ID.apply(lambda x: x in l_dict)],df[df.ID.isin(l_series)],0.297,2
23969447,answer,23956390,"python,pandas",codeblock,https://stackoverflow.com/questions/23969447,df_train['Store'].astype(str) +'_' + df_train['Dept'].astype(str)+'_'+ df_train['Date_Str'].astype(str),"df_train.apply(apply_id, 1)",5420,71000
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[(pd.Timestamp('2014-02-21') < s) & (s < pd.Timestamp('2014-02-22'))],s.loc[s.str.startswith('2014-02-21')],1.3,105
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[pd.DatetimeIndex(s).normalize() == pd.Timestamp('2014-02-21')],s.loc[s.str.startswith('2014-02-21')],0.405,1.16
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[pd.DatetimeIndex(s).normalize() == pd.Timestamp('2014-02-21')],s.loc[(pd.Timestamp('2014-02-21') < s) & (s < pd.Timestamp('2014-02-22'))],0.405,1.23
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[pd.DatetimeIndex(s).normalize() == pd.Timestamp('2014-02-21')],s.loc[s.str.startswith('2014-02-21')],0.694,105
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[pd.DatetimeIndex(s).normalize() == pd.Timestamp('2014-02-21')],s.loc[(pd.Timestamp('2014-02-21') < s) & (s < pd.Timestamp('2014-02-22'))],0.694,1.3
24004694,answer,24004229,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24004694,s.loc[s.str.startswith('2014-02-21')],s.loc[(pd.Timestamp('2014-02-21') < s) & (s < pd.Timestamp('2014-02-22'))],1.16,1.23
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,Utilidad.ix['resta'].clip_upper(0),"Utilidad.ix['positive']=np.clip(Utilidad.ix['resta'], 0, 100)",1.32,2.6
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,"Utilidad.ix['positive'] = np.where(Utilidad.ix['resta'] > 0, Utilidad.ix['resta'], 0)",Utilidad.ix['resta'].clip_upper(0),0.647,1.32
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,"Utilidad.ix['positive'] = np.where(Utilidad.ix['resta'] > 0, Utilidad.ix['resta'], 0)","Utilidad.ix['positive']=np.clip(Utilidad.ix['resta'], 0, 100)",0.647,2.6
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,(Utilidad.ix['resta']-Utilidad.ix['resta'].abs())/2,"Utilidad.ix['positive'] = np.where(Utilidad.ix['resta'] > 0, Utilidad.ix['resta'], 0)",0.627,0.647
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,(Utilidad.ix['resta']-Utilidad.ix['resta'].abs())/2,"Utilidad.ix['positive']=np.clip(Utilidad.ix['resta'], 0, 100)",0.627,2.6
24089655,answer,24089409,"python,pandas",codeblock,https://stackoverflow.com/questions/24089655,(Utilidad.ix['resta']-Utilidad.ix['resta'].abs())/2,Utilidad.ix['resta'].clip_upper(0),0.627,1.32
24091477,answer,24090889,"python,loops,numpy,matrix",codeblock,https://stackoverflow.com/questions/24091477,"z = np.einsum(""ijk, ikl -> ijl"", a, b)","z2 = np.array([ai.dot(bi) for ai, bi in zip(a, b)])",0.105,1.06
24091484,answer,24090889,"python,loops,numpy,matrix",codeblock,https://stackoverflow.com/questions/24091484,"z = np.einsum('...ij,...jk->...ik', a, b)","z = array([dot(va, vb) for va, vb in zip(a, b)])",0.0946,0.454
24113746,answer,24112729,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/24113746,pd.to_datetime(dates),"pd.to_datetime(dates, format='%Y-%m-%d')",22.2,342
24238020,answer,24237658,"python,numpy",codeblock,https://stackoverflow.com/questions/24238020,"v3=np.einsum('ij,ij->i',v1,v2)","np.sum(v1*v2,axis=1)",0.00514,0.0168
24238020,answer,24237658,"python,numpy",codeblock,https://stackoverflow.com/questions/24238020,"v3=np.einsum('ij,ij->i',v1,v2)","np.diag(np.dot(v1,v2.T))",0.00514,0.00743
24238020,answer,24237658,"python,numpy",codeblock,https://stackoverflow.com/questions/24238020,"np.diag(np.dot(v1,v2.T))","np.sum(v1*v2,axis=1)",0.00743,0.0168
24408575,answer,24404334,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/24408575,df.groupby(df.index//4).mean(),df.groupby(df.index//4).apply(lambda x: x.mean()),412,82000
24425407,answer,24334077,"python,numpy,complex-numbers",codeblock,https://stackoverflow.com/questions/24425407,abs(7+6j),np.abs(7+6j),102.574,1663.86
24561312,answer,24560596,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/24561312,"int("""".join([digits[y] for y in x]),2)","int("""".join(map(str, x)),2)",0.00615,0.00749
24619610,answer,24619450,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/24619610,"y[mask][:, mask]","y[np.ix_(mask, mask)]",0.494,59.8
24701324,answer,24701041,"python,numpy",codeblock,https://stackoverflow.com/questions/24701324,"np.diag(d.take(index, axis=1)).reshape(3, 1)","d.reshape(d.size)[np.arange(d.shape[0])*d.shape[1]+index].reshape(3, 1)",0.00381,0.00951
24701324,answer,24701041,"python,numpy",codeblock,https://stackoverflow.com/questions/24701324,"d.ravel()[np.arange(d.shape[0])*d.shape[1]+index].reshape(3, 1)","d.reshape(d.size)[np.arange(d.shape[0])*d.shape[1]+index].reshape(3, 1)",0.00856,0.00951
24701324,answer,24701041,"python,numpy",codeblock,https://stackoverflow.com/questions/24701324,"np.diag(d.take(index, axis=1)).reshape(3, 1)","d.ravel()[np.arange(d.shape[0])*d.shape[1]+index].reshape(3, 1)",0.00381,0.00856
24701324,answer,24701041,"python,numpy",codeblock,https://stackoverflow.com/questions/24701324,"d[(np.arange(index.size), index)].reshape(index.size, 1)","d.ravel()[np.arange(d.shape[0])*d.shape[1]+index].reshape(index.size, 1)",0.364,5.22
24705935,answer,24705644,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/24705935,"[lookupdict[k] for k in np.random.choice(lookupdict.keys(),1000000)]",[lookupdict[k] for k in [np.random.choice(lookupdict.keys()) for _ in range(1000000)]],658,8040
24744478,answer,24744056,"python,arrays,performance,optimization,numpy",codeblock,https://stackoverflow.com/questions/24744478,"np.sum(arr >= 0.5, axis=0)",[sum(i >= 0.5 for i in arr.T[c]) for c in xrange(len(arr))],1.53,1580
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"M.reshape(-1, 2, 2).sum(axis=0)",sum(sum(M)),0.184,0.202
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.sum(M, axis=(0,1))","M.reshape(-1, 2, 2).sum(axis=0)",0.182,0.184
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)",sum(sum(M)),0.099,0.202
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)","M.reshape(-1, 2, 2).sum(axis=0)",0.099,0.184
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)","np.sum(M, axis=(0,1))",0.099,0.182
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)","np.sum(M, axis=(0,1))",0.00242,0.00608
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)",sum(sum(M)),0.00242,0.00818
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)",M.sum(axis=0).sum(axis=0),0.00242,0.00983
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"M.reshape(-1, 2, 2).sum(axis=0)","np.sum(M, axis=(0,1))",0.00569,0.00608
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"M.reshape(-1, 2, 2).sum(axis=0)",sum(sum(M)),0.00569,0.00818
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"M.reshape(-1, 2, 2).sum(axis=0)",M.sum(axis=0).sum(axis=0),0.00569,0.00983
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.sum(M, axis=(0,1))",sum(sum(M)),0.00608,0.00818
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.sum(M, axis=(0,1))",M.sum(axis=0).sum(axis=0),0.00608,0.00983
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,sum(sum(M)),M.sum(axis=0).sum(axis=0),0.00818,0.00983
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,M.sum(axis=0).sum(axis=0),"np.einsum('ijkl->kl', M)",0.0599,0.099
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,M.sum(axis=0).sum(axis=0),"np.sum(M, axis=(0,1))",0.0599,0.182
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,M.sum(axis=0).sum(axis=0),"M.reshape(-1, 2, 2).sum(axis=0)",0.0599,0.184
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,M.sum(axis=0).sum(axis=0),sum(sum(M)),0.0599,0.202
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.einsum('ijkl->kl', M)","M.reshape(-1, 2, 2).sum(axis=0)",0.00242,0.00569
24841363,answer,24841306,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/24841363,"np.sum(M, axis=(0,1))",sum(sum(M)),0.182,0.202
24868338,answer,24868129,"python,sorting,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/24868338,a.data.argpartition(-k)[-k:],a.data.argsort()[-k:],13,135
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,"np.searchsorted(aa, N/2)+1",np.argmax(aa>N/2),0.00597,0.0463
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,"np.searchsorted(aa, N/2)+1",np.nonzero(aa>N/2)[0][0],0.00597,0.154
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,np.nonzero(aa>N/2)[0][0],np.where(aa>N/2)[0][0],0.154,0.154
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,"np.searchsorted(aa, N/2)+1",np.where(aa>N/2)[0][0],0.00597,0.154
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,np.argmax(aa>N/2),np.where(aa>N/2)[0][0],0.0463,0.154
25032853,answer,16243955,"python,numpy",codeblock,https://stackoverflow.com/questions/25032853,np.argmax(aa>N/2),np.nonzero(aa>N/2)[0][0],0.0463,0.154
25063451,answer,25063167,"python,numpy,repeat",codeblock,https://stackoverflow.com/questions/25063451,"np.fromiter(chain.from_iterable(imap(xrange, lengths)), dtype=int, count=np.sum(lengths))","np.concatenate(map(np.arange, lengths))",0.0283,0.0648
25063451,answer,25063167,"python,numpy,repeat",codeblock,https://stackoverflow.com/questions/25063451,"np.fromiter(chain.from_iterable(imap(xrange, lengths)), dtype=int)","np.concatenate(map(np.arange, lengths))",0.0258,0.0648
25063451,answer,25063167,"python,numpy,repeat",codeblock,https://stackoverflow.com/questions/25063451,"np.fromiter(chain.from_iterable(imap(xrange, lengths)), dtype=int)","np.fromiter(chain.from_iterable(imap(xrange, lengths)), dtype=int, count=np.sum(lengths))",0.0258,0.0283
25088219,answer,25087769,"python,numpy",codeblock,https://stackoverflow.com/questions/25088219,"idx = np.argpartition(-x, N); x[idx[:N]]",np.sort(x)[-N:],0.0533,0.233
25096184,answer,25095971,"python,pandas,merge,nan",codeblock,https://stackoverflow.com/questions/25096184,df.fillna(df2),df.combine_first(df2),0.333,2.15
25150020,answer,25149698,"python,image-processing,numpy",codeblock,https://stackoverflow.com/questions/25150020,np.asarray(im),np.array(im),156,222
25150020,answer,25149698,"python,image-processing,numpy",codeblock,https://stackoverflow.com/questions/25150020,"np.array(im, dtype=np.float32)","np.asarray(im, dtype=np.float32)",444,543
25192414,answer,25192270,"python,numpy,indexing,multidimensional-array",codeblock,https://stackoverflow.com/questions/25192414,"S.take([i, j], axis=1).take([i, j], axis=0)","S[:, [i, j]][[i, j], :]",0.00332,0.0088
25192414,answer,25192270,"python,numpy,indexing,multidimensional-array",codeblock,https://stackoverflow.com/questions/25192414,"S.take([i, j], axis=1).take([i, j], axis=0)","S[np.ix_([i,j],[i,j])]",0.00332,0.013
25192414,answer,25192270,"python,numpy,indexing,multidimensional-array",codeblock,https://stackoverflow.com/questions/25192414,"S[:, [i, j]][[i, j], :]","S[np.ix_([i,j],[i,j])]",0.0088,0.013
25229059,answer,25228168,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/25229059,df1.align(df2),"df1.merge(df2, how='outer', right_index=True, left_index=True).fillna(method='ffill')",36.5,69.3
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,(x.T*y).T,x * np.atleast_2d(y).T,0.00327,0.00798
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,x * np.atleast_2d(y).T,x * np.transpose([y]),0.00798,0.0202
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,"x * y.reshape(-1, 1)",x * np.atleast_2d(y).T,0.00366,0.00798
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,(x.T*y).T,x * np.transpose([y]),0.00327,0.0202
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,(x.T*y).T,"x * y.reshape(-1, 1)",0.00327,0.00366
25291556,answer,25291215,"python,numpy",codeblock,https://stackoverflow.com/questions/25291556,"x * y.reshape(-1, 1)",x * np.transpose([y]),0.00366,0.0202
25356329,answer,23482304,"python,numpy,pandas,dataframe",sentence,".where can be much faster than .apply, so if all you're doing is if/elses then i'd aim for .where.",.where,.apply,,
25432375,answer,25432182,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/25432375,"idx = np.argsort(data[..., -1].flatten())","idx = np.argpartition(-data[...,-1].flatten(), 3)",0.0026,0.00561
25432375,answer,25432182,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/25432375,"idx = np.argpartition(-data2[...,-1].flatten(), 3)","idx = np.argsort(data2[..., -1].flatten())",0.0495,0.164
25433348,answer,25432807,"python,pandas",codeblock,https://stackoverflow.com/questions/25433348,df.query('a < .25').index,df[df['a'] < .25].index,129,154
25455449,answer,25436783,"python,numpy,scipy,vectorization,broadcast",sentence,"at least in this case, einsum is faster than sum.",einsum,sum,,
25466387,answer,22851785,"python,multithreading,numpy,matrix,pandas",sentence,in addition i would try to use np.einsum which seems to be faster than np.dot,np.einsum,np.dot,,
25535101,answer,25534321,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/25535101,"x-A[:,5].toarray().flatten()","np.asarray(x-A[:,5].T).flatten()",0.185,0.264
25535101,answer,25534321,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/25535101,"x-A[:,5].toarray().flatten()","np.asarray(x-A[:,5].T).flatten()",0.334,0.41
25535101,answer,25534321,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/25535101,"x-A[:,5].toarray().flatten()","np.asarray(x-A[:,5].T).flatten()",0.494,1.3
25535803,answer,13148429,"python,pandas",sentence,"although reindex_axis seems to be slightly faster in micro benchmarks than reindex, i think i prefer the latter for its directness.",reindex_axis,reindex,,
25542523,answer,24479577,"python,pandas",codeblock,https://stackoverflow.com/questions/25542523,pd.to_datetime(((rng.astype(np.int64) // ns5min + 1 ) * ns5min)),rng.map(round_to_5min),1.01,1030
25575679,answer,25575062,"python,pandas",codeblock,https://stackoverflow.com/questions/25575679,"pd.rolling_apply(data['Low'],2,min)","pd.rolling_apply(data['Low'],2,np.min)",1.44,15.4
25605701,answer,25601346,"python,numpy,pandas,anaconda",codeblock,https://stackoverflow.com/questions/25605701,pd.to_datetime(df['date']),"pd.to_datetime(df['date'], dayfirst=True)",2.88,800
25605701,answer,25601346,"python,numpy,pandas,anaconda",codeblock,https://stackoverflow.com/questions/25605701,pd.to_datetime(df['date']),"pd.to_datetime(df['date'], format='%d-%m-%Y %H:%M')",2.88,78.2
25605701,answer,25601346,"python,numpy,pandas,anaconda",codeblock,https://stackoverflow.com/questions/25605701,"pd.to_datetime(df['date'], format='%d-%m-%Y %H:%M')","pd.to_datetime(df['date'], dayfirst=True)",78.2,800
25612064,answer,19350806,"datetime,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/25612064,"pd.Series(np.array(df['Y']-1970, dtype='<M8[Y]')+np.array(df['M']-1, dtype='<m8[M]')+np.array(df['D']-1, dtype='<m8[D]'))","pd.to_datetime((df['Y']*10000+df['M']*100+df['D']).astype('int'), format='%Y%m%d')",0.839,4.87
25817270,answer,25817226,"python,arrays,performance,numpy,element",sentence,"the reason np.sum is faster than sum is that sum is implemented to ""naively"" iterate over the iterable (in this case, the numpy array), calling elements' __add__ operator (which imposes a significant overhead), while numpy's implementation of sum is optimized, e.g. taking advantage of the fact it knows the type (dtype) of the elements, and that they are contiguous in memory.",np.sum,sum,,
25823673,answer,25823608,"python,numpy,scipy",codeblock,https://stackoverflow.com/questions/25823673,"np.where((vals2[:,0] == 0) & (vals2[:,1]==1))[0]","np.where((vals2 == (0, 1)).all(axis=1))[0]",0.152,0.808
25856471,answer,25854977,"python,pandas,time-series,dataframe,subset",codeblock,https://stackoverflow.com/questions/25856471,df1.index.get_indexer_for(df2.index),[np.argmax(df1.index >= t) for t in df2.index],0.0145,0.0855
25899480,answer,18327624,"python,pandas",codeblock,https://stackoverflow.com/questions/25899480,pd.Index(article_reference_df.asset_id).get_loc('100000003003614'),article_reference_df.asset_id[article_reference_df.asset_id == '100000003003614'].index[0],0.0601,0.255
25924347,answer,25924297,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/25924347,df.iloc[:np.where(df.any(axis=1))[0][-1]+1],df.loc[:df.any(axis=1).cumsum().argmax()],0.203,0.296
25943480,answer,10741346,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/25943480,"unique, counts = np.unique(x, return_counts=True)",scipy.stats.itemfreq(x),31.5,170
25962913,answer,25962838,"python,arrays,numpy,floating-point",codeblock,https://stackoverflow.com/questions/25962913,(abs(arr_f - a) < t).any(),"np.isclose(arr_f, a, atol=t).any()",646,802
25962913,answer,25962838,"python,arrays,numpy,floating-point",codeblock,https://stackoverflow.com/questions/25962913,(abs(arr_f - a) < t).any(),"np.isclose(arr_f, a, atol=t).any()",0.0115,0.0447
26047680,answer,26047560,"python,python-2.7,numpy,scipy",codeblock,https://stackoverflow.com/questions/26047680,"np.unique(x, return_counts=True)",scipy.stats.itemfreq(x),4.13,20.8
26070368,answer,26069235,"python,arrays,numpy,pandas",codeblock,https://stackoverflow.com/questions/26070368,pa['a'].map(operator.itemgetter(0)),pa['a'].str[0],0.044,0.0672
26154854,answer,26154711,"python,numpy,filter",codeblock,https://stackoverflow.com/questions/26154854,"x[np.sum(x, axis=1) > .5]",x[np.array([myfunc(row) for row in x])],5.71,217
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"np.all(np.all(arr == arr[0,:], axis = 1))","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",0.33,9.51
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"np.all(np.all(arr == arr[0,:], axis = 1))","all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))",0.33,9.44
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"(np.diff(M, axis=0) == 0).all()","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",0.594,9.51
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"(np.diff(M, axis=0) == 0).all()","all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))",0.594,9.44
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",9.44,9.51
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"np.all(np.all(arr == arr[0,:], axis = 1))","(np.diff(M, axis=0) == 0).all()",0.33,0.594
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"np.all(np.all(arr == arr[0,:], axis = 1))","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",0.272,10.6
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))","(np.diff(M, axis=0) == 0).all()",0.0113,0.596
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"(np.diff(M, axis=0) == 0).all()","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",0.596,10.6
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))","np.all(np.all(arr == arr[0,:], axis = 1))",0.0113,0.272
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"all(np.array_equal(M[0], M[i]) for i in xrange(1,len(M)))","np.all([np.array_equal(M[0], M[i]) for i in xrange(1,len(M))])",0.0113,10.6
26163824,answer,26163727,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26163824,"np.all(np.all(arr == arr[0,:], axis = 1))","(np.diff(M, axis=0) == 0).all()",0.272,0.596
26168677,answer,26168363,"python,numpy",codeblock,https://stackoverflow.com/questions/26168677,"np.einsum('ij, ij->i', a, b)","np.sum(a*b, axis=1)",8.4,28.4
26180427,answer,26175900,"python,numpy",codeblock,https://stackoverflow.com/questions/26180427,"X[np.arange(len(X)), L]",L.choose(X.T),0.0788,0.146
26180427,answer,26175900,"python,numpy",codeblock,https://stackoverflow.com/questions/26180427,L.choose(X.T),"X[range(len(X)), L]",0.146,0.629
26180427,answer,26175900,"python,numpy",codeblock,https://stackoverflow.com/questions/26180427,"X[np.arange(len(X)), L]","X[range(len(X)), L]",0.0788,0.629
26213327,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213327,np.zeros(size),a = np.empty(size); a[:] = 0,0.00875,322
26213327,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213327,a = np.empty(size); a[:] = 0,"np.full(size, 0)",322,344
26213327,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213327,np.zeros(size),"np.full(size, 0)",0.00875,344
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,"np.full(1e6, 0)",a = np.empty(1e6); a[:] = 0,0.816,0.919
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,a = np.empty(1e8); a[:] = 0,"np.full(1e8, 0)",229,614
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,np.zeros(1e8),a = np.empty(1e8); a[:] = 0,0.00966,229
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,np.zeros(1e6),a = np.empty(1e6); a[:] = 0,0.804,0.919
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,np.zeros(1e6),"np.full(1e6, 0)",0.804,0.816
26213344,answer,26213199,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26213344,np.zeros(1e8),"np.full(1e8, 0)",0.00966,614
26278919,answer,26275423,"python,performance,numpy,pandas,lookup-tables",codeblock,https://stackoverflow.com/questions/26278919,"new_q = activity_data[""Activity""].dot(weight_lookuptable)",q = [sum(activity_data['Activity']*activity_data['Class'].map(weight_lookuptable[c])) for c in activity_data['Class']],0.218,28.8
26306501,answer,26306163,"python,numpy",codeblock,https://stackoverflow.com/questions/26306501,(a > 0.5).sum(),sum(a > 0.5),0.906,1230
26306501,answer,26306163,"python,numpy",codeblock,https://stackoverflow.com/questions/26306501,np.count_nonzero(a > 0.5),sum(a > 0.5),0.266,1230
26306501,answer,26306163,"python,numpy",codeblock,https://stackoverflow.com/questions/26306501,np.count_nonzero(a > 0.5),(a > 0.5).sum(),0.266,0.906
26325432,answer,26325412,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/26325432,"c = empty(len(a)+len(b), dtype=a.dtype); c[::2] = a; c[1::2] = b","ravel([a, b], order='F')",0.00194,0.0031
26325432,answer,26325412,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/26325432,"c = empty(len(a)+len(b), dtype=a.dtype); c[::2] = a; c[1::2] = b","vstack((a,b)).T.flatten()",0.00194,0.0056
26325432,answer,26325412,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/26325432,"ravel([a, b], order='F')","vstack((a,b)).T.flatten()",0.0031,0.0056
26410051,answer,26409153,"python,pandas",codeblock,https://stackoverflow.com/questions/26410051,"s.ix[f(s.index.values, np.array(intervals))]","pd.concat([s.ix[start: end] for start, end in intervals])",0.212,1.64
26410051,answer,26409153,"python,pandas",codeblock,https://stackoverflow.com/questions/26410051,"s[f(s.index.values, np.array(intervals))]","s.ix[f(s.index.values, np.array(intervals))]",0.177,0.212
26410051,answer,26409153,"python,pandas",codeblock,https://stackoverflow.com/questions/26410051,"s[f(s.index.values, np.array(intervals))]","pd.concat([s.ix[start: end] for start, end in intervals])",0.177,1.64
26443115,answer,26442790,"python,pandas,indexing,multi-level",codeblock,https://stackoverflow.com/questions/26443115,"df['Count','small']",df['Count']['small'],0.00891,0.501
26469923,answer,26462617,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/26469923,"sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020), copy=False)","sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020), copy=True)",0.0473,6.26
26469923,answer,26462617,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/26469923,"sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020))","sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020), copy=True)",0.0482,6.26
26469923,answer,26462617,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/26469923,"sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020), copy=False)","sps.csr_matrix((a.data, a.indices, a.indptr),





shape=(10000, 10020))",0.0473,0.0482
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df['d'],"df.loc[:,'d']",0.00535,0.0443
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df.loc[:]['d'],"df.ix[:,'d']",0.0124,0.053
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df.ix[:]['d'],"df.ix[:,'d']",0.0104,0.053
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df['d'],"df.ix[:,'d']",0.00535,0.053
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df.loc[:]['d'],"df.loc[:,'d']",0.0124,0.0443
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df.ix[:]['d'],"df.loc[:,'d']",0.0104,0.0443
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,"df.loc[:,'d']","df.ix[:,'d']",0.0443,0.053
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df.ix[:]['d'],df.loc[:]['d'],0.0104,0.0124
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df['d'],df.loc[:]['d'],0.00535,0.0124
26491976,answer,26491455,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/26491976,df['d'],df.ix[:]['d'],0.00535,0.0104
26537991,answer,26537878,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/26537991,"result[cols].div(result[cols].sum(axis=1), axis=0)","result[cols].apply(lambda row: row / row.sum(axis=1), axis=1)",2.38,4.47
26539124,answer,26539078,"arrays,numpy",codeblock,https://stackoverflow.com/questions/26539124,"a = np.array((1,2,3))","a = np.array([1,2,3])",0.00104,0.00111
26571425,answer,26571199,"python,arrays,image,numpy,vectorization",codeblock,https://stackoverflow.com/questions/26571425,"np.tensordot(image, W, ([2], [1]))","np.einsum('ijk,lk->ijl', image, W)",18.9,31.1
26597365,answer,26579036,"python,arrays,numpy,linear-algebra,inner-product",sentence,"while messier to write, the einsum solution is faster than the tensordot one (3x faster for small test arrays).",einsum,tensordot,,
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.values.astype(numpy.str),s.astype(str),84.3241,3330.59
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.apply(str),s.apply(lambda x: str(x)),3572,3821.25
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.values.astype(numpy.str),s.apply(lambda x: str(x)),84.3241,3821.25
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.values.astype(numpy.str),s.apply(str),84.3241,3572
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.astype(str),s.apply(str),3330.59,3572
26744813,answer,26744370,"python,string,pandas,series",codeblock,https://stackoverflow.com/questions/26744813,s.astype(str),s.apply(lambda x: str(x)),3330.59,3821.25
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,"np.multiply.outer(np.arange(5), np.arange(5))","indices = np.indices((5, 5)); indices[0] * indices[1]",0.00497,0.0161
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,np.array( [ [ i*j for j in xrange(5)] for i in xrange(5)] ),"indices = np.indices((5, 5)); indices[0] * indices[1]",0.00551,0.0161
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,"indices = np.indices((4096, 4096)); indices[0] * indices[1]",np.array( [ [ i*j for j in xrange(4096)] for i in xrange(4096)] ),165,1390
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,"np.multiply.outer(np.arange(4096), np.arange(4096))",np.array( [ [ i*j for j in xrange(4096)] for i in xrange(4096)] ),62.4,1390
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,"np.multiply.outer(np.arange(5), np.arange(5))",np.array( [ [ i*j for j in xrange(5)] for i in xrange(5)] ),0.00497,0.00551
26789891,answer,6254713,"python,matrix,numpy",codeblock,https://stackoverflow.com/questions/26789891,"np.multiply.outer(np.arange(4096), np.arange(4096))","indices = np.indices((4096, 4096)); indices[0] * indices[1]",62.4,165
26791753,answer,26791687,"python,numpy",codeblock,https://stackoverflow.com/questions/26791753,"q = x[np.ix_(c1, c2, c3, c4)]","q = (((x[c1,:,:,:])[:,c2,:,:])[:,:,c3,:])[:,:,:,c4]",0.0193,237
26820109,answer,26816590,"python,numpy",codeblock,https://stackoverflow.com/questions/26820109,numpy.argmax(x),numpy.argmax(l),0.00655,0.729
26848526,answer,26832188,"python,pandas",sentence,"note that using map will become much slower than the numpy.in1d method, when data dimension gets large:",numpy.in1d,map,,
26848526,answer,26832188,"python,pandas",codeblock,https://stackoverflow.com/questions/26848526,"np.in1d(df.Variable, List_vals1)","map(lambda x: 1 if x in List_vals1 else 0, df['Variable'])",0.112,0.287
26849694,answer,26849411,"python,pandas,aggregate",codeblock,https://stackoverflow.com/questions/26849694,"df.groupby(['name', 'value']).agg(len).unstack().fillna(0)","pd.crosstab(df.name, df.value)",3.26,7.5
26914273,answer,26911441,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/26914273,"np.any(np.any(b.reshape(b.shape+(1,)) - a.T.reshape((1,a.shape[1],a.shape[0])) == 0, axis=0), axis=1)","[np.any(np.in1d(b[:,i], a[:, i])) for i in range(a.shape[1])]",0.0395,3.13
26942785,answer,26942701,"python,numpy",codeblock,https://stackoverflow.com/questions/26942785,"np.random.randint(2*5,2*9)/2.","0.5 * ceil(2.0 * np.random.uniform(5.0, 9.0))",0.000329,0.00461
26961879,answer,26961805,"python,pandas",codeblock,https://stackoverflow.com/questions/26961879,(df[0].values.astype('<M8[Y]').astype('<i8')+1970).mean(),df[0].dt.year.mean(),5.14,5.18
26961879,answer,26961805,"python,pandas",codeblock,https://stackoverflow.com/questions/26961879,pd.DatetimeIndex(df[0]).year.mean(),(df[0].values.astype('<M8[Y]').astype('<i8')+1970).mean(),4.5,5.14
26961879,answer,26961805,"python,pandas",codeblock,https://stackoverflow.com/questions/26961879,pd.DatetimeIndex(df[0]).year.mean(),df[0].dt.year.mean(),4.5,5.18
26977495,answer,26977076,"python,pandas,dataframe,unique",codeblock,https://stackoverflow.com/questions/26977495,"pd.unique(df1[['Col1', 'Col2']].values.ravel('K'))","np.unique(df1[['Col1', 'Col2']].values)",38.9,1120
26977495,answer,26977076,"python,pandas,dataframe,unique",codeblock,https://stackoverflow.com/questions/26977495,"pd.unique(df1[['Col1', 'Col2']].values.ravel())","np.unique(df1[['Col1', 'Col2']].values)",49.9,1120
26977495,answer,26977076,"python,pandas,dataframe,unique",codeblock,https://stackoverflow.com/questions/26977495,"pd.unique(df1[['Col1', 'Col2']].values.ravel('K'))","pd.unique(df1[['Col1', 'Col2']].values.ravel())",38.9,49.9
27064099,answer,27063516,"python,numpy,pandas,merge",codeblock,https://stackoverflow.com/questions/27064099,df1.join(df2.T.set_index(df1.index)),"pd.concat([df1, df2.T.set_index(df1.index)], axis=1)",0.6,1.18
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"c=np.concatenate([a,b],-1)","c=np.empty([100,200,300,5]); c[...,:5]=a; c[...,5:]=b",241,311
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"c=np.vstack([a.T,b.T]).T","c=np.empty([100,200,300,5]); c[...,:5]=a; c[...,5:]=b",309,311
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"vc=np.concatenate([va,vb],0)","vc=np.empty([6,300,200,100]); vc[:5]=va; vc[5:]=vb",191,281
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"vc=np.empty([6,300,200,100]); vc[:5]=va; vc[5:]=vb","vc=np.vstack([va,vb])",281,284
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"vc=np.concatenate([va,vb],0)","vc=np.vstack([va,vb])",191,284
27138503,answer,27137794,"arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/27138503,"c=np.concatenate([a,b],-1)","c=np.vstack([a.T,b.T]).T",241,309
27238758,answer,27238066,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/27238758,df_with_index.loc[999],df[df['index'] == 999],0.0577,0.368
27464738,answer,27464039,"python,numpy",codeblock,https://stackoverflow.com/questions/27464738,np.empty_like(x),"np.empty((12488, 7588, 3), np.uint8)",0.0136,0.0149
27464738,answer,27464039,"python,numpy",codeblock,https://stackoverflow.com/questions/27464738,"np.zeros((12488, 7588, 3), np.uint8)",np.zeros_like(x),0.0151,420
27506458,answer,27506367,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/27506458,"pd.to_datetime(df['date'].astype(str), format='%Y%m%d')","df['date'].apply(lambda x: pd.to_datetime(str(x), format='%Y%m%d'))",0.396,2.55
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.vstack((a,b,c)).T","np.dstack((a, b, c)).squeeze()",0.0178,0.0182
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.concatenate((a, b, c)).reshape((-1, 3), order='F')","np.vstack((a,b,c)).T",0.00341,0.0178
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.concatenate((a, b, c)).reshape((-1, 3), order='F')","np.dstack((a, b, c)).squeeze()",0.00341,0.0182
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.dstack((a, b, c)).squeeze()","np.c_[a, b, c]",0.0182,0.0467
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.vstack((a,b,c)).T","np.c_[a, b, c]",0.0178,0.0467
27513412,answer,27513246,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27513412,"np.concatenate((a, b, c)).reshape((-1, 3), order='F')","np.c_[a, b, c]",0.00341,0.0467
27567135,answer,26968551,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27567135,"tt=np.einsum('pqrs, pqs->pqr',x,y)","zz= np.sum(x[:,:,:,None,:]*y[:,:,:,None,None],axis=-2)",0.151,0.274
27567135,answer,26968551,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/27567135,"zz= np.sum(x[:,:,:,None,:]*y[:,:,:,None],axis=-2)","tt=np.einsum('pqrs, pqsu->pqru',x,y)",0.153,3.45
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,np.all(a==b),"np.array_equal(a, b)",13581.2,17950.9
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,np.all(a==b),all(a==b),13581.2,30610.8
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,np.all(a==b),"np.array_equal(a, b)",9980.97,13838.6
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,all(a==b),"np.array_equal(a, b)",879.837,13838.6
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,all(a==b),np.all(a==b),879.837,9980.97
27585152,answer,27585119,"python,arrays,numpy",sentence,note that the built-in all is much faster than np.all for small arrays (and np.array_equal is slower still):,all,np.all,,
27585152,answer,27585119,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27585152,"np.array_equal(a, b)",all(a==b),17950.9,30610.8
27700702,comment,18780054,"python,pandas",sentence,"where seems to be faster than loc: df.outts.where(-pd.notnull(df.orts), df.orts, inplace=True)",where,loc,,
27761810,answer,27760584,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27761810,"np.choose(boolvec[:,None],[a,b])","np.where(boolvec[:,None],b,a)",929,993
27761810,answer,27760584,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27761810,"c=a.copy();c[boolvec,:]=b[boolvec,:]","c=a.copy();c[:,cols]=b[:,cols]",783,1440
27761810,answer,27760584,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27761810,"np.where(cols,b,a)","np.choose(cols,[a,b])",878,915
27817752,answer,27817718,"python,pandas,dataframe,reverse",codeblock,https://stackoverflow.com/questions/27817752,"football.ix[::,football.columns[::-1]]",football[football.columns[::-1]],0.403,0.421
27819296,answer,27818968,"python,pandas",codeblock,https://stackoverflow.com/questions/27819296,df['CountryCount'] = df['PersonId'].map(df.groupby(['PersonId'])['Visited'].unique().apply(len)),df['CountryCount'] = df['PersonId'].map(df.groupby('PersonId')['Visited'].nunique()),1.29,2.52
27819296,answer,27818968,"python,pandas",codeblock,https://stackoverflow.com/questions/27819296,"df[""CountryCount""] = df.groupby(""PersonId"")[""Visited""].transform(pd.Series.nunique)",df['CountryCount'] = df['PersonId'].map(df.groupby('PersonId')['Visited'].nunique()),2.32,2.52
27819296,answer,27818968,"python,pandas",codeblock,https://stackoverflow.com/questions/27819296,df['CountryCount'] = df['PersonId'].map(df.groupby(['PersonId'])['Visited'].unique().apply(len)),"df[""CountryCount""] = df.groupby(""PersonId"")[""Visited""].transform(pd.Series.nunique)",1.29,2.32
27830642,answer,27830164,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/27830642,"o = np.einsum('ijk,ki->ji', R, v)","d = np.diagonal(np.dot(R, v), axis1=0, axis2=2)",0.0219,27.8
27834282,answer,25575356,"python,performance,optimization,numpy,scipy",codeblock,https://stackoverflow.com/questions/27834282,"A[np.ix_(indices, indices)]","A.take(indices, axis=0).take(indices, axis=1)",1020,1370
27834282,answer,25575356,"python,performance,optimization,numpy,scipy",codeblock,https://stackoverflow.com/questions/27834282,"A[np.ix_(indices, indices)]","A.take(indices, axis=0).take(indices, axis=1)",633,946
27868152,answer,27868020,"python,pandas",codeblock,https://stackoverflow.com/questions/27868152,"df3.loc[df3.groupby(""User"")[""X""].transform(sum) == 0]",df3.loc[df3.groupby('User')['X'].filter(lambda x: x.sum() == 0).index],11.4,13
27904006,answer,27903980,"python,arrays,numpy,min",codeblock,https://stackoverflow.com/questions/27904006,"np.minimum(input_b, 3, out=input_b)",input_b[input_b > input_a] = input_a,0.00253,0.00416
27978844,answer,27974746,"arrays,python-2.7,numpy,multidimensional-array,iteration",sentence,this np.ndindex approach is consistently a third faster than the apply_along_axis approach.,np.ndindex,apply_along_axis,,
28007256,answer,28005531,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/28007256,"A[np.arange(A.shape[0])[:,None],idx]","np.choose(idx,A.T[:,:,None])",0.0108,0.0308
28007256,answer,28005531,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/28007256,"A.flat[idx+np.arange(A.shape[0])[:,None]*A.shape[1]]","A[np.arange(A.shape[0])[:,None],idx]",0.0594,0.108
28007256,answer,28005531,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/28007256,"A[np.arange(A.shape[0])[:,None],idx]","A.flat[idx+np.arange(A.shape[0])[:,None]*A.shape[1]]",0.0108,0.0249
28007256,answer,28005531,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/28007256,"A.flat[idx+np.arange(A.shape[0])[:,None]*A.shape[1]]","np.choose(idx,A.T[:,:,None])",0.0249,0.0308
28129866,answer,28129674,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/28129866,df['Cumulative_Value'].diff(),df['Cumulative_Value'] - df['Cumulative_Value'].shift(),0.109,0.33
28129866,answer,28129674,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/28129866,df['Cumulative_Value'] - df['Cumulative_Value'].shift(),"df[['Cumulative_Value']].apply(lambda x: x - x.shift(), axis=1)",0.33,4.02
28129866,answer,28129674,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/28129866,df['Cumulative_Value'].diff(),"df[['Cumulative_Value']].apply(lambda x: x - x.shift(), axis=1)",0.109,4.02
28188064,answer,18158089,"python,pandas",codeblock,https://stackoverflow.com/questions/28188064,"df.drop_duplicates(['date', 'place', 'user'])['place'].value_counts()","df.groupby(['place', 'user', 'date']).place.count().groupby(level='place').count()",1.27,2.55
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull()),df.isnull().values.ravel().sum(),0.395,0.679
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull().values.ravel()),df.isnull().values.ravel().sum(),0.368,0.679
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull().values.ravel()),df.isnull().sum().sum(),0.368,6.56
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,sum(df.isnull().values.ravel()),df.isnull().values.ravel().sum(),0.675,0.679
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,"sum(map(any, df.apply(pd.isnull)))",df.shape[0] - df.dropna().shape[0],3.84,6.61
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,sum(df.isnull().values.ravel()),df.isnull().sum().sum(),0.675,6.56
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull()),df.isnull().sum().sum(),0.395,6.56
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull().values.ravel()),sum(df.isnull().values.ravel()),0.368,0.675
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.isnull().values.ravel().sum(),df.isnull().sum().sum(),0.679,6.56
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull().values.ravel()),np.count_nonzero(df.isnull()),0.368,0.395
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,np.count_nonzero(df.isnull()),sum(df.isnull().values.ravel()),0.395,0.675
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.shape[0] - df.dropna().shape[0],"sum([True for idx,row in df.iterrows() if any(row.isnull())])",6.61,9330
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,"sum([True for idx,row in df.iterrows() if any(row.isnull())])","sum(map(any, df.apply(pd.isnull)))",1.55,1.82
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.isnull().values.ravel().sum(),sum(df.isnull().values.ravel()),0.21,0.215
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,sum(df.isnull().values.ravel()),df.isnull().sum().sum(),0.215,0.605
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.isnull().values.ravel().sum(),df.isnull().sum().sum(),0.21,0.605
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,"sum(map(any, df.apply(pd.isnull)))","sum([True for idx,row in df.iterrows() if any(row.isnull())])",3.84,9330
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.shape[0] - df.dropna().shape[0],"sum(map(any, df.apply(pd.isnull)))",1.11,1.82
28199556,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28199556,df.shape[0] - df.dropna().shape[0],"sum([True for idx,row in df.iterrows() if any(row.isnull())])",1.11,1.55
28200127,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28200127,np.count_nonzero(df.isnull().values),df.isnull().sum().sum(),1.89,15.7
28200127,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28200127,np.count_nonzero(df.isnull().values),df.isnull().values.ravel().sum(),1.89,3.15
28200127,answer,28199524,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/28200127,df.isnull().values.ravel().sum(),df.isnull().sum().sum(),3.15,15.7
28244503,answer,28244153,"python,pandas,boolean,nan,nonetype",codeblock,https://stackoverflow.com/questions/28244503,"any(df[df.columns[1:]].notnull(), axis=1).astype(int)","df[df.columns[1:]].apply(lambda x: all(x.isnull()) , axis=1).astype(int)",1.4,2.46
28256667,answer,28256618,"python,arrays,numpy,elementwise-operations",codeblock,https://stackoverflow.com/questions/28256667,"a = np.array([4,5,6]); b = np.array([7,8,9]); all(a>b)","a = np.array([4,5,6]); b = np.array([7,8,9]); np.all(a>b)",341.042,920.172
28313832,answer,28312374,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/28313832,"np.where((x[:,0]==0)&(x[:,1]==0)&(x[:,2]==0))","np.where(np.all(x == [0,0,0], axis=1) == True)",0.00357,0.0065
28364453,answer,28364136,"python,pandas",codeblock,https://stackoverflow.com/questions/28364453,x.loc[:(x.diff() > 1).argmax()].iloc[:-1],x.loc[(x.diff() > 1).cumsum() == 0],0.884,1.12
28385957,answer,28385666,"python,numpy",codeblock,https://stackoverflow.com/questions/28385957,"np.outer(b[None,:],b)","np.outer(b.reshape(1,-1),b)",287,288
28387285,answer,28387180,"python,csv,pandas",codeblock,https://stackoverflow.com/questions/28387285,"df[df[color_cols].apply(all_equal, axis=1)].imageName","df[df.eval(""color1 == color2 & color3 == color4 & color1 == color3"")].imageName",2.55,7.53
28387285,answer,28387180,"python,csv,pandas",codeblock,https://stackoverflow.com/questions/28387285,df[(df['color1'] == df['color2']) & (df['color3'] == df['color4']) & (df1['color1'] == df['color3'])].imageName,"df.query(""color1 == color2 == color3 == color4"").imageName",3.22,7.24
28424848,answer,28424599,"python,numpy,slice",codeblock,https://stackoverflow.com/questions/28424848,"np.r_[tuple([slice(i[0],i[1]) for i in slices])]","data[np.r_[tuple([slice(i[0],i[1]) for i in slices])]]",0.0675,0.079
28424848,answer,28424599,"python,numpy,slice",codeblock,https://stackoverflow.com/questions/28424848,"data[[idx for iin, iout in slices for idx in range(iin,iout)]]","np.take(data, [idx for iin, iout in slices for idx in range(iin,iout)])",0.0922,0.0925
28696301,answer,28696232,"python,pandas",codeblock,https://stackoverflow.com/questions/28696301,"np.logical_or.reduce([(table['OPINION'] == val) for val in ('buy', 'neutral')])",table['OPINION'].str.contains(r'buy|neutral'),204,474
28696301,answer,28696232,"python,pandas",codeblock,https://stackoverflow.com/questions/28696301,"table['OPINION'].isin(['buy', 'neutral'])","np.logical_or.reduce([(table['OPINION'] == val) for val in ('buy', 'neutral')])",40,204
28696301,answer,28696232,"python,pandas",codeblock,https://stackoverflow.com/questions/28696301,"table['OPINION'].isin(['buy', 'neutral'])",table['OPINION'].str.contains(r'buy|neutral'),40,474
28760412,answer,28759048,"python,pandas,wildcard",codeblock,https://stackoverflow.com/questions/28760412,"df1 = pd.DataFrame(np.ones(df.shape), columns=df.columns)","df2 = df.copy(); df2.loc[:, :] = 1",0.0946,0.245
28767692,answer,28767642,"python,list,python-3.x,numpy,itertools",codeblock,https://stackoverflow.com/questions/28767692,"all(starmap(lt, zip(a, b)))","all(i < j for (i, j) in zip(a, b))",0.487,0.995
28856131,answer,28855695,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/28856131,vec[idx] = 1.2,sr.values[idx] = 1.2,0.0258,0.0273
28907744,answer,28904411,"python,matlab,numpy,matrix",codeblock,https://stackoverflow.com/questions/28907744,"W = np.maximum( A, A.T)",W = A + A.T - np.diag(A.diagonal()),5.65,11.7
28907744,answer,28904411,"python,matlab,numpy,matrix",codeblock,https://stackoverflow.com/questions/28907744,"W = np.maximum( A, A.T)",W = A + A.T - np.diag(A.diagonal()),0.0286,0.0498
28907744,answer,28904411,"python,matlab,numpy,matrix",codeblock,https://stackoverflow.com/questions/28907744,"W = np.maximum( A, A.T)",W = A + A.T - np.diag(A.diagonal()),0.00295,0.00988
28932799,answer,28931900,"python,numpy",sentence,np.ix_ is faster than np.ogrid.,np.ix_,np.ogrid,,
28932799,answer,28931900,"python,numpy",codeblock,https://stackoverflow.com/questions/28932799,"Abig[np.ix_(*[np.arange(x) for x in Jbig.shape])+(Jbig,)]","Abig.ravel()[Jbig+Abig.shape[-1]*np.arange(0,np.prod(Jbig.shape)).reshape(Jbig.shape) ]",0.0227,0.0448
28932799,answer,28931900,"python,numpy",codeblock,https://stackoverflow.com/questions/28932799,"Abig.ravel()[Jbig+Abig.shape[-1]*np.arange(0,np.prod(Jbig.shape)).reshape(Jbig.shape) ]","Jbig.choose(np.rollaxis(Abig,-1))",0.0448,0.0731
28932799,answer,28931900,"python,numpy",codeblock,https://stackoverflow.com/questions/28932799,"Abig[np.ix_(*[np.arange(x) for x in Jbig.shape])+(Jbig,)]","Jbig.choose(np.rollaxis(Abig,-1))",0.0227,0.0731
28933768,answer,28933537,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/28933768,"pd.DataFrame(Counter(pd.DataFrame(dictionary).Year).items(), columns=['Year', 'Count'])",pd.DataFrame(dictionary).groupby('Year')['Year'].count(),0.672,0.777
28969776,answer,28969573,"arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/28969776,"A = np.zeros((500, 300)); A.ravel()[:len(B)] = B","A = np.zeros((500, 300)); A.flat[:len(B)] = B",0.0916,0.158
28969776,answer,28969573,"arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/28969776,"A = np.zeros((500, 300)); A.flat[:len(B)] = B","A = np.zeros((500, 300)); np.put(A, np.arange(len(B)), B)",0.158,0.238
28969776,answer,28969573,"arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/28969776,"A = np.zeros((500, 300)); A.ravel()[:len(B)] = B","A = np.zeros((500, 300)); np.put(A, np.arange(len(B)), B)",0.0916,0.238
28969776,answer,28969573,"arrays,numpy,matrix",sentence,"which suggests that A.ravel()[:len(B)] = B is the faster than A.flat[:len(B)] = B which is faster than np.put(A, np.arange(len(B)), B).",A.flat[:len(B)] = B,"np.put(A, np.arange(len(B)), B)",,
28969776,answer,28969573,"arrays,numpy,matrix",sentence,"which suggests that A.ravel()[:len(B)] = B is the faster than A.flat[:len(B)] = B which is faster than np.put(A, np.arange(len(B)), B).",A.ravel()[:len(B)] = B,A.flat[:len(B)] = B,,
29090717,answer,29090342,"python,numpy,pool",codeblock,https://stackoverflow.com/questions/29090717,"np.dot(b,b)","np.dot(a,a)",28.1,6910
29235615,answer,29234661,"python,pandas,ipython,dataframe",codeblock,https://stackoverflow.com/questions/29235615,df['col2'] = df['col2'].apply(lambda x: '-'.join(set(x.split('-')))),df['col2'].str.split('-').apply(lambda x: '-'.join(set(x))),0.246,0.418
29287954,answer,29287847,"python,pandas",codeblock,https://stackoverflow.com/questions/29287954,"df['email'] = df['email'].str.replace(r'@.+', '@newcompany.com')","df['email'] = df['email'].replace(r'@.+', '@newcompany.com', regex=True)",0.632,0.738
29298599,answer,29298577,"python,string,datetime,pandas,type-conversion",codeblock,https://stackoverflow.com/questions/29298599,"pd.to_datetime(df['Date'], errors='coerce')",df['Date'].apply(func),0.0658,0.186
29305456,answer,29298789,"python,numpy,pandas,apply,cumulative-sum",codeblock,https://stackoverflow.com/questions/29305456,np.cumsum(v*(h+l)/2) / np.cumsum(v),(df.v*(df.h+df.l)/2).cumsum() / df.v.cumsum(),0.165,0.829
29311751,answer,29281680,"python,arrays,list,numpy",sentence,"two other reasons why a[100][100] (getting from the list) is quicker than b[100,100] (getting from the array) are that:",a[100][100],"b[100,100]",,
29378496,answer,29377590,"python,matlab,numpy",sentence,so np.abs(t-t[0]) is faster than abs(t-t[0]).,np.abs(t-t[0]),abs(t-t[0]),,
29444822,answer,29444666,"python,arrays,numpy,scipy",codeblock,https://stackoverflow.com/questions/29444822,"np.interp(np.arange((len(A) - 1) * 10 + 1), np.arange(0, 10*len(A), 10), A)","np.unique(np.hstack(np.linspace(a, b, 10 + 1) for a, b in zip(A[:-1], A[1:])))",0.0103,0.14
29444822,answer,29444666,"python,arrays,numpy,scipy",codeblock,https://stackoverflow.com/questions/29444822,"np.interp(np.arange((len(A) - 1) * 10 + 1), np.arange(0, 10*len(A), 10), A)","np.append(np.concatenate([np.linspace(i, j, 10, False) for i, j in zip(A, A[1:])]), A[-1])",0.0103,0.0942
29444822,answer,29444666,"python,arrays,numpy,scipy",codeblock,https://stackoverflow.com/questions/29444822,"np.append(np.concatenate([np.linspace(i, j, 10, False) for i, j in zip(A, A[1:])]), A[-1])","np.unique(np.hstack(np.linspace(a, b, 10 + 1) for a, b in zip(A[:-1], A[1:])))",0.0942,0.14
29507658,answer,14446744,"python,performance,pandas,date-formatting",codeblock,https://stackoverflow.com/questions/29507658,"read_csv('test.csv', cache={})","pd.read_csv('test.csv', parse_dates=[['date', 'time']])",62.6,10300
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().values.any(),df.isnull().sum().sum(),0.948,18
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().values.sum(),df.isnull().any().any(),2.15,14.7
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().any().any(),df.isnull().sum().sum(),14.7,18
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().values.any(),df.isnull().any().any(),0.948,14.7
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().values.sum(),df.isnull().sum().sum(),2.15,18
29530601,answer,29530232,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/29530601,df.isnull().values.any(),df.isnull().values.sum(),0.948,2.15
29630877,answer,29630445,"python,arrays,performance,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29630877,"(x.reshape((n, -1), order='f') * y).ravel('f')","(y[:, np.newaxis] * x.reshape((-1, n))).flatten()",0.00498,0.0074
29662834,answer,29660252,"python,csv,numpy,scikit-learn",sentence,"if you have pandas installed, then pandas.read_csv will probably be faster than np.loadtxt for a large array such as this one.",pandas.read_csv,np.loadtxt,,
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='c')","pd.read_csv('test.csv', delimiter=',', engine='python')",6470,9190
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='python', header=None)","pd.read_csv('test.csv', delimiter=',', engine='python')",6260,9190
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='c', header=None)","pd.read_csv('test.csv', delimiter=',', engine='python')",6460,9190
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='python', header=None)","pd.read_csv('test.csv', delimiter=',', engine='c')",6260,6470
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='c', header=None)","pd.read_csv('test.csv', delimiter=',', engine='c')",6460,6470
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', delimiter=',', engine='python', header=None)","pd.read_csv('test.csv', delimiter=',', engine='c', header=None)",6260,6460
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', sep=',', engine='c', header=None, na_filter=False)","pd.read_csv('test.csv', sep=',', engine='c', header=None)",4720,6420
29680339,answer,29678154,"python,parsing,csv,numpy,pandas",codeblock,https://stackoverflow.com/questions/29680339,"pd.read_csv('test.csv', sep=',', engine='c', header=None, na_filter=False, dtype=np.float64, low_memory=False)","pd.read_csv('test.csv', sep=',', engine='c', header=None, na_filter=False, dtype=np.float64, low_memory=True)",3270,4300
29703463,answer,29692875,"python,arrays,numpy,numpy-ufunc",codeblock,https://stackoverflow.com/questions/29703463,"np.vstack(foo1(10*np.ones((10,))))","np.vstack([np.arange(i) for i in 10*np.ones((10,))])",0.127,0.169
29815523,answer,29815129,"python,list,dictionary,pandas,dataframe",codeblock,https://stackoverflow.com/questions/29815523,df.to_dict('records'),df.T.to_dict().values(),0.053,0.395
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"(x[:, np.newaxis] * y).T","np.outer(x, y).T",0.00668,0.0122
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"np.einsum('i,j->ji', x, y)","np.multiply.outer(x, y).T",0.00288,0.00548
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"np.einsum('i,j->ji', x, y)","(x[:, np.newaxis] * y).T",0.00288,0.00668
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"np.multiply.outer(x, y).T","np.outer(x, y).T",0.00548,0.0122
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"np.multiply.outer(x, y).T","(x[:, np.newaxis] * y).T",0.00548,0.00668
29848825,answer,29848757,"python,arrays,python-2.7,numpy,multiplication",codeblock,https://stackoverflow.com/questions/29848825,"np.einsum('i,j->ji', x, y)","np.outer(x, y).T",0.00288,0.0122
29892815,answer,29892707,"python,pandas,dataframe,vectorization,percentile",codeblock,https://stackoverflow.com/questions/29892815,"df.apply(lambda x: x.clip_upper(np.percentile(x, 90)))","np.minimum(df, df.quantile(0.9))",7.49,11.1
29892815,answer,29892707,"python,pandas,dataframe,vectorization,percentile",codeblock,https://stackoverflow.com/questions/29892815,"df.apply(lambda x: x.clip_upper(np.percentile(x, 90)))","np.minimum(df, df.quantile(0.9))",54.5,73.9
29892971,answer,29892707,"python,pandas,dataframe,vectorization,percentile",sentence,df.quantile appears to be slower than np.percentile (possibly because it returns a series rather than a plain numpy array).,np.percentile,df.quantile,,
29919465,answer,29919306,"python,pandas,dataframe,max",codeblock,https://stackoverflow.com/questions/29919465,df.idxmax(axis=1),"df.apply(lambda x: x.argmax(), axis=1)",47.3,479
29921647,answer,29921407,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/29921647,"arr = np.zeros((500, 100, 100, 100))","arr = np.full((500, 100, 100, 100),0)",0.0135,1190
29921647,answer,29921407,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/29921647,"arr = np.zeros((200, 100, 100, 100))","arr = np.full((200, 100, 100, 100),0)",0.0126,232
29979983,answer,29979515,"python-2.7,numpy,scipy",sentence,"timing wise, Rbf is noticeably slower than griddata.",griddata,Rbf,,
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,df[0].apply(lambda v: '_'.join(v.split('_')[1:])),df[0].str[4:],0.127,0.179
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,df[0].str[4:],df[0].str.split('_').str[1:].str.join('_'),0.179,0.553
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,df[0].apply(lambda v: '_'.join(v.split('_')[1:])),df[0].str.split('_').str[1:].str.join('_'),0.127,0.553
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,"df[0].str.split(""_"", 1).str[1]",df[0].str.split('_').str[1:].str.join('_'),0.374,0.553
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,df[0].apply(lambda v: '_'.join(v.split('_')[1:])),"df[0].str.split(""_"", 1).str[1]",0.127,0.374
29993834,answer,29993761,"python,pandas,concatenation,dataframe",codeblock,https://stackoverflow.com/questions/29993834,df[0].str[4:],"df[0].str.split(""_"", 1).str[1]",0.179,0.374
30034933,answer,30026047,"python,arrays,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/30034933,x=np.array([(a*j).tolist() for j in range(n_dim)]).T,x=np.array([(a*j) for j in range(n_dim)]).T,228,228
30091017,answer,30090889,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/30091017,df[bar_cols].sum(axis=1),df.filter(regex='foo').sum(axis=1),0.476,0.483
30091017,answer,30090889,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/30091017,df.filter(regex='foo').sum(axis=1),df[[i for i in df.columns if 'bar' in i]].sum(axis=1),0.483,0.483
30091017,answer,30090889,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/30091017,df[bar_cols].sum(axis=1),df[[i for i in df.columns if 'bar' in i]].sum(axis=1),0.476,0.483
30113715,answer,30113499,"python,performance,pandas,split",codeblock,https://stackoverflow.com/questions/30113715,"df[['ip0', 'ip1', 'ip2', 'ip3']] = df.ip.str.split('.', return_type='frame')","df[['ip0', 'ip1', 'ip2', 'ip3']] = df['ip'].apply(lambda x: pd.Series(x.split('.')))",3060,3100
30113715,answer,30113499,"python,performance,pandas,split",codeblock,https://stackoverflow.com/questions/30113715,"df[['ip0', 'ip1', 'ip2', 'ip3']] = pd.read_table(StringIO(df['ip'].to_csv(None,index=None)),sep='.',header=None)","df[['ip0', 'ip1', 'ip2', 'ip3']] = df['ip'].apply(lambda x: pd.Series(x.split('.')))",46.4,3100
30113715,answer,30113499,"python,performance,pandas,split",codeblock,https://stackoverflow.com/questions/30113715,"df[['ip0', 'ip1', 'ip2', 'ip3']] = pd.read_table(StringIO(df['ip'].to_csv(None,index=None)),sep='.',header=None)","df[['ip0', 'ip1', 'ip2', 'ip3']] = df.ip.str.split('.', return_type='frame')",46.4,3060
30141358,answer,13728392,"python,python-2.7,numpy,matplotlib,scipy",codeblock,https://stackoverflow.com/questions/30141358,"pd.rolling_mean(x, N)[N-1:]","np.convolve(x, np.ones((N,))/N, mode='valid')",4.74,172
30148214,answer,30147378,"python,numpy",codeblock,https://stackoverflow.com/questions/30148214,"np.reshape(a,(2,3,1,1)).shape","np.resize(a,(2,3,1,1)).shape",0.00279,0.0415
30239686,answer,30236481,"python,arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/30239686,"a[:max(idx)+1] = np.bincount(idx,vals)","np.add.at(a, idx, vals)",0.404,0.597
30239686,answer,30236481,"python,arrays,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/30239686,"a[:max(idx)+1] = np.bincount(idx,vals)","np.add.at(a, idx, vals)",0.0424,0.0634
30247807,answer,30247397,"python,pandas",codeblock,https://stackoverflow.com/questions/30247807,"[sum(freq_dict.get(item, 0)for item in phrase.split()) for phrase in phrases]",df_multigram['multigram'].str.split().apply(lambda x: pd.Series(x).map(freq).sum()),0.0036,1.01
30250585,answer,17709270,"python,merge,pandas",codeblock,https://stackoverflow.com/questions/30250585,"df = pd.DataFrame({'Color': 'Red Red Blue'.split(), 'Value': [100, 150, 50]}); df['Counts'] = [sum(df['Color'] == df['Color'][i]) for i in xrange(len(df))]","df = pd.DataFrame({'Color': 'Red Red Blue'.split(), 'Value': [100, 150, 50]}); df['Counts'] = df.groupby(['Color']).transform('count')",1.03,2.87
30397427,answer,30397315,"python,numpy",codeblock,https://stackoverflow.com/questions/30397427,(A==B).sum(),sum(A==B),0.0114,1.34
30529347,answer,30528749,"python,pandas",codeblock,https://stackoverflow.com/questions/30529347,df1['A'].map(df2.set_index('A')['B']),"df1.merge(df2, on='A')",0.718,1.31
30555718,answer,5347065,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/30555718,"np.vstack((a,b)).ravel([-1])","np.ravel(np.dstack((a,b)))",0.00708,0.00714
30555718,answer,5347065,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/30555718,"np.ravel(np.column_stack((a,b)))","np.vstack((a,b)).ravel([-1])",0.00631,0.00708
30555718,answer,5347065,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/30555718,"np.ravel(np.column_stack((a,b)))","np.ravel(np.dstack((a,b)))",0.00631,0.00714
30587210,answer,30587076,"python,arrays,numpy,vectorization,cartesian-product",codeblock,https://stackoverflow.com/questions/30587210,"np.multiply.outer(x, y).flatten()",np.array([x * j for j in y]).flatten(),0.0105,0.0242
30588058,answer,30587076,"python,arrays,numpy,vectorization,cartesian-product",codeblock,https://stackoverflow.com/questions/30588058,"np.einsum('i,j->ij',x,y).ravel()","np.dot(x[:,None],y[None]).ravel()",274,302
30627257,answer,30616430,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/30627257,np.array(ll)[ind],"np.take(ll,ind)",3.29,3.34
30638036,answer,30637708,"python,performance,pandas,split",codeblock,https://stackoverflow.com/questions/30638036,df['newcol']  = df.column_name.map(lambda x: x.split('.')[1]),"for i in range(len(df)): df['newcol'].iloc[i] = df['column_name'].iloc[i].split('.',1)[1]",10.7,7630
30655559,answer,30652760,"python,arrays,performance,numpy,matching",codeblock,https://stackoverflow.com/questions/30655559,"np.searchsorted(np.around(bigx,2), np.around(x,2),side='left')","np.where(np.in1d(np.around(bigx,2), np.around(x,2)))",1.81,4.1
30656662,answer,30656247,"python,arrays,numpy,indexing,masking",codeblock,https://stackoverflow.com/questions/30656662,a.astype(bool).astype(int),a[a != 0] = 1,1.58,4.61
30658454,answer,30656247,"python,arrays,numpy,indexing,masking",codeblock,https://stackoverflow.com/questions/30658454,(x==0).astype(int),1 - x.astype(bool).astype(int),186,319
30658454,answer,30656247,"python,arrays,numpy,indexing,masking",codeblock,https://stackoverflow.com/questions/30658454,(x==0).astype(int),1 - x.astype(bool).astype(int),0.00108,0.00151
30687531,answer,30684563,"arrays,python-3.x,search,numpy",sentence,"np.flatnonzero(arr==i) is slower than ().nonzero()[0], but i haven't looked into why.",().nonzero()[0],np.flatnonzero(arr==i),,
30712571,answer,30712402,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/30712571,numpy.exp(arr),[math.exp(i) for i in arr],1.89,17.9
30716019,answer,30711469,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/30716019,"mat_csr[0, :].todense()","mat_lil[0, :].todense()",0.101,0.157
30716019,answer,30711469,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/30716019,"mat_ds[0, :]","mat_csr[0, :].todense()",0.000954,0.101
30716019,answer,30711469,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/30716019,"mat_ds[0, :]","mat_lil[0, :].todense()",0.000954,0.157
30766702,answer,30741461,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/30766702,sparse.coo_matrix(mat.A+vec.A),sparse.coo_matrix(mat+vec.A),0.338,0.716
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,df[[c for c in df if c[0] == 'd']],"df.select(lambda col: col.startswith('d'), axis=1)",16.4,21.4
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,df[[c for c in df if c[0] == 'd']],"df.filter(regex=(""d.*""))",16.4,40
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,df[[c for c in df if c[0] == 'd']],df[[c for c in df if c.startswith('d')]],16.4,29.2
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,"df.select(lambda col: col.startswith('d'), axis=1)","df.filter(regex=(""d.*""))",21.4,40
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,df[[c for c in df if c.startswith('d')]],"df.filter(regex=(""d.*""))",29.2,40
30808498,answer,30808430,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/30808498,"df.select(lambda col: col.startswith('d'), axis=1)",df[[c for c in df if c.startswith('d')]],21.4,29.2
30812116,answer,30800863,"python,numpy,numba",codeblock,https://stackoverflow.com/questions/30812116,"np.sum(special.eval_laguerre(A[:,None,:],A[None,:,:]),0)","np.sum([special.eval_laguerre(n,A) for n in A],axis=0)",0.0439,0.0848
30874209,answer,30873844,"python,python-2.7,numpy",sentence,"edit: as rth pointed out in the comments to tom's answer, argmin is appreciably faster than nanargmin.",argmin,nanargmin,,
30934912,answer,30921517,"python-2.7,pandas,export-to-csv",codeblock,https://stackoverflow.com/questions/30934912,x.copy().to_csv(),x.copy().to_csv(encoding='ascii'),56.8,109
30934912,answer,30921517,"python-2.7,pandas,export-to-csv",codeblock,https://stackoverflow.com/questions/30934912,x.copy().to_csv(),x.copy().to_csv(encoding='utf8'),56.8,108
30934912,answer,30921517,"python-2.7,pandas,export-to-csv",codeblock,https://stackoverflow.com/questions/30934912,x.copy().to_csv(encoding='utf8'),x.copy().to_csv(encoding='ascii'),108,109
30953773,answer,30953299,"python,pandas",codeblock,https://stackoverflow.com/questions/30953773,"df[""A""].map(lambda x: ""Long"" if ""BULL"" in x else ""Short"" if ""BEAR"" in x else """")","df['A'].str.extract(r'(BULL|BEAR)').map({'BULL':'Long', 'BEAR':'Short'})",4.98,39.7
31053345,answer,31052376,"python,pandas",codeblock,https://stackoverflow.com/questions/31053345,df.resample('15S'),df.groupby(pd.TimeGrouper(freq='15S')).mean(),15.6,15.7
31053985,answer,31053848,"python,pandas,dataframe,nan,subtraction",codeblock,https://stackoverflow.com/questions/31053985,"df['INVOICED_QUANTITY'].sub(df['QUANTITY_SHIPPED'], fill_value=0)",df['INVOICED_QUANTITY'] - df['QUANTITY_SHIPPED'].fillna(0),0.0817,0.144
31065305,answer,31064974,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/31065305,"np.where(arr > threshold, 255, 0)",up = arr > threshold; new_arr = np.zeros_like(arr); new_arr[up] = 255;,12.3,14.2
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[~np.einsum('ij->i',data ==0)]","data[np.all(data!=0, axis=1)]",0.825,1.03
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[~np.any(data==0,1)]","data[np.all(data!=0, axis=1)]",1,1.03
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[~np.any(data==0,1)]","data[np.all(data, axis=1)]",1,1.09
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[~np.einsum('ij->i',data ==0)]","data[np.all(data, axis=1)]",0.825,1.09
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[~np.einsum('ij->i',data ==0)]","data[~np.any(data==0,1)]",0.825,1
31097913,answer,31097043,"python,numpy",codeblock,https://stackoverflow.com/questions/31097913,"data[np.all(data!=0, axis=1)]","data[np.all(data, axis=1)]",1.03,1.09
31100286,answer,30967888,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/31100286,"input[binary_matrix.ravel()[idx[:,0]*lat_len + idx[:,1]] ==1]","input[binary_matrix[idx[:,0], idx[:,1]] == 1]",0.103,0.121
31100286,answer,30967888,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/31100286,"input[binary_matrix.ravel()[idx[:,0]*lat_len + idx[:,1]] ==1]","input[binary_matrix[idx[:,0], idx[:,1]] == 1]",13.1,18.5
31128006,answer,31126698,"python,python-3.x,numpy,scipy,statsmodels",codeblock,https://stackoverflow.com/questions/31128006,"scipy.stats.linregress(x,y)","numpy.polynomial.polynomial.polyfit(x, y, 1)",1.67,8.89
31151773,answer,31151202,"python,algorithm,numpy,matrix-multiplication,blas",codeblock,https://stackoverflow.com/questions/31151773,"np.einsum('ik,ijkl',H,W)","(H[:,None,:,None]*W).sum(axis=(0,2))",0.0107,0.0295
31151773,answer,31151202,"python,algorithm,numpy,matrix-multiplication,blas",codeblock,https://stackoverflow.com/questions/31151773,"(H[:,None,:,None]*W).sum(axis=(0,2))","np.tensordot(H,W,[(0,1),(0,2)])",0.0295,0.0328
31151773,answer,31151202,"python,algorithm,numpy,matrix-multiplication,blas",codeblock,https://stackoverflow.com/questions/31151773,"np.einsum('ik,ijkl',H,W)","np.tensordot(H,W,[(0,1),(0,2)])",0.0107,0.0328
31173785,answer,19913659,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/31173785,df['color'] = df.Set.map( lambda x: 'red' if x == 'Z' else 'green'),"df['color'] = np.where(df['Set']=='Z', 'green', 'red')",0.263,0.523
31188354,answer,31187512,"python,arrays,numpy,intel-mkl,numpy-einsum",sentence,"as a result, tensordot will be generally faster than einsum in single core execution, unless small array sizes are used (and then the reshaping/broadcasting overhead becomes non negligible).",tensordot,einsum,,
31283933,answer,31271039,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/31283933,"np.outer(M.conj().ravel(),M.ravel()).reshape(N,b_size,N,b_size).transpose(1,3,0,2)","np.einsum('ia,jb->abij', M.conj(), M)",24.2,31
31283933,answer,31271039,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/31283933,"np.outer(M.conj().ravel(),M.ravel()).reshape(N,b_size,N,b_size).transpose(1,3,0,2)","np.einsum('ia,jb->abij', M.conj(), M)",399,497
31283933,answer,31271039,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/31283933,"np.einsum('ia,jb->abij', M.conj(), M)","np.outer(M.conj().ravel(),M.ravel()).reshape(N,b_size,N,b_size).transpose(1,3,0,2)",0.026,0.0556
31420295,answer,31419952,"python,pandas",codeblock,https://stackoverflow.com/questions/31420295,c = a.join(b),"c = pd.concat([a, b], axis=1)",6.47,7.11
31420295,answer,31419952,"python,pandas",codeblock,https://stackoverflow.com/questions/31420295,"c = pd.concat([a, b], axis=1)","c = pd.concat([a, b], axis=1, ignore_index=True)",7.11,10.8
31420295,answer,31419952,"python,pandas",codeblock,https://stackoverflow.com/questions/31420295,c = a.join(b),"c = pd.concat([a, b], axis=1, ignore_index=True)",6.47,10.8
31469249,answer,31466769,"python,pandas",codeblock,https://stackoverflow.com/questions/31469249,"df['empty1'] = pd.np.empty((len(df), 0)).tolist()","df['empty3'] = df.apply(lambda x: [], axis=1)",127,5890
31499284,answer,31498784,"python,numpy",sentence,"but, filling a new allocated memory with numpy.zeros is nearly twice as fast, as filling an existing array with numpy.fill, and three times faster than item setting x[:] = 0.",numpy.zeros,x[:] = 0,,
31534542,answer,31502958,"numpy,pandas",codeblock,https://stackoverflow.com/questions/31534542,"df.merge(randlist, left_index=True, right_index=True, how='right')","df.merge(pandas.DataFrame(index=np.random.randint(n, size=n)), left_index=True, right_index=True, how='right')",1.87,2.29
31606544,answer,31606137,"python,pandas",codeblock,https://stackoverflow.com/questions/31606544,df.loc[df.any(axis=1)],"df[df.apply(any, axis=1)]",0.636,2.13
31606544,answer,31606137,"python,pandas",codeblock,https://stackoverflow.com/questions/31606544,"df.loc[np.logical_or.reduce(df, axis=1)]","df[df.apply(any, axis=1)]",0.261,2.13
31606544,answer,31606137,"python,pandas",codeblock,https://stackoverflow.com/questions/31606544,"df.loc[np.logical_or.reduce(df, axis=1)]",df.loc[df.any(axis=1)],0.261,0.636
31618820,answer,31614804,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/31618820,"c = df.loc[:, (df.isnull().sum(axis=0) <= max_number_of_nans)]","c = df.drop(df.columns[df.apply(lambda col: col.isnull().sum() > max_number_of_nans)], axis=1)",1.76,2.04
31618820,answer,31614804,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/31618820,"c = df.loc[:, (df.isnull().sum(axis=0) <= max_number_of_nans)]","c = df.drop(df.columns[df.apply(lambda col: col.isnull().sum() > max_number_of_nans)], axis=1)",0.662,1.08
31653385,answer,31642353,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/31653385,"np.partition(a, 10, axis=None)[:10]","np.sort(a, axis=None)[:10]",0.0751,0.465
31678310,answer,31675610,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31678310,En.dot(b),E.dot(b),43.4,55.5
31678310,answer,31675610,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31678310,A.dot(b),An.dot(b),0.00963,41.6
31678310,answer,31675610,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31678310,D.dot(b),Dn.dot(b),35.4,43.2
31678310,answer,31675610,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31678310,C.dot(b),Cn.dot(b),3.2,41.2
31678310,answer,31675610,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31678310,B.dot(b),Bn.dot(b),0.0413,41.2
31789252,answer,31789187,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/31789252,"np.searchsorted(b, a, side='right') != np.searchsorted(b, a, side='left')","np.in1d(a, b)",106,176
31800771,answer,31790819,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/31800771,"np.add.reduceat(A2.data, A2.indptr[:-1])",[np.sum(l) for l in A2.tolil().data],0.00741,0.28
31857163,answer,31821480,"python,pandas",codeblock,https://stackoverflow.com/questions/31857163,"pd.to_datetime(dates,format=format)",dates.map(lambda x: pd.datetools.parse(x)),525,6980
31859675,answer,31858530,"python,performance,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/31859675,"dists1 = np.asarray([cdist(x,y) for x, y in zip(A, B)])","dists2 = np.sqrt( np.sum( (A[:,:,np.newaxis,:] - B[:,np.newaxis,:,:])**2, axis=-1) )",8.81,46.9
31859675,answer,31858530,"python,performance,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/31859675,"dists3 = np.asarray([euclidean_distances(x,y) for x, y in zip(A, B)])","dists1 = np.asarray([cdist(x,y) for x, y in zip(A, B)])",2940,3070
31895487,answer,31892550,"python,pandas",codeblock,https://stackoverflow.com/questions/31895487,"pd.to_datetime(df2['date'] + ' ' + df2['time'],format='%m/%d/%Y %H:%M:%S.%f')","pd.to_datetime(df2['date'], format=""%m/%d/%Y"") +  pd.to_timedelta(df2['time'])",8810,9760
31963209,answer,31954393,"python,performance,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/31963209,(df2.notnull().cumsum(1) == 4).idxmax(axis=1),df2.T.apply(lambda x: x.dropna()[n-1:].index[0]),10.5,673
31963209,answer,31954393,"python,performance,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/31963209,df2.T.apply(lambda x: x.dropna()[n-1:].index[0]),"df2.apply(lambda row: get_nth(row, n), axis=1)",673,749
31963209,answer,31954393,"python,performance,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/31963209,(df2.notnull().cumsum(1) == 4).idxmax(axis=1),"df2.apply(lambda row: get_nth(row, n), axis=1)",10.5,749
31969024,answer,31968711,pandas,codeblock,https://stackoverflow.com/questions/31969024,"pd.Series(np.tile(a.values, 1000000))",pd.concat([a] * 1000000),17.7,16900
31980338,answer,31979554,"python,sql,pandas,pickle",codeblock,https://stackoverflow.com/questions/31980338,ts.to_pickle('p.test'),"ts.to_sql('ts1', engine, if_exists='replace')",279,11900
31980338,answer,31979554,"python,sql,pandas,pickle",codeblock,https://stackoverflow.com/questions/31980338,ts.to_json('p.json'),ts.to_pickle('p.test'),261,279
31980338,answer,31979554,"python,sql,pandas,pickle",codeblock,https://stackoverflow.com/questions/31980338,ts.to_json('p.json'),"ts.to_sql('ts1', engine, if_exists='replace')",261,11900
32029053,answer,32028402,"python,arrays,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/32029053,"np.array([A[i,j] for i,j in I])",np.array([A[tuple(i)] for i in I]),0.0157,0.0173
32029053,answer,32028402,"python,arrays,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/32029053,"i,j=tuple(I.T)





A[i,j]",A[tuple(I.T)],0.00486,0.01
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"np.einsum('ij->i',X)[:,None]/X.shape[1]","X.mean(axis=1, keepdims=True)",0.832,1.5
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"np.einsum('ij->i',X)[:,None]/X.shape[1]","X.mean(axis=1).reshape(-1, 1)",0.832,1.52
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"X - X.mean(axis=1).reshape(-1, 1)","X - X.mean(axis=1, keepdims=True)",6.54,6.56
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"X - np.einsum('ij->i',X)[:,None]/X.shape[1]","X - X.mean(axis=1).reshape(-1, 1)",6.18,6.54
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"X - np.einsum('ij->i',X)[:,None]/X.shape[1]","X - X.mean(axis=1, keepdims=True)",6.18,6.56
32032621,answer,32030343,"python,numpy",sentence,"if you are looking for performance, you can also consider using np.einsum that is supposedly faster than actually using np.sum or np.mean.",np.einsum,np.sum,,
32032621,answer,32030343,"python,numpy",codeblock,https://stackoverflow.com/questions/32032621,"X.mean(axis=1, keepdims=True)","X.mean(axis=1).reshape(-1, 1)",1.5,1.52
32034914,answer,32034689,"python,csv,pandas,python-datetime,string-to-datetime",codeblock,https://stackoverflow.com/questions/32034914,"pd.to_datetime(s_c, format=""%Y/%m/%d %H:%M:%S"")",pd.to_datetime(s_c),99.5,1140
32034914,answer,32034689,"python,csv,pandas,python-datetime,string-to-datetime",codeblock,https://stackoverflow.com/questions/32034914,"pd.to_datetime(s_c, format=""%Y/%m/%d %H:%M:%S"")","pd.to_datetime(s_c, infer_datetime_format=True)",99.5,105
32034914,answer,32034689,"python,csv,pandas,python-datetime,string-to-datetime",codeblock,https://stackoverflow.com/questions/32034914,"pd.to_datetime(s_c, infer_datetime_format=True)",pd.to_datetime(s_c),105,1140
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,"np.sqrt(np.einsum('ij,ij->i',a,a))","np.sqrt(np.add.reduce(a * a, axis=1))",0.00542,0.0107
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,"np.sqrt(np.einsum('ij,ij->i',a,a))","np.linalg.norm(a, axis=1)",0.00542,0.0135
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,"np.sqrt(np.add.reduce(a * a, axis=1))","np.linalg.norm(a, axis=1)",0.0107,0.0135
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,"np.sqrt(np.einsum('ij,ij->i',a,a))",np.sqrt((a*a).sum(axis=1)),0.00542,0.0111
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,np.sqrt((a*a).sum(axis=1)),"np.linalg.norm(a, axis=1)",0.0111,0.0135
32084333,answer,32083997,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/32084333,"np.sqrt(np.add.reduce(a * a, axis=1))",np.sqrt((a*a).sum(axis=1)),0.0107,0.0111
32094352,answer,32093829,"python,pandas,duplicates",codeblock,https://stackoverflow.com/questions/32094352,"df.loc[df.groupby(['A', 'B']).C.max == df.C]","df.sort_values('C').drop_duplicates(subset=['A', 'B'], keep='last')",25.7,101
32140623,answer,32135572,"python,numpy,memory,scipy",codeblock,https://stackoverflow.com/questions/32140623,"std(a, blocksize=1000000)","std(a, blocksize=4096)",105,160
32140623,answer,32135572,"python,numpy,memory,scipy",codeblock,https://stackoverflow.com/questions/32140623,np.std(a),"std(a, blocksize=4096)",105,160
32140623,answer,32135572,"python,numpy,memory,scipy",codeblock,https://stackoverflow.com/questions/32140623,"std(a, blocksize=1000000)",np.std(a),105,105
32142625,answer,32141856,"python,arrays,math,numpy,euclidean-distance",codeblock,https://stackoverflow.com/questions/32142625,"np.linalg.norm(a[1:2] - a, axis=1)",np.sqrt(((a[1:2] - a) ** 2).sum(1)),5.43,5.5
32148268,answer,32138067,pandas,codeblock,https://stackoverflow.com/questions/32148268,df['y'].cumprod(),df.groupby('x').cumprod(),0.133,102
32155109,answer,32155011,"python,numpy,types,format,type-conversion",codeblock,https://stackoverflow.com/questions/32155109,"np.array(map(int,s))",np.array([int(c) for c in s]),0.389,0.422
32155265,answer,32155011,"python,numpy,types,format,type-conversion",codeblock,https://stackoverflow.com/questions/32155265,"np.fromstring(' '.join(s), sep=' ', dtype=int)","np.fromiter(s, dtype=int)",0.499,2.33
32249984,answer,32249960,"python,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/32249984,df.index = df.index + 1,"df.index = np.arange(1, len(df) + 1)",0.107,0.154
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.values.sum(),df.unstack().sum(),0.00627,0.233
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.values.sum(),df.stack().sum(),0.00627,0.19
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.sum().sum(),df.unstack().sum(),0.109,0.233
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.sum().sum(),df.stack().sum(),0.109,0.19
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.stack().sum(),df.unstack().sum(),0.19,0.233
32340834,answer,32340689,"python,pandas",codeblock,https://stackoverflow.com/questions/32340834,df.values.sum(),df.sum().sum(),0.00627,0.109
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,True in mydf['Campaign'].duplicated().get_values(),True if len(mydf.drop_duplicates('Campaign')) < len(mydf['Campaign']) else False,12.3,138
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,mydf.Campaign.duplicated().any(),True if len(mydf.drop_duplicates('Campaign')) < len(mydf['Campaign']) else False,11.2,138
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,mydf.Campaign.duplicated().any(),True if len(mydf.drop_duplicates('Campaign')) < len(mydf['Campaign']) else False,0.0399,0.311
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,True in mydf['Campaign'].duplicated().get_values(),mydf.Campaign.duplicated().any(),0.034,0.0399
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,True in mydf['Campaign'].duplicated().get_values(),True if len(mydf.drop_duplicates('Campaign')) < len(mydf['Campaign']) else False,0.034,0.311
32386955,answer,32386791,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/32386955,mydf.Campaign.duplicated().any(),True in mydf['Campaign'].duplicated().get_values(),11.2,12.3
32453333,answer,32453038,"python,pandas,list-comprehension,datetime-format",codeblock,https://stackoverflow.com/questions/32453333,"df.index + pd.TimedeltaIndex(df['hour'], unit='h')","df.index + df['hour'].apply(lambda x: pd.Timedelta(x, 'h'))",0.291,1.18
32530226,answer,32523819,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/32530226,"M[np.arange(100)<80,:]","M[np.arange(80),:]",15,15.1
32530226,answer,32523819,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/32530226,"M[:80,:]","M[np.arange(100)<80,:]",5.63,15
32530226,answer,32523819,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/32530226,"M[:80,:]","M[np.arange(80),:]",5.63,15.1
32588847,answer,32588797,"python,pandas",codeblock,https://stackoverflow.com/questions/32588847,df.select_dtypes(include=['object']).apply(function),"df.select_dtypes(include=['object']).apply(function, axis=1)",2.37,3.42
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.iloc[5, 5]",0.00926,0.0988
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.loc[5, 5]",8.55E-05,0.0108
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.at[5, 5]",8.55E-05,0.00687
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.iloc[5, 5]",8.55E-05,0.0149
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.iat[5, 5]",8.55E-05,0.00989
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.loc[5, 5]",0.00687,0.0108
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.loc[5, 5]",0.00031,0.104
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.at[5, 5]",0.00031,0.00926
32658847,answer,22084338,"python,dictionary,pandas",sentence,"not only the performance gap between dictionary access and .loc reduced (from about 335 times to 126 times slower), loc (iloc) is less than two times slower than at (iat) now.",at,loc,,
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.iat[5, 5]",0.00031,0.00958
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.loc[5, 5]",0.00926,0.104
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.loc[5, 5]","value = df.iloc[5, 5]",0.0108,0.0149
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.iat[5, 5]","value = df.loc[5, 5]",0.00989,0.0108
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.iloc[5, 5]",0.00687,0.0149
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.iat[5, 5]",0.00687,0.00989
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.iat[5, 5]","value = df.iloc[5, 5]",0.00989,0.0149
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.iloc[5, 5]","value = df.loc[5, 5]",0.0988,0.104
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.iat[5, 5]","value = df.loc[5, 5]",0.00958,0.104
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.iat[5, 5]","value = df.iloc[5, 5]",0.00958,0.0988
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,value = dictionary[5][5],"value = df.iloc[5, 5]",0.00031,0.0988
32658847,answer,22084338,"python,dictionary,pandas",codeblock,https://stackoverflow.com/questions/32658847,"value = df.at[5, 5]","value = df.iat[5, 5]",0.00926,0.00958
32680162,answer,16476924,"python,pandas,rows,dataframe",codeblock,https://stackoverflow.com/questions/32680162,[row[1] * 2 for row in df.itertuples()],"[row.a * 2 for idx, row in df.iterrows()]",0.541,50.3
32686660,answer,32686460,"python,numpy",codeblock,https://stackoverflow.com/questions/32686660,"coords=np.array((xx.ravel(), yy.ravel())).T","coords=np.c_[xx.ravel(), yy.ravel()]",0.0146,0.0476
32697426,answer,32697193,"python,arrays,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/32697426,"np.concatenate((A,B,C,D,E,F,G,H,J)).reshape(3,3,-1).transpose(2,0,1)","np.concatenate((A,B,C,D,E,F,G,H,J)).reshape(9,-1).T.reshape(-1,3,3)",0.0148,0.0158
32697426,answer,32697193,"python,arrays,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/32697426,"np.concatenate((A,B,C,D,E,F,G,H,J)).reshape(3,3,-1).transpose(2,0,1)","np.column_stack((A,B,C,D,E,F,G,H,J)).reshape(-1,3,3)",0.0148,0.0844
32697426,answer,32697193,"python,arrays,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/32697426,"np.concatenate((A,B,C,D,E,F,G,H,J)).reshape(9,-1).T.reshape(-1,3,3)","np.column_stack((A,B,C,D,E,F,G,H,J)).reshape(-1,3,3)",0.0158,0.0844
32726761,answer,32726701,"python,arrays,numpy,casting",codeblock,https://stackoverflow.com/questions/32726761,(b > 0).view(np.int8),(b > 0).astype(int),1.12,4.63
32726761,answer,32726701,"python,arrays,numpy,casting",codeblock,https://stackoverflow.com/questions/32726761,(b > 0).view(np.int8),np.array([ x if x >=0 else 0 for x in np.sign(b)]),1.12,420
32726761,answer,32726701,"python,arrays,numpy,casting",codeblock,https://stackoverflow.com/questions/32726761,(b > 0).astype(int),np.array([ x if x >=0 else 0 for x in np.sign(b)]),4.63,420
32731304,answer,32730202,"python,arrays,numpy,cython,hamming-distance",codeblock,https://stackoverflow.com/questions/32731304,np.count_nonzero(a!=b),"np.sum(np.bitwise_xor(a,b))",0.00107,0.0058
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"b = np.where(a>0, a, 0)",b = a.clip(min=0),152,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"np.multiply(a,G,a)",a[np.where(L)] = 0,40.1,122
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"np.multiply(a,G,a)",a[L] = 0,40.1,158
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,a[np.where(L)] = 0,a[L] = 0,122,158
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"np.multiply(a,G,a)",b = a.clip(min=0),40.1,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,a[np.where(L)] = 0,b = a.clip(min=0),122,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,a[L] = 0,b = a.clip(min=0),158,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,a[np.where(L)] = 0,"b = np.where(G, a, 0)",122,132
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"b = np.where(G, a, 0)",a[L] = 0,132,158
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"b = np.where(G, a, 0)",b = a.clip(min=0),132,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.copy(); b*=a>0,b = a.copy(); b[np.where(a<0)] = 0,121,205
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.copy(); b*=a>0,b = a.copy(); b[a<0] = 0,121,231
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.copy(); b[np.where(a<0)] = 0,b = a.copy(); b[a<0] = 0,205,231
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.copy(); b*=a>0,b = a.clip(min=0),121,165
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"np.multiply(a,G,a)","b = np.where(G, a, 0)",40.1,132
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"b = np.where(a>0, a, 0)",b = a.copy(); b[a<0] = 0,152,231
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.clip(min=0),b = a.copy(); b[np.where(a<0)] = 0,165,205
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,"b = np.where(a>0, a, 0)",b = a.copy(); b[np.where(a<0)] = 0,152,205
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.copy(); b*=a>0,"b = np.where(a>0, a, 0)",121,152
32745932,answer,3391843,"python,numpy",codeblock,https://stackoverflow.com/questions/32745932,b = a.clip(min=0),b = a.copy(); b[a<0] = 0,165,231
32807342,answer,32807267,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/32807342,"data.reshape(300,-1,data.shape[1])","np.vsplit(data,300)",0.00108,7.05
32814986,answer,32814746,"pandas,dataframe,manual",sentence,"or use set_value method (which is much faster than iloc by the way): df.set_value(0,'A',5)",set_value,iloc,,
32848377,answer,32846846,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/32848377,"a.repeat(20, axis=0).repeat(20, axis=1)","np.kron(a, np.ones((20,20), a.dtype))",0.026,0.106
32850563,answer,32850491,"python,pandas",codeblock,https://stackoverflow.com/questions/32850563,(df1.values * df2.values).sum(axis=1),(df1*df2).sum(axis=1),0.0498,0.379
32850563,answer,32850491,"python,pandas",codeblock,https://stackoverflow.com/questions/32850563,"np.einsum('ij,ij->i', df1.values, df2.values)",(df1*df2).sum(axis=1),0.03,0.379
32850563,answer,32850491,"python,pandas",codeblock,https://stackoverflow.com/questions/32850563,"np.einsum('ij,ij->i', df1.values, df2.values)",(df1.values * df2.values).sum(axis=1),0.03,0.0498
32902941,answer,32902837,"pandas,replace,substring,dataframe",codeblock,https://stackoverflow.com/questions/32902941,"df['raw_parameter_name'].str.replace('MEAN', 'X-BAR')","df['raw_parameter_name'].apply(lambda x: re.sub(';MEAN$',';X-BAR',x))",687,1010
33006122,answer,33004551,"python,numpy,multidimensional-array,product",codeblock,https://stackoverflow.com/questions/33006122,"np.einsum(""ijk, kl -> ijl"", A, x)","np.dot(A,x)",0.108,0.174
33006122,answer,33004551,"python,numpy,multidimensional-array,product",codeblock,https://stackoverflow.com/questions/33006122,"np.dot(A,x)","np.einsum(""ikj, kl -> ijl"", A, x)",0.174,0.238
33034619,answer,33034559,"python,pandas,dataframe,integer",codeblock,https://stackoverflow.com/questions/33034619,df['DATE'].floordiv(100),df['DATE'].astype(str).str[:-2].astype(np.int64),0.203,2.92
33038587,answer,33036759,"python,numpy",codeblock,https://stackoverflow.com/questions/33038587,"np.unpackbits(np.arange(2**r,dtype='uint8')[:,None], axis=1)[:,8-r:]","np.array(list(product([0,1], repeat=5)))",0.0106,0.0339
33038587,answer,33036759,"python,numpy",codeblock,https://stackoverflow.com/questions/33038587,"(((np.arange(2**r)[:,None] & 2**np.arange(r)[::-1]))>0).astype(int)","np.array(list(product([0,1], repeat=5)))",0.0311,0.0339
33038587,answer,33036759,"python,numpy",codeblock,https://stackoverflow.com/questions/33038587,"np.unpackbits(np.arange(2**r,dtype='uint8')[:,None], axis=1)[:,8-r:]","(((np.arange(2**r)[:,None] & 2**np.arange(r)[::-1]))>0).astype(int)",0.0106,0.0311
33038587,answer,33036759,"python,numpy",codeblock,https://stackoverflow.com/questions/33038587,"(((np.arange(2**r)[:,None] & 2**np.arange(r)[::-1]))>0).astype(int)","np.array(list(product([0,1], repeat=r)))",6.6,77.5
33045655,answer,33036759,"python,numpy",codeblock,https://stackoverflow.com/questions/33045655,"np.fromiter(chain(*product([0,1],repeat=5)),int,count=160).reshape(-1,5)","np.array(list(product([0,1],repeat=5)))",0.0338,0.0651
33047596,answer,33047277,"python,pandas",codeblock,https://stackoverflow.com/questions/33047596,"mask = pd.isnull(df2).values; df2.values[np.arange(len(df2)), np.argmin(mask, axis=1)]","df2.apply(coalesce, axis=1)",0.617,84.1
33095798,answer,33092527,"python,numpy,theano",codeblock,https://stackoverflow.com/questions/33095798,"np.einsum('i->',np.arange(k0,kN+1))*x","np.arange(k0,kN+1).sum()*x",0.0497,0.0549
33141411,answer,33140674,"python,arrays,sorting,numpy,numerical-methods",codeblock,https://stackoverflow.com/questions/33141411,"b.ravel()[a.argsort(1)+(np.arange(M)[:,None]*N)]","b[np.arange(np.shape(a)[0])[:,np.newaxis], np.argsort(a)]",96.7,133
33144907,answer,33144813,"python,pandas",codeblock,https://stackoverflow.com/questions/33144907,"df.apply(pd.Series.value_counts).dropna(thresh=2, axis=1)","df[df.apply(pd.Series.value_counts).dropna(thresh=2, axis=1).columns]",5.81,8.81
33238944,answer,33238913,"arrays,performance,numpy,vectorization,python-2.x",codeblock,https://stackoverflow.com/questions/33238944,"np.take(b,a)",b[a.ravel()].reshape(a.shape),0.105,0.231
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.concatenate((a,np.zeros((a.shape[0],N))), axis=1)","np.lib.pad(a, ((0,0),(0,N)), 'constant', constant_values=(0))",1.71,2.99
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.concatenate((a,np.zeros((a.shape[0],N))), axis=1)","np.hstack([a, np.zeros([a.shape[0], N])])",1.71,1.72
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.hstack([a, np.zeros([a.shape[0], N])])","np.lib.pad(a, ((0,0),(0,N)), 'constant', constant_values=(0))",1.72,2.99
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.concatenate((a,np.zeros((a.shape[0],N))), axis=1)","np.hstack([a, np.zeros([a.shape[0], N])])",0.00449,0.0112
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.concatenate((a,np.zeros((a.shape[0],N))), axis=1)","np.lib.pad(a, ((0,0),(0,N)), 'constant', constant_values=(0))",0.00449,0.0327
33256875,answer,33256823,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33256875,"np.hstack([a, np.zeros([a.shape[0], N])])","np.lib.pad(a, ((0,0),(0,N)), 'constant', constant_values=(0))",0.0112,0.0327
33286826,answer,33282369,"python,numpy,itertools",codeblock,https://stackoverflow.com/questions/33286826,"np.fromiter(itertools.chain.from_iterable(itertools.combinations(range(6), 2)), np.int)","np.array(np.triu_indices(6, 1)).T",0.00404,0.0223
33286826,answer,33282369,"python,numpy,itertools",codeblock,https://stackoverflow.com/questions/33286826,"np.array(np.triu_indices(1000, 1)).T","np.fromiter(itertools.chain.from_iterable(itertools.combinations(range(1000), 2)), np.int)",10.6,69.7
33288261,answer,33288061,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/33288261,df.groupby('count_id').AMV.transform(lambda x: x - np.min(x)),df.groupby('count_id').AMV.apply(lambda x: x - np.min(x)),0.804,1.32
33288261,answer,33288061,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/33288261,"df[""AMV""] - df.groupby('count_id')[""AMV""].transform('min')",df.groupby('count_id').AMV.transform(lambda x: x - np.min(x)),0.736,0.804
33288261,answer,33288061,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/33288261,"df[""AMV""] - df.groupby('count_id')[""AMV""].transform('min')",df.groupby('count_id').AMV.apply(lambda x: x - np.min(x)),0.736,1.32
33308347,answer,33307993,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/33308347,"df.groupby(pd.Grouper(key='date_build', freq='M')).size()","pd.DatetimeIndex(df.date_build).to_series().resample('M', how='count')",136,149
33308834,answer,33308738,"python,numpy,itertools",codeblock,https://stackoverflow.com/questions/33308834,"np.split(a,np.nonzero(np.diff(a))[0]+1)","np.split(a,np.where(np.diff(a)>0)[0]+1)",0.0252,0.0292
33334694,answer,33334630,"python,arrays,numpy,vectorization,multiplication",codeblock,https://stackoverflow.com/questions/33334694,"np.einsum('ijk,lk->lij',A,Combinations)","np.array([  np.sum( A*cb, axis=2)  for cb in Combinations])",32,324
33346784,answer,33346712,"python,numpy,lambda",codeblock,https://stackoverflow.com/questions/33346784,b[b<0] = 0,"a = np.where(b > 0, b, 0)",0.00111,0.00215
33354793,answer,33354576,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/33354793,df.reindex(selection2),df.loc[selection2],0.833,2.54
33362030,answer,14933577,"python,multidimensional-array,numpy,swap",codeblock,https://stackoverflow.com/questions/33362030,"a[:,0,0], b[:, 0, 0] = b[:, 0, 0], a[:, 0, 0].copy()","t = np.copy(a[:,0,0]); a[:,0,0] = b[:,0,0]; b[:,0,0] = t",0.00175,0.00268
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,"pd.to_datetime(dates, format='%d %b %Y %H:%M:%S')",pd.to_datetime(dates),5.96,139
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,"pd.to_datetime(dates, format='%d %b %Y %H:%M:%S')","pd.to_datetime(dates, infer_datetime_format=True)",5.96,6.79
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,"pd.to_datetime(dates, infer_datetime_format=True)",ser.apply(lambda x: parser.parse(x)),6.79,91.1
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,"pd.to_datetime(dates, infer_datetime_format=True)",pd.to_datetime(dates),6.79,139
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,ser.apply(lambda x: parser.parse(x)),pd.to_datetime(dates),91.1,139
33374969,answer,33373312,"optimization,pandas,dataframe,apply",codeblock,https://stackoverflow.com/questions/33374969,"pd.to_datetime(dates, format='%d %b %Y %H:%M:%S')",ser.apply(lambda x: parser.parse(x)),5.96,91.1
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"((A.transpose(2,0,1).reshape(-1,m).dot(B.T)).reshape(n,-1)).dot(A.reshape(-1,n)).T","np.tensordot(A, np.tensordot(A, B, axes=(1, 1)), axes=((0, 1), (0, 2)))",5.3,6.22
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"((A.transpose(2,0,1).reshape(-1,m).dot(B.T)).reshape(n,-1)).dot(A.reshape(-1,n)).T","np.einsum('nij, il, kln ->jk', A, B, A.T)",5.3,105
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"np.tensordot(A, np.tensordot(A, B, axes=(1, 1)), axes=((0, 1), (0, 2)))","np.einsum('nij, il, kln ->jk', A, B, A.T)",6.22,105
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"((A.transpose(2,0,1).reshape(-1,m).dot(B.T)).reshape(n,-1)).dot(A.reshape(-1,n)).T","np.einsum('nij,njk->ik', np.einsum('nij,jk->nik', A.transpose(0,2,1), B), A)",5.3,10.7
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"np.tensordot(A, np.tensordot(A, B, axes=(1, 1)), axes=((0, 1), (0, 2)))","np.einsum('nij,njk->ik', np.einsum('nij,jk->nik', A.transpose(0,2,1), B), A)",6.22,10.7
33402675,answer,33399981,"python,arrays,numpy,vectorization,numpy-einsum",codeblock,https://stackoverflow.com/questions/33402675,"np.einsum('nij,njk->ik', np.einsum('nij,jk->nik', A.transpose(0,2,1), B), A)","np.einsum('nij, il, kln ->jk', A, B, A.T)",10.7,105
33437506,answer,23966923,"python,numpy,matrix,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/33437506,"M = sparse.rand(m, n, format='csr')





dropcols_coo(M, idx_to_drop)","M = sparse.rand(m, n, format='csr')





dropcols_fancy(M, idx_to_drop)",365,1110
33479331,answer,33479149,"python,datetime,numpy,pandas",codeblock,https://stackoverflow.com/questions/33479331,s.dt.tz_localize(pytz.utc),s.apply(lambda x: x.replace(tzinfo=pytz.utc)),107,10400
33499916,answer,33498061,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/33499916,df.groupby(cols).apply(lambda group: 0),df.groupby(cols).apply(lambda group: group),64.3,2410
33518725,answer,33518124,"python,function,pandas",codeblock,https://stackoverflow.com/questions/33518725,np.sqrt((2*df['D']*ck)/(ch*df['p'])),"df.apply(lambda row: EOQ(row['D'], row['p'], ck, ch), axis=1)",0.622,1190
33521696,answer,33518873,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/33521696,df.iloc[df.groupby('id')['date'].idxmax()],df.groupby('id').apply(lambda t: t[t.date==t.date.max()]),135,815
33521696,answer,33518873,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/33521696,"df.reindex(df.sort_values([""date""], ascending=False)[""id""].drop_duplicates().index)",df.iloc[df.groupby('id')['date'].idxmax()],1.99,135
33521696,answer,33518873,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/33521696,"df.reindex(df.sort_values([""date""], ascending=False)[""id""].drop_duplicates().index)",df.groupby('id').apply(lambda t: t[t.date==t.date.max()]),5.1,826
33521696,answer,33518873,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/33521696,"df.reindex(df.sort_values([""date""], ascending=False)[""id""].drop_duplicates().index)",df.groupby('id').apply(lambda t: t[t.date==t.date.max()]),1.99,815
33552005,answer,33551962,"python,numpy",codeblock,https://stackoverflow.com/questions/33552005,"np.multiply(a,b[:,None])","np.array([np.multiply(a[x],b[x]) for x in range(a.shape[0])])",64,118
33558112,answer,33557022,"python,pandas,dask",sentence,the .assign method is available in pandas as well and may be faster than using .apply.,.assign,.apply,,
33604340,answer,33600328,"python,numpy,cython,linear-algebra,numba",codeblock,https://stackoverflow.com/questions/33604340,"np.amax(np.linalg.svd(A1,compute_uv=0),axis=-1)","np.linalg.norm(A1,ord=2,axis=(1,2))",0.389,0.398
33677278,answer,21821045,"python,python-3.x,numpy",sentence,numpy's arr.tobytes() seems to be significantly faster than bytes(memoryview(arr)) in returning a bytes object.,arr.tobytes(),bytes(memoryview(arr)),,
33701536,answer,33700954,"python,json,dictionary,pandas",codeblock,https://stackoverflow.com/questions/33701536,"s = df.apply((lambda x: x.to_dict()), axis=1)","s = df.apply((lambda x: x.to_json()), axis=1)",3.91,5.88
33701536,answer,33700954,"python,json,dictionary,pandas",codeblock,https://stackoverflow.com/questions/33701536,"s = df.apply((lambda x: x.to_json()), axis=1)","s = df.apply((lambda x: x.to_dict()), axis=1)",0.375,0.45
33763855,answer,29550414,"python,numpy,pandas,dataframe,tuples",sentence,"on much larger datasets, i found that .apply() is few orders slower than pd.DataFrame(df['b'].values.tolist())",pd.DataFrame(df['b'].values.tolist()),.apply(),,
33836920,answer,16970982,"python,arrays,numpy,unique",codeblock,https://stackoverflow.com/questions/33836920,"pd.DataFrame(image.reshape(-1,3)).drop_duplicates().values","np.vstack({tuple(r) for r in image.reshape(-1,3)})",3080,51000
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.concatenate((a1[...,None].transpose(1,0,2),a2[...,None].transpose(1,0,2)),2)","np.concatenate((a1.T[...,None],a2.T[...,None]),2)",372,373
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.concatenate((a1.T[...,None],a2.T[...,None]),2)","np.dstack((a1,a2)).transpose(1,0,2)",3.03,3.05
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.concatenate((a1[...,None].transpose(1,0,2),a2[...,None].transpose(1,0,2)),2)","np.dstack((a1,a2)).transpose(1,0,2)",3.02,3.05
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.concatenate((a1[...,None].transpose(1,0,2),a2[...,None].transpose(1,0,2)),2)","np.concatenate((a1.T[...,None],a2.T[...,None]),2)",3.02,3.03
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.dstack((a1,a2)).transpose(1,0,2)","np.concatenate((a1[...,None].transpose(1,0,2),a2[...,None].transpose(1,0,2)),2)",371,372
33877552,answer,33877419,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/33877552,"np.dstack((a1,a2)).transpose(1,0,2)","np.concatenate((a1.T[...,None],a2.T[...,None]),2)",371,373
33879621,answer,33879197,"pandas,dataframe,datetimeindex",codeblock,https://stackoverflow.com/questions/33879621,df[df.index.dayofweek < 2],"df[np.in1d(df.index.dayofweek, [1, 2])]",0.464,0.521
33879692,answer,33879197,"pandas,dataframe,datetimeindex",codeblock,https://stackoverflow.com/questions/33879692,"df[np.in1d(df.index.dayofweek, [0, 1])]","df.loc[df.index.to_series().dt.dayofweek.isin([0,1]).values]",0.393,2.01
33900914,answer,33898225,"python,datetime,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/33900914,"df[:pd.to_datetime(""2015-09-01"")].ix[-1, :]","df[df.index < pd.to_datetime(""2015-09-01"")].ix[-1, :]",0.45,0.62
33900914,answer,33898225,"python,datetime,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/33900914,"df.iloc[:df.index.values.searchsorted(np.datetime64(""2015-09-01""))].ix[-1, :]","df[:pd.to_datetime(""2015-09-01"")].ix[-1, :]",0.293,0.45
33900914,answer,33898225,"python,datetime,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/33900914,"df.iloc[:df.index.values.searchsorted(np.datetime64(""2015-09-01""))].ix[-1, :]","df[df.index < pd.to_datetime(""2015-09-01"")].ix[-1, :]",0.293,0.62
33906373,answer,33897625,"arrays,opencv,numpy,pixel",codeblock,https://stackoverflow.com/questions/33906373,"np.partition(img.ravel(), 1)[1]",np.unique(img.ravel())[1],4.99,86.8
33913961,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/33913961,"df[""Year""].astype(str)","df[""Year""].map(str)",0.0822,0.132
33933687,answer,33928471,"python,arrays,python-3.x,numpy,vectorization",codeblock,https://stackoverflow.com/questions/33933687,"np.einsum('ijk,k->ij',f,ex)","f.reshape(-1,f.shape[2]).dot(ex).reshape(f.shape[:2])",3.84,4.8
33975750,answer,33961028,"python,pandas",codeblock,https://stackoverflow.com/questions/33975750,df_big[df_big.id.apply(lambda x: x.isnumeric())],"df_big[pd.to_numeric(df_big['id'], errors='coerce').notnull()]",15.3,29.9
33975750,answer,33961028,"python,pandas",codeblock,https://stackoverflow.com/questions/33975750,df_big[df_big.id.apply(lambda x: x.isnumeric())],df_big[df_big.id.str.isnumeric()],15.3,20.3
33975750,answer,33961028,"python,pandas",codeblock,https://stackoverflow.com/questions/33975750,df_big[df_big.id.str.isnumeric()],"df_big[pd.to_numeric(df_big['id'], errors='coerce').notnull()]",20.3,29.9
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.array([0,1,2,3,4,5,6]).astype(float)","np.array([0,1,2,3,4,5,6],dtype=float)",0.00621,0.00652
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter([0,1,2,3,4,5,6.],dtype=int)","np.fromiter([0,1,2,3,4,5,6.],dtype=float)",0.00335,0.00388
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter([0,1,2,3,4,5,6.],dtype=int)","np.array([0,1,2,3,4,5,6])",0.00335,0.00393
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter([0,1,2,3,4,5,6.],dtype=float)","np.array([0,1,2,3,4,5,6.])",0.00388,0.00451
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter([0,1,2,3,4,5,6.],dtype=float)","np.array([0,1,2,3,4,5,6])",0.00388,0.00393
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.array([0,1,2,3,4,5,6])","np.array([0,1,2,3,4,5,6.])",0.00393,0.00451
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter(range(1000),dtype=int).astype(float)","np.fromiter(range(1000),dtype=float)",0.106,0.189
34032455,answer,34031074,"python,arrays,numpy,generator,memory-efficient",codeblock,https://stackoverflow.com/questions/34032455,"np.fromiter([0,1,2,3,4,5,6.],dtype=int)","np.array([0,1,2,3,4,5,6.])",0.00335,0.00451
34081737,answer,34080979,"python,pandas",codeblock,https://stackoverflow.com/questions/34081737,[df.columns[row.astype(bool)].tolist() for row in df.values],[df.columns[row == 1].tolist() for row in df.values],0.186,0.212
34081737,answer,34080979,"python,pandas",codeblock,https://stackoverflow.com/questions/34081737,[df.columns[row.astype(bool)].tolist() for row in df.values],"[df.columns[df.ix[i,:]==1].tolist() for i in range(len(df.index))]",0.186,2.4
34081737,answer,34080979,"python,pandas",codeblock,https://stackoverflow.com/questions/34081737,[df.columns[row == 1].tolist() for row in df.values],"[df.columns[df.ix[i,:]==1].tolist() for i in range(len(df.index))]",0.212,2.4
34083317,answer,34082065,"python,pandas",codeblock,https://stackoverflow.com/questions/34083317,df.groupby(['id'])['purchased_item'].apply(list).values.tolist(),"[gr['purchased_item'].tolist() for n, gr in df.groupby('id')]",1.36,2.1
34097939,answer,19482970,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34097939,df.columns.values.tolist(),df.columns.tolist(),0.00297,0.00967
34116741,answer,34113608,"python,python-2.7,numpy,pandas,matrix-multiplication",codeblock,https://stackoverflow.com/questions/34116741,"np.dot(df1, df2)","np.matmul(df1, df2)",0.0637,0.0642
34125877,answer,34125366,"python,pandas",codeblock,https://stackoverflow.com/questions/34125877,"[(i, j) for i, j in df.val.iteritems()]","[(df.index[i], val) for i, val in enumerate(df['val'])]",0.692,18.9
34141767,answer,34141535,"python,numpy",codeblock,https://stackoverflow.com/questions/34141767,"arr.sum(1)-arr[:,i]","np.sum(arr[:,[j for j in xrange(3) if j != i]], axis=1)",0.0227,0.0291
34158400,answer,34158293,"python,pandas",codeblock,https://stackoverflow.com/questions/34158400,df1.combine_first(df2),df1.fillna(df2),2.15,2.76
34166097,answer,34166030,"python,pandas",codeblock,https://stackoverflow.com/questions/34166097,df.e.iat[-1],df.e.iloc[-1],0.018,0.024
34213728,answer,34213362,"python-3.x,pandas,row,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/34213728,df[df.applymap(lambda x: False if 'c' in str(x) else True)].dropna(),df[~df.apply(lambda series: series.str.contains('c')).any(axis=1)],43,60.7
34226816,answer,34226400,"python,numpy",codeblock,https://stackoverflow.com/questions/34226816,"idx1 = np.argpartition(x, 100)[:100]",idx0 = np.argsort(x)[:100],0.721,8.26
34232174,answer,34232091,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/34232174,xL.sum(),np.sum(xL),7.34,7.38
34238643,answer,34235452,"python,algorithm,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/34238643,"np.einsum('ij,kj',arr1,arr1)","np.dot(arr1, arr1.T)",9.12,17.8
34283406,answer,34283234,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34283406,df['detail1'] = 'file_' + df.index.map(str),df['detail']= 'file_' + df.index.astype(str),16.9,31.2
34297689,answer,13035764,"python,pandas",codeblock,https://stackoverflow.com/questions/34297689,df1[~df1.index.duplicated(keep='last')],df1.groupby(level=df1.index.names).last(),0.365,0.771
34297689,answer,13035764,"python,pandas",codeblock,https://stackoverflow.com/questions/34297689,df3.groupby(df3.index).first(),"df3.reset_index().drop_duplicates(subset='index', keep='first').set_index('index')",0.58,1.54
34297689,answer,13035764,"python,pandas",codeblock,https://stackoverflow.com/questions/34297689,df3[~df3.index.duplicated(keep='first')],"df3.reset_index().drop_duplicates(subset='index', keep='first').set_index('index')",0.307,1.54
34297689,answer,13035764,"python,pandas",codeblock,https://stackoverflow.com/questions/34297689,df3[~df3.index.duplicated(keep='first')],df3.groupby(df3.index).first(),0.307,0.58
34323537,answer,34319971,"python,pandas",sentence,"finally, apply(lambda x: F(x)) will be slightly slower than apply(F) due to the additional lambda function.",apply(F),apply(lambda x: F(x)),,
34372727,answer,34366618,"python,pandas",codeblock,https://stackoverflow.com/questions/34372727,df['using_datetime64'] = df['orig'].values.astype('datetime64[M]') + ONE_MONTH - ONE_DAY,df['using_rollforward'] = df['orig'].apply(lambda x: offsets.MonthEnd().rollforward(x)),0.913,813
34372727,answer,34366618,"python,pandas",codeblock,https://stackoverflow.com/questions/34372727,df['using_datetime64'] = df['orig'].values.astype('datetime64[M]') + ONE_MONTH - ONE_DAY,df['using_to_period'] = pd.Index(df['orig']).to_period('M').to_timestamp('M'),0.913,1.95
34372727,answer,34366618,"python,pandas",codeblock,https://stackoverflow.com/questions/34372727,df['using_to_period'] = pd.Index(df['orig']).to_period('M').to_timestamp('M'),df['using_rollforward'] = df['orig'].apply(lambda x: offsets.MonthEnd().rollforward(x)),1.95,813
34380584,answer,34380361,"python,pandas",codeblock,https://stackoverflow.com/questions/34380584,"df.groupby(['a','b']).count().to_dict()","df.groupby(['a','b']).size()",552,619
34380584,answer,34380361,"python,pandas",codeblock,https://stackoverflow.com/questions/34380584,"df.groupby(['a','b']).count().to_dict()","df.groupby(['a','b']).count()",552,588
34380584,answer,34380361,"python,pandas",codeblock,https://stackoverflow.com/questions/34380584,"df.groupby(['a','b']).count()","df.groupby(['a','b']).size()",588,619
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].idxmax(),s[s==True].last_valid_index(),0.127,0.261
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].idxmax(),(s[s==True].index.tolist()[-1]),0.127,0.239
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].idxmax(),(s[s==True].index[-1]),0.127,0.227
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,(s[s==True].index.tolist()[-1]),s[s==True].last_valid_index(),0.239,0.261
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,(s[s==True].index[-1]),s[s==True].last_valid_index(),0.227,0.261
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,(s[s==True].index[-1]),(s[s==True].index.tolist()[-1]),0.227,0.239
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].argmax(),(s[s==True].index[-1]),0.126,0.227
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s.index[s][-1],s[::-1].idxmax(),0.035,0.127
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s.index[s][-1],s[::-1].argmax(),0.035,0.126
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].argmax(),(s[s==True].index.tolist()[-1]),0.126,0.239
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].argmax(),s[s==True].last_valid_index(),0.126,0.261
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s[::-1].argmax(),s[::-1].idxmax(),0.126,0.127
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s.index[s][-1],(s[s==True].index[-1]),0.035,0.227
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s.index[s][-1],(s[s==True].index.tolist()[-1]),0.035,0.239
34385309,answer,34384349,"python,pandas",codeblock,https://stackoverflow.com/questions/34385309,s.index[s][-1],s[s==True].last_valid_index(),0.035,0.261
34480416,answer,34480328,"python,list,numpy,vector",codeblock,https://stackoverflow.com/questions/34480416,np.add.reduce(L),"np.sum(L, axis=0)",0.0157,0.0207
34480416,answer,34480328,"python,list,numpy,vector",codeblock,https://stackoverflow.com/questions/34480416,"np.sum(L, axis=0)",np.add.reduce(L),41.5,41.9
34529731,answer,34529417,"python,pandas,timedelta",codeblock,https://stackoverflow.com/questions/34529731,"np.asarray(np.round(df['B'].values / np.timedelta64(1, 's')), dtype='timedelta64[s]')","pd.to_timedelta(df['B'].dt.total_seconds().round(), unit='s')",0.0277,3.94
34529731,answer,34529417,"python,pandas,timedelta",codeblock,https://stackoverflow.com/questions/34529731,df['A'] - df['A'].values.astype('timedelta64[D]'),"df['A'] - pd.to_timedelta(df['A'].dt.days, unit='d')",0.729,12.6
34549867,answer,34548681,"python,numpy,pandas,vectorization,numerical-integration",codeblock,https://stackoverflow.com/questions/34549867,"np.trapz(forces, x=forces.index, axis=0)","forces.apply(np.trapz, axis=0, args=(forces.index,))",0.0534,0.582
34583934,answer,34583539,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/34583934,A + B[np.zeros(A.shape[0])],"u = sparse.csr_matrix(np.ones((A.shape[0], 1), dtype=B.dtype)); Bp = u * B; A + Bp",280,284
34595662,answer,34595601,"python,pandas",codeblock,https://stackoverflow.com/questions/34595662,(A.gt(B)).astype(int),(A > B).astype(int),0.901,0.908
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].count(axis=1),"df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",2.98,3.28
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df.drop(['Close', 'Time'], axis=1).count(axis=1)","df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",2.76,3.28
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df.drop(['Close', 'Time'], axis=1).count(axis=1)",df[list('abcde')].count(axis=1),2.76,2.98
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].notnull().sum(axis=1),"df.drop(['Close', 'Time'], axis=1).count(axis=1)",1.05,1.14
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)",df[list('abcde')].count(axis=1),1.11,1.11
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)","df.drop(['Close', 'Time'], axis=1).count(axis=1)",1.11,1.14
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].count(axis=1),"df.drop(['Close', 'Time'], axis=1).count(axis=1)",1.11,1.14
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].notnull().sum(axis=1),"df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",1.05,1.4
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)","df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",1.11,1.4
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].count(axis=1),"df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",1.11,1.4
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df.drop(['Close', 'Time'], axis=1).count(axis=1)","df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",1.14,1.4
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df.drop(['Close', 'Time'], axis=1).count(axis=1)","df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",2.7,3.33
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].notnull().sum(axis=1),df[list('abcde')].count(axis=1),1.05,1.11
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].notnull().sum(axis=1),"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)",1.05,1.11
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].count(axis=1),"df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",2.7,3.33
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)","df[['a', 'b', 'c', 'd', 'e']].apply(lambda x: sum(x.notnull()), axis=1)",2.57,3.33
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,df[list('abcde')].count(axis=1),"df.drop(['Close', 'Time'], axis=1).count(axis=1)",2.7,2.7
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)","df.drop(['Close', 'Time'], axis=1).count(axis=1)",2.57,2.7
34622748,answer,34622715,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/34622748,"df[['a', 'b', 'c', 'd', 'e']].count(axis=1)",df[list('abcde')].count(axis=1),2.57,2.7
34631718,answer,34625318,"python,pandas",codeblock,https://stackoverflow.com/questions/34631718,"df.groupby(['x1', 'x2'])['x3'].agg( {'my_sum':np.sum, 'my_mean':np.mean}).reset_index()","df.groupby(['x1', 'x2'], as_index=False)['x3'].agg({'my_sum':np.sum, 'my_mean':np.mean})",2.82,3.18
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in very_long_coords]),"np.array([np.fromstring(i, dtype=int, sep=' ') for j in very_long_coords for i in j])",73.5,125
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in very_long_coords]),"np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in very_long_coords])",73.5,140
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,"np.array([np.fromstring(i, dtype=int, sep=' ') for j in very_long_coords for i in j])","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in very_long_coords])",125,140
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in long_coords]),"np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in long_coords])",7.54,14.2
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in long_coords]),"np.array([np.fromstring(i, dtype=int, sep=' ') for j in long_coords for i in j])",7.54,12.2
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,"np.array([np.fromstring(i, dtype=int, sep=' ') for j in long_coords for i in j])","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in long_coords])",12.2,14.2
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in coordinates]),"np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in coordinates])",0.0121,0.019
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in coordinates]),"np.array([np.fromstring(i, dtype=int, sep=' ') for j in coordinates for i in j])",0.0121,0.0184
34650619,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650619,"np.array([np.fromstring(i, dtype=int, sep=' ') for j in coordinates for i in j])","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in coordinates])",0.0184,0.019
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(very_long_coords, "" ""), dtype=int,sep="" "").reshape(len(very_long_coords),-1)","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in very_long_coords])",27.2,103
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in very_long_coords]),"np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in very_long_coords])",71,103
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(very_long_coords, "" ""), dtype=int,sep="" "").reshape(len(very_long_coords),-1)","np.array([np.fromstring(i, dtype=int, sep=' ') for j in very_long_coords for i in j])",27.2,80.7
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in very_long_coords]),"np.array([np.fromstring(i, dtype=int, sep=' ') for j in very_long_coords for i in j])",71,80.7
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(very_long_coords, "" ""), dtype=int,sep="" "").reshape(len(very_long_coords),-1)",np.array([[int(x)  for x in coordinate[0].split()] for coordinate in very_long_coords]),27.2,71
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.array([np.fromstring(i, dtype=int, sep=' ') for j in very_long_coords for i in j])","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in very_long_coords])",80.7,103
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(long_coords, "" ""), dtype=int,sep="" "").reshape(len(long_coords),-1)",np.array([[int(x)  for x in coordinate[0].split()] for coordinate in long_coords]),2.73,6.84
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(long_coords, "" ""), dtype=int,sep="" "").reshape(len(long_coords),-1)","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in long_coords])",2.73,9.52
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in long_coords]),"np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in long_coords])",6.84,9.52
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.fromstring(np.core.defchararray.add(long_coords, "" ""), dtype=int,sep="" "").reshape(len(long_coords),-1)","np.array([np.fromstring(i, dtype=int, sep=' ') for j in long_coords for i in j])",2.73,7.27
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,np.array([[int(x)  for x in coordinate[0].split()] for coordinate in long_coords]),"np.array([np.fromstring(i, dtype=int, sep=' ') for j in long_coords for i in j])",6.84,7.27
34650658,answer,34650361,"python,arrays,list,numpy,split",codeblock,https://stackoverflow.com/questions/34650658,"np.array([np.fromstring(i, dtype=int, sep=' ') for j in long_coords for i in j])","np.array([np.fromstring(item[0], dtype=int, sep=' ').tolist() for item in long_coords])",7.27,9.52
34679258,answer,34677862,"python,pandas",codeblock,https://stackoverflow.com/questions/34679258,"pd.concat((df, pd.DataFrame(df.columns[np.argsort(df.values, axis=1)[:, -3:][:, ::-1]], columns=['First', 'Second', 'Third'])), axis=1)","df.apply(lambda x: pd.Series(x.sort_values(ascending=False).index[:3]), axis=1)",4.14,9470
34679258,answer,34677862,"python,pandas",codeblock,https://stackoverflow.com/questions/34679258,"pd.concat((df, pd.DataFrame(df.columns[np.argsort(df.values, axis=1)[:, -3:][:, ::-1]], columns=['First', 'Second', 'Third'])), axis=1)","df.apply(lambda x: pd.Series(x.sort_values(ascending=False).index[:3]), axis=1)",1.33,3.55
34738077,answer,34738076,"python,arrays,numpy,scipy,distance",codeblock,https://stackoverflow.com/questions/34738077,"costheta = np.einsum('ij,kj->ik', x, y)","costheta = 1 - dist.cdist(x, y, 'cosine')",61.3,124
34738077,answer,34738076,"python,arrays,numpy,scipy,distance",sentence,in this case i find that np.einsum is much faster than dist.cdist.,np.einsum,dist.cdist,,
34738129,answer,34738010,"python,arrays,list,numpy",codeblock,https://stackoverflow.com/questions/34738129,np.concatenate(l),np.hstack(l),0.00412,0.0133
34760285,answer,34756004,"python,pandas",codeblock,https://stackoverflow.com/questions/34760285,df1.y.iat[0],df1.y.iloc[0],0.0188,0.0246
34760285,answer,34756004,"python,pandas",codeblock,https://stackoverflow.com/questions/34760285,df1.y.iloc[0],df1.y.ix[0],0.0246,0.0302
34760285,answer,34756004,"python,pandas",codeblock,https://stackoverflow.com/questions/34760285,df1.y.iat[0],df1.y.ix[0],0.0188,0.0302
34770968,answer,34770389,"python,sorting,numpy,matrix",codeblock,https://stackoverflow.com/questions/34770968,X[np.lexsort(X.T[::-1])],"np.matrix(sorted(map(tuple, X.A)))",1.22,2.23
34779601,answer,34775117,"python,multithreading,performance,numpy",codeblock,https://stackoverflow.com/questions/34779601,"y = np.random.randn(n1, n2)





ne.evaluate('x + y')","y = np.random.randn(n1, n2)





x + y",83.6,245
34790377,answer,34790241,"pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/34790377,df.groupby('Clusters')['order_id'].apply(lambda x: x.tolist()),"df.pivot_table(index='Clusters', aggfunc=pd.Series.tolist)",0.751,3.55
34805142,answer,34803841,"pandas,series",codeblock,https://stackoverflow.com/questions/34805142,s - 6*(s.index != a.iloc[0]),s - 6 * ~s.index.isin(a),0.144,0.166
34863702,answer,34862336,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/34863702,df['id'].map(str.strip),df['id'].astype(str).map(str.strip),5.18,10.5
34888933,answer,34885612,"python,performance,numpy,cython",codeblock,https://stackoverflow.com/questions/34888933,"np.unravel_index(np.where(data.ravel()==10),data.shape)",np.where(data==10),26,105
34896797,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34896797,df[df.columns[1:]].corr()['special_col'],df[df.columns[1:-1]].apply(lambda x: x.corr(df['special_col'])),0.836,1.75
34896835,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34896835,np.corrcoef(data[data.columns[1:]].T)[-1][:-1],data[data.columns[1:]].corr()['special_col'],0.437,0.526
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,"df.corr().iloc[-1,:-1]","df.corr().ix['special_col', :-1]",0.576,0.634
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,df[df.columns[1:]].corr()['special_col'],df[df.columns[1:-1]].apply(lambda x: x.corr(df['special_col'])),0.968,2.12
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,"df.corr().ix['special_col', :-1]",df[df.columns[1:-1]].apply(lambda x: x.corr(df['special_col'])),0.634,2.12
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,"df.corr().ix['special_col', :-1]",df[df.columns[1:]].corr()['special_col'],0.634,0.968
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,"df.corr().iloc[-1,:-1]",df[df.columns[1:-1]].apply(lambda x: x.corr(df['special_col'])),0.576,2.12
34897294,answer,34896455,"python,pandas",codeblock,https://stackoverflow.com/questions/34897294,"df.corr().iloc[-1,:-1]",df[df.columns[1:]].corr()['special_col'],0.576,0.968
34931289,answer,34926898,"python,numpy,pandas,scipy,correlation",codeblock,https://stackoverflow.com/questions/34931289,"np.corrcoef(VALUE[:,0,0],VALUE[:,0,1])",DFexample[0].corr(DFexample[1]),0.556,1.09
34933969,answer,34933105,"performance,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/34933969,"np.twod=np.zeros((10000,2), np.double)","np_homo = np.zeros(10000, dtype=[('a', np.double), ('b', np.double)])",0.0367,0.0383
35069163,answer,35068722,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/35069163,"np.where(df['B'] < 3, df['A'], 0)","df['A'].where(df['B'] < 3,0)",0.407,1.4
35088841,answer,35087665,"python,pandas",codeblock,https://stackoverflow.com/questions/35088841,"pd.DataFrame([ x.split(',') for x in s ]).stack()","s.str.split(',').apply(pd.Series).stack()",0.866,2.46
35108249,answer,35108199,"python,pandas,find,dataframe",codeblock,https://stackoverflow.com/questions/35108249,"df1.loc[(900000498,900022133), 'Proximity']","df.loc[(df['ID1']==900000498)&(df['ID2']==900022133), 'Proximity']",0.565,1.69
35108263,answer,35108108,"python,pandas,dataframe,indexing",sentence,i am iterating through all the rows of the dataframe using .itertuples() which is faster than .iterrows() and looking for the desired entry/value.,.itertuples(),.iterrows(),,
35123632,answer,35123219,"python,pandas,multi-index",codeblock,https://stackoverflow.com/questions/35123632,"df[~df.index.isin([('A','a')])]","df.drop(('A','a'))",0.457,1.33
35162508,answer,35161916,"arrays,numpy,multidimensional-array,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/35162508,"A.T*(np.tri(A.shape[1],dtype=bool).T[...,None])","np.dstack(map(np.triu, A))",24.8,69.9
35212485,answer,35212271,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/35212485,z1.sum(),y1.sum(),0.464,0.975
35244864,answer,35244321,"python,arrays,numpy,scalar",sentence,using np.broadcast is faster than np.broadcast_arrays:,np.broadcast,np.broadcast_arrays,,
35244864,answer,35244321,"python,arrays,numpy,scalar",codeblock,https://stackoverflow.com/questions/35244864,"np.column_stack(np.broadcast(*[x, 0, x]*10))","np.row_stack(np.broadcast_arrays(*[x, 0, x]*10))",0.0464,0.38
35268805,answer,27817718,"python,pandas,dataframe,reverse",codeblock,https://stackoverflow.com/questions/35268805,"football.ix[::,::-1]","football.ix[::,football.columns[::-1]]",0.255,0.491
35284122,answer,35282214,"python,numpy,matrix-multiplication,blas",codeblock,https://stackoverflow.com/questions/35284122,"v=np.zeros((100,));v[::60]=1;np.dot(A,v)","v=np.zeros((100,));v[::60]=1;dot2(A,v)",0.0292,0.0354
35284122,answer,35282214,"python,numpy,matrix-multiplication,blas",codeblock,https://stackoverflow.com/questions/35284122,"v=np.zeros((100,));v[::20]=1;np.dot(A,v)","v=np.zeros((100,));v[::20]=1;dot2(A,v)",0.0287,0.0465
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index(drop=True, level=1).reset_index().rename(columns={0:'col_B'})","df['col_B'].apply(pd.Series).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})",3.09,357
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index(drop=True, level=1).reset_index().rename(columns={0:'col_B'})","pd.DataFrame([{'col_A':row['col_A'], 'col_B':val} for ind, row in df.iterrows() for val in row['col_B']])",3.09,153
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})","df['col_B'].apply(pd.Series).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})",4.01,357
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})","pd.DataFrame([{'col_A':row['col_A'], 'col_B':val} for ind, row in df.iterrows() for val in row['col_B']])",4.01,153
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index(drop=True, level=1).reset_index().rename(columns={0:'col_B'})","pd.DataFrame(x for x in df['col_B']).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})",3.09,4.01
35287398,answer,35283198,"python,pandas",codeblock,https://stackoverflow.com/questions/35287398,"pd.DataFrame([{'col_A':row['col_A'], 'col_B':val} for ind, row in df.iterrows() for val in row['col_B']])","df['col_B'].apply(pd.Series).set_index(df['col_A']).stack().reset_index().drop('level_1', axis=1).rename(columns={0:'col_B'})",153,357
35301340,answer,35301262,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/35301340,"np.argwhere(np.einsum('ijk->ij',image>threshold))",np.argwhere((image > threshold).any(-1)),3.69,5.47
35301340,answer,35301262,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/35301340,"np.argwhere(np.einsum('ijk->ij',image>threshold))",np.argwhere((image > threshold).any(-1)),640,833
35301340,answer,35301262,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/35301340,"np.argwhere(np.einsum('ijk->ij',image>threshold))",np.argwhere((image > threshold).any(-1)),0.0565,0.0792
35317894,answer,35317706,"python,arrays,numpy,concatenation,slice",codeblock,https://stackoverflow.com/questions/35317894,"c = np.concatenate([a,b], axis=1)","c = np.hstack([a,b])",66.4,67.3
35369582,answer,35368956,"python,numpy",codeblock,https://stackoverflow.com/questions/35369582,"np.array([line.split() for line in txt[4:6]],dtype=float)","np.loadtxt(txt[4:6],dtype=float)",0.013,0.0714
35371985,answer,35371499,"python,numpy,vectorization,mathematical-expressions",codeblock,https://stackoverflow.com/questions/35371985,"sum(power(1.1, 10))","sum(powervector(1.1, 10))",0.00113,0.00352
35371985,answer,35371499,"python,numpy,vectorization,mathematical-expressions",codeblock,https://stackoverflow.com/questions/35371985,"sum(powernumba(1.1, 100))","sum(power(1.1, 100))",0.00264,0.00767
35401020,answer,35400793,"python,numpy",codeblock,https://stackoverflow.com/questions/35401020,"abs(mat[1:,:] - mat[:-1,:])","abs(np.diff(mat, axis=0))",1287.8,3239.27
35439943,answer,35430479,"python,numpy,scipy,sympy",codeblock,https://stackoverflow.com/questions/35439943,"sol = odeint(lambdified_odes, init, t, args=((k1, k2),))","sol = odeint(my_odes, init, t, args=((k1, k2),))",0.61,239
35447656,answer,35447487,"python,pandas,series",codeblock,https://stackoverflow.com/questions/35447656,transaction.reindex(profile.index).fillna(0),transaction.loc[profile.index].fillna(0),0.224,0.329
35484334,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484334,df.groupby('fruit').cumcount() + 1,"[(df.fruit[0:i+1] == x).sum() for i, x in df.fruit.iteritems()]",0.926,3.76
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit')['fruit'].cumcount() + 1,"[(df.fruit[0:i+1] == x).sum() for i, x in df.fruit.iteritems()]",0.845,5120
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit').cumcount() + 1,"[(df.fruit[0:i+1] == x).sum() for i, x in df.fruit.iteritems()]",1.59,5120
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit')['fruit'].cumcount() + 1,df.groupby('fruit').cumcount() + 1,0.845,1.59
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit').cumcount() + 1,"[(df.fruit[0:i+1] == x).sum() for i, x in df.fruit.iteritems()]",0.921,2.72
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit')['fruit'].cumcount() + 1,"[(df.fruit[0:i+1] == x).sum() for i, x in df.fruit.iteritems()]",0.299,2.72
35484390,answer,35484250,"python,pandas",codeblock,https://stackoverflow.com/questions/35484390,df.groupby('fruit')['fruit'].cumcount() + 1,df.groupby('fruit').cumcount() + 1,0.299,0.921
35491399,answer,35491274,"python,pandas",codeblock,https://stackoverflow.com/questions/35491399,"pd.DataFrame(df2['teams'].values.tolist(), columns=['team1','team2'])",df2['teams'].apply(pd.Series),0.82,1150
35498497,answer,35498313,"python,pandas,group-by,apply",codeblock,https://stackoverflow.com/questions/35498497,df2['output'] / df2.groupby('a_id')['output'].transform('count'),"(df2.groupby('a_id')['output'].apply(lambda x: x / len(x) ).reset_index(level='a_id', drop=True))",0.449,1.73
35581981,answer,35581733,"python,pandas,notnull",codeblock,https://stackoverflow.com/questions/35581981,df.loc[df.index.difference(df.dropna(how='all').index)],"df[df.apply(lambda x: x.isnull().all(), axis=1)]",8.95,2820
35600418,answer,35600064,"python,pandas,python-3.4",codeblock,https://stackoverflow.com/questions/35600418,pd.DataFrame([x for x in flagInfoSeries]),pd.DataFrame(flagInfoSeries.to_dict()).T,0.361,0.554
35600418,answer,35600064,"python,pandas,python-3.4",codeblock,https://stackoverflow.com/questions/35600418,pd.DataFrame(flagInfoSeries.to_dict()).T,flagInfoSeries.apply(lambda dict: pd.Series(dict)),0.554,0.751
35600418,answer,35600064,"python,pandas,python-3.4",codeblock,https://stackoverflow.com/questions/35600418,pd.DataFrame([x for x in flagInfoSeries]),flagInfoSeries.apply(lambda dict: pd.Series(dict)),0.361,0.751
35603730,answer,35602484,numpy,codeblock,https://stackoverflow.com/questions/35603730,"(c == (np.arange(12)[:,None,None])).sum(-1).T","(c[...,None] == np.arange(12)).sum(1)",232,423
35607226,answer,35603340,"python,arrays,string,numpy,numbers",codeblock,https://stackoverflow.com/questions/35607226,_ = ar.view(np.uint8) - ord('0'),_ = ar.view('S1').astype(np.uint8),1.07,284
35624868,answer,2828059,"python,arrays,sorting,numpy,scipy",codeblock,https://stackoverflow.com/questions/35624868,"table[table[:,9].argsort()]","table.view('f8,f8,f8,f8,f8,f8,f8,f8,f8,f8').sort(order=['f9'], axis=0)",0.18,1.88
35630179,answer,35630098,"python,datetime,pandas,epoch",codeblock,https://stackoverflow.com/questions/35630179,df['date'].astype('int64')//1e9,"(df['date'] - dt.datetime(1970,1,1)).dt.total_seconds()",0.275,1.72
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"df.eq(df.max(axis=1), axis=0).astype(int)","(df.rank(method='max', axis=1) == df.rank(method='max', axis=1).max().max()).astype(int)",0.456,1.32
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"df.eq(df.max(axis=1), axis=0).astype(int)","df.apply(lambda x: x == x.max(), axis='columns').astype(int)",0.456,496
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"(df.rank(method='max', axis=1) == df.rank(method='max', axis=1).max().max()).astype(int)","df.apply(lambda x: x == x.max(), axis='columns').astype(int)",1.32,496
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"(df.rank(method='max', axis=1) == df.rank(method='max', axis=1).max().max()).astype(int)","df.apply(lambda x: x == x.max(), axis='columns').astype(int)",0.656,1.44
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"df.eq(df.max(axis=1), axis=0).astype(int)","(df.rank(method='max', axis=1) == df.rank(method='max', axis=1).max().max()).astype(int)",0.334,0.656
35630591,answer,35630348,"python,pandas,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/35630591,"df.eq(df.max(axis=1), axis=0).astype(int)","df.apply(lambda x: x == x.max(), axis='columns').astype(int)",0.334,1.44
35644973,answer,35644847,"python,numpy,slice,comma,notation",codeblock,https://stackoverflow.com/questions/35644973,"x[0, 0]",x[0][0],0.000148,0.000357
35711180,answer,35711059,"python,pandas",codeblock,https://stackoverflow.com/questions/35711180,pd.DataFrame([x for x in df['dic']]),df.dic.apply(pn.Series),3.16,748
35711180,answer,35711059,"python,pandas",codeblock,https://stackoverflow.com/questions/35711180,pd.DataFrame([x for x in df['dic']]),df.dic.apply(pn.Series),0.596,1.43
35719451,answer,35718653,"python,pandas,merge,concat",codeblock,https://stackoverflow.com/questions/35719451,"pd.concat([df1, df2[~df2.id_col.isin(df1.id_col)]])","pd.concat((df1, df2)).drop_duplicates('id_col')",1.79,1.95
35723879,answer,35722815,"python,arrays,numpy,pandas",codeblock,https://stackoverflow.com/questions/35723879,"np.take(mean_colors,Y,axis=0)",mean_colors[Y],0.0637,0.28
35724117,answer,35723759,"python,pandas",codeblock,https://stackoverflow.com/questions/35724117,"df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].nunique().groupby(level=0).max().reset_index(name='MaxCallsOneDay')","df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].unique().apply(lambda x: len(x)).groupby(level=0).nlargest(1).reset_index(level=1, drop=True).reset_index()",3.52,8.58
35724117,answer,35723759,"python,pandas",codeblock,https://stackoverflow.com/questions/35724117,"df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].nunique().groupby(level=0).max().reset_index(name='MaxCallsOneDay')","df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].nunique().groupby(level=0).nlargest(1).reset_index(level=1, drop=True).reset_index()",3.52,7.07
35724117,answer,35723759,"python,pandas",codeblock,https://stackoverflow.com/questions/35724117,"df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].nunique().groupby(level=0).nlargest(1).reset_index(level=1, drop=True).reset_index()","df.groupby(['Caller',pd.DatetimeIndex(df['Date']).normalize()])['Called'].unique().apply(lambda x: len(x)).groupby(level=0).nlargest(1).reset_index(level=1, drop=True).reset_index()",7.07,8.58
35785302,answer,35785109,"python,multithreading,pandas,parallel-processing,multiprocessing",codeblock,https://stackoverflow.com/questions/35785302,result2 = left2.join(right2),"result = pd.merge(left, right, on='key')",0.361,1.01
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,"pd.concat([df1.set_index('id'), df2.groupby('id')['secs'].sum()], axis=1).reset_index()","pd.merge(df1, df2.groupby('id')['secs'].sum().reset_index(), on=['id'])",2.73,3.44
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,"pd.concat([df1.set_index('id'), df2.groupby('id')['secs'].sum()], axis=1).reset_index()","pd.merge(df1, df2.groupby('id', as_index=False)['secs'].sum(), on=['id'])",2.73,3.73
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,df1.set_index('id').join(df2.groupby('id')['secs'].sum()).reset_index(),"pd.merge(df1, df2.groupby('id', as_index=False)['secs'].sum(), on=['id'])",2.88,3.73
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,df1.set_index('id').join(df2.groupby('id')['secs'].sum()).reset_index(),"pd.merge(df1, df2.groupby('id')['secs'].sum().reset_index(), on=['id'])",2.88,3.44
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,"pd.merge(df1, df2.groupby('id')['secs'].sum().reset_index(), on=['id'])","pd.merge(df1, df2.groupby('id', as_index=False)['secs'].sum(), on=['id'])",3.44,3.73
35795585,answer,35795496,"python,pandas,sum,dataframe",codeblock,https://stackoverflow.com/questions/35795585,"pd.concat([df1.set_index('id'), df2.groupby('id')['secs'].sum()], axis=1).reset_index()",df1.set_index('id').join(df2.groupby('id')['secs'].sum()).reset_index(),2.73,2.88
35796730,answer,35795663,"python,algorithm,numpy,math,scipy",codeblock,https://stackoverflow.com/questions/35796730,c=b.copy();c[0]=-(p/p[0])[1:];eig(c),roots(p),0.181,0.365
35806471,answer,35806120,"python,pandas",codeblock,https://stackoverflow.com/questions/35806471,df.groupby('A')['D'].sum(),"pd.pivot_table(df, values='D', index=['A'], aggfunc=np.sum)",0.581,2.28
35870806,answer,35869175,"python,arrays,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/35870806,"df.pivot(index='user', columns='item', values='rating')","df.pivot_table(index='user', columns='item', values='rating')",6.38,18.6
35959822,answer,35959675,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/35959822,df[end:],df[(df.index >= end ) & (df.index <= start)],0.12,1.75
36003802,answer,36003322,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/36003802,"np.sqrt(np.einsum('ij,ij->i',a,a))","np.sum(a**2, axis=1)**.5",1.52,7.57
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,df.loc[df.groupby('id')['rank'].idxmin()],df.sort_values('rank').groupby('id').first().reset_index(),1.52,2.26
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,df.loc[df.groupby('id')['rank'].idxmin()],"df.loc[df.groupby('id')['rank'].idxmin(),:]",1.52,1.67
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,"df.loc[df.groupby('id')['rank'].idxmin(),:]",df.sort_values('rank').groupby('id').first().reset_index(),2.24,3.55
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,df.loc[df.groupby('id')['rank'].idxmin()],df.sort_values('rank').groupby('id').first().reset_index(),2.12,3.55
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,df.loc[df.groupby('id')['rank'].idxmin()],"df.loc[df.groupby('id')['rank'].idxmin(),:]",2.12,2.24
36019979,answer,36019856,"python,pandas",codeblock,https://stackoverflow.com/questions/36019979,"df.loc[df.groupby('id')['rank'].idxmin(),:]",df.sort_values('rank').groupby('id').first().reset_index(),1.67,2.26
36031086,answer,36030963,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/36031086,"np.tensordot(arr,w,axes=([2],[0]))","np.einsum('ijk,k->ij',arr,w)",8.75,9.78
36031086,answer,36030963,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/36031086,"np.tensordot(arr,w,axes=([2],[0]))","np.matmul(arr, w)",8.75,9.72
36031086,answer,36030963,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/36031086,"np.matmul(arr, w)","np.einsum('ijk,k->ij',arr,w)",9.72,9.78
36031788,answer,36031749,"python,pandas",codeblock,https://stackoverflow.com/questions/36031788,np.sqrt(df['A']),df['A'].apply(math.sqrt),0.0997,2.15
36041464,answer,36041277,"python,pandas",codeblock,https://stackoverflow.com/questions/36041464,df['B'].iat[2],df['B'].iloc[2],0.00728,0.0115
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,(a == 1).sum(),np.sum(a == 1),0.18,0.196
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,"np.in1d(a,1).sum()",np.sum(a == 1),0.0485,0.273
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,"np.in1d(a,1).sum()",(a == 1).sum(),0.0485,0.271
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,(a == 1).sum(),np.sum(a == 1),0.271,0.273
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,"np.in1d(a,1).sum()",(a == 1).sum(),0.0299,0.18
36067931,answer,36067894,"python,pandas",codeblock,https://stackoverflow.com/questions/36067931,"np.in1d(a,1).sum()",np.sum(a == 1),0.0299,0.196
36072267,answer,36072042,"python,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/36072267,"np.tensordot(X, tensor, axes=([1], [0]))","np.tensordot(X, tensor, axes=1)",14.7,15.2
36079824,answer,36076303,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36079824,df.groupby('StoreID').ProductID.transform(lambda x: x.rank()/len(x)),df.groupby('StoreID').ProductID.apply(lambda x: x.rank()/len(x)),1.3,2.26
36082588,answer,21606987,pandas,codeblock,https://stackoverflow.com/questions/36082588,df.columns.str.strip(),df.rename(columns=lambda x: x.strip()),0.143,0.293
36118547,answer,36118413,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/36118547,s.nsmallest(2),s.sort_values()[:2],2.5,12.4
36118547,answer,36118413,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/36118547,s.sort_values()[:2],s.nsmallest(2),0.349,0.37
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"pd.DataFrame(df.values * s.values[:,None])","df.mul(s, axis=0)",0.164,0.197
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"pd.DataFrame(df.values * s.values[:,None])","df.mul(s, axis=0).values",0.164,0.21
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"df.values * s.values[:,None]","pd.DataFrame(df.values * s.values[:,None])",0.0164,0.164
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"df.values * s.values[:,None]","df.mul(s, axis=0).values",0.0164,0.21
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"df.values * s.values[:,None]","df.mul(s, axis=0)",0.0164,0.197
36125553,answer,36125425,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36125553,"df.mul(s, axis=0)","df.mul(s, axis=0).values",0.197,0.21
36133042,answer,36132973,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36133042,"df.loc[(df.y == 'wo'), 'y'] = df.x","df.y.replace(""wo"",df.x)",3.31,13.9
36133042,answer,36132973,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36133042,"df.ix[(df.y == 'wo'), 'y'] = df.x","df.y.replace(""wo"",df.x)",3.31,13.9
36133042,answer,36132973,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36133042,"df.ix[(df.y == 'wo'), 'y'] = df.x","df.loc[(df.y == 'wo'), 'y'] = df.x",3.31,3.31
36147148,answer,36144028,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/36147148,"np.array([lol(tmp[:,i],2) for i in range(tmp.shape[1])])","np.apply_along_axis(lol,0,tmp,2)",0.0641,0.132
36147148,answer,36144028,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/36147148,"np.apply_along_axis(lol,1,tmp,2)","np.apply_along_axis(lambda x,y:lol(x,y),1,tmp,2)",0.103,0.105
36150420,answer,36150339,"python,arrays,performance,numpy,multiplication",codeblock,https://stackoverflow.com/questions/36150420,"np.tensordot(t,I, axes=([0],[0]))","np.einsum('i,ijk->jk',t,I)",110,201
36156022,answer,36155942,"python,pandas",codeblock,https://stackoverflow.com/questions/36156022,df.lt(0).sum().sum(),sum(n < 0 for n in df.values.flatten()),2.36,405
36156022,answer,36155942,"python,pandas",codeblock,https://stackoverflow.com/questions/36156022,np.sum((df < 0).values.ravel()),sum(n < 0 for n in df.values.flatten()),0.77,405
36156022,answer,36155942,"python,pandas",codeblock,https://stackoverflow.com/questions/36156022,np.sum((df < 0).values.ravel()),df.lt(0).sum().sum(),0.77,2.36
36188175,answer,36187607,"python,pandas",codeblock,https://stackoverflow.com/questions/36188175,df.ix[(df.b) & (df.index < idx19)].tail(5),df.ix[(df.b) & (df.index < df[df.a == 19].index[0])].tail(5),0.564,0.973
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.any(np.in1d(a1, a2))",pd.Series(a1).isin(a2).any(),0.0271,0.135
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,any(i in a1 for i in a2),pd.Series(a1).isin(a2).any(),0.00188,0.135
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.intersect1d(a1, a2)",pd.Series(a1).isin(a2).any(),0.0156,0.135
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.intersect1d(a1, a2)","np.any(np.in1d(a1, a2))",0.0156,0.0271
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,any(i in a1 for i in a2),"np.any(np.in1d(a1, a2))",0.00188,0.0271
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,any(i in a1 for i in a2),"np.intersect1d(a1, a2)",0.00188,0.0156
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.intersect1d(a3, a4)","np.any(np.in1d(a3, a4))",13.8,18.4
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.intersect1d(a3, a4)",any(i in a3 for i in a4),13.8,34500
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,pd.Series(a3).isin(a4).any(),"np.any(np.in1d(a3, a4))",18.3,18.4
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,pd.Series(a3).isin(a4).any(),any(i in a3 for i in a4),18.3,34500
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.any(np.in1d(a3, a4))",any(i in a3 for i in a4),18.4,34500
36190611,answer,36190533,"python,numpy",codeblock,https://stackoverflow.com/questions/36190611,"np.intersect1d(a3, a4)",pd.Series(a3).isin(a4).any(),13.8,18.3
36199786,answer,36199719,"python,pandas",codeblock,https://stackoverflow.com/questions/36199786,"np.where(df['_merge'] == 'both', 'yes', 'no')","np.where(np.in1d(df['_merge'],'both'), 'yes', 'no')",0.652,2.22
36205467,answer,36198118,"python,numpy",codeblock,https://stackoverflow.com/questions/36205467,np.array([i is np.nan for i in xb]),isnan(xb),0.393,1.03
36232400,answer,36231926,"python,arrays,numpy,multidimensional-array,replace",sentence,so bincount method is 14 times faster than unique method.,bincount,unique,,
36252898,answer,36252814,"python,numpy",codeblock,https://stackoverflow.com/questions/36252898,array([x if type(x) is ndarray else [x]*100 for x in l]),column_stack(broadcast(*l)),0.655,3.77
36267227,answer,36263552,"python,numpy",codeblock,https://stackoverflow.com/questions/36267227,"x[np.argsort(x[:,0]),:]","np.sort(x.view('f8,f8'),order=['f0'],axis=0).view('f8')",0.0132,0.0685
36274775,answer,36274447,"python,numpy,pandas,scipy,mean",codeblock,https://stackoverflow.com/questions/36274775,pd.Series(x).rolling(window=2).mean(),"pd.rolling_mean(x, window=2)",0.226,0.24
36297194,answer,36296450,"python,numpy,matplotlib",sentence,"in some other so questions i found that frompyfunc is faster than vectorize, and a modest improvement over direct iteration.",frompyfunc,vectorize,,
36318797,answer,36318618,"python,numpy",codeblock,https://stackoverflow.com/questions/36318797,"(a[:,None]<b).sum(axis=0)","np.searchsorted(a, b, 'right',sorter=a.argsort())",0.089,0.141
36318797,answer,36318618,"python,numpy",codeblock,https://stackoverflow.com/questions/36318797,"np.searchsorted(a, b, 'right',sorter=a.argsort())","(a[:,None]<b).sum(axis=0)",0.172,1.44
36318797,answer,36318618,"python,numpy",codeblock,https://stackoverflow.com/questions/36318797,"(a[:,None]<b).sum(axis=0)","np.searchsorted(a, b, 'right',sorter=a.argsort())",78.2,448
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: pd.Series({'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}))","grp.apply(lambda g: {'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}).apply(pd.Series)",265,273
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: {'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}).apply(pd.Series)","pd.concat([grp.apply(lambda g: g.e.count()), grp.apply(lambda g: (g.b * g.c).sum() / g.c.sum()), grp.apply(lambda g: g.d.mean()), grp.apply(lambda g: g.e.std())], axis=1)",273,708
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: pd.Series({'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}))","pd.concat([grp.apply(lambda g: g.e.count()), grp.apply(lambda g: (g.b * g.c).sum() / g.c.sum()), grp.apply(lambda g: g.d.mean()), grp.apply(lambda g: g.e.std())], axis=1)",265,708
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: (g.e.count(), (g.b * g.c).sum() / g.c.sum(), g.d.mean(), g.e.std())).apply(pd.Series)","pd.concat([grp.apply(lambda g: g.e.count()), grp.apply(lambda g: (g.b * g.c).sum() / g.c.sum()), grp.apply(lambda g: g.d.mean()), grp.apply(lambda g: g.e.std())], axis=1)",266,708
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: (g.e.count(), (g.b * g.c).sum() / g.c.sum(), g.d.mean(), g.e.std())).apply(pd.Series)","grp.apply(lambda g: pd.DataFrame([{'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}])).reset_index(level=1, drop=True)",266,328
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: pd.Series({'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}))","grp.apply(lambda g: (g.e.count(), (g.b * g.c).sum() / g.c.sum(), g.d.mean(), g.e.std())).apply(pd.Series)",265,266
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: pd.DataFrame([{'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}])).reset_index(level=1, drop=True)","pd.concat([grp.apply(lambda g: g.e.count()), grp.apply(lambda g: (g.b * g.c).sum() / g.c.sum()), grp.apply(lambda g: g.d.mean()), grp.apply(lambda g: g.e.std())], axis=1)",328,708
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: {'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}).apply(pd.Series)","grp.apply(lambda g: pd.DataFrame([{'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}])).reset_index(level=1, drop=True)",273,328
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: pd.Series({'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}))","grp.apply(lambda g: pd.DataFrame([{'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}])).reset_index(level=1, drop=True)",265,328
36321840,answer,36073504,"python,pandas,dataframe,aggregate",codeblock,https://stackoverflow.com/questions/36321840,"grp.apply(lambda g: (g.e.count(), (g.b * g.c).sum() / g.c.sum(), g.d.mean(), g.e.std())).apply(pd.Series)","grp.apply(lambda g: {'n': g.e.count(), 'x': (g.b * g.c).sum() / g.c.sum(), 'y': g.d.mean(), 'z': g.e.std()}).apply(pd.Series)",266,273
36327297,answer,36322243,"python,pandas",codeblock,https://stackoverflow.com/questions/36327297,"df.time.str.findall('\d').str.join('_').str.split('_', expand=True)","df.time.str.split(expand=True).iloc[:, [0, 2]]",1.43,1.6
36355092,answer,36351317,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/36355092,mean = big_array_f.mean(axis = 0),mean = big_array.mean(axis = 0),205,319
36412525,answer,36412453,"python,pandas",codeblock,https://stackoverflow.com/questions/36412525,df1.join(df2).join(df3),"pd.concat([df1,df2,df3], axis=1)",3.93,5.67
36422197,answer,36422065,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/36422197,df.groupby('UserId')['WordID'].apply(list).values,df.groupby('UserId')['WordID'].apply(lambda x: x.tolist()).values,1.22,1.23
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[df['id'].isin(['0','1']),'id'].map({'0': False, '1': True})","df.loc[df['id'].str.contains('0|1'),'id'].map({'0': False, '1': True})",2.78,20
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].replace({'0': False, '1': True})","df.loc[df['id'].isin(['0','1']),'id'].astype(int).astype(bool)",4.72,9.5
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].replace({'0': False, '1': True})","df.loc[df['id'].str.contains('0|1'),'id'].map({'0': False, '1': True})",4.72,20
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].map({'0': False, '1': True})","df.loc[df['id'].isin(['0','1']),'id'].map({'0': False, '1': True})",2.19,2.78
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[df['id'].isin(['0','1']),'id'].map({'0': False, '1': True})","df.loc[df['id'].isin(['0','1']),'id'].astype(int).astype(bool)",2.78,9.5
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].map({'0': False, '1': True})","df.loc[np.in1d(df['id'], ['0','1']),'id'].replace({'0': False, '1': True})",2.19,4.72
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].map({'0': False, '1': True})","df.loc[df['id'].isin(['0','1']),'id'].astype(int).astype(bool)",2.19,9.5
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[df['id'].isin(['0','1']),'id'].astype(int).astype(bool)","df.loc[df['id'].str.contains('0|1'),'id'].map({'0': False, '1': True})",9.5,20
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[np.in1d(df['id'], ['0','1']),'id'].map({'0': False, '1': True})","df.loc[df['id'].str.contains('0|1'),'id'].map({'0': False, '1': True})",2.19,20
36440110,answer,36439620,"python,pandas",codeblock,https://stackoverflow.com/questions/36440110,"df.loc[df['id'].isin(['0','1']),'id'].map({'0': False, '1': True})","df.loc[np.in1d(df['id'], ['0','1']),'id'].replace({'0': False, '1': True})",2.78,4.72
36442267,answer,36442094,"excel,numpy,pandas",codeblock,https://stackoverflow.com/questions/36442267,"df[pd.to_numeric(df['B'], errors='coerce').notnull() ^ pd.to_numeric(df['C'], errors='coerce').isnull()]",df[df['B'].str.isdigit().isnull() ^ df['C'].str.isdigit().notnull()],1.88,16.1
36442267,answer,36442094,"excel,numpy,pandas",codeblock,https://stackoverflow.com/questions/36442267,"df[pd.to_numeric(df['B'], errors='coerce').notnull() ^ pd.to_numeric(df['C'], errors='coerce').isnull()]","df[df[['B','C']].apply(pd.to_numeric, errors='coerce').notnull().all(axis=1)]",1.88,3.49
36442267,answer,36442094,"excel,numpy,pandas",codeblock,https://stackoverflow.com/questions/36442267,"df[df[['B','C']].apply(pd.to_numeric, errors='coerce').notnull().all(axis=1)]",df[df['B'].str.isdigit().isnull() ^ df['C'].str.isdigit().notnull()],3.49,16.1
36473661,answer,36465481,"python,pandas",codeblock,https://stackoverflow.com/questions/36473661,(df + ' ').sum(axis=1),"df[cols[0]].str.cat(df[cols[1:]].values.transpose(), sep = ' ')",0.368,0.87
36473661,answer,36465481,"python,pandas",codeblock,https://stackoverflow.com/questions/36473661,(df + ' ').sum(axis=1),"df[[0,1,2]].apply(' '.join, axis=1)",0.368,0.937
36473661,answer,36465481,"python,pandas",codeblock,https://stackoverflow.com/questions/36473661,"df[cols[0]].str.cat(df[cols[1:]].values.transpose(), sep = ' ')","df[[0,1,2]].apply(' '.join, axis=1)",0.87,0.937
36480899,answer,36479668,"python,pandas",codeblock,https://stackoverflow.com/questions/36480899,"u.set_value(0,0,3)","u.ix[0,0]=2",0.0419,0.745
36481099,answer,36480086,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/36481099,corr[0:corr.size-5],"np.delete(corr,range(corr.size-5,corr.size))",0.00145,0.145
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'])","pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime})",3060,3060
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime}, date_parser=dt_parser)","pd.read_csv(fn, parse_dates=['date'])",2320,3060
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime}, date_parser=dt_parser)","pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime})",2320,3060
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'])","pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime})",29900,29900
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime}, date_parser=dt_parser)","pd.read_csv(fn, parse_dates=['date'])",22600,29900
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,pd.read_csv(fn),"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime}, date_parser=dt_parser)",1530,2320
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"df2 = pd.read_csv(fn2, parse_dates=['from'], index_col=0)","df = pd.read_csv(fn, parse_dates=['from'], index_col=0)",399,15700
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,pd.read_csv(fn),"pd.read_csv(fn, parse_dates=['date'])",1530,3060
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,pd.read_csv(fn),"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime})",1530,3060
36485452,answer,36484575,"python,performance,pandas,dataframe,scalability",codeblock,https://stackoverflow.com/questions/36485452,"pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime}, date_parser=dt_parser)","pd.read_csv(fn, parse_dates=['date'], dtype={0: pd.datetime})",22600,29900
36486641,answer,36480358,"python,numpy,dictionary",codeblock,https://stackoverflow.com/questions/36486641,dicarray.take(data),np.array([[dic[x] for x in line] for line in data]),24.4,2270
36486746,answer,36485891,"python,pandas",codeblock,https://stackoverflow.com/questions/36486746,"df_large.ix[df_small.index, 'col_3'] = df_small.col_3",df = df_large.combine_first(df_small),2.43,6.45
36493443,answer,36489941,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/36493443,"np.tensordot(np.conj(x),x,axes=(1,1))","np.einsum('ik,jk->ij', np.conj(x), x)",3760,4450
36514970,answer,36514781,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/36514970,big[str(year)] = 1 * ((big['FIRST'].dt.year <= year) & (big['LAST'].dt.year >= year)),"big[str(year)] = big.apply(lambda row: 1*(year >= row['FIRST'].year and year <= row['LAST'].year), axis=1)",8.33,6510
36514970,answer,36514781,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/36514970,"dlf[str(year)] = dlf.apply(lambda row: 1*(year >= row['FIRST'].year and year <= row['LAST'].year), axis=1)",df[str(year)] = 1 * ((df['FIRST'].dt.year <= year) & (df['LAST'].dt.year >= year)),1.27,1.7
36627979,answer,36614427,"python,pandas",codeblock,https://stackoverflow.com/questions/36627979,df.loc[beg:end],"df.xs(slice(beg,end),level='tstp')",0.317,0.632
36627979,answer,36614427,"python,pandas",codeblock,https://stackoverflow.com/questions/36627979,df.loc[beg:end],"df.unstack().between_time(beg,end).stack()",0.317,3.35
36627979,answer,36614427,"python,pandas",codeblock,https://stackoverflow.com/questions/36627979,"df.xs(slice(beg,end),level='tstp')","df.unstack().between_time(beg,end).stack()",0.632,3.35
36629460,answer,36628622,"python,numpy,scipy,vectorization,euclidean-distance",codeblock,https://stackoverflow.com/questions/36629460,"cdist(A,B,'sqeuclidean')","((A[:,None,:] - B[None,:,:])**2).sum(axis=-1)",0.249,1.9
36682210,answer,36681438,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/36682210,mask = df.price != df.price.shift(),prices = gCell.apply(removeSameLast),0.183,4.46
36695824,answer,36695757,"python,pandas",codeblock,https://stackoverflow.com/questions/36695824,df[~df.ID1.isin(df.ID2)],"df.loc[~df['ID1'].isin(df['ID2']), :]",55,55.5
36753921,answer,36753799,"python,numpy,pandas,dataframe,unique",codeblock,https://stackoverflow.com/questions/36753921,"pd.DataFrame({'col1':np.repeat(aa,bb.size),'col2':np.tile(bb,aa.size)})","pd.DataFrame(list(product(aa,bb)), columns=['col1', 'col2'])",25.4,1280
36763268,answer,36763038,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/36763268,"df.loc[np.repeat(df.index.values,df.condition)].reset_index(drop=True)","df.groupby('condition', as_index=False, sort=False).apply(lambda x: pd.concat([x]*x.condition.values[0], ignore_index=True)).reset_index(drop=True)",1.04,7.78
36786103,answer,36785966,"python,numpy,pandas,dataframe,arithmetic-expressions",codeblock,https://stackoverflow.com/questions/36786103,pd.DataFrame(df2.values * df1.values),"df2.mul(df1.ix[0], axis=1)",0.098,0.287
36810721,answer,36810595,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/36810721,"pd.DataFrame(np.einsum('ijk->ik',df.values.reshape(-1,2,df.shape[1]))/2.0)","pd.DataFrame(df.values.reshape(-1,2,df.shape[1]).mean(1))",0.266,0.317
36810721,answer,36810595,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/36810721,"pd.DataFrame(np.einsum('ijk->ik',df.values.reshape(-1,2,df.shape[1]))/2.0)",df.groupby(df.index//2).mean(),0.266,1.61
36810721,answer,36810595,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/36810721,"pd.DataFrame(df.values.reshape(-1,2,df.shape[1]).mean(1))",df.groupby(df.index//2).mean(),0.317,1.61
36834820,answer,36832450,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/36834820,np.sum(a32),sum(a32),1.86,572
36834820,answer,36832450,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/36834820,np.sum(a64),sum(a64),2.22,604
36841313,answer,36840299,"python,numpy,numpy-einsum",codeblock,https://stackoverflow.com/questions/36841313,"B[:, None]","np.einsum('i,j->ji', np.ones(1), B)",0.00023,0.00543
36879575,answer,36879311,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/36879575,"np.einsum('ij,jk,ki->ijk',A,A,A)","np.einsum('ijki->ijk',np.einsum('ij,jk,kl->ijkl',A,A,A))",10.9,1100
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",131,567
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",65.5,9380
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df[['Year','quarter']].astype(str).sum(axis=1)",65.5,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",65.5,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",53.3,9380
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df[['Year','quarter']].astype(str).sum(axis=1)",53.3,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",53.3,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],df.Year.str.cat(df.quarter),53.3,79.9
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],df['Year'].map(str) + df['quarter'],53.3,65.5
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",161,24700
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df[['Year','quarter']].astype(str).sum(axis=1)",161,584
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",161,567
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],df.Year.str.cat(df.quarter),161,189
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",131,24700
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],df['Year'].map(str) + df['quarter'],131,161
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],df.Year.str.cat(df.quarter),131,189
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].astype(str) + df['quarter'],"df[['Year','quarter']].astype(str).sum(axis=1)",131,584
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df['Year'].map(str) + df['quarter'],df.Year.str.cat(df.quarter),65.5,79.9
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df[['Year','quarter']].astype(str).sum(axis=1)",189,584
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",189,24700
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",189,567
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)","df[['Year','quarter']].astype(str).sum(axis=1)",567,584
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)","df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",567,24700
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df[['Year','quarter']].astype(str).sum(axis=1)","df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",584,24700
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",79.9,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df[['Year','quarter']].astype(str).sum(axis=1)",79.9,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,df.Year.str.cat(df.quarter),"df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",79.9,9380
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df[['Year','quarter']].astype(str).sum(axis=1)","df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)",230,230
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df.loc[:, ['Year','quarter']].astype(str).sum(axis=1)","df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",230,9380
36911306,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/36911306,"df[['Year','quarter']].astype(str).sum(axis=1)","df[['Year','quarter']].apply(lambda x : '{}{}'.format(x[0],x[1]), axis=1)",230,9380
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"df.values[:,[0,2,4,5,6]]","pd.DataFrame(df.values[:,[0,2,4,5,6]],columns=df.columns[[0,2,4,5,6]])",0.0587,0.568
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"df.values[:,[0,2,4,5,6]]","df[['a','c','e','f','g']]",0.0587,2.67
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"df.ix[:,[0,2,4,5,6]]","df[['a','c','e','f','g']]",1.81,2.67
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"pd.DataFrame(df.values[:,[0,2,4,5,6]],columns=df.columns[[0,2,4,5,6]])","df[['a','c','e','f','g']]",0.568,2.67
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"df.values[:,[0,2,4,5,6]]","df.ix[:,[0,2,4,5,6]]",0.0587,1.81
36911782,answer,36909107,"python,pandas,multiple-columns",codeblock,https://stackoverflow.com/questions/36911782,"pd.DataFrame(df.values[:,[0,2,4,5,6]],columns=df.columns[[0,2,4,5,6]])","df.ix[:,[0,2,4,5,6]]",0.568,1.81
36932862,answer,36930546,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/36932862,"np.einsum('ij,jk,ik->i', X, M, X)","np.dot(X, np.dot(M,X.T)).trace()",442,2240
36932862,answer,36930546,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/36932862,"np.einsum('ij,ij->i',X.dot(M),X)","np.dot(X, np.dot(M,X.T)).trace()",28.1,2240
36932862,answer,36930546,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/36932862,"np.einsum('ij,ij->i',X.dot(M),X)","np.einsum('ij,jk,ik->i', X, M, X)",28.1,442
36932888,answer,36930546,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/36932888,"np.einsum('ij,jk,ik->i', X, M, X)","np.einsum('ij,ij->i',X.dot(M),X)",0.00898,0.0119
36934505,answer,36934353,"python,pandas",codeblock,https://stackoverflow.com/questions/36934505,df[df.groupkey.map(df.groupkey.value_counts() != 1)],df.groupby('groupkey').filter(lambda x: len(x) != 1),1.87,2.71
36945762,answer,36945602,"python,sorting,pandas,multi-index",codeblock,https://stackoverflow.com/questions/36945762,"df1.reset_index(level=['id','name']).reindex(df2.no).reset_index().set_index(['id','no','name'])","df1.unstack([0, 2]).ix[df2.no].stack([1, 2]).swaplevel(0, 1)",4.41,18.8
36971131,answer,36969886,"python,numpy,matrix,scipy,scikit-learn",codeblock,https://stackoverflow.com/questions/36971131,"Ma[500,500]","M.tocsr()[500,500]",0.000318,86.4
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"pd.Series([item for sublist in [ x.split(',') for x in s.tolist() ] for item in sublist]).value_counts()","s.str.split(',', expand=True).stack().value_counts()",16.6,46.2
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"pd.Series([item for sublist in [ x.split(',') for x in s.tolist() ] for item in sublist]).value_counts()","pd.DataFrame([ x.split(',') for x in s.tolist() ]).stack().value_counts()",16.6,22.2
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"pd.DataFrame([ x.split(',') for x in s.tolist() ]).stack().value_counts()","s.str.split(',', expand=True).stack().value_counts()",22.2,46.2
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"s.str.split(',', expand=True).stack().value_counts()","pd.Series(s.str.split(',').sum()).value_counts()",46.2,3100
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"pd.DataFrame([ x.split(',') for x in s.tolist() ]).stack().value_counts()","pd.Series(s.str.split(',').sum()).value_counts()",22.2,3100
36988436,answer,36988360,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/36988436,"pd.Series([item for sublist in [ x.split(',') for x in s.tolist() ] for item in sublist]).value_counts()","pd.Series(s.str.split(',').sum()).value_counts()",16.6,3100
36989094,answer,36988859,"python,pandas",codeblock,https://stackoverflow.com/questions/36989094,"pd.melt(df, id_vars=['Col1','Col2'],value_name='Col').drop('variable', axis=1)","df.set_index(['Col1', 'Col2']).stack().reset_index(-1, drop=True).reset_index(name='Col')",2.48,3.83
37025654,answer,37025485,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37025654,"pd.merge(df, df.groupby('Column 1')['Column 3'].first().reset_index(), on=['Column 1','Column 3'])",df[(df.assign(diff=df.groupby('Column 1')['Column 3'].diff().fillna(0)).groupby('Column 1')['diff'].cumsum() == 0)],3.58,5.06
37036444,answer,37035082,"python,performance,sorting,numpy,pandas",codeblock,https://stackoverflow.com/questions/37036444,"np.argpartition(-z,np.arange(7))[:7]",np.argsort(z)[::-1][:7],36.5,264
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,"df[(df.ix[:,'Var1_Belgium':] != 0).sum(axis=1) >  1]","df[df.filter(like='var1_').apply(lambda r: (r != 0).sum() > 1, axis=1)]",1.39,746
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,df[(df.filter(like='var1') != 0).sum(1) > 1],"df[df.filter(like='var1_').apply(lambda r: (r != 0).sum() > 1, axis=1)]",1.48,746
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,"df[(df.iloc[:,1:] != 0).sum(axis=1) > 1]","df[df.filter(like='var1_').apply(lambda r: (r != 0).sum() > 1, axis=1)]",1.34,746
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,"df[(df.ix[:,'Var1_Belgium':] != 0).sum(axis=1) >  1]",df[(df.filter(like='var1') != 0).sum(1) > 1],1.39,1.48
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,"df[(df.iloc[:,1:] != 0).sum(axis=1) > 1]","df[(df.ix[:,'Var1_Belgium':] != 0).sum(axis=1) >  1]",1.34,1.39
37053474,answer,37053065,"python,pandas",codeblock,https://stackoverflow.com/questions/37053474,"df[(df.iloc[:,1:] != 0).sum(axis=1) > 1]",df[(df.filter(like='var1') != 0).sum(1) > 1],1.34,1.48
37059239,answer,37056258,"python,performance,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37059239,"sparse.kron(A,np.ones((3000,1),int)).A",sparse.vstack([A]*3000).A,1.27,32.3
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"d.jaccard(mrowd, ad)  #  dense","d.jaccard(mrow.todense(), a.todense())  # with conversion",0.173,0.539
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"d.jaccard(mrow.todense(), a.todense())  # with conversion","d.jaccard(mrow, a)  # one sparse row",0.539,1.32
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"d.jaccard(mrowd, ad)  #  dense","d.jaccard(mrow, a)  # one sparse row",0.173,1.32
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"for row in mat.todense(): d.jaccard(row,ad) # all dense","for row in mat: d.jaccard(row.todense(),ad) # inner dense",734,1690
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"for row in mat.todense(): d.jaccard(row,ad) # all dense","for row in mat: d.jaccard(row,a) # all sparse",734,4610
37076829,answer,37071015,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37076829,"for row in mat: d.jaccard(row.todense(),ad) # inner dense","for row in mat: d.jaccard(row,a) # all sparse",1690,4610
37087133,answer,19666626,"python,arrays,numpy,replace,condition",codeblock,https://stackoverflow.com/questions/37087133,"np.putmask(A, A>0.5, 5)",A[A > 0.5] = 5,1.34,1.82
37110774,answer,37106640,"python,pandas,data-analysis,bigdata",codeblock,https://stackoverflow.com/questions/37110774,"df.user_agent.apply(lambda x: pd.Series(parse_ua_list(x))).rename(columns={0:'browser', 1:'os'})","df.user_agent.apply(parse_ua_series).rename(columns={0:'browser', 1:'os'})",5780,5830
37110774,answer,37106640,"python,pandas,data-analysis,bigdata",codeblock,https://stackoverflow.com/questions/37110774,"df.user_agent.apply(parse_ua_list).apply(pd.Series).rename(columns={0:'browser', 1:'os'})","df.user_agent.apply(lambda x: pd.Series(parse_ua_list(x))).rename(columns={0:'browser', 1:'os'})",5610,5780
37110774,answer,37106640,"python,pandas,data-analysis,bigdata",codeblock,https://stackoverflow.com/questions/37110774,"df.user_agent.apply(parse_ua_list).apply(pd.Series).rename(columns={0:'browser', 1:'os'})","df.user_agent.apply(parse_ua_series).rename(columns={0:'browser', 1:'os'})",5610,5830
37120235,answer,37117427,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37120235,d=datad[inds],d=data[inds],0.0559,0.617
37120235,answer,37117427,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37120235,row_sumd=datad[inds].sum(axis=0),row_sum=data[inds].sum(axis=0),0.529,0.89
37120235,answer,37117427,"python,arrays,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/37120235,"b=np.zeros((1,data.shape[0]),'int8'); b[:,inds]=1; x2=b*data","b=np.zeros((1,data.shape[0]),'int8'); b[:,inds]=1; x1=np.asmatrix(b)*data",0.605,0.661
37125873,answer,37125174,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37125873,df.A.map(lambda x: x[0]),df['new_col'] = df.A.apply(lambda x: x[0]),11.1,12.1
37125873,answer,37125174,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37125873,df['new_col'] = df.A.apply(lambda x: x[0]),"df[""new_col""] = df[""A""].str[0]",12.1,15.3
37125873,answer,37125174,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37125873,df.A.map(lambda x: x[0]),"df[""new_col""] = df[""A""].str[0]",11.1,15.3
37157992,answer,37157370,"python,pandas",codeblock,https://stackoverflow.com/questions/37157992,"df.groupby([df.ID, df.url.str.extract(r'audios(\d+)?', expand=False)]).size().reset_index(name='count')","pd.concat([df['ID'], df['url'].str.extract('(?P<count>audios)(?P<digit>\d+)', expand=False)], axis=1).groupby(['ID', 'digit'], as_index=False).count()",1.92,3.5
37162086,answer,37161967,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37162086,product_list.brand_name.iat[int(prod)-1],product_list.iloc[int(prod)-1]['category_name'],0.00996,0.0827
37162086,answer,37161967,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37162086,product_list.brand_name.iat[int(prod)-1],product_list.iloc[int(prod)-1]['category_name'],0.00986,0.0847
37178111,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178111,"df['genes'].str.extract('(\w*)\s*', expand=False)","df[""genes""].str.split().str[0]",0.173,0.586
37178111,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178111,df['genes'].map(lambda x: x.split()[0]),"df['genes'].str.extract('(\w*)\s*', expand=False)",0.153,0.173
37178111,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178111,df['genes'].map(lambda x: x.split()[0]),"df[""genes""].str.split().str[0]",0.153,0.586
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,pd.Series([ x.split()[0] for x in df['genes'].tolist() ]),df['genes'].map(lambda x: x.split()[0]),0.946,1.27
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,"df[""genes""].str.split().str[0]","df['genes'].str.extract('(\w*)\s*', expand=False)",2.52,5.08
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,pd.Series([ x.split()[0] for x in df['genes'].tolist() ]),"df[""genes""].str.split().str[0]",0.946,2.52
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,df['genes'].map(lambda x: x.split()[0]),"df['genes'].str.extract('(\w*)\s*', expand=False)",1.27,5.08
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,pd.Series([ x.split()[0] for x in df['genes'].tolist() ]),"df['genes'].str.extract('(\w*)\s*', expand=False)",0.946,5.08
37178431,answer,37177157,"python,pandas",codeblock,https://stackoverflow.com/questions/37178431,df['genes'].map(lambda x: x.split()[0]),"df[""genes""].str.split().str[0]",1.27,2.52
37179182,answer,37179155,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/37179182,df.index.values.tolist(),df.index.tolist(),0.000787,0.00175
37203747,answer,37203712,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37203747,"df.pivot(index='Person Id',  columns='Characteristics',  values='Count').fillna(0).reset_index().rename_axis(None, axis=1)","df.pivot_table(index='Person Id',  columns='Characteristics',  values='Count',  fill_value=0).reset_index().rename_axis(None, axis=1)",1.87,5.26
37216587,answer,37216485,"python,pandas",codeblock,https://stackoverflow.com/questions/37216587,"df.at[('a', 'A'), ('c', 'C')]","df.loc[('a', 'A'), ('c', 'C')]",0.00833,0.187
37216587,answer,37216485,"python,pandas",codeblock,https://stackoverflow.com/questions/37216587,"df.get_value(('a', 'A'), ('c', 'C'))","df.loc[('a', 'A'), ('c', 'C')]",0.00362,0.187
37216587,answer,37216485,"python,pandas",codeblock,https://stackoverflow.com/questions/37216587,"df.get_value(('a', 'A'), ('c', 'C'))","df.at[('a', 'A'), ('c', 'C')]",0.00362,0.00833
37224022,answer,37224002,"python,pandas,dataframe,split,series",codeblock,https://stackoverflow.com/questions/37224022,pd.DataFrame([ x.split('; ') for x in SR_test.tolist() ]),"SR_test.str.split('; ', expand=True)",9.59,34.5
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"(AA.dot(AA.T))[idx[:,0], idx[:,1]]","(A[idx[:,0]].multiply(A[idx[:,1]])).sum(axis=1)",0.00962,1.32
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"(A*A.T)[idx[:,0], idx[:,1]]","(A[idx[:,0]].multiply(A[idx[:,1]])).sum(axis=1)",0.689,1.32
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"(AA.dot(AA.T))[idx[:,0], idx[:,1]]","(A*A.T)[idx[:,0], idx[:,1]]",0.00962,0.689
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"Al[idx[:,0]]","A[idx[:,0]]",0.234,0.476
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"(AA.dot(AA.T))[idx[:,0], idx[:,1]]","np.einsum('ij,ij->i', AA[idx[:,0]], AA[idx[:,1]])",0.00962,0.0181
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"[AA[i].dot(AA[j]) for i,j in idx]","[A[i].multiply(A[j]).sum() for i,j in idx]",0.0384,2.58
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"np.einsum('ij,ij->i', AA[idx[:,0]], AA[idx[:,1]])","(A*A.T)[idx[:,0], idx[:,1]]",0.0181,0.689
37245105,answer,37237453,"python,numpy,scipy,sparse-matrix,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37245105,"np.einsum('ij,ij->i', AA[idx[:,0]], AA[idx[:,1]])","(A[idx[:,0]].multiply(A[idx[:,1]])).sum(axis=1)",0.0181,1.32
37258929,answer,37258563,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37258929,np.where((df.iloc[0] * df.iloc[1])),np.where((df.iloc[0]) & (df.iloc[1])),0.269,0.4
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers'], sort=False, how='left')","data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers']).sort_index()",1.71,2.68
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers'], sort=False, how='left')","pd.concat([data2.x, data2.y, data2.Cluster, data2.Cluster.map(centers2.x.to_dict()), data2.Cluster.map(centers2.y.to_dict())], axis=1, keys=['x','y','Cluster','Centers.x','Centers.y'])",1.71,2.15
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"data2.join(centers2, on='Cluster', rsuffix ='_centers', sort=False, how='left')","data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers'], sort=False, how='left')",1.71,1.71
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"data2.join(centers2, on='Cluster', rsuffix ='_centers', sort=False, how='left')","data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers']).sort_index()",1.71,2.68
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"data2.join(centers2, on='Cluster', rsuffix ='_centers', sort=False, how='left')","pd.concat([data2.x, data2.y, data2.Cluster, data2.Cluster.map(centers2.x.to_dict()), data2.Cluster.map(centers2.y.to_dict())], axis=1, keys=['x','y','Cluster','Centers.x','Centers.y'])",1.71,2.15
37262427,answer,37262315,"python,pandas,dataframe,mapping,series",codeblock,https://stackoverflow.com/questions/37262427,"pd.concat([data2.x, data2.y, data2.Cluster, data2.Cluster.map(centers2.x.to_dict()), data2.Cluster.map(centers2.y.to_dict())], axis=1, keys=['x','y','Cluster','Centers.x','Centers.y'])","data2.merge(centers2, left_on='Cluster', right_index=True, suffixes=['', '_centers']).sort_index()",2.15,2.68
37308259,answer,37307796,"python,datetime,pandas,indexing,data-science",codeblock,https://stackoverflow.com/questions/37308259,"df.loc[~np.in1d(df.index.date, pd.to_datetime(removelist).date), :]",df[[d.date() not in pd.to_datetime(removelist) for d in df.index]],1.42,3.25
37328910,answer,37328680,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/37328910,"A[np.arange(A.shape[0]),min_idx]","np.amin(A,axis=1)",0.056,37.3
37332027,answer,37313691,"python,pandas,dataframe,subtraction",codeblock,https://stackoverflow.com/questions/37332027,"df2[df2.apply(lambda x: x.value not in df2.values, axis=1)]","pd.concat([df1, df2, df2]).drop_duplicates(keep=False)",0.546,0.987
37332027,answer,37313691,"python,pandas,dataframe,subtraction",codeblock,https://stackoverflow.com/questions/37332027,"df2[df2.apply(lambda x: x.value not in df2.values, axis=1)]","df1.loc[pd.merge(df1, df2, on=['a','b'], how='left', indicator=True)['_merge'] == 'left_only']",0.546,4.57
37332027,answer,37313691,"python,pandas,dataframe,subtraction",codeblock,https://stackoverflow.com/questions/37332027,"pd.concat([df1, df2, df2]).drop_duplicates(keep=False)","df1.loc[pd.merge(df1, df2, on=['a','b'], how='left', indicator=True)['_merge'] == 'left_only']",0.987,4.57
37335656,answer,37335598,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37335656,"df['Event'].str.split(""/"").apply(len)","df['Event'].str.split(""/"").str.len()",4.08,4.28
37335656,answer,37335598,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37335656,"df['Event'].str.count(""/"") + 1","df['Event'].str.split(""/"").apply(len)",3.18,4.08
37335656,answer,37335598,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37335656,"df['Event'].str.count(""/"") + 1","df['Event'].str.split(""/"").str.len()",3.18,4.28
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.values[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.get_value(2,2)",0.2,0.309
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iat[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.ix[2,2]",0.308,0.316
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.get_value(2,2)","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.ix[2,2]",0.309,0.316
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.get_value(2,2)","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iloc[2,2]",0.309,0.42
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iat[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iloc[2,2]",0.308,0.42
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.values[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.ix[2,2]",0.2,0.316
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.values[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iloc[2,2]",0.2,0.42
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.values[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iat[2,2]",0.2,0.308
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iat[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.get_value(2,2)",0.308,0.309
37338196,answer,37336306,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/37338196,"df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.ix[2,2]","df = pd.DataFrame(np.arange(16).reshape(4, 4)); df.iloc[2,2]",0.316,0.42
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].apply(lambda x: ', '.join(x))","df['A'].str.replace('\[|\]|\'', '')",0.505,2.43
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].apply(', '.join)","df['A'].str.join(', ')",0.292,0.368
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].apply(', '.join)","df['A'].apply(lambda x: ', '.join(x))",0.292,0.505
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].apply(', '.join)","df['A'].str.replace('\[|\]|\'', '')",0.292,2.43
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].str.join(', ')","df['A'].apply(lambda x: ', '.join(x))",0.368,0.505
37348124,answer,37347725,"python,pandas",codeblock,https://stackoverflow.com/questions/37348124,"df['A'].str.join(', ')","df['A'].str.replace('\[|\]|\'', '')",0.368,2.43
37350818,answer,37350777,"python,python-2.7,pandas,dataframe,rounding",codeblock,https://stackoverflow.com/questions/37350818,"((df[['B', 'C']].div(resolution)).round().mul(resolution))","(df[['B', 'C']].apply(lambda x: (x / resolution).round()* resolution))",22.6,29
37350818,answer,37350777,"python,python-2.7,pandas,dataframe,rounding",codeblock,https://stackoverflow.com/questions/37350818,"((df[['B', 'C']] / resolution).round() * resolution)","((df[['B', 'C']].div(resolution)).round().mul(resolution))",22.5,22.6
37350818,answer,37350777,"python,python-2.7,pandas,dataframe,rounding",codeblock,https://stackoverflow.com/questions/37350818,"((df[['B', 'C']] / resolution).round() * resolution)","(df[['B', 'C']].apply(lambda x: (x / resolution).round()* resolution))",22.5,29
37358754,answer,37358016,"python,numpy",codeblock,https://stackoverflow.com/questions/37358754,"x=linspace(-pi, pi, N); np.where(x<0 , 2*pi+x, x)","x=linspace(-pi, pi, N); np.select(x<0 , 2*pi+x, x)",0.0791,354
37378346,answer,37378315,"python,python-3.x,pandas,grouping",codeblock,https://stackoverflow.com/questions/37378346,df.loc[df['B']==5].groupby('A').size(),df.groupby('A')['B'].agg(lambda ser: (ser==5).sum()),0.649,0.927
37381009,answer,37380178,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/37381009,"(df.Datum.str.extract(r'([0-2]\d:[0-5]\d)', expand=True))","(df.Datum.astype(str).str.split(pat=' ', expand=True)[2])",0.347,0.727
37381009,answer,37380178,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/37381009,"(df.Datum.str.extract(r'([0-2]\d:[0-5]\d)', expand=True))","(df.Datum.str.split(r'\s+', expand=True)[2])",0.347,0.675
37381009,answer,37380178,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/37381009,"(df.Datum.str.split(r'\s+', expand=True)[2])","(df.Datum.astype(str).str.split(pat=' ', expand=True)[2])",0.675,0.727
37383030,answer,37382643,"python,for-loop,pandas,multidimensional-array,dataframe",codeblock,https://stackoverflow.com/questions/37383030,"( pd.DataFrame({col: pd.Series(range(df[col].iloc[0], df[col].iloc[-1] + 1)) for col in df.columns }) )","( pd.DataFrame({col: pd.Series(range(df[col].min(), df[col].max() + 1)) for col in df.columns })  )",1.75,2.18
37392009,answer,37391539,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37392009,(df.transpose()[dfBool1.a.values].transpose()),(df[df.columns[dfBool.a]]),0.55,0.769
37392009,answer,37391539,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37392009,"(df.loc[:, dfBool1.a.values])",(df[df.columns[dfBool.a]]),0.38,0.769
37392009,answer,37391539,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37392009,"(df.loc[:, dfBool1.a.values])",(df.transpose()[dfBool1.a.values].transpose()),0.38,0.55
37417291,answer,37416978,"python,numpy",codeblock,https://stackoverflow.com/questions/37417291,"np.sum(np.triu(arr1[:,None]*arr2[None,:],1))","np.sum( [arr1[i]*arr2[j] for i in xrange(n) for j in xrange(i+1, n)] )",0.0559,1.45
37418621,answer,37408685,"python,numpy,transpose",codeblock,https://stackoverflow.com/questions/37418621,X.transpose(),np.transpose(X),0.00047,0.000993
37418621,answer,37408685,"python,numpy,transpose",codeblock,https://stackoverflow.com/questions/37418621,X[:],X.copy(),0.000465,0.0108
37418621,answer,37408685,"python,numpy,transpose",codeblock,https://stackoverflow.com/questions/37418621,X.T,X.transpose(),0.000379,0.00047
37418621,answer,37408685,"python,numpy,transpose",codeblock,https://stackoverflow.com/questions/37418621,X.T,np.transpose(X),0.000379,0.000993
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600].copy()","x = df.iloc[:,300:600].copy()",0.497,1.18
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,idx]","x = df.values[:,idx].copy()",1.53,2.23
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,idx].copy()","x = df.values[:,idx].copy()",2.16,2.23
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,idx]","x = a[:,idx].copy()",1.53,2.16
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600]","x = df.iloc[:,300:600]",0.000414,0.153
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600]","x = df.iloc[:,300:600].copy()",0.000414,1.18
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.values[:,300:600]","x = a[:,300:600].copy()",0.0157,0.497
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600]","x = df.values[:,300:600]",0.000414,0.0157
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.iloc[:,300:600]","x = df.iloc[:,300:600].copy()",0.153,1.18
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600]","x = df.values[:,300:600].copy()",0.000414,0.568
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600]","x = a[:,300:600].copy()",0.000414,0.497
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,300:600].copy()","x = df.values[:,300:600].copy()",0.497,0.568
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.values[:,300:600]","x = df.values[:,300:600].copy()",0.0157,0.568
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.iloc[:,300:600]","x = a[:,300:600].copy()",0.153,0.497
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.iloc[:,idx]","x = df.iloc[:,idx].copy()",1.69,2.75
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,idx].copy()","x = df.iloc[:,idx].copy()",2.16,2.75
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.values[:,idx]","x = df.values[:,idx].copy()",1.61,2.23
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = df.values[:,idx]","x = a[:,idx].copy()",1.61,2.16
37422850,answer,37418556,"python-3.x,numpy,pandas,series",codeblock,https://stackoverflow.com/questions/37422850,"x = a[:,idx]","x = df.values[:,idx]",1.53,1.61
37428259,answer,37428218,"pandas,lambda",codeblock,https://stackoverflow.com/questions/37428259,"sample['PR'].mask(sample['PR'] < 90, np.nan)",sample['PR'].apply(lambda x: np.nan if x < 90 else x),3.71,102
37445196,answer,37423844,pandas,sentence,map seems to be faster than astype,map,astype,,
37445196,answer,37423844,pandas,codeblock,https://stackoverflow.com/questions/37445196,df['mean'].map(str) + '( ' + df['std'].map(str) + ')',"df['mean'].map('{:,.2f}'.format) + df['std'].map('({:,.2f})'.format)",786,845
37445196,answer,37423844,pandas,codeblock,https://stackoverflow.com/questions/37445196,df['mean'].map(str) + '( ' + df['std'].map(str) + ')',df['mean'].astype(str) + '(' + df['std'].astype(str) + ')',786,1510
37445196,answer,37423844,pandas,codeblock,https://stackoverflow.com/questions/37445196,"df['mean'].map('{:,.2f}'.format) + df['std'].map('({:,.2f})'.format)",df['mean'].astype(str) + '(' + df['std'].astype(str) + ')',845,1510
37459213,answer,37459176,"python,list,pandas",sentence,"ps iat should be faster compared to iloc, because the latter one does some overhead",iat,iloc,,
37466482,answer,37464737,"python,arrays,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/37466482,"np.multiply.outer(x,y)",x[[slice(None)]*x.ndim + [None]*y.ndim] * y,0.0526,0.0536
37467762,answer,37466364,"python,csv,pandas",codeblock,https://stackoverflow.com/questions/37467762,"df1.merge(df2.stack().reset_index(level=0).rename(columns={0:'TC_NUM'}), how='left', on=['TC_NUM'])","df1.apply(lambda x: get_key(df2, x.TC_NUM), axis=1)",3.84,10.4
37483537,answer,37483470,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37483537,df['fruits'].str.split().str.len(),df['fruits'].str.split().apply(len).value_counts(),6,6.3
37483537,answer,37483470,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37483537,df['fruits'].str.split().str.len(),df['fruits'].str.split().apply(len).value_counts(),0.347,0.799
37501332,answer,37385992,"python,pandas",sentence,"in my tests, asof was even faster than .loc when the index (A.index) already contained I.",asof,.loc,,
37527120,answer,37526889,"python,pandas,count",codeblock,https://stackoverflow.com/questions/37527120,"(pd.DataFrame([x for x in a.apply(Counter, axis=1)]))","(a.apply(lambda x: x.value_counts(), axis=1))",1.27,3.74
37527120,answer,37526889,"python,pandas,count",codeblock,https://stackoverflow.com/questions/37527120,"(pd.DataFrame([x for x in a.apply(Counter, axis=1)]))","(a.apply(lambda x: x.value_counts(), axis=1))",87,2450
37553473,answer,37553397,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37553473,"df.apply(lambda x: np.where(x >0, 1, 0))","df.applymap(lambda x: np.where(x >0, 1, 0))",256,3750
37553473,answer,37553397,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37553473,(df>0).astype(np.int8),"df.applymap(lambda x: np.where(x >0, 1, 0))",2.95,3750
37553473,answer,37553397,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37553473,(df>0).astype(np.int8),"df.apply(lambda x: np.where(x >0, 1, 0))",2.95,256
37553473,answer,37553397,"python,pandas,dataframe",sentence,".apply() - will work faster than .applymap() as it works on columns, but still much slower compared to df>0",.apply(),.applymap(),,
37559236,answer,37557485,"python,pandas,divide",codeblock,https://stackoverflow.com/questions/37559236,"df.groupby('mat').time.apply(decompose).reset_index(-1, drop=True)","df.groupby('mat', group_keys=False).apply(split_max_time)",1.83,4.21
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame(df.col.str.split().tolist())),"(pd.DataFrame(dict(zip(range(3), [df['col'].apply(lambda x : x.split(' ')[i]) for i in range(3)]))))",87.8,211
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame(list(df.col.str.split()))),"(pd.DataFrame(dict(zip(range(3), [df['col'].apply(lambda x : x.split(' ')[i]) for i in range(3)]))))",86.1,211
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame([ x.split() for x in df['col'].tolist()])),(df.col.str.split(expand=True)),54.1,156
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame(list(df.col.str.split()))),(pd.DataFrame(df.col.str.split().tolist())),86.1,87.8
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(df.col.str.split(expand=True)),"(pd.DataFrame(dict(zip(range(3), [df['col'].apply(lambda x : x.split(' ')[i]) for i in range(3)]))))",156,211
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame([ x.split() for x in df['col'].tolist()])),"(pd.DataFrame(dict(zip(range(3), [df['col'].apply(lambda x : x.split(' ')[i]) for i in range(3)]))))",54.1,211
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame(df.col.str.split().tolist())),(df.col.str.split(expand=True)),87.8,156
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame([ x.split() for x in df['col'].tolist()])),(pd.DataFrame(df.col.str.split().tolist())),54.1,87.8
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame(list(df.col.str.split()))),(df.col.str.split(expand=True)),86.1,156
37592047,answer,17116814,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37592047,(pd.DataFrame([ x.split() for x in df['col'].tolist()])),(pd.DataFrame(list(df.col.str.split()))),54.1,86.1
37594347,answer,37594294,"python,numpy,pandas,math,exp",codeblock,https://stackoverflow.com/questions/37594347,np.exp(-N_DATA['column_name']*0.008),(-N_DATA['column_name']*0.008).apply(math.exp),0.214,0.873
37594347,answer,37594294,"python,numpy,pandas,math,exp",codeblock,https://stackoverflow.com/questions/37594347,np.exp(-N_DATA['column_name']*0.008),(-N_DATA['column_name']*0.008).apply(math.exp),0.168,0.209
37598440,answer,37597836,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37598440,customer[~customer.Email.str.endswith(invalid_emails)],"customer[~customer.Email.str.replace(r'^[^@]*\@', '').isin(blacklist.Domain)]",136,642
37598440,answer,37597836,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37598440,customer[customer['Email'].apply(lambda s: not s.endswith(invalid_emails))],"customer[~customer.Email.str.replace(r'^[^@]*\@', '').isin(blacklist.Domain)]",151,642
37598440,answer,37597836,"python,pandas,dataframe",codeblock,"customer[~customer.Email.str.endswith(invalid_emails)] is a bit faster compared to customer[customer['Email'].apply(lambda s: not s.endswith(invalid_emails))] and customer[~customer.Email.str.replace(r'^[^@]*\@', '').isin(blacklist.Domain)] is much slower",customer[~customer.Email.str.endswith(invalid_emails)],customer[customer['Email'].apply(lambda s: not s.endswith(invalid_emails))],136,151
37598440,answer,37597836,"python,pandas,dataframe",sentence,"customer[~customer.Email.str.endswith(invalid_emails)] is a bit faster compared to customer[customer['Email'].apply(lambda s: not s.endswith(invalid_emails))] and customer[~customer.Email.str.replace(r'^[^@]*\@', '').isin(blacklist.Domain)] is much slower",customer[~customer.Email.str.endswith(invalid_emails)],customer[customer['Email'].apply(lambda s: not s.endswith(invalid_emails))],,
37628797,answer,37628593,"python,numpy,multidimensional-array,matrix-multiplication",codeblock,https://stackoverflow.com/questions/37628797,"c2 = a[...,np.newaxis, np.newaxis]*b","c = np.einsum('ij,kl-> ijkl', a, b)",250,342
37650516,answer,37649829,"python,numpy,pandas,binary,integer",codeblock,https://stackoverflow.com/questions/37650516,"df.apply(lambda col: int(''.join(str(v) for v in col), 2))","(df.T*(1 << np.arange(df.shape[0]-1, -1, -1))).sum(axis=1)",0.264,0.492
37650516,answer,37649829,"python,numpy,pandas,binary,integer",codeblock,https://stackoverflow.com/questions/37650516,"(df.T.dot(1 << np.arange(df.shape[0] - 1, -1, -1)))","(df.T*(1 << np.arange(df.shape[0]-1, -1, -1))).sum(axis=1)",0.204,0.492
37650516,answer,37649829,"python,numpy,pandas,binary,integer",codeblock,https://stackoverflow.com/questions/37650516,"(df.T.dot(1 << np.arange(df.shape[0] - 1, -1, -1)))","df.apply(lambda col: int(''.join(str(v) for v in col), 2))",0.204,0.264
37686871,answer,37572822,"python,python-3.x,numpy,convolution,least-squares",sentence,also i think scipy.signal.fftconvolve can be faster than np.convolve but this depends on the length of the shorter vector (see here),scipy.signal.fftconvolve,np.convolve,,
37687852,answer,37687806,"python,pandas,dataframe,vectorization,string-length",codeblock,https://stackoverflow.com/questions/37687852,df['text_length'] = df['text'].apply(len),df['text_length'] = (df.text.str.len()),17.6,20.6
37713013,answer,37712274,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/37713013,"f.loc[~f.duplicated(subset=['User Name'], keep=False), :]",f.groupby('User Name').filter(lambda x: len(x) == 1),17.4,6780
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc[('chr1', [3000714, 3001110]),:])","(df.loc[pd.IndexSlice['chr1', [3000714, 3001110]],:])",0.824,0.826
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc(axis=0)[('chr1', slice(3000714, 3001110))])","(df.loc[pd.IndexSlice['chr1', [3000714, 3001110]],:])",0.743,0.826
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc(axis=0)[('chr1', slice(3000714, 3001110))])","(df.loc[('chr1', slice(3000714, 3001110)),:])",0.743,0.757
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc[('chr1', slice(3000714, 3001110)),:])","(df.loc[('chr1', [3000714, 3001110]),:])",0.757,0.824
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc[('chr1', slice(3000714, 3001110)),:])","(df.loc[pd.IndexSlice['chr1', [3000714, 3001110]],:])",0.757,0.826
37717252,answer,37717137,"python,pandas,dataframe,multi-index",codeblock,https://stackoverflow.com/questions/37717252,"(df.loc(axis=0)[('chr1', slice(3000714, 3001110))])","(df.loc[('chr1', [3000714, 3001110]),:])",0.743,0.824
37736132,answer,37735403,"python,performance,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37736132,res[res.sum(axis=1).str.contains('e|A')],res[res.apply(lambda x: x.str.contains('e|A')).any(axis=1)],0.664,1.86
37747667,answer,37747524,"python-3.x,pandas,dataframe,multi-index,levels",codeblock,https://stackoverflow.com/questions/37747667,(df.index.get_level_values('ID').unique().tolist()),(df.index.get_level_values('ID').drop_duplicates().tolist()),0.131,0.182
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iloc[random.randint(0, 10**7), 1]","df.loc[random.randint(0, 10**7), 'b']",0.394,0.502
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.ix[random.randint(0, 10**7), 'b']","df.loc[random.randint(0, 10**7), 'b']",0.0648,0.502
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.loc[random.randint(0, 10**7), 'b']","df.ix[random.randint(0, 10**7), 1]",0.502,0.503
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.at[random.randint(0, 10**7), 'b']","df.iloc[random.randint(0, 10**7), 1]",0.0668,0.394
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iat[random.randint(0, 10**7), 1]","df.iloc[random.randint(0, 10**7), 1]",0.0329,0.394
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.ix[random.randint(0, 10**7), 'b']","df.iloc[random.randint(0, 10**7), 1]",0.0648,0.394
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iloc[random.randint(0, 10**7), 1]","df.ix[random.randint(0, 10**7), 1]",0.394,0.503
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iat[random.randint(0, 10**7), 1]","df.at[random.randint(0, 10**7), 'b']",0.0329,0.0668
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.ix[random.randint(0, 10**7), 'b']","df.at[random.randint(0, 10**7), 'b']",0.0648,0.0668
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.at[random.randint(0, 10**7), 'b']","df.ix[random.randint(0, 10**7), 1]",0.0668,0.503
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iat[random.randint(0, 10**7), 1]","df.ix[random.randint(0, 10**7), 'b']",0.0329,0.0648
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iat[random.randint(0, 10**7), 1]","df.ix[random.randint(0, 10**7), 1]",0.0329,0.503
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.ix[random.randint(0, 10**7), 'b']","df.ix[random.randint(0, 10**7), 1]",0.0648,0.503
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.at[random.randint(0, 10**7), 'b']","df.loc[random.randint(0, 10**7), 'b']",0.0668,0.502
37761363,answer,37757844,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/37761363,"df.iat[random.randint(0, 10**7), 1]","df.loc[random.randint(0, 10**7), 'b']",0.0329,0.502
37770623,answer,37769975,"python,numpy,math,matrix",codeblock,https://stackoverflow.com/questions/37770623,M.diagonal();np.fliplr(M).diagonal(),"i=np.arange(N);mm=M[i,i],M[i,i[::-1]]",0.00363,0.0513
37775575,answer,37774990,"python,numpy",codeblock,https://stackoverflow.com/questions/37775575,"np.in1d(data, list(test)).reshape(data.shape)","np.in1d(data, np.hstack(test)).reshape(data.shape)",26.2,374
37775575,answer,37774990,"python,numpy",codeblock,https://stackoverflow.com/questions/37775575,np.vectorize(test.__contains__)(data),"np.in1d(data, list(test)).reshape(data.shape)",3.16,26.2
37775575,answer,37774990,"python,numpy",codeblock,https://stackoverflow.com/questions/37775575,np.vectorize(test.__contains__)(data),"np.in1d(data, np.hstack(test)).reshape(data.shape)",3.16,374
37776622,answer,37775308,"python,pandas",codeblock,https://stackoverflow.com/questions/37776622,"df[df[""customer_id""] > 9999999].reset_index(drop=True)","(df.drop(df.loc[df[""customer_id""] < 9999999, 'customer_id'].index))",0.676,0.921
37791167,answer,37791073,"python,pandas",codeblock,https://stackoverflow.com/questions/37791167,"(df.groupby(['name','date','id'], as_index=False).apply(lambda x: np.average(x.value, weights=x.weights)))","((df.value * df.weights).groupby([df.name,df.date,df.id]).sum() /  df.weights.groupby([df.name,df.date,df.id]).sum())",34.6,38.4
37808663,answer,37808550,"python,csv,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37808663,"pd.read_csv('d:/temp/test.csv', index_col=0, chunksize=1000)","pd.read_csv('d:/temp/test.csv', index_col=0)",4.42,1210
37820199,answer,37820107,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/37820199,"D[N + np.arange(N)[:,None] - np.arange(N)]","np.take(D,N + np.arange(N)[:,None] - np.arange(N))",2.82,2.84
37829826,answer,37829330,"python,pandas,dataframe,iteration,condition",codeblock,https://stackoverflow.com/questions/37829826,"(df.groupby(['Group','Name'])['Medal'].apply(lambda x: x.replace('?', x.sort_values().iloc[-1])))","(df.replace('?', np.nan).groupby(['Name', 'Group']).apply(lambda df: df.ffill().bfill()).fillna('?'))",4.13,11.3
37846553,answer,30437947,"python,numpy,complex-numbers,memory-efficient,numpy-ufunc",codeblock,https://stackoverflow.com/questions/37846553,x.real**2 + x.imag**2,np.abs(x)**2,0.0127,0.0814
37846655,answer,37845306,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/37846655,df.groupby(level='Name').tail(1),"df.reset_index(level='Date').groupby(level='Name').last().set_index('Date', append=True)",1.04,3.75
37846655,answer,37845306,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/37846655,df1.groupby(level='Name').tail(1),"df1.reset_index(level='Date').groupby(level='Name').last().set_index('Date', append=True)",1.66,4.69
37862251,answer,37854256,"python,datetime,pandas,time-series,data-analysis",codeblock,https://stackoverflow.com/questions/37862251,"pd.to_timedelta(df.hours, unit='h') + Timestamp(base)",df.hours.apply(lambda x: base + timedelta(hours=x)),11.3,74.2
37872823,answer,37872565,"python,pandas,dataframe,reverse",codeblock,https://stackoverflow.com/questions/37872823,"df.ix[::-1, 'A'].cumsum()[::-1]",df['A'].sum()-df['A'].shift(1).fillna(0).cumsum(),0.701,19.8
37888796,answer,37888675,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37888796,df.iloc[np.flatnonzero(df['strings'].str.contains('A'))[0]:],df.loc[df['strings'].str.contains('A').cumsum().astype(bool)],0.299,0.516
37888796,answer,37888675,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37888796,df.iloc[df['strings'].tolist().index(test_string):],df.loc[df['strings'].str.contains('A').cumsum().astype(bool)],0.095,0.516
37888796,answer,37888675,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37888796,df.iloc[df['strings'].tolist().index(test_string):],df.iloc[np.flatnonzero(df['strings'].str.contains('A'))[0]:],0.095,0.299
37888821,answer,37888675,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37888821,df.iloc[np.flatnonzero(df['col'].str.contains(r'XX'))[0]:],df.loc[df['col'].str.contains(r'XX').cumsum().astype(bool)],43.5,46
37894837,answer,37894807,"python,dictionary,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37894837,df1.Name.map(df2.set_index('Player')['Gender']),"(pd.merge(df1,df2, left_on='Name', right_on='Player').rename(columns={'Gender':'sex'}).drop('Player', axis=1))",0.882,2.53
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df.STRING.str.replace(r'\D+', '').astype(int)","df.STRING.apply(lambda x: int(''.join(filter(str.isdigit, x))))",507,562
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df.STRING.str.extract('(?P<NUMBER>\d+)', expand=True).astype(int)","df.STRING.str.replace(r'\D+', '').astype(int)",434,507
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df.STRING.str.extract('(?P<NUMBER>\d+)', expand=True).astype(int)","df.STRING.apply(lambda x: int(''.join(filter(str.isdigit, x))))",434,562
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df.STRING.str.extract('(?P<NUMBER>\d+)', expand=True).astype(int)","df['STRING'].apply(lambda x: re.sub(r'[^0-9]','',x))",434,552
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df['STRING'].apply(lambda x: re.sub(r'[^0-9]','',x))","df.STRING.apply(lambda x: int(''.join(filter(str.isdigit, x))))",552,562
37897515,answer,37897125,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37897515,"df.STRING.str.replace(r'\D+', '').astype(int)","df['STRING'].apply(lambda x: re.sub(r'[^0-9]','',x))",507,552
37898273,answer,37897894,"python,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/37898273,"X[np.ix_(a,b)]","X[a,:][:,b]",1.24,1.74
37921823,answer,37921703,"python,pandas,machine-learning",codeblock,https://stackoverflow.com/questions/37921823,"df.dropna(thresh=0.8*len(df), axis=1)","df.loc[:, pd.notnull(df).sum()>len(df)*.8]",0.537,0.716
37925789,answer,21022542,"python,numpy",codeblock,https://stackoverflow.com/questions/37925789,"b = np.delete(a, indices, axis=0)","c = a[np.setdiff1d(np.arange(100),indices),:]",0.0247,0.0484
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,(pd.Series([[y[0] for y in x.split()] for x in s])),(s.str.split().map(lambda lst : [string[0] for string  in lst])),28.8,50.4
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,(s.str.split().map(lambda lst : [string[0] for string  in lst])),(s.str.split().apply(lambda lst: [list(elt)[0] for elt in lst])),50.4,76.1
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,pd.Series([[y[0] for y in x.split()] for x in s.tolist()]),(pd.Series([[y[0] for y in x.split()] for x in s])),28.6,28.8
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,pd.Series([[y[0] for y in x.split()] for x in s.tolist()]),(s.str.split().apply(lambda lst: [list(elt)[0] for elt in lst])),28.6,76.1
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,(pd.Series([[y[0] for y in x.split()] for x in s])),(s.str.split().apply(lambda lst: [list(elt)[0] for elt in lst])),28.8,76.1
37936260,answer,37935729,"python,string,pandas,dataframe,character",codeblock,https://stackoverflow.com/questions/37936260,pd.Series([[y[0] for y in x.split()] for x in s.tolist()]),(s.str.split().map(lambda lst : [string[0] for string  in lst])),28.6,50.4
37997284,answer,37997127,"python,performance,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/37997284,t = np.sqrt((df['x'] - df['avg_x'])**2 + (df['y'] - df['avg_y'])**2),"t = df.apply(lambda row: math.sqrt((row.x - row.avg_x)**2 + (row.y - row.avg_y)**2),axis=1)",0.28,40.5
38018104,answer,38017972,"python,pandas,apply",codeblock,https://stackoverflow.com/questions/38018104,df.add(df.columns.map(int)),df.apply(lambda x: int(x.name) + x),7.95,40.7
38033487,answer,38033388,"python,pandas",codeblock,https://stackoverflow.com/questions/38033487,"np.where(np.abs(df.second_step) > 2, np.sign(df.second_step) * 2, df.second_step)",df.second_step.apply(bounded),16.4,996
38045137,answer,38044808,"python,numpy,pandas",codeblock,https://stackoverflow.com/questions/38045137,"df = pd.DataFrame(np.random.random((nrows, ncols)), columns=['Time', 'A1', 'A2', 'A3'])





using_column_based_operations(df)","df = pd.DataFrame(np.random.random((nrows, ncols)), columns=['Time', 'A1', 'A2', 'A3'])





using_loop(df)",1.91,3020
38055046,answer,38054955,"python,haskell,numpy",codeblock,https://stackoverflow.com/questions/38055046,"np.putmask(arr, arr < 4, np.nan)","np.where(arr > 3, arr, np.nan)",1.08,3.61
38055046,answer,38054955,"python,haskell,numpy",codeblock,https://stackoverflow.com/questions/38055046,arr[arr < 4] = np.nan,"np.where(arr > 3, arr, np.nan)",0.564,3.61
38055046,answer,38054955,"python,haskell,numpy",codeblock,https://stackoverflow.com/questions/38055046,arr[arr < 4] = np.nan,"np.putmask(arr, arr < 4, np.nan)",0.564,1.08
38078650,answer,38078579,"python-2.7,csv,pandas",sentence,conclusion: apply(...) is 1114 times slower compared to select_dtypes() method,select_dtypes(),apply(...),,
38078650,answer,38078579,"python-2.7,csv,pandas",codeblock,https://stackoverflow.com/questions/38078650,(df.select_dtypes(include=[object]) == 'action').sum(axis=1),"df.apply(lambda x: x.str.contains('action').sum(), axis=1)",7.08,7890
38078650,answer,38078579,"python-2.7,csv,pandas",codeblock,https://stackoverflow.com/questions/38078650,df.isin(['action']).sum(axis=1),"df.apply(lambda x: x.str.contains('action').sum(), axis=1)",22.8,7890
38078650,answer,38078579,"python-2.7,csv,pandas",codeblock,https://stackoverflow.com/questions/38078650,(df.select_dtypes(include=[object]) == 'action').sum(axis=1),df.isin(['action']).sum(axis=1),7.08,22.8
38081713,answer,38079887,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38081713,df_big['important_col'][(df_big['A']== 'A4') & (df_big['C'] == 'CA4') & (df_big['D'] == 'D4')].mean(),df_big[(df_big['A']== 'A4') & (df_big['C'] == 'CA4') & (df_big['D'] == 'D4')]['important_col'].mean(),2.46,2.91
38084031,answer,38083227,"python,arrays,numpy,pandas,indexing",codeblock,https://stackoverflow.com/questions/38084031,df.index[df.Col4.isin(target_array)],df.loc[df.Col4.isin(target_array)].index,36.7,47.8
38084031,answer,38083227,"python,arrays,numpy,pandas,indexing",codeblock,https://stackoverflow.com/questions/38084031,"df.index[np.in1d(df['Col4'],target_array)]",df.loc[df.Col4.isin(target_array)].index,35.1,47.8
38084031,answer,38083227,"python,arrays,numpy,pandas,indexing",codeblock,https://stackoverflow.com/questions/38084031,"df.index[np.in1d(df['Col4'],target_array)]",df.index[df.Col4.isin(target_array)],35.1,36.7
38087336,answer,38086005,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/38087336,ar.T,"np.fliplr(np.rot90(ar,3))",0.000455,0.00828
38088490,answer,38088419,"python,list,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/38088490,df['C'] = df['A'] + df['B'].apply(lambda x:x[1]),"df['C'] = df['A'] + df.apply(lambda row: row['B'][1], axis = 1)",0.25,0.406
38088490,answer,38088419,"python,list,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/38088490,"df['C'] = df['A'] + df.apply(lambda row: row['B'][1], axis = 1)",df['C'] = df['A'] + pd.DataFrame(df['B'].tolist())[1],0.406,0.567
38088490,answer,38088419,"python,list,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/38088490,df['C'] = df['A'] + df['B'].apply(lambda x:x[1]),df['C'] = df['A'] + pd.DataFrame(df['B'].tolist())[1],0.25,0.567
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.string.isin(exclude_str)],df.query('@exclude_str not in string'),189,206
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.string.isin(exclude_str)],df[~df.string.isin(exclude_str)],189,189
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.query('@exclude_str not in string'),"df[~np.in1d(df.string, exclude_str)]",206,2420
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.string.isin(exclude_str)],"df[~np.in1d(df.string, exclude_str)]",189,2420
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.string.isin(exclude_str)],"df[~np.in1d(df.string, exclude_str)]",189,2420
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.float.isin(exclude_float)],df.query('@exclude_float not in float'),553,563
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.float.isin(exclude_float)],df.query('@exclude_float not in float'),514,563
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.float.isin(exclude_float)],df.ix[~df.float.isin(exclude_float)],514,553
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.float, exclude_float)]",df.query('@exclude_float not in float'),307,563
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.float, exclude_float)]",df.ix[~df.float.isin(exclude_float)],307,553
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.float, exclude_float)]",df[~df.float.isin(exclude_float)],307,514
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.int64.isin(exclude_int64)],df.query('@exclude_int64 not in int64'),212,228
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.int64.isin(exclude_int64)],df.query('@exclude_int64 not in int64'),210,228
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.query('@exclude_int64 not in int64'),"df[~np.in1d(df.int64, exclude_int64)]",228,271
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.int64.isin(exclude_int64)],"df[~np.in1d(df.int64, exclude_int64)]",212,271
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.int64.isin(exclude_int64)],"df[~np.in1d(df.int64, exclude_int64)]",210,271
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.int32.isin(exclude_int32)],df.query('@exclude_int32 not in int32'),399,415
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.int32.isin(exclude_int32)],df.query('@exclude_int32 not in int32'),414,415
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.int32.isin(exclude_int32)],df[~df.int32.isin(exclude_int32)],399,414
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.int32, exclude_int32)]",df.query('@exclude_int32 not in int32'),249,415
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.int32, exclude_int32)]",df.ix[~df.int32.isin(exclude_int32)],249,399
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,"df[~np.in1d(df.int32, exclude_int32)]",df[~df.int32.isin(exclude_int32)],249,414
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df.ix[~df.string.isin(exclude_str)],df.query('@exclude_str not in string'),189,206
38110564,answer,38109137,"python,pandas,filter,dataframe",codeblock,https://stackoverflow.com/questions/38110564,df[~df.int64.isin(exclude_int64)],df.ix[~df.int64.isin(exclude_int64)],210,212
38153693,answer,38152389,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/38153693,"df['c'] = np.where(df[""a""].isnull(), df[""b""], df[""a""] )",df['d'] = df.a.combine_first(df.b),0.291,0.472
38167809,answer,38167738,"python,pandas",codeblock,https://stackoverflow.com/questions/38167809,"pd.concat([df, pd.concat([dm] * 3, axis=1, keys=df.columns)])",df.apply(lambda S:S.append(dm)),4.75,8.7
38171625,answer,38167738,"python,pandas",codeblock,https://stackoverflow.com/questions/38171625,"pd.concat([df, pd.DataFrame(np.ones((5,3))*dm.values[:, np.newaxis], columns=df.columns,index=dm.index )   ])","dm3 = pd.DataFrame(dm.values[:, None].repeat(df.shape[1], axis=1),dm.index, df.columns);df.append(dm3)",0.535,0.536
38215101,answer,38215071,"python,pandas,vectorization,apply",codeblock,https://stackoverflow.com/questions/38215101,"np.where(mask, 'Yes', 'No')",ser.map(lambda x: 'Yes' if x > .5 else 'No'),14.8,223
38215101,answer,38215071,"python,pandas,vectorization,apply",codeblock,https://stackoverflow.com/questions/38215101,"pd.Series(np.where(mask, 'Yes', 'No'))",ser.map(lambda x: 'Yes' if x > .5 else 'No'),86.5,223
38250228,answer,38250077,"python,pandas",codeblock,https://stackoverflow.com/questions/38250228,"df[df.duplicated(subset=['pborderid', 'to_wpadr'], keep=False)]","df.groupby([""pborderid"",""to_wpadr""],sort=False).filter(lambda x: len(x) >1)",129,313
38254864,answer,33098040,"python,pandas,nltk",sentence,pandas.Series.apply is faster than pandas.DataFrame.apply,pandas.Series.apply,pandas.DataFrame.apply,,
38258390,answer,38254067,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/38258390,df1[df1['letter'] == 'ben'],df2[df2['letter'] == 'ben'],36.1,108
38258390,answer,38254067,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/38258390,df1['letter'].values == 'ben',df2['letter'].values == 'ben',24.1,96.5
38258390,answer,38254067,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/38258390,df2[df2['value'] == 0],df1[df1['value'] == 0],1.78,1.8
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum([i for i in range(100000)]),a = sum(range(100000)),16.2,19.7
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum((i for i in range(100000))),a = sum(range(100000)),9.27,19.7
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum([i for i in range(100000)]),a = sum([range(100000)]),16.2,20.2
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum((i for i in range(100000))),a = sum([i for i in range(100000)]),9.27,16.2
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum((i for i in range(100000))),a = sum([range(100000)]),9.27,20.2
38261708,answer,38261534,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/38261708,a = sum(range(100000)),a = sum([range(100000)]),19.7,20.2
38279232,answer,38278881,"python,python-3.x,numpy,ipython",codeblock,https://stackoverflow.com/questions/38279232,"x=np.arange(10000)





np.sum(x)","x=np.arange(10000)





sum(x)",0.0186,5.92
38279232,answer,38278881,"python,python-3.x,numpy,ipython",sentence,"when operating on a list, the python sum is quite fast, faster than np.sum on the same:",sum,np.sum,,
38279232,answer,38278881,"python,python-3.x,numpy,ipython",sentence,fromiter can be faster than np.array; but the builtin arange is much better.,fromiter,np.array,,
38309830,answer,38309729,"python,pandas,group-by,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/38309830,df.groupby('domain')['ID'].nunique(),df.drop_duplicates().domain.value_counts(),0.44,1.1
38309830,answer,38309729,"python,pandas,group-by,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/38309830,df.groupby('domain')['ID'].nunique(),df.drop_duplicates().groupby('domain').size(),0.44,0.939
38309830,answer,38309729,"python,pandas,group-by,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/38309830,df.drop_duplicates().groupby('domain').size(),df.drop_duplicates().domain.value_counts(),0.939,1.1
38365744,answer,38365363,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/38365744,(df.ix[df.index.difference(df.groupby('A')['B'].tail(1).index)]),"(df.groupby('A').apply(lambda x: x.iloc[:-1, :]).reset_index(0, drop=True).sort_index())",1.29,2.48
38365744,answer,38365363,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/38365744,"(df.ix[df.index.difference(df.groupby('A', as_index=False)['B'].nth(1).index)])","(df.groupby('A').apply(lambda x: x.iloc[:-1, :]).reset_index(0, drop=True).sort_index())",1.48,2.48
38365744,answer,38365363,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/38365744,(df.ix[df.index.difference(df.groupby('A')['B'].tail(1).index)]),"(df.ix[df.index.difference(df.groupby('A', as_index=False)['B'].nth(1).index)])",1.29,1.48
38421196,answer,38421170,"python,pandas,dataframe,set,row",codeblock,https://stackoverflow.com/questions/38421196,"summaryDF.index = ['A','B','C', 'D','E','F','G','H','I','J','K','L']","summaryDF.set_index(pd.Index(['A','B','C', 'D','E','F','G','H','I','J','K','L']))",0.0762,0.227
38432193,answer,38428108,"python,python-3.x,numpy,pandas,vectorization",codeblock,https://stackoverflow.com/questions/38432193,"pd.Series([set1.union(set2) for set1, set2 in zip(df['A'], df['B'])])","df.apply(lambda x: x.A.union(x.B), axis=1)",43.3,2600
38444333,answer,38444271,"python,pandas",codeblock,https://stackoverflow.com/questions/38444333,"df['C'] = df['A'].add(df['B'].shift(), fill_value=0)",df['C1'] = df['A'] + df['B'].shift(1).fillna(0),0.457,0.544
38468947,answer,38468859,"python,pandas",codeblock,https://stackoverflow.com/questions/38468947,"pd.Series(df.lookup(s.index, s.values), s.index)","pd.Series([df.at[i, s[i]] for i in s.index], s.index)",241,770
38468947,answer,38468859,"python,pandas",codeblock,https://stackoverflow.com/questions/38468947,"pd.Series(df.lookup(s.index, s.values), s.index)","pd.Series([df.ix[ind,col] for ind, col in s.iteritems()], s.index)",241,381
38468947,answer,38468859,"python,pandas",codeblock,https://stackoverflow.com/questions/38468947,"pd.Series([df.ix[ind,col] for ind, col in s.iteritems()], s.index)","pd.Series([df.at[i, s[i]] for i in s.index], s.index)",381,770
38469097,answer,38468859,"python,pandas",codeblock,https://stackoverflow.com/questions/38469097,"pd.Series([ df.ix[ind,col] for ind, col in s.iteritems()  ], s.index)","pd.Series([df.at[i, s[i]] for i in s.index], s.index)",0.0863,0.0965
38480441,answer,38480043,"python,date,csv,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38480441,"df.groupby('date')['count', 'unique'].median().round().astype(int)","df.groupby(['date'])[['count','unique']].agg({'count':'median','unique':'median'}).round().astype(int)",2.67,3.64
38483618,answer,38483570,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/38483618,"a[1:][np.diff(a[:,0])!=0,1]","a[(a[1:,0]-a[:-1,0]).nonzero()[0]+1,1]",4.51,6.31
38483618,answer,38483570,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/38483618,"a[np.append(True,np.diff(a[:,0])!=0),1]","a[np.append(0,(a[1:,0]-a[:-1,0]).nonzero()[0]+1),1]",5,6.8
38497089,answer,38496930,"python,performance,pandas,category",codeblock,https://stackoverflow.com/questions/38497089,(df.groupby(by='B')['A1'].nunique()),(df.groupby(by='B')['A2'].nunique()),19.8,20.2
38497089,answer,38496930,"python,performance,pandas,category",codeblock,https://stackoverflow.com/questions/38497089,df.groupby(by='B').agg({'A2':'nunique'}),df.groupby(by='B').agg({'A1':'nunique'}),20.1,20.1
38497089,answer,38496930,"python,performance,pandas,category",codeblock,https://stackoverflow.com/questions/38497089,df.groupby(by='B').agg(dict(A1=lambda s: s.nunique())),df.groupby(by='B').agg(dict(A2=lambda s: s.nunique())),824,3070
38505051,answer,38504885,"python,pandas",codeblock,https://stackoverflow.com/questions/38505051,"pd.concat([df[col].astype('category') for col in df], axis=1)",df.apply(lambda x: x.astype('category')),18.7,41.5
38505914,answer,38505895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38505914,(train[train['Age'].astype(int) < train['Age']]),(train[train['Age'].apply(int) < train['Age']]),0.544,11.1
38505914,answer,38505895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38505914,(train[train['Age'].astype(int) < train['Age']]),(train[train.Age > train.Age.round(0)]),0.544,1.55
38505914,answer,38505895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38505914,(train[train.Age > train.Age.round(0)]),(train[train['Age'].apply(int) < train['Age']]),1.55,11.1
38550190,answer,38549915,"python,pandas",codeblock,https://stackoverflow.com/questions/38550190,"df[0].str.cat(df.ix[:, 1:].T.values, sep=' ')","df.apply("" "".join, axis=1)",4.48,112
38551192,answer,38549915,"python,pandas",codeblock,https://stackoverflow.com/questions/38551192,"df[0].str.cat(df.ix[:, 1:].T.values, sep=' ')","df.apply("" "".join, axis=1)",138,5800
38551192,answer,38549915,"python,pandas",codeblock,https://stackoverflow.com/questions/38551192,df.add([' '] * (df.columns.size - 1) + ['']).sum(axis=1),"df.apply("" "".join, axis=1)",478,5800
38551192,answer,38549915,"python,pandas",codeblock,https://stackoverflow.com/questions/38551192,"df[0].str.cat(df.ix[:, 1:].T.values, sep=' ')",df.add([' '] * (df.columns.size - 1) + ['']).sum(axis=1),138,478
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),10100,10400
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),((df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)])),10100,10300
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,((df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)])),(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),10300,10400
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),((df[(df.filter(like='Value').abs() < 1).all(axis=1)])),10100,10300
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,((df[(df.filter(like='Value').abs() < 1).all(axis=1)])),(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),10300,10400
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,((df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)])),((df[(df.filter(like='Value').abs() < 1).all(axis=1)])),10300,10300
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)]),(df[(df.filter(like='Value').abs() < 1).all(axis=1)]),7.3,7.48
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),(df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)]),7.02,7.3
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),7.02,7.02
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),(df[(df.filter(like='Value').abs() < 1).all(axis=1)]),7.02,7.48
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(regex=r'Value').abs().lt(1).all(1)]),(df[(df.filter(like='Value').abs() < 1).all(axis=1)]),7.02,7.48
38582173,answer,38582127,"python,numpy,pandas,dataframe",codeblock,https://stackoverflow.com/questions/38582173,(df[df.filter(like='Value').abs().lt(1).all(1)]),(df[(df.filter(regex=r'Value').abs() < 1).all(axis=1)]),7.02,7.3
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df.loc[:, ['age', 'url']] = df[['age', 'url']].notnull() * 1","df[['age', 'url']] = np.where(df[['age', 'url']].isnull(), 0, 1)",1.45,2.69
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df.loc[:, ['age', 'url']] = df[['age', 'url']].notnull() * 1","df[['age', 'url']] = df[['age', 'url']].applymap(lambda x: 0 if pd.isnull(x) else 1)",1.45,11.2
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df.loc[:, ['age', 'url']] = df[['age', 'url']].notnull() * 1","df[['age', 'url']] = np.where(pd.notnull(df[['age', 'url']]), 1, 0)",1.45,2.78
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = df[['age', 'url']].notnull().astype(int)","df[['age', 'url']] = np.where(pd.notnull(df[['age', 'url']]), 1, 0)",1.01,2.78
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = df[['age', 'url']].notnull().astype(int)","df[['age', 'url']] = np.where(df[['age', 'url']].isnull(), 0, 1)",1.01,2.69
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = np.where(df[['age', 'url']].isnull(), 0, 1)","df[['age', 'url']] = np.where(pd.notnull(df[['age', 'url']]), 1, 0)",2.69,2.78
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = df[['age', 'url']].notnull().astype(int)","df[['age', 'url']] = df[['age', 'url']].applymap(lambda x: 0 if pd.isnull(x) else 1)",1.01,11.2
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = np.where(pd.notnull(df[['age', 'url']]), 1, 0)","df[['age', 'url']] = df[['age', 'url']].applymap(lambda x: 0 if pd.isnull(x) else 1)",2.78,11.2
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = np.where(df[['age', 'url']].isnull(), 0, 1)","df[['age', 'url']] = df[['age', 'url']].applymap(lambda x: 0 if pd.isnull(x) else 1)",2.69,11.2
38607447,answer,38607381,"pandas,dataframe,python-3.5",codeblock,https://stackoverflow.com/questions/38607447,"df[['age', 'url']] = df[['age', 'url']].notnull().astype(int)","df.loc[:, ['age', 'url']] = df[['age', 'url']].notnull() * 1",1.01,1.45
38608725,answer,38608652,"pandas,dataframe,compare",codeblock,https://stackoverflow.com/questions/38608725,df1['B'] = df1.A.map(df2.set_index('A')['C']),"merged = df1.merge(df2, on='A', how='left').rename(columns={'C':'B'})",6.05,12.8
38608725,answer,38608652,"pandas,dataframe,compare",codeblock,https://stackoverflow.com/questions/38608725,df1['B'] = df1.A.map(df2.set_index('A')['C']),"merged = df1.merge(df2, on='A', how='left').rename(columns={'C':'B'})",0.873,1.73
38613324,answer,38613043,"python,pandas",codeblock,https://stackoverflow.com/questions/38613324,"((pd.concat([df.A.str.contains(word,regex=False) for word in list_words.split()], axis=1)).sum(1) > 1)","((pd.concat([df.A.str.contains(word) for word in list_words.split()], axis=1)).sum(1) > 1)",8.13,16
38613324,answer,38613043,"python,pandas",codeblock,https://stackoverflow.com/questions/38613324,"df['A'].map(lambda x: check(x, list_words))","((pd.concat([df.A.str.contains(word) for word in list_words.split()], axis=1)).sum(1) > 1)",14.7,16
38613324,answer,38613043,"python,pandas",codeblock,https://stackoverflow.com/questions/38613324,"((pd.concat([df.A.str.contains(word,regex=False) for word in list_words.split()], axis=1)).sum(1) > 1)","df['A'].map(lambda x: check(x, list_words))",8.13,14.7
38613551,answer,38613517,"python,pandas,dataframe,append,multiple-columns",codeblock,https://stackoverflow.com/questions/38613551,"pd.concat([df3,pd.DataFrame(columns=myList, index=df.index,data=0)],axis=1)","pd.concat([df,pd.DataFrame(columns=myList)], axis=1).fillna(0)",81.7,1170
38619350,answer,38619143,"python,arrays,numpy,sequence,variable-length-array",codeblock,https://stackoverflow.com/questions/38619350,"np.array(list(itertools.izip_longest(*v, fillvalue=0))).T",pd.DataFrame(v).fillna(0).values.astype(np.int32),264,292
38619350,answer,38619143,"python,arrays,numpy,sequence,variable-length-array",codeblock,https://stackoverflow.com/questions/38619350,"np.array(list(itertools.izip_longest(*v, fillvalue=0))).T",pd.DataFrame(v).fillna(0).values.astype(np.int32),1.55,3.12
38619350,answer,38619143,"python,arrays,numpy,sequence,variable-length-array",codeblock,https://stackoverflow.com/questions/38619350,"np.array(list(itertools.izip_longest(*v, fillvalue=0))).T",pd.DataFrame(v).fillna(0).values.astype(np.int32),5.11,9.82
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.einsum(""ij,jkl->ikl"", a, b)","np.tensordot(a, b, axes=([1], [0]))",0.0101,0.022
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.tensordot(a, b, axes=([1], [0]))","np.einsum(""ij,jkl->ikl"", a, b)",0.198,0.868
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.tensordot(a, b, axes=([1], [0]))","(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))",0.198,0.907
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.einsum(""ij,jkl->ikl"", a, b)","(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))",0.868,0.907
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.einsum(""ij,jkl->ikl"", a, b)","(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))",164,166
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))","np.tensordot(a, b, axes=([1], [0]))",0.0111,0.022
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.tensordot(a, b, axes=([1], [0]))","(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))",21.7,166
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.tensordot(a, b, axes=([1], [0]))","np.einsum(""ij,jkl->ikl"", a, b)",21.7,164
38647553,answer,38645111,"python,numpy,matrix,scipy",codeblock,https://stackoverflow.com/questions/38647553,"np.einsum(""ij,jkl->ikl"", a, b)","(a @ b.transpose((2, 0, 1))).transpose((1, 2, 0))",0.0101,0.0111
38673007,answer,35233375,"python,pandas",codeblock,https://stackoverflow.com/questions/38673007,"df['delta_x'] = df.groupby(['l1', 'l2'])['x'].transform(lambda x: x.diff())","df['delta_x'] = df.x - df.merge(df, left_on=['t', 'l1', 'l2'], right_on=['t.1', 'l1', 'l2'],how='left',suffixes=['','.1'])['x.1']",1.55,3.33
38677336,answer,38673531,"python,arrays,numpy,floating-point,int",codeblock,https://stackoverflow.com/questions/38677336,(A*B).astype(int),"np.multiply(A, B, out=A, casting='unsafe')",0.00165,0.00201
38679861,answer,38679666,"python,arrays,performance,numpy,optimization",codeblock,https://stackoverflow.com/questions/38679861,np.array(a)[b],"np.take(a, b)",84.8,91.3
38680028,answer,38679666,"python,arrays,performance,numpy,optimization",codeblock,https://stackoverflow.com/questions/38680028,"np.take(aa, ba)","take(al, ba)",0.0514,0.254
38687313,answer,38687292,"python,numpy",codeblock,https://stackoverflow.com/questions/38687313,np.count_nonzero(arr),arr.sum(),0.00121,0.0296
38689978,answer,38689743,"python,pandas,indexing,hierarchy",codeblock,https://stackoverflow.com/questions/38689978,"x[1, 'a']",x[1]['a'],0.00846,0.274
38707213,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707213,"df.loc[df[(df['Count'] == 1)].index[0]:, :]",df[(df.Count == 1).cumsum() > 0],7.02,16.4
38707213,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707213,df[(df.Count == 1).idxmax():],df[(df.Count == 1).cumsum() > 0],3.7,16.4
38707213,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707213,df[(df.Count == 1).idxmax():],"df.loc[df[(df['Count'] == 1)].index[0]:, :]",3.7,7.02
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,"df.loc[df[(df['Count'] == 1)].index[0]:, :]",df[(df.Count == 1).cumsum() > 0],11.2,26.6
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,df[(df.Count == 1).idxmax():],"df.loc[df[(df['Count'] == 1)].index[0]:, :]",6.18,11.2
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,df[np.where(df['Count']==1)[0][0]:],df[(df.Count == 1).cumsum() > 0],2.74,26.6
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,df[np.where(df['Count']==1)[0][0]:],"df.loc[df[(df['Count'] == 1)].index[0]:, :]",2.74,11.2
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,df[(df.Count == 1).idxmax():],df[(df.Count == 1).cumsum() > 0],6.18,26.6
38707479,answer,38707165,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/38707479,df[np.where(df['Count']==1)[0][0]:],df[(df.Count == 1).idxmax():],2.74,6.18
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,pd.Series(df.T.to_dict('list')),df.T.apply(tuple).apply(list),0.685,0.958
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,"(pd.Series(df.values.tolist(), index=df.index))",df.T.apply(tuple).apply(list),0.295,0.958
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,"(pd.Series(df.values.tolist(), index=df.index))",pd.Series(df.T.to_dict('list')),2.06,203
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,"(pd.Series(df.values.tolist(), index=df.index))",df.T.apply(tuple).apply(list),2.06,506
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,pd.Series(df.T.to_dict('list')),df.T.apply(tuple).apply(list),203,506
38713387,answer,38713200,"python,list,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/38713387,"(pd.Series(df.values.tolist(), index=df.index))",pd.Series(df.T.to_dict('list')),0.295,0.685
38722705,answer,38722675,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/38722705,(df[(df['xk']  == 0) & (df['yk'] == 0)].index.tolist()),"df[(df[['xk', 'yk']] == 0).all(1)].index.tolist()",0.828,1.21
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:,'tp1':].idxmax(axis=1))","(df.ix[:,'tp1':].apply(lambda x: x.argmax(), axis=1))",5.9,237
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:,'tp1':].idxmax(axis=1))","(df.ix[:,'tp1':].replace(0,np.NaN).apply(lambda x: x.last_valid_index(), axis=1))",5.9,126
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:,'tp1':].idxmax(axis=1))","(df.ix[:, 'tp1':].cumsum(axis=1).idxmax(axis=1))",5.9,6.71
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:,'tp1':].replace(0,np.NaN).apply(lambda x: x.last_valid_index(), axis=1))","(df.ix[:,'tp1':].apply(lambda x: x.argmax(), axis=1))",126,237
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:, 'tp1':].cumsum(axis=1).idxmax(axis=1))","(df.ix[:,'tp1':].apply(lambda x: x.argmax(), axis=1))",6.71,237
38762500,answer,38762290,"python,pandas,dataframe,max,cumsum",codeblock,https://stackoverflow.com/questions/38762500,"(df.ix[:, 'tp1':].cumsum(axis=1).idxmax(axis=1))","(df.ix[:,'tp1':].replace(0,np.NaN).apply(lambda x: x.last_valid_index(), axis=1))",6.71,126
38764482,answer,38764425,"python,pandas,indexing,dataframe",codeblock,https://stackoverflow.com/questions/38764482,"(SHIGH.divide(SHIGH.index.values, axis = 0))","(SHIGH.divide(SHIGH.index.to_series(), axis = 0))",14.8,14.9
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))",1.33,3.77
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"pd.crosstab(df['Id'], df['Category'])",514,822
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"pd.crosstab(df['Id'], df['Category'])",1.73,5.46
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,"(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))","pd.crosstab(df['Id'], df['Category'])",4.64,5.46
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))",1.73,4.64
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,"(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))","pd.crosstab(df['Id'], df['Category'])",3.77,4.82
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,"pd.crosstab(df['Id'], df['Category'])","(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))",822,907
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"(df.pivot_table(index='Id', columns='Category', aggfunc=len, fill_value=0))",514,907
38822035,answer,38821985,"python,pandas,dataframe,pivot-table,crosstab",codeblock,https://stackoverflow.com/questions/38822035,df.groupby(df.columns.tolist()).size().unstack().fillna(0),"pd.crosstab(df['Id'], df['Category'])",1.33,4.82
38832514,answer,38832486,"python,date,pandas",codeblock,https://stackoverflow.com/questions/38832514,"(y['Datediff'] / np.timedelta64(1, 'D')).astype(int)",y['Datediff'].dt.days,0.789,15.3
38833040,answer,38832968,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/38833040,"(df['month'].map({'January':'01','February':'02','December':'12'}))","(pd.to_datetime(df['month'], format='%B').dt.month.astype(str).str.zfill(2))",0.462,13.5
38834945,answer,38834788,"python,pandas,dataframe,duplicates",codeblock,https://stackoverflow.com/questions/38834945,"df['State']=np.where(df['Name'].duplicated(keep=False),np.nan,df['State'])","df.loc[df.duplicated(subset=['ID'], keep=False), 'State'] = None",0.657,2.32
38842702,answer,38840319,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/38842702,pd.Series(a.tolist()),pd.Series(list(a)),261,301
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"{tuple(item) for item in data.reshape(-1,3).tolist()}","{tuple(item.tolist()) for item in data.reshape(-1,3)}",0.0577,0.1
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"data.reshape(-1,3).tolist()","{tuple(item) for item in data.reshape(-1,3).tolist()}",0.0198,0.0577
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"data.reshape(-1,3).tolist()","{tuple(item.tolist()) for item in data.reshape(-1,3)}",0.0198,0.1
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"{tuple(item.tolist()) for item in data.reshape(-1,3)}","{tuple(item) for item in data.reshape(-1,3)}",0.1,0.239
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"data.reshape(-1,3).tolist()","{tuple(item) for item in data.reshape(-1,3)}",0.0198,0.239
38843039,answer,38840641,"python,arrays,python-2.7,numpy,set",codeblock,https://stackoverflow.com/questions/38843039,"{tuple(item) for item in data.reshape(-1,3).tolist()}","{tuple(item) for item in data.reshape(-1,3)}",0.0577,0.239
38892408,answer,38892353,"python,sorting,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/38892408,"df[['column_01','column_02']] = pd.DataFrame(np.sort(df[['column_01','column_02']].values), index=df.index, columns=['column_01','column_02'])","df[['column_01','column_02']] = np.sort(df[['column_01','column_02']].values)",1.36,1.54
38892408,answer,38892353,"python,sorting,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/38892408,"df[['column_01','column_02']] = pd.DataFrame(np.sort(df[['column_01','column_02']].values), index=df.index, columns=['column_01','column_02'])","df[['column_01','column_02']] = (df[['column_01','column_02']].apply(lambda x: sorted(x.values), axis=1))",1.36,291
38892408,answer,38892353,"python,sorting,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/38892408,"df[['column_01','column_02']] = np.sort(df[['column_01','column_02']].values)","df[['column_01','column_02']] = (df[['column_01','column_02']].apply(lambda x: sorted(x.values), axis=1))",1.54,291
38896116,answer,38895856,"python,list,pandas,merge,unique",codeblock,https://stackoverflow.com/questions/38896116,"(pd.Series(sum(df.val.tolist(),[])).unique().tolist())",(df['val'].apply(pd.Series).stack().unique()).tolist(),31.9,410
38896116,answer,38895856,"python,list,pandas,merge,unique",codeblock,https://stackoverflow.com/questions/38896116,np.unique(np.hstack(df.val)).tolist(),(df['val'].apply(pd.Series).stack().unique()).tolist(),10.7,410
38896116,answer,38895856,"python,list,pandas,merge,unique",codeblock,https://stackoverflow.com/questions/38896116,np.unique(np.hstack(df.val)).tolist(),"(pd.Series(sum(df.val.tolist(),[])).unique().tolist())",10.7,31.9
38903431,answer,38901563,"python,pandas,swap",codeblock,https://stackoverflow.com/questions/38903431,"df[""Col3""], df[""Col2""] = np.where(df['Col3'].isnull(), [df[""Col2""], df[""Col3""]], [df[""Col3""], df[""Col2""] ])","df.loc[df['Col3'].isnull(), ['Col2', 'Col3']] = df.loc[df['Col3'].isnull(), ['Col3', 'Col2']].values",0.592,2.68
38915411,answer,38915186,"python,pandas,dataframe,group-by,timedelta",codeblock,https://stackoverflow.com/questions/38915411,(df.groupby('ID')['used_at'].apply(lambda g: g.iloc[0] - g.iloc[-1]).dt.seconds),"(df.groupby('ID').agg(['first','last']).apply( lambda r: r['used_at','first'] - r['used_at','last'], axis=1).dt.seconds)",1.53,14.4
38920899,answer,38920257,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/38920899,"pd.DataFrame(x.sum().values[np.newaxis,:].repeat(len(x.index), axis=0),columns=x.columns, index=x.index)","(pd.DataFrame(np.tile(x.sum().values, (len(x.index),1)), columns=x.columns, index=x.index))",0.184,0.192
38920899,answer,38920257,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/38920899,"pd.DataFrame(x.sum().values[np.newaxis,:].repeat(len(x.index), axis=0),columns=x.columns, index=x.index)",df = pd.DataFrame([x.sum()] * len(x)),0.184,0.786
38920899,answer,38920257,"python,pandas,lambda",codeblock,https://stackoverflow.com/questions/38920899,"(pd.DataFrame(np.tile(x.sum().values, (len(x.index),1)), columns=x.columns, index=x.index))",df = pd.DataFrame([x.sum()] * len(x)),0.192,0.786
38925156,answer,38925082,"python,pandas",codeblock,https://stackoverflow.com/questions/38925156,"np.where(df['age'] <= 9, 'child', df['sex'])","df.apply(lambda x: 'child' if x['age'] <= 9 else x['sex'], axis=1)",1.26,3.92
38925156,answer,38925082,"python,pandas",codeblock,https://stackoverflow.com/questions/38925156,"df['sex'].where(df['age'] > 9, 'child')","df.apply(lambda x: 'child' if x['age'] <= 9 else x['sex'], axis=1)",3.25,3.92
38925156,answer,38925082,"python,pandas",codeblock,https://stackoverflow.com/questions/38925156,"np.where(df['age'] <= 9, 'child', df['sex'])","df['sex'].where(df['age'] > 9, 'child')",1.26,3.25
38946645,answer,38943055,"python,scipy,correlation",sentence,using cdist is much faster than calling pearsonr in a nested loop.,cdist,pearsonr,,
38961561,answer,38960514,"python,pandas",codeblock,https://stackoverflow.com/questions/38961561,pd.to_timedelta(df['time']),df['time'].apply(pd.Timedelta),891,7150
38965036,answer,38957036,"python,pandas",codeblock,https://stackoverflow.com/questions/38965036,"df.groupby(['A','B']).tail(2).groupby(['A','B']).head(1)","(df.groupby(['A', 'B'], as_index=False).apply(lambda x: x if len(x)==1 else x.iloc[[-2]]).reset_index(level=0, drop=True))",1.7,17.9
38971477,answer,38970767,"python,performance,pandas",sentence,"moreover, it is faster to build the dataframe with one call to pd.DataFrame than many calls to newdf.loc[index] = new_row in a loop.",pd.DataFrame,newdf.loc[index] = new_row,,
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"pd.DataFrame(np.logical_and(df.values, ser.values[:, None]), columns=df.columns, index=df.index)","pd.DataFrame(df.values * ser.values[:,None], columns=df.columns, index=df.index)",0.0934,0.0944
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"pd.DataFrame(np.logical_and(df.values, ser.values[:, None]), columns=df.columns, index=df.index)","df.mul(ser, axis=0)",0.0934,0.166
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"df.mul(ser, axis=0)",df.apply(lambda x: x & ser),0.166,135
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"pd.DataFrame(df.values * ser.values[:,None], columns=df.columns, index=df.index)",df.apply(lambda x: x & ser),0.0944,135
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"pd.DataFrame(df.values * ser.values[:,None], columns=df.columns, index=df.index)","df.mul(ser, axis=0)",0.0944,0.166
38974330,answer,38972934,"python,pandas",codeblock,https://stackoverflow.com/questions/38974330,"pd.DataFrame(np.logical_and(df.values, ser.values[:, None]), columns=df.columns, index=df.index)",df.apply(lambda x: x & ser),0.0934,135
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",5.6,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),((aa>0.5) & (bb>0.5)).astype(np.uint8),5.6,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)",5.6,5.61
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')",((aa>0.5) & (bb>0.5)).astype('uint8'),5.61,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')","np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.61,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')",((aa>0.5) & (bb>0.5)).astype(np.int8),5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')","np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')",((aa>0.5) & (bb>0.5)).astype(np.uint8),5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('uint8')",((aa>0.5) & (bb>0.5)).astype('uint8'),5.63,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),((aa>0.5) & (bb>0.5)).astype(np.int8),5.6,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),((aa>0.5) & (bb>0.5)).astype('uint8'),5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",((aa>0.5) & (bb>0.5)).astype('uint8'),5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),((aa>0.5) & (bb>0.5)).astype('uint8'),5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)",((aa>0.5) & (bb>0.5)).astype('uint8'),5.61,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),"np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)","np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.logical_and(aa>0.5, bb>0.5).astype('int8')",5.61,5.61
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.6,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.where((aa>0.5) & (bb>0.5),1,0)",5.6,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.logical_and(aa>0.5, bb>0.5).astype('int8')",5.6,5.61
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(int)","np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",9.16,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(int)","np.where((aa>0.5) & (bb>0.5),1,0)",9.16,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)",((aa>0.5) & (bb>0.5)).astype(int),5.61,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),((aa>0.5) & (bb>0.5)).astype(int),5.62,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",((aa>0.5) & (bb>0.5)).astype(int),5.62,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),((aa>0.5) & (bb>0.5)).astype(int),5.62,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('uint8')",((aa>0.5) & (bb>0.5)).astype(int),5.63,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('uint8'),((aa>0.5) & (bb>0.5)).astype(int),5.63,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.logical_and(aa>0.5, bb>0.5).astype(int)",5.6,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')",((aa>0.5) & (bb>0.5)).astype(int),5.61,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(int),"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",9.13,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(int),"np.where((aa>0.5) & (bb>0.5),1,0)",9.13,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(int),"np.logical_and(aa>0.5, bb>0.5).astype(int)",9.13,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),((aa>0.5) & (bb>0.5)).astype(np.int8),5.62,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)",((aa>0.5) & (bb>0.5)).astype(np.int8),5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",5.62,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)",((aa>0.5) & (bb>0.5)).astype(np.uint8),5.61,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),((aa>0.5) & (bb>0.5)).astype(int),5.6,9.13
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')","np.logical_and(aa>0.5, bb>0.5).astype(int)",5.61,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('uint8'),"np.logical_and(aa>0.5, bb>0.5).astype(int)",5.63,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('uint8')","np.logical_and(aa>0.5, bb>0.5).astype(int)",5.63,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.61,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)","np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('uint8')","np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.63,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('uint8'),"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.63,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')","np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.61,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)",5.6,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.where((aa>0.5) & (bb>0.5),1,0)",5.61,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),"np.where((aa>0.5) & (bb>0.5),1,0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)","np.where((aa>0.5) & (bb>0.5),1,0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),"np.where((aa>0.5) & (bb>0.5),1,0)",5.62,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('uint8')","np.where((aa>0.5) & (bb>0.5),1,0)",5.63,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('uint8'),"np.where((aa>0.5) & (bb>0.5),1,0)",5.63,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype('int8')","np.where((aa>0.5) & (bb>0.5),1,0)",5.61,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.where(np.logical_and(aa>0.5, bb>0.5), 1, 0)","np.where((aa>0.5) & (bb>0.5),1,0)",10.4,10.4
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.logical_and(aa>0.5, bb>0.5).astype(int)",5.61,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)","np.logical_and(aa>0.5, bb>0.5).astype(int)",5.62,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.int8),"np.logical_and(aa>0.5, bb>0.5).astype(int)",5.62,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype('int8'),((aa>0.5) & (bb>0.5)).astype('uint8'),5.6,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),"np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.62,5.63
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,((aa>0.5) & (bb>0.5)).astype(np.uint8),"np.logical_and(aa>0.5, bb>0.5).astype(int)",5.62,9.16
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.int8)",((aa>0.5) & (bb>0.5)).astype(np.int8),5.62,5.62
38988035,answer,38943403,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/38988035,"np.logical_and(aa>0.5, bb>0.5).astype(np.uint8)","np.logical_and(aa>0.5, bb>0.5).astype('uint8')",5.61,5.63
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"a.max(axis=1, skipna=True)","(a.apply(f, axis=1))",2.84,2180
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"a.max(axis=1, skipna=True)","(pd.Series(np.where(a.notnull().any(1), a.sum(1), np.nan)))",2.84,3.18
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"(np.max(a, axis=1))","a.max(axis=1, skipna=True)",2.83,2.84
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"(np.max(a, axis=1))","(a.apply(f, axis=1))",2.83,2180
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"(pd.Series(np.where(a.notnull().any(1), a.sum(1), np.nan)))","(a.apply(f, axis=1))",3.18,2180
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,(a.max(axis=1)),"a.max(axis=1, skipna=True)",2.81,2.84
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,(a.max(axis=1)),"(a.apply(f, axis=1))",2.81,2180
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,(a.max(axis=1)),"(pd.Series(np.where(a.notnull().any(1), a.sum(1), np.nan)))",2.81,3.18
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,(a.max(axis=1)),"(np.max(a, axis=1))",2.81,2.83
39011358,answer,39011192,"python,pandas,dataframe,nan,series",codeblock,https://stackoverflow.com/questions/39011358,"(np.max(a, axis=1))","(pd.Series(np.where(a.notnull().any(1), a.sum(1), np.nan)))",2.83,3.18
39011812,answer,39009986,"python,performance,numpy",sentence,"for a product of 2 2d arrays, np.dot is faster than einsum.",np.dot,einsum,,
39042910,answer,39042214,"python,arrays,string,numpy,slice",codeblock,https://stackoverflow.com/questions/39042910,"np.frompyfunc(lambda x:x[1:3],1,1)(a)","np.frompyfunc(lambda x:x[1:3],1,1)(a).astype('U2')",141,170
39042910,answer,39042214,"python,arrays,string,numpy,slice",codeblock,https://stackoverflow.com/questions/39042910,"a.view('U1').reshape(len(a),-1)[:,1:3].astype(object).sum(axis=1)","np.frompyfunc(lambda x:x[1:3],1,1)(a)",60.7,141
39042910,answer,39042214,"python,arrays,string,numpy,slice",codeblock,https://stackoverflow.com/questions/39042910,"a.view('U1').reshape(len(a),-1)[:,1:3].astype(object).sum(axis=1)","np.frompyfunc(lambda x:x[1:3],1,1)(a).astype('U2')",60.7,170
39045337,answer,39042214,"python,arrays,string,numpy,slice",codeblock,https://stackoverflow.com/questions/39045337,"np.frompyfunc(lambda x:x[1:3],1,1)(a)",np.array([i[1:3] for i in a]),11.6,12.1
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p[:,cols].shape","p.take(cols,axis=1).shape",0.649,0.739
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p.take(cols,axis=1).shape","p[rows][:,cols].shape",0.739,2.78
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p[rows[:,None],cols].shape","p[rows][:,cols].shape",1.43,2.78
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p[:,cols].shape","p[rows][:,cols].shape",0.649,2.78
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p.take(cols,axis=1).shape","p[rows[:,None],cols].shape",0.739,1.43
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,np.asarray(operator.itemgetter(*cols)(p.T)).T.shape,np.array([p.T[c] for c in cols]).T.shape,0.738,0.748
39046433,answer,39045976,"python,numpy,optimization,slice",codeblock,https://stackoverflow.com/questions/39046433,"p[:,cols].shape","p[rows[:,None],cols].shape",0.649,1.43
39050811,answer,39050318,"python,pandas,dataframe,pivot-table,data-munging",codeblock,https://stackoverflow.com/questions/39050811,"['{}_{}'.format(x,y) for x,y in zip(df.columns.get_level_values(0),df.columns.get_level_values(1))]",df.columns.to_series().str.join('_'),0.131,0.452
39050811,answer,39050318,"python,pandas,dataframe,pivot-table,data-munging",codeblock,https://stackoverflow.com/questions/39050811,['_'.join(col) for col in df.columns],df.columns.to_series().str.join('_'),0.00405,0.452
39050811,answer,39050318,"python,pandas,dataframe,pivot-table,data-munging",codeblock,https://stackoverflow.com/questions/39050811,['_'.join(col) for col in df.columns],"['{}_{}'.format(x,y) for x,y in zip(df.columns.get_level_values(0),df.columns.get_level_values(1))]",0.00405,0.131
39058941,answer,39054539,"python,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/39058941,"np.amax(C, axis=1)","np.amax(F,axis=1)",70.4,168
39058941,answer,39054539,"python,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/39058941,C.sum(axis=0),F.sum(axis=0),101,149
39058941,answer,39054539,"python,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/39058941,F.sum(axis=1),C.sum(axis=1),102,149
39058941,answer,39054539,"python,numpy,multidimensional-array,scipy",codeblock,https://stackoverflow.com/questions/39058941,"np.amax(F,axis=0)","np.amax(C, axis=0)",72,173
39087209,answer,39087136,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/39087209,np.vstack(tup1).T,np.transpose(tup1),0.0141,0.0159
39087209,answer,39087136,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/39087209,np.column_stack(tup1),np.transpose(tup1),0.011,0.0159
39087209,answer,39087136,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/39087209,np.column_stack(tup1),np.vstack(tup1).T,0.011,0.0141
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,"df['col2'] = np.where(df.col.isin(d.keys()), df.col.map(d), 3).astype(int)","df['col3'] = df.col.map(lambda L: d.get(L, 3))",7.68,36.2
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,"df['col2'] = np.where(df.col.isin(d.keys()), df.col.map(d), 3).astype(int)","df['col1'] = np.where(df.col.isin(d.keys()), df.col.replace(d), 3)",7.68,14.3
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,df['col0'] = df.col.map(d).fillna(3).astype(int),"df['col3'] = df.col.map(lambda L: d.get(L, 3))",4.93,36.2
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,df['col0'] = df.col.map(d).fillna(3).astype(int),"df['col2'] = np.where(df.col.isin(d.keys()), df.col.map(d), 3).astype(int)",4.93,7.68
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,"df['col1'] = np.where(df.col.isin(d.keys()), df.col.replace(d), 3)","df['col3'] = df.col.map(lambda L: d.get(L, 3))",14.3,36.2
39104759,answer,39104730,"python,pandas,replace,dataframe,condition",codeblock,https://stackoverflow.com/questions/39104759,df['col0'] = df.col.map(d).fillna(3).astype(int),"df['col1'] = np.where(df.col.isin(d.keys()), df.col.replace(d), 3)",4.93,14.3
39106830,answer,39104999,"python,numpy,matrix,linear-algebra",codeblock,https://stackoverflow.com/questions/39106830,"(mat.reshape(m1,m2//m1,n1,n2//n1)*x[:,None,:,None]).reshape(m2,n2)","np.multiply(mat, np.kron(x, np.ones((n,n))))",0.0837,0.312
39128324,answer,39128145,"python,arrays,performance,numpy,graph-tool",codeblock,https://stackoverflow.com/questions/39128324,a[a != 2147483647].mean(),"np.nanmean(np.where(a == 2147483647, np.nan, a))",0.259,0.639
39132761,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132761,"(df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0))","(df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0))",12.2,12.4
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)",231,232
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)","pd.crosstab([df.id, df.group], df.term)",2300,3370
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)",1890,2270
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)",2270,2280
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","pd.crosstab([df.id, df.group], df.term)",2270,3370
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",2270,2300
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)","pd.crosstab([df.id, df.group], df.term)",2280,3370
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","pd.crosstab([df.id, df.group], df.term)",231,355
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)","pd.crosstab([df.id, df.group], df.term)",232,355
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)","pd.crosstab([df.id, df.group], df.term)",236,355
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",232,236
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",2280,2300
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)",226,231
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)",226,232
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","pd.crosstab([df.id, df.group], df.term)",226,355
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term'])['term'].size().unstack(fill_value=0)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",226,236
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","pd.crosstab([df.id, df.group], df.term)",1890,3370
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","df.groupby(['id','group','term'])['term'].size().unstack().fillna(0).astype(int)",1890,2280
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",231,236
39132838,answer,39132742,"python,pandas,dataframe,crosstab,pandas-groupby",codeblock,https://stackoverflow.com/questions/39132838,"df.groupby(['id', 'group', 'term']).size().unstack(fill_value=0)","df.pivot_table(index=['id','group'], columns='term', aggfunc='size', fill_value=0)",1890,2300
39133425,answer,39133279,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/39133425,"np.einsum('ij,j,kj->ik',L,D,L)","np.dot(np.dot(L, np.diag(D)), L.T)",1710,3870
39133425,answer,39133279,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/39133425,(L*D).dot(L.T),"np.dot(np.dot(L, np.diag(D)), L.T)",1390,3870
39133425,answer,39133279,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/39133425,(L*D).dot(L.T),"np.einsum('ij,j,kj->ik',L,D,L)",1390,1710
39138897,answer,39111347,"python,pandas,multi-index",codeblock,https://stackoverflow.com/questions/39138897,"([' '.join((str(i[0]), str(i[1]))) for i in idx])",(idx.get_level_values(0).astype(str).values + ' ' + idx.get_level_values(1).astype(str).values),0.00962,0.215
39152098,answer,39151545,"python,pandas,binary,int",codeblock,https://stackoverflow.com/questions/39152098,df.astype(object),df.applymap(lambda x: int(x) if pd.notnull(x) else x).astype(object),113,7860
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,"(df[(df[[ u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])",(df[(df.set_index('car') == 'yes').all(1).values]),1.53,1.64
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,"(df[(df[[ u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])",(df[(df.dvd == 'yes')&(df.sunroof == 'yes')&(df.warranty == 'yes')]),1.53,2.09
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,(df[(df.set_index('car') == 'yes').all(1).values]),(df[(df.dvd == 'yes')&(df.sunroof == 'yes')&(df.warranty == 'yes')]),1.64,2.09
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,"(df[(df.ix[:, [u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])","(df[(df[[ u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])",1.51,1.53
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,"(df[(df.ix[:, [u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])",(df[(df.set_index('car') == 'yes').all(1).values]),1.51,1.64
39241195,answer,39240820,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39241195,"(df[(df.ix[:, [u'dvd', u'sunroof', u'warranty']] == ""yes"").all(axis=1)])",(df[(df.dvd == 'yes')&(df.sunroof == 'yes')&(df.warranty == 'yes')]),1.51,2.09
39263575,answer,39263536,"python,pandas,dataframe,multiple-columns,nan",codeblock,https://stackoverflow.com/questions/39263575,(df[df.Killed.isnull()].groupby('Type')['Killed'].size().reset_index(name='Sum(isnull)')),"(df.ix[df.Killed.isnull(), 'Type'].value_counts().reset_index(name='Sum(isnull)'))",2.02,5.36
39276392,answer,39276293,"python,function,pandas,grouping",codeblock,https://stackoverflow.com/questions/39276392,df['v'] - df.groupby('type')['v'].transform('mean'),"df.groupby(""type"")['v'].apply(lambda x: x-x.mean())",0.922,2.95
39293567,answer,39291499,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39293567,big['bar'].astype(str)+'_'+big['foo']+'_'+big['new'],"big.apply(lambda x:'%s_%s_%s' % (x['bar'],x['foo'],x['new']),axis=1)",44.2,881
39293567,answer,39291499,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39293567,"big.ix[:, :-1].astype(str).add('_').sum(axis=1).str.cat(big.new)",big.astype(str).add('_').sum(axis=1).str[:-1],72.2,82.3
39309371,answer,39308835,"python,arrays,numpy,multidimensional-array,vectorization",codeblock,https://stackoverflow.com/questions/39309371,"np.log(A/np.power(np.sum(A,2,keepdims=True),1/3))","np.apply_along_axis(chromaticity, 2, A)",90.8,9680
39354739,answer,39354531,"python,pandas,vector",codeblock,https://stackoverflow.com/questions/39354739,pd.Series([' '.join(sorted(sentence.split())) for sentence in s.tolist()]),s.str.split().apply(sorted).str.join(' '),1950,2710
39368586,answer,39357882,"python,sql,pandas",codeblock,https://stackoverflow.com/questions/39368586,df['Rank2'] = pd.factorize(df.Year)[0] + 1,df['Rank'] = df.Year.rank(method='dense').astype(int),0.737,1.55
39368586,answer,39357882,"python,sql,pandas",codeblock,https://stackoverflow.com/questions/39368586,df['Rank1'] = df.Year.astype('category').cat.codes + 1,df['Rank'] = df.Year.rank(method='dense').astype(int),1.22,1.55
39368586,answer,39357882,"python,sql,pandas",codeblock,https://stackoverflow.com/questions/39368586,df['Rank2'] = pd.factorize(df.Year)[0] + 1,df['Rank1'] = df.Year.astype('category').cat.codes + 1,0.737,1.22
39439067,answer,39439054,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/39439067,(df.columns.get_loc('z')),(df.columns.searchsorted('z')),0.00199,0.00448
39445186,answer,39445111,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/39445186,df['D2']=df['A'].mul(0.5)+df['B'].mul(0.3)+df['C'].mul(0.2),"df['D']=df.apply(lambda row: 0.5*row['A']+0.3*row['B']+0.2*row['C'], axis=1)",0.95,928
39445186,answer,39445111,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/39445186,df['D2']=df['A'].mul(0.5)+df['B'].mul(0.3)+df['C'].mul(0.2),"df['D']=df.apply(lambda row: 0.5*row['A']+0.3*row['B']+0.2*row['C'], axis=1)",34.8,47300
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,"big.ix[:, 'n2'] = big.x.apply(str) + big.y","big.loc[:, 'n3'] = big.x.apply(str) + big.y",317,333
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,"big.insert(len(big.columns), 'n4', big.x.apply(str) + big.y)","big.ix[:, 'n2'] = big.x.apply(str) + big.y",266,317
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,"big.insert(len(big.columns), 'n4', big.x.apply(str) + big.y)","big.loc[:, 'n3'] = big.x.apply(str) + big.y",266,333
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,"big.insert(len(big.columns), 'n4', big.x.apply(str) + big.y)",big['n1'] = big.x.apply(str) + big.y,266,266
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,big['n1'] = big.x.apply(str) + big.y,"big.loc[:, 'n3'] = big.x.apply(str) + big.y",266,333
39456621,answer,39454471,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39456621,big['n1'] = big.x.apply(str) + big.y,"big.ix[:, 'n2'] = big.x.apply(str) + big.y",266,317
39476537,answer,39476430,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/39476537,np.nonzero((a[1:] - a[:-1]) == 1)[0] + 1,np.where(np.diff(a)==1)[0] + 1,1460,1640
39477357,answer,39477328,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39477357,(df1[~df1['col2'].isin(df2['col1'])]),(df1.query('col2 not in @df2.col1')),0.466,1.57
39477421,answer,39477328,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39477421,(df1[~df1['col2'].isin(df2['col1'])]),(df1.query('col2 not in @df2.col1')),5560,5960
39482794,answer,39479228,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/39482794,"np.tensordot(As,Ms,axes=(0,0))","np.einsum('i,ijk->jk', As, Ms)",2.79,5.03
39482794,answer,39479228,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/39482794,"np.einsum('i,ijk->jk', As, Ms)","np.sum(As[:, np.newaxis, np.newaxis] * Ms, axis=0)",5.03,14.8
39482794,answer,39479228,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/39482794,"np.tensordot(As,Ms,axes=(0,0))","np.sum(As[:, np.newaxis, np.newaxis] * Ms, axis=0)",2.79,14.8
39482794,answer,39479228,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/39482794,"np.einsum('i,ijk->jk', As, Ms)","np.sum(As[:, np.newaxis, np.newaxis] * Ms, axis=0)",0.00244,0.00858
39494321,answer,39494152,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39494321,dfA['value'] = dfA['name'].map(dfB.set_index('name')['value']),dfB.set_index('name').loc[dfA.name].reset_index(),1650,2270
39494321,answer,39494152,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39494321,dfB.set_index('name').ix[dfA.name].reset_index(),dfB.set_index('name').loc[dfA.name].reset_index(),1660,2270
39494321,answer,39494152,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39494321,dfA['value'] = dfA['name'].map(dfB.set_index('name')['value']),dfB.set_index('name').ix[dfA.name].reset_index(),1650,1660
39512200,answer,39512002,"python,pandas,type-conversion,uppercase,lowercase",codeblock,https://stackoverflow.com/questions/39512200,"pd.concat([df[col].astype(str).str.upper() for col in df.columns], axis=1)",df.apply(lambda x: x.astype(str).str.upper()),3.32,3.32
39512200,answer,39512002,"python,pandas,type-conversion,uppercase,lowercase",codeblock,https://stackoverflow.com/questions/39512200,"pd.concat([df[col].astype(str).str.upper() for col in df.columns], axis=1)",df.apply(lambda x: x.astype(str).str.upper()),104,130
39548416,answer,39548139,"python,pandas",codeblock,https://stackoverflow.com/questions/39548416,"pd.to_datetime(df['Date'], format='%m/%d/%y').dt.weekday_name",pd.to_datetime(df['Date']).dt.weekday_name,0.507,2.48
39548416,answer,39548139,"python,pandas",codeblock,https://stackoverflow.com/questions/39548416,"pd.to_datetime(large_df['Date'], format='%m/%d/%y').dt.weekday_name",pd.to_datetime(large_df['Date']).dt.weekday_name,45.9,1620
39576878,answer,39576800,"python,list,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/39576878,"pd.DataFrame.from_records(df.col.values.tolist(), columns=['colA','colB','colC','colD','colE'])","pd.DataFrame(df['col'].apply(pd.Series).values, columns=['colA','colB','colC','colD','colE'])",3.73,753
39586425,answer,39586398,"python,pandas,indexing,dataframe,condition",codeblock,https://stackoverflow.com/questions/39586425,"df1.BB = df1.BB.mask(df1.Result,df1.AA)","df1.ix[df1.Result, 'BB'] = df1.AA",0.9,1.19
39587480,answer,39587451,"python,pandas,apache-spark,pyspark,spark-dataframe",codeblock,https://stackoverflow.com/questions/39587480,df.created_at.dt.year.astype(str) + '-' + df.created_at.dt.weekofyear.astype(str),df.created_at.dt.year.astype(str) + '-' + df.created_at.dt.week.astype(str),7430,7450
39587480,answer,39587451,"python,pandas,apache-spark,pyspark,spark-dataframe",codeblock,https://stackoverflow.com/questions/39587480,df.created_at.dt.year.astype(str) + '-' + df.created_at.dt.week.astype(str),df.created_at.dt.strftime('%Y-%U'),7450,16100
39587480,answer,39587451,"python,pandas,apache-spark,pyspark,spark-dataframe",codeblock,https://stackoverflow.com/questions/39587480,df.created_at.dt.year.astype(str) + '-' + df.created_at.dt.weekofyear.astype(str),df.created_at.dt.strftime('%Y-%U'),7430,16100
39587987,answer,39587730,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39587987,df2.set_index('sym2').index.difference(df1.set_index('sym1').index).values.tolist(),"df2.ix[~df2.sym2.isin(df1.sym1), 'sym2']",123,216
39587987,answer,39587730,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39587987,df2.set_index('sym2').index.difference(df1.set_index('sym1').index).values.tolist(),df2.set_index('sym2').index.difference(df1.set_index('sym1').index).values,123,123
39587987,answer,39587730,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39587987,df2.set_index('sym2').index.difference(df1.set_index('sym1').index).values,"df2.ix[~df2.sym2.isin(df1.sym1), 'sym2']",123,216
39624046,answer,39620968,"performance,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/39624046,A.dot(np.diag(e)).dot(A.transpose()).dot(f),"np.einsum('ij,j,kj,k', A, e, A, f)",18.6,77.6
39624046,answer,39620968,"performance,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/39624046,A.dot(e*f.dot(A)),A.dot(np.diag(e)).dot(A.transpose()).dot(f),0.1,18.6
39624046,answer,39620968,"performance,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/39624046,A.dot(e*f.dot(A)),"np.einsum('ij,j,kj,k', A, e, A, f)",0.1,77.6
39631091,answer,39630653,"pandas,nan",codeblock,https://stackoverflow.com/questions/39631091,"np.where(df.CloseDelta.isnull(), 0, np.where(df.CloseDelta<0, -1, 1))",df.CloseDelta.apply(f),1.99,245
39634397,answer,39634312,"python,pandas",codeblock,https://stackoverflow.com/questions/39634397,"countryKPI.groupby(['country','indicator']).mean().squeeze().unstack().fillna(0)","countryKPI.pivot_table(index='country', columns='indicator', values='value', fill_value=0)",4.28,6.24
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.einsum('ijk,aj,ak->ai', eijk, a, b)","np.einsum('iak,ak->ai', np.einsum('ijk,aj->iak', eijk, a), b)",5.29,9
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.einsum('aik,ak->ai',np.tensordot(a,eijk,axes=([1],[1])),b)","np.einsum('ijk,aj,ak->ai', eijk, a, b)",0.838,5.29
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.tensordot(np.einsum('aj,ak->ajk',a,b),eijk,axes=([1,2],[1,2]))","np.einsum('ijk,aj,ak->ai', eijk, a, b)",0.882,5.29
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.einsum('aik,ak->ai',np.tensordot(a,eijk,axes=([1],[1])),b)","np.einsum('iak,ak->ai', np.einsum('ijk,aj->iak', eijk, a), b)",0.838,9
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.cross(a, b)","np.einsum('aik,ak->ai',np.tensordot(a,eijk,axes=([1],[1])),b)",0.298,0.838
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.einsum('aik,ak->ai',np.tensordot(a,eijk,axes=([1],[1])),b)","np.tensordot(np.einsum('aj,ak->ajk',a,b),eijk,axes=([1,2],[1,2]))",0.838,0.882
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.cross(a, b)","np.einsum('ijk,aj,ak->ai', eijk, a, b)",0.298,5.29
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.cross(a, b)","np.einsum('iak,ak->ai', np.einsum('ijk,aj->iak', eijk, a), b)",0.298,9
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.tensordot(np.einsum('aj,ak->ajk',a,b),eijk,axes=([1,2],[1,2]))","np.einsum('iak,ak->ai', np.einsum('ijk,aj->iak', eijk, a), b)",0.882,9
39663181,answer,39662540,"python,performance,numpy,cross-product,numpy-einsum",codeblock,https://stackoverflow.com/questions/39663181,"np.cross(a, b)","np.tensordot(np.einsum('aj,ak->ajk',a,b),eijk,axes=([1,2],[1,2]))",0.298,0.882
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,"1-np.ones(Arr.shape[0],dtype=bool)*Arr.astype(bool)","1-(Arr.col==np.arange(Arr.shape[1])[:,None]).any(axis=1)",0.334,3.9
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,"1-np.in1d(np.arange(Arr.shape[1]),Arr.col)","1-np.ones(Arr.shape[0],dtype=bool)*Arr.astype(bool)",0.323,0.334
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,"1-np.ones(Arr.shape[0],dtype=bool)*Arr.astype(bool)",(Arr!=0).sum(axis=0)==0,0.334,0.82
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,"1-np.in1d(np.arange(Arr.shape[1]),Arr.col)","1-(Arr.col==np.arange(Arr.shape[1])[:,None]).any(axis=1)",0.323,3.9
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,"1-np.in1d(np.arange(Arr.shape[1]),Arr.col)",(Arr!=0).sum(axis=0)==0,0.323,0.82
39713115,answer,39711838,"python,numpy,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/39713115,(Arr!=0).sum(axis=0)==0,"1-(Arr.col==np.arange(Arr.shape[1])[:,None]).any(axis=1)",0.82,3.9
39719208,answer,39719140,"python,arrays,numpy,binary,boolean",codeblock,https://stackoverflow.com/questions/39719208,np.flatnonzero(x[:-1] != x[1:]).mean()+0.5,np.flatnonzero(x).mean(),0.0387,0.115
39722216,answer,39721958,"python,numpy,optimization,floating-point,indices",codeblock,https://stackoverflow.com/questions/39722216,"np.take(data,(query_pos * (1/len1)).astype(int))",data[(query_pos *(1/len1)).astype(int)],0.526,0.538
39724270,answer,39724182,"python,string,pandas,condition,contains",codeblock,https://stackoverflow.com/questions/39724270,df['link'].apply(page_type),"np.where(df.link.str.contains(search),'Search', np.where(df.link.str.contains(profile),'Profile', np.where(df.link.str.contains(homepage), 'Homepage', np.where(df.link.str.contains(login),'Login','Other'))))",1.72,11.7
39750769,answer,39750590,"python,pandas,merge,group-by,sum",codeblock,https://stackoverflow.com/questions/39750769,"(pd.merge(df, df.groupby(['ref','type'])['amount'].sum().unstack().reset_index(), on='ref'))","(pd.merge(df, pd.pivot_table(df, values='amount', index=['ref'], columns=['type'], aggfunc=np.sum), left_on='ref', right_index=True))",3.4,4.99
39753963,answer,39752250,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/39753963,"np.fromfile('mytest.txt',count=-1,dtype=float,sep=' ')",np.loadtxt('mytest.txt'),0.174,0.623
39761785,answer,39761488,"python,pandas,dataframe,min,string-length",codeblock,https://stackoverflow.com/questions/39761785,"([df[col].apply(len).min() for col in ['a','b','c']])","([df[col].str.len().min() for col in ['a','b','c']])",2.63,2.88
39765337,answer,39765264,"python,pandas,indexing,condition,nan",codeblock,https://stackoverflow.com/questions/39765337,(df[df['Col1'].mod(1) > 0].dropna()),(df[df.Col1 // 1 != df.Col1].dropna()),2.58,3.04
39765337,answer,39765264,"python,pandas,indexing,condition,nan",codeblock,https://stackoverflow.com/questions/39765337,(df[df['Col1'].mod(1) > 0].dropna()),(df[(df.Col1.astype(str).str[-1] != '0') & (df.Col1.notnull())]),2.58,80.2
39765337,answer,39765264,"python,pandas,indexing,condition,nan",codeblock,https://stackoverflow.com/questions/39765337,(df[df.Col1 // 1 != df.Col1].dropna()),(df[(df.Col1.astype(str).str[-1] != '0') & (df.Col1.notnull())]),3.04,80.2
39797640,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39797640,pd.Series([[a] for a in s]),pd.Series(np.vstack(s.values).tolist()),0.393,3.2
39797640,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39797640,pd.Series([[a] for a in s]),s.apply(lambda x: [x]),0.393,0.473
39797640,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39797640,s.apply(lambda x: [x]),pd.Series(np.vstack(s.values).tolist()),0.473,3.2
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values.reshape(-1,1).tolist())","pd.Series(s.values[:,None].tolist())",0.306,0.307
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,s.apply(lambda x: [x]),pd.Series(np.vstack(s.values).tolist()),0.551,5.77
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values[:,None].tolist())",pd.Series(np.vstack(s.values).tolist()),0.307,5.77
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values.reshape(-1,1).tolist())",pd.Series(np.vstack(s.values).tolist()),0.306,5.77
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,pd.Series([[a] for a in s]),s.apply(lambda x: [x]),0.412,0.551
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values.reshape(-1,1).tolist())",pd.Series([[a] for a in s]),0.306,0.412
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values[:,None].tolist())",s.apply(lambda x: [x]),0.307,0.551
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values.reshape(-1,1).tolist())",s.apply(lambda x: [x]),0.306,0.551
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,pd.Series([[a] for a in s]),pd.Series(np.vstack(s.values).tolist()),0.412,5.77
39798234,answer,39797206,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/39798234,"pd.Series(s.values[:,None].tolist())",pd.Series([[a] for a in s]),0.307,0.412
39829090,answer,39826720,"python,pandas,dataframe,spark-dataframe,pyspark-sql",codeblock,https://stackoverflow.com/questions/39829090,"df.drop_duplicates(subset=['id','x','y']).copy()","df.groupby(['id','x','y']).first().reset_index()",0.658,2.42
39839592,answer,27989120,"python,date,numpy,pandas",codeblock,https://stackoverflow.com/questions/39839592,df['myday'] - df['myday'].dt.weekday.astype('timedelta64[D]'),"df.apply(lambda x: x['myday'] - datetime.timedelta(days=x['myday'].weekday()), axis=1)",12.3,7430
39839592,answer,27989120,"python,date,numpy,pandas",codeblock,https://stackoverflow.com/questions/39839592,df['myday'].dt.to_period('W').apply(lambda r: r.start_time),"df.apply(lambda x: x['myday'] - datetime.timedelta(days=x['myday'].weekday()), axis=1)",2380,7430
39839592,answer,27989120,"python,date,numpy,pandas",codeblock,https://stackoverflow.com/questions/39839592,df['myday'] - df['myday'].dt.weekday.astype('timedelta64[D]'),df['myday'].dt.to_period('W').apply(lambda r: r.start_time),12.3,2380
39844743,answer,39843279,"python,string,pandas,indexing,numeric",codeblock,https://stackoverflow.com/questions/39844743,"(df[pd.to_numeric(df.Col1, errors='coerce').notnull()])","(df[~df['Col1'].astype(str).str.contains(r'[ABCDEGGHIJKLMNOPQRSTUVWXYZ.]', na=False)])",22,38.8
39844743,answer,39843279,"python,string,pandas,indexing,numeric",codeblock,https://stackoverflow.com/questions/39844743,"(df[~df['Col1'].astype(str).str.contains(r'[ABCDEGGHIJKLMNOPQRSTUVWXYZ.]', na=False)])","(df.ix[df.Col1.map(lambda x: re.compile(""[a-zA-Z]+"").search(x) is None)])",38.8,57.7
39844743,answer,39843279,"python,string,pandas,indexing,numeric",codeblock,https://stackoverflow.com/questions/39844743,"(df[pd.to_numeric(df.Col1, errors='coerce').notnull()])","(df.ix[df.Col1.map(lambda x: re.compile(""[a-zA-Z]+"").search(x) is None)])",22,57.7
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df.ix[df.event_address.map(lambda x: any([True for i in urls.url.tolist() if i in x]))]),(df[df['event_address'].apply(lambda x: any([n in x for n in urls.url.tolist()] ))]),163,174
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df.ix[df.event_address.map(check_exists)]),(df[df['event_address'].apply(lambda x: any([n in x for n in urls.url.tolist()] ))]),155,174
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df.ix[df.event_address.map(check_exists)]),(df.ix[df.event_address.map(lambda x: any([True for i in urls.url.tolist() if i in x]))]),155,163
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df[df['event_address'].str.contains('|'.join(urls.url))]),(df[df['event_address'].apply(lambda x: any([n in x for n in urls.url.tolist()] ))]),12,174
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df[df['event_address'].str.contains('|'.join(urls.url))]),(df.ix[df.event_address.map(lambda x: any([True for i in urls.url.tolist() if i in x]))]),12,163
39848010,answer,39847973,"python,string,pandas,indexing,substring",codeblock,https://stackoverflow.com/questions/39848010,(df[df['event_address'].str.contains('|'.join(urls.url))]),(df.ix[df.event_address.map(check_exists)]),12,155
39896731,answer,39896395,"performance,numpy",codeblock,https://stackoverflow.com/questions/39896731,"np.einsum('ij,ji->i',np.dot(rs.T,R),rs)","np.diag(np.dot(np.dot(rs.T,R), rs))",37.2,84
39896731,answer,39896395,"performance,numpy",codeblock,https://stackoverflow.com/questions/39896731,"np.einsum('ij,kj,ki->j', rs, rs, R)","np.diag(np.dot(np.dot(rs.T,R), rs))",65.2,84
39896731,answer,39896395,"performance,numpy",codeblock,https://stackoverflow.com/questions/39896731,"np.einsum('ij,ji->i',np.dot(rs.T,R),rs)","np.einsum('ij,kj,ki->j', rs, rs, R)",37.2,65.2
39908235,answer,39906919,"python,matlab,numpy",codeblock,https://stackoverflow.com/questions/39908235,"np.take(np.take(a,perm,0),perm,1)","a[perm[:,None],perm]   # same as `np.ix_...`",1410,1880
39908235,answer,39906919,"python,matlab,numpy",codeblock,https://stackoverflow.com/questions/39908235,"np.take(np.take(a,perm,0),perm,1)","a[perm,:][:,perm]",1410,8880
39908235,answer,39906919,"python,matlab,numpy",codeblock,https://stackoverflow.com/questions/39908235,"a[perm[:,None],perm]   # same as `np.ix_...`","a[perm,:][:,perm]",1880,8880
39959302,answer,39954668,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/39959302,"pd.DataFrame({ ""A"": np.repeat(df.A.values, [len(x) for x in (chain.from_iterable(df.B))]),""B"": list(chain.from_iterable(chain.from_iterable(df.B)))})","((df['B'].apply(lambda x: pd.Series(x[0])).stack().reset_index(level=1, drop=True).to_frame('B').join(df[['A']], how='left')))",0.818,103
39963789,answer,39961210,"numpy,scipy,lapack,intel-mkl,numpy-einsum",codeblock,https://stackoverflow.com/questions/39963789,"np.einsum('ijl,jkl->ijk',a,b).shape","(a[:,:,None,None,:]@b[None,:,:,:,None])[...,0,0].shape",2000,2060
40015705,answer,40015666,"python,pandas,dataframe,pivot-table,reshape",codeblock,https://stackoverflow.com/questions/40015705,"(pd.crosstab( df.date, df.sentiment).reset_index())","(df.pivot_table(index=""date"", columns=""sentiment"", aggfunc=len, fill_value=0).reset_index())",11.3,12.2
40015705,answer,40015666,"python,pandas,dataframe,pivot-table,reshape",codeblock,https://stackoverflow.com/questions/40015705,"(df.groupby([""date"", ""sentiment""]).size().unstack(fill_value=0).reset_index())","(pd.crosstab( df.date, df.sentiment).reset_index())",6.3,11.3
40015705,answer,40015666,"python,pandas,dataframe,pivot-table,reshape",codeblock,https://stackoverflow.com/questions/40015705,"(df.groupby([""date"", ""sentiment""]).size().unstack(fill_value=0).reset_index())","(df.pivot_table(index=""date"", columns=""sentiment"", aggfunc=len, fill_value=0).reset_index())",6.3,12.2
40029176,answer,40029071,"python,python-2.7,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/40029176,"pd.Series(data['numerical_column'].values , index=data['dates'])",data.set_index('dates')['numerical_column'],0.308,1.28
40056135,answer,40055835,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40056135,"A[~((A[:,None,:] == B).all(-1)).any(1)]","A[np.all(np.any((A-B[:, None]), axis=2), axis=0)]",0.00741,0.00941
40056135,answer,40055835,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40056135,"A[~np.in1d(np.power(A, 2).sum(1), np.power(B, 2).sum(1))]","A[~np.in1d(np.diff(np.diff(np.power(A, 2))), np.diff(np.diff(np.power(B, 2))))]",0.112,0.137
40056135,answer,40055835,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40056135,"A[~np.in1d(np.power(A, 2).sum(1), np.power(B, 2).sum(1))]","A[~np.in1d(np.diff(np.diff(np.power(A, 2))), np.diff(np.diff(np.power(B, 2))))]",0.88,1.01
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.replace(['\d+', '[^1]+'], ['1', ''], regex=True).str.len()","big.apply(lambda x: len(re.sub('\D+', ' ', x).strip().split()))",1000,1180
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.apply(lambda x: len(re.sub('\D+', ' ', x).strip().split()))","big.str.replace(r'\D+', ' ').str.strip().str.split().str.len()",11700,12600
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.replace(['\d+', '[^1]+'], ['1', ''], regex=True).str.len()","big.str.replace(r'\D+', ' ').str.strip().str.split().str.len()",9980,12600
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.replace(['\d+', '[^1]+'], ['1', ''], regex=True).str.len()","big.str.replace(r'\D+', ' ').str.strip().str.split().str.len()",1000,1250
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.apply(lambda x: len(re.sub('\D+', ' ', x).strip().split()))","big.str.replace(r'\D+', ' ').str.strip().str.split().str.len()",1180,1250
40069177,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069177,"big.replace(['\d+', '[^1]+'], ['1', ''], regex=True).str.len()","big.apply(lambda x: len(re.sub('\D+', ' ', x).strip().split()))",9980,11700
40069408,answer,40069151,"python,pandas",codeblock,https://stackoverflow.com/questions/40069408,"s.apply(lambda x: len(re.sub('\D+', ' ', x).strip().split()))","s.str.replace(r'\D+', ' ').str.strip().str.split().str.len()",367,403
40069790,answer,40069694,"python,pandas",codeblock,https://stackoverflow.com/questions/40069790,df['label'].isin(value_count[value_count.values<=threshold].index),df.groupby('label')['label'].transform('count') <= threshold,7.1,11.7
40105381,answer,40104946,"python,pandas",codeblock,https://stackoverflow.com/questions/40105381,"df['date'] -  pd.to_timedelta(df['day'], unit='d')","df['date'] -  df.day.apply(lambda x: pd.Timedelta(x, unit='D'))",1.71,45.3
40125748,answer,40111730,"python,pandas,dataframe,categorical-data",codeblock,https://stackoverflow.com/questions/40125748,"(data[pd.concat([data[x[0]].eq(x[1]) for x in tmp.items()], axis=1).all(axis=1)])","(data.query(' and '.join([""{} == '{}'"".format(k,v) for k,v in tmp.items()])))",89.1,237
40125748,answer,40111730,"python,pandas,dataframe,categorical-data",codeblock,https://stackoverflow.com/questions/40125748,"(data[pd.concat([data[x[0]].eq(x[1]) for x in tmp.items()], axis=1).all(axis=1)])","(pd.merge(pd.DataFrame(tmp, index =[0]), data.reset_index()).set_index('index'))",89.1,256
40125748,answer,40111730,"python,pandas,dataframe,categorical-data",codeblock,https://stackoverflow.com/questions/40125748,"(data.query(' and '.join([""{} == '{}'"".format(k,v) for k,v in tmp.items()])))","(pd.merge(pd.DataFrame(tmp, index =[0]), data.reset_index()).set_index('index'))",237,256
40142158,answer,40142004,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/40142158,"np.einsum('i,i,j->j',a,b,b)","np.sum(np.outer(a*b, b), axis=0)",24.2,105
40142158,answer,40142004,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/40142158,"np.einsum('i,j->j',a*b,b)","np.einsum('i,i,j->j',a,b,b)",21.9,24.2
40142158,answer,40142004,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/40142158,"np.einsum('i,j->j',a*b,b)","np.sum(np.outer(a*b, b), axis=0)",21.9,105
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index, index=s ))","pd.Series(dict((v,k) for k,v in s.iteritems()))",0.106,1770
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index, index=s ))","(pd.Series(s.index.values, index=s ))",0.106,26.5
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index.values, index=s ))","(pd.Series(s.index, index=s ))",26.5,130
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index.values, index=s ))","pd.Series(dict((v,k) for k,v in s.iteritems()))",26.5,1770
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index.values, index=s ))","pd.Series(dict((v,k) for k,v in s.iteritems()))",0.102,0.146
40146518,answer,40146472,"python,pandas",codeblock,https://stackoverflow.com/questions/40146518,"(pd.Series(s.index, index=s ))","pd.Series(dict((v,k) for k,v in s.iteritems()))",130,1770
40149715,answer,40149650,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/40149715,"pd.DataFrame(np.array(features).reshape(len(features) // len(column_names), len(column_names)), columns=column_names)","pd.DataFrame(dict(zip(column_names, features)), index=[0], columns=column_names)",0.206,5.25
40149715,answer,40149650,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/40149715,"pd.DataFrame(dict(zip(column_names, features)), index=[0], columns=column_names)","pd.DataFrame([features], columns=column_names)",5.25,5.94
40149715,answer,40149650,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/40149715,"pd.DataFrame(np.array(features).reshape(len(features) // len(column_names), len(column_names)), columns=column_names)","pd.DataFrame([features], columns=column_names)",0.206,5.94
40174807,answer,40174764,"python,pandas,lambda,condition",codeblock,https://stackoverflow.com/questions/40174807,(df['TM52_fail_norm'].astype(str).apply(str_to_number)),(df.TM52_fail_norm.str.count('\d+')),518,707
40190706,answer,40190295,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40190706,"pd.merge(dates.assign(key='x'), sku.assign(key='x'), on='key').drop('key', 1)","pd.DataFrame(list(product(dates.Date, sku.SKU)), columns=['Date','SKU'])",222,667
40194405,answer,40185721,"python,pandas",codeblock,https://stackoverflow.com/questions/40194405,"t2 = pd.concat([df.VALUE, df.sort_values(by=""GROUP"", kind='mergesort').VALUE.diff()], axis=1, keys=['VALUE', 'DIFF'])[df.MASK]","t1 = pd.concat([df.VALUE, df.groupby('GROUP').VALUE.diff()], axis=1, keys=['VALUE', 'DIFF'])[df.MASK]",1240,1280
40194405,answer,40185721,"python,pandas",codeblock,https://stackoverflow.com/questions/40194405,"t2 = pd.concat([df.VALUE, df.sort_values(by=""GROUP"", kind='mergesort').VALUE.diff()], axis=1, keys=['VALUE', 'DIFF'])[df.MASK]","t1 = pd.concat([df.VALUE, df.groupby('GROUP').VALUE.diff()], axis=1, keys=['VALUE', 'DIFF'])[df.MASK]",63.1,1280
40216718,answer,40216570,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40216718,newmesh[tuple(idx.T)],"np.take(newmesh,np.ravel_multi_index(idx.T,newmesh.shape))",0.0209,0.0225
40216718,answer,40216570,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40216718,"newmesh[idx[:,0],idx[:,1],idx[:,2]]","np.take(newmesh,np.ravel_multi_index(idx.T,newmesh.shape))",0.0172,0.0225
40216718,answer,40216570,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/40216718,"newmesh[idx[:,0],idx[:,1],idx[:,2]]",newmesh[tuple(idx.T)],0.0172,0.0209
40218034,answer,40218017,"python,pandas",codeblock,https://stackoverflow.com/questions/40218034,(pd.to_datetime(df.Date).dt.month),(df.Date.apply(lambda x: x.month)),5.44,15.8
40234251,answer,40233869,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40234251,(((df_sample//10 * df_sample%10).sum(axis=1).div((df_sample//10).sum(axis=1))).fillna(0)),((((df_sample['col2']//10 * df_sample['col2']%10) + (df_sample['col3']//10 * df_sample['col3']%10) + (df_sample['col4']//10 * df_sample['col4']%10) + (df_sample['col5']//10 * df_sample['col5']%10))  / (df_sample['col2']//10 + df_sample['col3']//10 + df_sample['col4']//10 + df_sample['col5']//10)).fillna(0)),0.897,2.03
40246158,answer,40246130,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40246158,t[t.columns.intersection(col_list)],t[[col for col in col_list if col in t.columns]],52.8,103
40246158,answer,40246130,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40246158,df_[[col for col in col_list if col in df_.columns]],df_[df_.columns.intersection(col_list)],5.69,6.24
40246861,answer,40246152,"python,numpy,cython",codeblock,https://stackoverflow.com/questions/40246861,"np.einsum('ijk,i->k',bidule,betas)","np.dot(np.sum(bidule, axis=1).T, betas)",0.00405,0.0124
40246861,answer,40246152,"python,numpy,cython",codeblock,https://stackoverflow.com/questions/40246861,"np.einsum('ijk,i->k',bidule,betas)","np.dot(np.sum(bidule, axis=1).T, betas)",0.0909,0.157
40250978,answer,40246130,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40250978,df_[[col for col in col_list if col in df_.columns]],"df_.ix[:,df_.columns.isin(col_list)]",18.6,26.6
40250978,answer,40246130,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40250978,df_[df_.columns.intersection(col_list)],df_[[col for col in col_list if col in df_.columns]],12.8,18.6
40250978,answer,40246130,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40250978,df_[df_.columns.intersection(col_list)],"df_.ix[:,df_.columns.isin(col_list)]",12.8,26.6
40251483,answer,40250501,"python,arrays,numpy,type-conversion",codeblock,https://stackoverflow.com/questions/40251483,"np.array([a for a in arr[:,1]])","np.stack(arr[:,1],axis=0)",0.0186,0.0602
40251483,answer,40250501,"python,arrays,numpy,type-conversion",codeblock,https://stackoverflow.com/questions/40251483,"np.array(arr[:,1].tolist())","np.vstack(arr[:,1])",0.0115,0.0541
40295606,answer,40295468,pandas,sentence,"of the two options above, using sortlevel is a bit quicker than sort_values.",sortlevel,sort_values,,
40305820,answer,40305449,"python,pandas,quantile",codeblock,https://stackoverflow.com/questions/40305820,sx.expanding().agg(lambda x: rankdata(x)[-1]/len(x)),sx.expanding().apply(lambda x: ranking(x)),0.611,1.15
40326770,answer,40326098,"python,pandas,bigdata",codeblock,https://stackoverflow.com/questions/40326770,(100 * (df['State_born_in'] == df['State_lives_in']).sum()/len(df.index)),(100 * len(df[(df['State_born_in'] == df['State_lives_in'])].index)/len(df.index)),444,472
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,df['ColumnB'].ne(df['ColumnB'].shift().bfill()).astype(int),df['ColumnB'] == df['ColumnB'].shift(1).fillna(df['ColumnB']),38.1,99.6
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,(df.ColumnB != df.ColumnB.shift()).astype(int),df['ColumnB'] == df['ColumnB'].shift(1).fillna(df['ColumnB']),77.7,99.6
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,df['ColumnB'].ne(df['ColumnB'].shift().bfill()).astype(int),(df.ColumnB != df.ColumnB.shift()).astype(int),38.1,77.7
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,(df.ColumnB.ne(df.ColumnB.shift())).astype(int),df['ColumnB'].ne(df['ColumnB'].shift().bfill()).astype(int),19.3,38.1
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,(df.ColumnB.ne(df.ColumnB.shift())).astype(int),(df.ColumnB != df.ColumnB.shift()).astype(int),19.3,77.7
40348884,answer,40348541,"python,pandas",codeblock,https://stackoverflow.com/questions/40348884,(df.ColumnB.ne(df.ColumnB.shift())).astype(int),df['ColumnB'] == df['ColumnB'].shift(1).fillna(df['ColumnB']),19.3,99.6
40364296,answer,40363646,"python,numpy,linear-regression",codeblock,https://stackoverflow.com/questions/40364296,weights.dot(features),np.sum(weights * features),0.000649,0.00283
40369718,answer,40369581,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/40369718,"s[s.index.values.searchsorted(np.datetime64('2035-03-23'),'right')-1]","s[s.index.searchsorted('2035-03-23','right')-1]",0.0467,0.063
40386509,answer,40386175,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40386509,df['duration'].astype(int),df['duration'].apply(lambda x: int(x)),10.9,60.1
40386509,answer,40386175,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40386509,df['duration'].apply(int),df['duration'].apply(lambda x: int(x)),44.3,60.1
40386509,answer,40386175,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40386509,df['duration'].astype(int),df['duration'].apply(int),10.9,44.3
40390704,answer,40390634,"python,pandas,group-by,sum",codeblock,https://stackoverflow.com/questions/40390704,df.groupby('A')['B'].apply(lambda grp: grp.nlargest(2).sum()),df.groupby('A')['B'].nlargest(2).sum(level=0),103,147
40408599,answer,40408471,"python,pandas",codeblock,https://stackoverflow.com/questions/40408599,(df[df['Date1'].isnull() | df['Date2'].isnull()]),(df[df.filter(like='Date').isnull().any(1)]),89.3,146
40432972,answer,40432845,"python,pandas,dataframe,group-concat,pandas-groupby",codeblock,https://stackoverflow.com/questions/40432972,"df.join(df.groupby('Id').concat.apply(list).to_frame('new'), on='Id')",df.groupby('Id').apply(func),1.69,4.18
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()),"(df.sort_values(['Name','Total']).groupby('Name').head(2))",162,351
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,"(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()[['Name','Total','Category']])","(df.sort_values(['Name','Total']).groupby('Name').head(2))",161,351
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()),"(df.sort_values(['Name','Total']).groupby('Name').head(2))",19.2,27.5
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,(df.loc[df.groupby('Name')['Total'].nsmallest(2).index.get_level_values(1)]),(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()),123,162
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,"(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()[['Name','Total','Category']])",(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()),161,162
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,(df.loc[df.groupby('Name')['Total'].nsmallest(2).index.get_level_values(1)]),"(df.sort_values(['Name','Total']).groupby('Name').head(2))",123,351
40454838,answer,40454805,"python,pandas",codeblock,https://stackoverflow.com/questions/40454838,(df.loc[df.groupby('Name')['Total'].nsmallest(2).index.get_level_values(1)]),"(df.set_index('Category').groupby('Name')['Total'].nsmallest(2).reset_index()[['Name','Total','Category']])",123,161
40475008,answer,40474799,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40475008,"pd.DataFrame(np.sort(big.values, axis=1), columns=big.columns).drop_duplicates()","big.apply(np.sort, axis = 1).drop_duplicates()",3.96,2690
40475008,answer,40474799,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40475008,"big.apply(np.sort, axis = 1).drop_duplicates()","big.apply(lambda r: sorted(r), axis = 1).drop_duplicates()",2690,3040
40475008,answer,40474799,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40475008,"pd.DataFrame(np.sort(big.values, axis=1), columns=big.columns).drop_duplicates()","big.apply(lambda r: sorted(r), axis = 1).drop_duplicates()",3.96,3040
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,"pd.DataFrame(d1.values - d2.values, d1.index, ['x1-x2'])",d1.reset_index(drop=True) - d2.reset_index(drop=True),19.9,242
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,"pd.DataFrame(d1.values - d2.values, d1.index, ['x1-x2'])",d1.reset_index(drop=True).sub(d2.reset_index(drop=True)),19.9,242
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,d1 - d2.values,d1.reset_index(drop=True) - d2.reset_index(drop=True),14,242
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,d1 - d2.values,"pd.DataFrame(d1.values - d2.values, d1.index, ['x1-x2'])",3.99,4.07
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,d1 - d2.values,d1.reset_index(drop=True).sub(d2.reset_index(drop=True)),14,242
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,d1.reset_index(drop=True).sub(d2.reset_index(drop=True)),d1.reset_index(drop=True) - d2.reset_index(drop=True),242,242
40476125,answer,40476064,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40476125,d1 - d2.values,"pd.DataFrame(d1.values - d2.values, d1.index, ['x1-x2'])",14,19.9
40493359,answer,40493292,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40493359,df[[col for col in df if not df[col].nunique()==1]],"df.loc[:, ~(df == df.iloc[0]).all()]",353,3710
40493359,answer,40493292,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40493359,df[[col for col in df if not df[col].nunique()==1]],"df.loc[:, ~(df == df.iloc[0]).all()]",35.6,377
40493359,answer,40493292,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40493359,df[[col for col in df if not df[col].nunique()==1]],"df.loc[:, ~(df == df.iloc[0]).all()]",1060,11300
40524177,answer,40524086,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40524177,"(df.at[0, 'A'])","(df.loc[0, 'A'])",0.00761,0.177
40524177,answer,40524086,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40524177,"(df.get_value(0, 'A'))","(df.loc[0, 'A'])",0.00336,0.177
40524177,answer,40524086,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40524177,"(df.get_value(0, 'A'))","(df.at[0, 'A'])",0.00336,0.00761
40541845,answer,40541806,"python,python-3.x,pandas,concatenation,nonetype",codeblock,https://stackoverflow.com/questions/40541845,"(df.replace({None: np.nan, 'None': np.nan}).apply(lambda x : ''.join([y for y in x if isinstance(y, str)]), axis=1))","(df.replace({None: np.nan, 'None': np.nan}).stack().groupby(level=0).apply(' \\ '.join))",820,4620
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.groupby(['bowl', 'cookie']).size().unstack('cookie', fill_value=0)","pd.crosstab(big.bowl, big.cookie)",34.2,58
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.groupby(['bowl', 'cookie']).size().unstack('cookie', fill_value=0)","big.pivot_table(index='bowl', columns='cookie', aggfunc='size', fill_value=0)",34.2,38.4
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.pivot_table(index='bowl', columns='cookie', aggfunc='size', fill_value=0)","pd.crosstab(big.bowl, big.cookie)",333,446
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.pivot_table(index='bowl', columns='cookie', aggfunc='size', fill_value=0)","pd.crosstab(big.bowl, big.cookie)",38.4,58
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.groupby(['bowl', 'cookie']).size().unstack('cookie', fill_value=0)","pd.crosstab(big.bowl, big.cookie)",327,446
40556638,answer,40556597,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40556638,"big.groupby(['bowl', 'cookie']).size().unstack('cookie', fill_value=0)","big.pivot_table(index='bowl', columns='cookie', aggfunc='size', fill_value=0)",327,333
40578932,answer,40578781,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/40578932,"w*(1.0/w.sum(1,keepdims=1))","w/w.sum(axis=1, keepdims=True)",40,66.7
40593934,answer,40593444,"python,pandas,numpy,itertools",codeblock,https://stackoverflow.com/questions/40593934,np.arange(10000000).tolist(),[i for i in list(np.arange(10000000))],927,2180
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,((a==0) | (a==1)).all(),np.count_nonzero((a!=0) & (a!=1))==0,28,29.1
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,~((a!=0) & (a!=1)).any(),((a==0) | (a==1)).all(),27.5,28
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,a.size == np.count_nonzero((a==0) | (a==1)),np.count_nonzero((a!=0) & (a!=1))==0,28.8,28.9
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,a.size == np.count_nonzero((a==0) | (a==1)),~((a!=0) & (a!=1)).any(),28.8,29.3
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,np.count_nonzero((a!=0) & (a!=1))==0,~((a!=0) & (a!=1)).any(),28.9,29.3
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,a.size == np.count_nonzero((a==0) | (a==1)),np.count_nonzero((a!=0) & (a!=1))==0,28.9,29.1
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,((a==0) | (a==1)).all(),np.count_nonzero((a!=0) & (a!=1))==0,28.8,28.9
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,((a==0) | (a==1)).all(),~((a!=0) & (a!=1)).any(),28.8,29.3
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,~((a!=0) & (a!=1)).any(),a.size == np.count_nonzero((a==0) | (a==1)),27.5,28.9
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,~((a!=0) & (a!=1)).any(),np.count_nonzero((a!=0) & (a!=1))==0,27.5,29.1
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,a.size == np.count_nonzero((a==0) | (a==1)),((a==0) | (a==1)).all(),28.8,28.8
40596003,answer,40595967,"python,numpy",codeblock,https://stackoverflow.com/questions/40596003,((a==0) | (a==1)).all(),a.size == np.count_nonzero((a==0) | (a==1)),28,28.9
40601470,answer,40601372,"python,numpy",codeblock,https://stackoverflow.com/questions/40601470,"C = np.einsum('ik,jk->ijk', A, B)","C2 = np.dstack([np.outer(A[:,i], B[:,i]) for i in range(r)])",0.216,2.08
40602939,answer,40601934,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40602939,"(np.array(idx)[:,None]==np.array(lst)).argmax(0)","np.where(np.in1d(idx,lst))",0.0354,0.0531
40613889,answer,40613850,"python,string,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/40613889,"df['color'] = np.where(df['Type'].apply(lambda x: 'Green' in x), 1, 0)","df['color1'] = np.where(df['Type'].str.contains('Green'), 1, 0)",94.1,256
40621409,answer,40621301,"python,pandas",codeblock,https://stackoverflow.com/questions/40621409,"pd.DataFrame(data=df.values.reshape(df.shape[0]*2,-1), columns=['original'])","df.stack().reset_index(level=[0,1], drop=True)",0.446,0.82
40741612,answer,40741580,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40741612,"(df.at[2, 'StartDate'])","(df.loc[2, 'StartDate'])",0.0063,0.147
40786381,answer,40786255,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40786381,(df.sum(1).to_frame().dot(df.sum().to_frame().T).div(df.sum().sum())),(df.apply(lambda r: df.sum()[r.name]*df.sum(1)[r.index]/df.sum().sum())),1.19,14.1
40788399,answer,40784770,"python,pandas,dataframe,replace",sentence,using apply and fillna() (fillna is faster than combine_first by a factor of two):,fillna,combine_first,,
40799223,answer,40788063,"python-2.7,sorting,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/40799223,df.groupby('Names')['Hobby'].apply(lambda x: Counter(x).most_common(1)[0][0]),df.groupby('Names')['Hobby'].agg(lambda x: pd.value_counts(x).index[0]),242,345
40799223,answer,40788063,"python-2.7,sorting,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/40799223,"df.groupby(['Names', 'Hobby']).size().groupby(level=0).nlargest(1).reset_index(level=0, drop=True).reset_index(name='Count')",df.groupby('Names')['Hobby'].agg(lambda x: pd.value_counts(x).index[0]),191,345
40799223,answer,40788063,"python-2.7,sorting,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/40799223,"df.groupby(['Names', 'Hobby']).size().groupby(level=0).nlargest(1).reset_index(level=0, drop=True).reset_index(name='Count')",df.groupby('Names')['Hobby'].apply(lambda x: Counter(x).most_common(1)[0][0]),191,242
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(f))","((df.c.astype(str)+df.d.astype(str)).groupby([df.a, df.b]).nunique())",387,4950
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(f))","(df.groupby(['a', 'b', 'c', 'd']).size().groupby(level=['a', 'b']).size())",387,441
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(f))","(df.groupby(['a','b'])[['c','d']].apply(lambda g: len(g) - g.duplicated().sum()))",387,663
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(f))","((df[['c','d']].apply(tuple, axis=1)).groupby([df.a, df.b]).nunique())",387,17600
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a', 'b', 'c', 'd']).size().groupby(level=['a', 'b']).size())","((df.c.astype(str)+df.d.astype(str)).groupby([df.a, df.b]).nunique())",441,4950
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(lambda g: len(g) - g.duplicated().sum()))","((df[['c','d']].apply(tuple, axis=1)).groupby([df.a, df.b]).nunique())",663,17600
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a','b'])[['c','d']].apply(lambda g: len(g) - g.duplicated().sum()))","((df.c.astype(str)+df.d.astype(str)).groupby([df.a, df.b]).nunique())",663,4950
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"((df.c.astype(str)+df.d.astype(str)).groupby([df.a, df.b]).nunique())","((df[['c','d']].apply(tuple, axis=1)).groupby([df.a, df.b]).nunique())",4950,17600
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a', 'b', 'c', 'd']).size().groupby(level=['a', 'b']).size())","((df[['c','d']].apply(tuple, axis=1)).groupby([df.a, df.b]).nunique())",441,17600
40805876,answer,40805769,"python,pandas,group-by",codeblock,https://stackoverflow.com/questions/40805876,"(df.groupby(['a', 'b', 'c', 'd']).size().groupby(level=['a', 'b']).size())","(df.groupby(['a','b'])[['c','d']].apply(lambda g: len(g) - g.duplicated().sum()))",441,663
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,"df.ix[""Cumulative""] = ((df+1).cumprod()-1).iloc[-1]",df.ix['Cummulative'] = df.apply(lambda x: (x+1).prod()-1),18.4,32.9
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,"df.ix[""Cumulative""] = ((df+1).cumprod()-1).iloc[-1]","df.append(df.apply(lambda col: prod([(1+c) for c in col]) - 1), ignore_index=True)",18.4,262
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,"df.ix[""Cumulative""] = ((df+1).cumprod()-1).iloc[-1]","df.append(df.iloc[:,1:].apply(lambda col: (col + 1).prod() - 1), ignore_index=True)",18.4,37.1
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,df.ix['Cummulative'] = df.apply(lambda x: (x+1).prod()-1),"df.append(df.apply(lambda col: prod([(1+c) for c in col]) - 1), ignore_index=True)",32.9,262
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,df.ix['Cummulative'] = df.apply(lambda x: (x+1).prod()-1),"df.append(df.iloc[:,1:].apply(lambda col: (col + 1).prod() - 1), ignore_index=True)",32.9,37.1
40811680,answer,40811246,"python,pandas,dataframe,finance",codeblock,https://stackoverflow.com/questions/40811680,"df.append(df.iloc[:,1:].apply(lambda col: (col + 1).prod() - 1), ignore_index=True)","df.append(df.apply(lambda col: prod([(1+c) for c in col]) - 1), ignore_index=True)",37.1,262
40832774,answer,40832728,"python,pandas,lambda,size",codeblock,https://stackoverflow.com/questions/40832774,"(df[df.date1 == df.date2].groupby(['id', 'date1']).size().reset_index(name='count'))","(df.groupby(['id', 'date1']).apply(lambda x: (x['date1'] == x['date2']).sum()).reset_index())",3.84,7.57
40840015,answer,40839984,"python,list,pandas,numpy,condition",codeblock,https://stackoverflow.com/questions/40840015,"brl.loc[brl['Renewal % Change'] == '0%', 'Account Name'].tolist()",brl[brl['Renewal % Change']=='0%']['Account Name'].tolist(),0.536,0.657
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([Counter(x.split('\n')).most_common(1)[0][0] for x in df.tolist()])),"(df.str.split('\n', expand=True).apply(lambda x: pd.value_counts(x).index[0],axis=1))",257,15700
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([Counter(x.split('\n')).most_common(1)[0][0] for x in df.tolist()])),"(df.str.split('\n', expand=True).apply(lambda x: pd.value_counts(x).index[0],axis=1))",0.197,2.33
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([Counter(x.split('\n')).most_common(1)[0][0] for x in df.tolist()])),(pd.DataFrame([ x.split('\n') for x in df.tolist()]).mode(1)),0.197,2.32
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([ x.split('\n') for x in df.tolist()]).mode(1)),"(df.str.split('\n', expand=True).apply(lambda x: pd.value_counts(x).index[0],axis=1))",2.32,2.33
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([Counter(x.split('\n')).most_common(1)[0][0] for x in df.tolist()])),(df.apply(lambda x: Counter(x.split('\n')).most_common()[0][:][0])),257,282
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([Counter(x.split('\n')).most_common(1)[0][0] for x in df.tolist()])),(pd.DataFrame([ x.split('\n') for x in df.tolist()]).mode(1)),257,9180
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(df.apply(lambda x: Counter(x.split('\n')).most_common()[0][:][0])),(pd.DataFrame([ x.split('\n') for x in df.tolist()]).mode(1)),282,9180
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(pd.DataFrame([ x.split('\n') for x in df.tolist()]).mode(1)),"(df.str.split('\n', expand=True).apply(lambda x: pd.value_counts(x).index[0],axis=1))",9180,15700
40841997,answer,40841788,"python,pandas,whitespace,text-processing",codeblock,https://stackoverflow.com/questions/40841997,(df.apply(lambda x: Counter(x.split('\n')).most_common()[0][:][0])),"(df.str.split('\n', expand=True).apply(lambda x: pd.value_counts(x).index[0],axis=1))",282,15700
40860654,answer,40860633,"python,pandas",codeblock,https://stackoverflow.com/questions/40860654,"(df.groupby('id')['value'].apply(lambda x: ','.join(x.astype(str))).reset_index())","(df.astype(str).groupby('id').value.apply(','.join).reset_index())",1460,1830
40867993,answer,40867977,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40867993,(df[df['Third C'] != -999]),(df.drop(df[df['Third C'] == -999].index)),0.359,0.691
40875755,answer,40875649,"python,pandas",codeblock,https://stackoverflow.com/questions/40875755,df['A'].apply(lambda x: x.count('$')),df['A'].str.count(r'\$'),0.202,0.243
40875785,answer,26984414,"python,arrays,sorting,numpy",codeblock,https://stackoverflow.com/questions/40875785,temp[np.argsort(-temp)],np.sort(temp)[::-1],0.00391,0.00465
40881380,answer,40881281,"python,string,pandas,join,group-by",codeblock,https://stackoverflow.com/questions/40881380,"(df.groupby('id')['name'].apply(','.join))","(df.groupby('id')['name'].apply(lambda x: ','.join(x.tolist())))",130,131
40898143,answer,40896703,"python,datetime,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40898143,df['2015-11-17'],df.loc['2015-11-17'],0.486,1390
40898143,answer,40896703,"python,datetime,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40898143,df['2015-11-17'],df.loc[(df.index >= '2015-11-17') & (df.index < '2015-11-18')],0.486,13.8
40898143,answer,40896703,"python,datetime,pandas,dataframe",codeblock,https://stackoverflow.com/questions/40898143,df.loc[(df.index >= '2015-11-17') & (df.index < '2015-11-18')],df.loc['2015-11-17'],13.8,1390
40907495,answer,40907470,"python,pandas,list-comprehension",codeblock,https://stackoverflow.com/questions/40907495,(df.apply(lambda x: x.str.lower())),(df.stack().str.lower().unstack()),2630,5040
40907495,answer,40907470,"python,pandas,list-comprehension",codeblock,https://stackoverflow.com/questions/40907495,"(pd.concat([df[i].str.lower() for i in df], axis=1))",(df.stack().str.lower().unstack()),2300,5040
40907495,answer,40907470,"python,pandas,list-comprehension",codeblock,https://stackoverflow.com/questions/40907495,"(pd.concat([df[i].str.lower() for i in df], axis=1))",(df.apply(lambda x: x.str.lower())),2300,2630
40909155,answer,40908827,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/40909155,"(pd.concat((df.ID, pd.DataFrame(df.column_2.values.tolist())),axis=1))","(pd.concat((df.ID, pd.DataFrame(df.column_2.tolist())),axis=1))",322,339
40909155,answer,40908827,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/40909155,"(pd.concat((df.ID, pd.DataFrame(df.column_2.tolist())),axis=1))","pd.concat([df, df.column_2.apply(lambda x: pd.Series(x))], axis=1)",339,67000
40909155,answer,40908827,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/40909155,"(pd.concat((df.ID, pd.DataFrame(df.column_2.values.tolist())),axis=1))","pd.concat([df, df.column_2.apply(lambda x: pd.Series(x))], axis=1)",322,67000
40925967,answer,40925331,"python,arrays,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/40925967,a.argmax(axis=1),a.nonzero()[1],1.15,9.03
40927435,answer,40927376,"python,performance,list,pandas,set",codeblock,https://stackoverflow.com/questions/40927435,([set(v) for v in df.groupby('OrderID')['ItemID'].unique().values]),(df.groupby('OrderID').apply(lambda x: set(x['ItemID'])).tolist()),125,168
40930967,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/40930967,np.isnan(array.min()),np.isnan(array.sum()),1.64,4.45
40930967,answer,6736590,"python,numpy,nan",codeblock,https://stackoverflow.com/questions/40930967,np.isnan(array.min()),np.isnan(array.sum()),1.65,4.57
40946557,answer,40946187,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40946557,"(pd.DataFrame(np.column_stack((np.tile(df.columns, df.shape[0]), df.values.reshape(-1,1))), columns=['name', 'value']))","(df.stack().reset_index(level=0, drop=True).reset_index(name='value').rename(columns={'index':'name'}))",196,344
40946557,answer,40946187,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40946557,"(pd.DataFrame({""name"": np.tile(df.columns, len(df.index)),""value"": df.values.ravel()}))","(df.stack().reset_index(level=0, drop=True).reset_index(name='value').rename(columns={'index':'name'}))",84.8,344
40946557,answer,40946187,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/40946557,"(pd.DataFrame({""name"": np.tile(df.columns, len(df.index)),""value"": df.values.ravel()}))","(pd.DataFrame(np.column_stack((np.tile(df.columns, df.shape[0]), df.values.reshape(-1,1))), columns=['name', 'value']))",84.8,196
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(newsampledata.sample(N, replace=True).reset_index(drop=True))","(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",0.47,0.745
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",0.476,0.745
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(newsampledata.sample(N, replace=True).reset_index(drop=True))",(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),0.47,0.476
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(newsampledata.sample(N, replace=True).reset_index(drop=True))","(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",0.775,0.946
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",0.827,0.946
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))","(newsampledata.sample(N, replace=True).reset_index(drop=True))",6.93,7.07
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),6.93,7.87
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(newsampledata.sample(N, replace=True).reset_index(drop=True))",(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),0.775,0.827
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))","(newsampledata.sample(N, replace=True).reset_index(drop=True))",589,757
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(pd.DataFrame(newsampledata.values.tolist(), index=np.arange(N), columns=sampledata.columns))",(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),589,731
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),"(newsampledata.sample(N, replace=True).reset_index(drop=True))",731,757
40990006,answer,40989855,"python,pandas",codeblock,https://stackoverflow.com/questions/40990006,"(newsampledata.sample(N, replace=True).reset_index(drop=True))",(newsampledata.reindex(newsampledata.index.repeat(N)).reset_index(drop=True)),7.07,7.87
41006800,answer,39856523,"python,pandas",codeblock,https://stackoverflow.com/questions/41006800,df.B.values[n-5],"df.iat[n-5,1]",0.0073,0.00972
41006800,answer,39856523,"python,pandas",codeblock,https://stackoverflow.com/questions/41006800,"df.iat[n-5,1]",df.B.iat[n-5],0.00972,0.0154
41006800,answer,39856523,"python,pandas",codeblock,https://stackoverflow.com/questions/41006800,df.B.values[n-5],"df.values[n-5,1]",0.0073,0.00942
41022840,answer,16476924,"python,pandas,rows,dataframe",sentence,itertuples() is supposed to be faster than iterrows(),itertuples(),iterrows(),,
41047892,answer,32034689,"python,csv,pandas,python-datetime,string-to-datetime",codeblock,https://stackoverflow.com/questions/41047892,someSeries.apply(parseDateStr),"pd.to_datetime(someSeries, errors='coerce')",904,1780
41049374,answer,41049291,"arrays,matlab,numpy,vectorization,mean",codeblock,https://stackoverflow.com/questions/41049374,"A.reshape(-1,500).sum(1)/500.0","A.reshape(-1,500).mean(1)",0.516,0.534
41049374,answer,41049291,"arrays,matlab,numpy,vectorization,mean",codeblock,https://stackoverflow.com/questions/41049374,"A.reshape(-1,500).sum(1)/500.0","A.reshape(-1,500).mean(1)",0.583,1.19
41069967,answer,41069825,"python,numpy,binary,bitstring",codeblock,https://stackoverflow.com/questions/41069967,b.dot(1 << np.arange(b.size)[::-1]),b.dot(2**np.arange(b.size)[::-1]),0.00792,0.0131
41091838,answer,41091785,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41091838,"df.groupby(['channel','year','month'])['day'].nunique()","df.groupby(['channel','year','month'])['day'].apply(lambda x: len(x.unique()))",2.05,4.42
41094529,answer,41020978,"python,pandas",sentence,"here's a variation based on np.searchsorted that seems to be an order of magnitude faster than using intervaltree or merge, assuming my larger sample data is correct.",np.searchsorted,merge,,
41118151,answer,41117560,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/41118151,"(pd.DataFrame(df.columns[np.argsort(-df.values, axis=1)],index=df.index, columns=df.columns))","(df.apply(lambda row: row.sort_values(ascending=False).index, axis=1))",1.76,7210
41118151,answer,41117560,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/41118151,"(pd.DataFrame(df.columns[np.argsort(-df.values, axis=1)],index=df.index, columns=df.columns))","(df.apply(lambda row: row.sort_values(ascending=False).index, axis=1))",0.126,1.95
41120253,answer,41120199,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41120253,"(df_day.div(df_day.sum(), axis=1).mul(100).round(0))","(df_day.apply(lambda x: round(100 * x / df_day.sum()), axis=1))",1.89,5.18
41129368,answer,41129279,"python,pandas",codeblock,https://stackoverflow.com/questions/41129368,"df['plane_type'] = df.Operator.str.extract('(Military|Private)', expand=False).fillna('Passengers')",df['plane_type1'] = df['Operator'].astype(str).apply(plane_type),711,1690
41129368,answer,41129279,"python,pandas",codeblock,https://stackoverflow.com/questions/41129368,"df['plane_type'] = df.Operator.str.extract('(Military|Private)', expand=False).fillna('Passengers')",df['plane_type1'] = df['Operator'].astype(str).apply(plane_type),10.8,25.8
41149742,answer,41148080,"python,numpy,vectorization,mathematical-optimization,numba",codeblock,https://stackoverflow.com/questions/41149742,"np.einsum('ijk,k',asset_returns,weights)","np.dot(asset_returns,weights)",4.73,6.8
41158287,answer,41157981,"python,pandas",codeblock,https://stackoverflow.com/questions/41158287,(df.userid.apply(lambda x: '{:.0f}'.format(x))),(df.userid.map(lambda x: '{:.0f}'.format(x))),210,211
41166160,answer,41165818,"python,pandas",codeblock,https://stackoverflow.com/questions/41166160,"df['Grade']= np.where(df['Spending'] > 100 ,'A','B')","df['grade'] = df.apply(lambda row: 'A' if row['Spending'] > 100 else 'B', axis = 1)",21.6,7080
41187069,answer,41187041,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41187069,dff.groupby('a')['b'].apply(lambda x: x.nlargest(3).sum()),dff.groupby('a')['b'].nlargest(3).groupby(level='a').sum(),2.44,3.44
41187252,answer,41186501,"python,csv,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41187252,df['actual'].apply(fix),"df.actual.apply(lambda x: ''.join(k if i==0 else k.ljust(3, '0') for i,k in enumerate(x.split(',')))).astype(int)",5.48,8.34
41187252,answer,41186501,"python,csv,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41187252,"df.actual.apply(lambda x: ''.join(k if i==0 else k.ljust(3, '0') for i,k in enumerate(x.split(',')))).astype(int)","pd.to_numeric((df['actual'].str.replace(',', '') + np.where(df['actual'].str.contains(','), (3 - df['actual'].str.split(',').str.get(-1).str.len()).mul(pd.Series(len(df) * ['0'])), '')))",8.34,12.6
41187252,answer,41186501,"python,csv,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41187252,df['actual'].apply(fix),"pd.to_numeric((df['actual'].str.replace(',', '') + np.where(df['actual'].str.contains(','), (3 - df['actual'].str.split(',').str.get(-1).str.len()).mul(pd.Series(len(df) * ['0'])), '')))",5.48,12.6
41191236,answer,41189392,"python,pandas,dataframe",sentence,so we see that .isin() is much quicker than .apply() and twice as quick as .map().,.isin(),.apply(),,
41191236,answer,41189392,"python,pandas,dataframe",sentence,so we see that .isin() is much quicker than .apply() and twice as quick as .map().,.isin(),.map(),,
41204944,answer,27300402,"python,numpy",codeblock,https://stackoverflow.com/questions/41204944,"A[:,568]",A.T[568],211.353,302.563
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,"df['Start_Time'].str.extract('(\d*):', expand=False).astype(int)",pd.to_timedelta(df['Start_Time']+ ':00').dt.components.hours,654,7120
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,df['Start_Time'].str.split(':').str[0].astype(int),"df['Start_Time'].str.extract('(\d*):', expand=False).astype(int)",415,654
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,df['Start_Time'].str.split(':').str[0].astype(int),"pd.to_datetime(df['Start_Time'], format='%H:%M').dt.hour",415,1260
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,"df['Start_Time'].str.extract('(\d*):', expand=False).astype(int)","pd.to_datetime(df['Start_Time'], format='%H:%M').dt.hour",654,1260
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,df['Start_Time'].str.split(':').str[0].astype(int),pd.to_timedelta(df['Start_Time']+ ':00').dt.components.hours,415,7120
41210086,answer,41209974,"python,datetime,pandas,int,series",codeblock,https://stackoverflow.com/questions/41210086,"pd.to_datetime(df['Start_Time'], format='%H:%M').dt.hour",pd.to_timedelta(df['Start_Time']+ ':00').dt.components.hours,1260,7120
41227457,answer,41225604,"python,pandas,rbind",codeblock,https://stackoverflow.com/questions/41227457,pd.Series(np.concatenate([df.values.ravel() for df in res])),x = []; [x.extend(df.values.tolist()) for df in res]; pd.DataFrame(x),0.0702,0.196
41227457,answer,41225604,"python,pandas,rbind",codeblock,https://stackoverflow.com/questions/41227457,"pd.concat(res, axis=1).stack().reset_index(drop=True)","pd.DataFrame(pd.concat(res, axis=1).values.ravel(), columns=['col']).dropna()",0.902,1.07
41227457,answer,41225604,"python,pandas,rbind",codeblock,https://stackoverflow.com/questions/41227457,"pd.Series(pd.concat(res, axis=1).values.ravel()).dropna()","pd.DataFrame(pd.concat(res, axis=1).values.ravel(), columns=['col']).dropna()",0.92,1.07
41227457,answer,41225604,"python,pandas,rbind",codeblock,https://stackoverflow.com/questions/41227457,"pd.concat(res, axis=1).stack().reset_index(drop=True)","pd.Series(pd.concat(res, axis=1).values.ravel()).dropna()",0.902,0.92
41262926,answer,41262893,"python,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/41262926,X.dot(A.T),"np.apply_along_axis(F, 1, X)",0.228,185
41273969,answer,41273770,"python,pandas,matrix,dataframe",codeblock,https://stackoverflow.com/questions/41273969,pd.DataFrame(df.groupby(level=0)[0].apply(list).to_dict()),"df.assign(id = df.groupby([0]).cumcount()).set_index(['id', 0]).unstack(level=1)",210,1340
41274299,answer,41273770,"python,pandas,matrix,dataframe",codeblock,https://stackoverflow.com/questions/41274299,"pd.DataFrame({name:group.values for name, group in df.groupby(level=0)[0]})",pd.DataFrame(df.groupby(level=0)[0].apply(list).to_dict()),73.6,249
41285308,answer,41285271,"python,function,pandas,apply",codeblock,https://stackoverflow.com/questions/41285308,df.v1.mul(df.v3).div(df.v2),"df.apply(lambda x: my_res(x.v1,x.v2,x.v3),axis=1)",0.305,1660
41291462,answer,41290350,"python,algorithm,numpy,matrix",codeblock,https://stackoverflow.com/questions/41291462,"alist=arr.tolist()





[list(row[::-1]) for row in zip(*alist)]","alist=arr.tolist()





rotate(alist)",0.00683,0.021
41303279,answer,41303189,"python,python-3.x,pandas,python-3.5",codeblock,https://stackoverflow.com/questions/41303279,(np.ceil(dff.price_cleaning / 10) * 10).astype(int),dff['price_cleaning'].apply(roundup),0.436,7.86
41305450,answer,41305324,"python,performance,numpy,indexing,vectorization",codeblock,https://stackoverflow.com/questions/41305450,"np.take(mats,idxs,axis=0)",mats[idxs],8.88,22.8
41306249,answer,41306217,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/41306249,"dff.sort_values(by=['ID', 'VAL'])","dff.iloc[np.lexsort((dff.VAL.values, dff.ID.values))]",2.62,8.8
41307005,answer,41293382,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41307005,"pd.concat(dict_of_series, axis=0).unstack(0)","pd.concat(dict_of_series, axis=1)",57.9,82.9
41324751,answer,41320568,"python,numpy",codeblock,https://stackoverflow.com/questions/41324751,a.argmax(),np.isnan(a).argmax(),0.0203,0.462
41340543,answer,41340341,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/41340543,"pd.Series([len(x) for x in ser], index=ser.index)",ser.str.len(),236,248
41340543,answer,41340341,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/41340543,"pd.Series([len(x) for x in ser], index=ser.index)",ser.apply(lambda x: len(x)),236,425
41340543,answer,41340341,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/41340543,ser.str.len(),ser.apply(lambda x: len(x)),248,425
41399555,answer,41399538,"python,pandas,numpy,boolean,shift",codeblock,https://stackoverflow.com/questions/41399555,df.col1.eq(df.col1.shift()),df.col1 == df.col1.shift(),0.933,1
41399670,answer,41399538,"python,pandas,numpy,boolean,shift",codeblock,https://stackoverflow.com/questions/41399670,df['col1'].diff().eq(0),df.col1.eq(df.col1.shift()),0.405,0.731
41403332,answer,41403301,"python,pandas",codeblock,https://stackoverflow.com/questions/41403332,df.apply(to_float),"df.replace(',', '.', regex=True).astype(float)",1470,1790
41403332,answer,41403301,"python,pandas",codeblock,https://stackoverflow.com/questions/41403332,df.apply(to_float),"df.applymap(lambda x: float(x.replace("","", ""."")))",1470,1750
41403332,answer,41403301,"python,pandas",codeblock,https://stackoverflow.com/questions/41403332,"df.applymap(lambda x: float(x.replace("","", ""."")))","df.replace(',', '.', regex=True).astype(float)",1750,1790
41403332,answer,41403301,"python,pandas",codeblock,https://stackoverflow.com/questions/41403332,df.apply(to_float_inplace),"df.applymap(lambda x: x.replace("","", ""."")).astype(float)",269,1260
41407156,answer,37649829,"python,numpy,pandas,binary,integer",codeblock,https://stackoverflow.com/questions/41407156,"pd.Series((2**np.arange(df.shape[0]-1,-1,-1)).dot(df.values))","(df.T.dot(1 << np.arange(df.shape[0] - 1, -1, -1)))",0.268,0.554
41445674,answer,41445580,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/41445674,a[:((a*b).cumsum()>l).argmax()],a[np.where((a*b).cumsum() < l)],0.0713,0.0928
41445674,answer,41445580,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/41445674,a[:((a*b).cumsum()>l).argmax()],a[(a*b).cumsum() < l],0.0713,0.0826
41445674,answer,41445580,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/41445674,a[(a*b).cumsum() < l],a[np.where((a*b).cumsum() < l)],0.0826,0.0928
41472706,answer,41472327,"python,pandas",codeblock,https://stackoverflow.com/questions/41472706,"result2 = data2.groupby(['i1', 'i2', 'i3']).apply(lambda group: group['i4']*group['x'])","result3 = data3.groupby(level = ['i1', 'i2', 'i3']).apply(lambda group: group['i4']*group['x'])",1690,3310
41485919,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41485919,"pd.Series(np.einsum('ij->i',s.values.reshape(-1,3)))","pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))",1.04,2.07
41485919,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41485919,"pd.Series(s.values.reshape(-1,3).sum(1))","pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))",2.03,2.07
41485919,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41485919,"pd.Series(np.einsum('ij->i',s.values.reshape(-1,3)))","pd.Series(s.values.reshape(-1,3).sum(1))",1.04,2.03
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.sum(np.array(s).reshape(-1, 3), axis=1))","pd.Series(np.sum(np.array(s).reshape(len(s)/3,3), axis = 1))",2.15,2.17
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(s.values.reshape(-1,3).sum(1))","pd.Series(np.sum(np.array(s).reshape(len(s)/3,3), axis = 1))",1.62,2.17
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))","pd.Series(s.values.reshape(-1,3).sum(1))",1.45,1.62
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))","pd.Series(np.bincount(np.arange(s.size)//3, s))",1.45,5.44
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(s.values.reshape(-1,3).sum(1))","pd.Series(np.bincount(np.arange(s.size)//3, s))",1.62,5.44
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.sum(np.array(s).reshape(-1, 3), axis=1))","pd.Series(np.bincount(np.arange(s.size)//3, s))",2.15,5.44
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.sum(np.array(s).reshape(len(s)/3,3), axis = 1))","pd.Series(np.bincount(np.arange(s.size)//3, s))",2.17,5.44
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))","pd.Series(np.sum(np.array(s).reshape(len(s)/3,3), axis = 1))",1.45,2.17
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))",s.rolling(3).sum()[2::3],1.45,15.6
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.sum(np.array(s).reshape(-1, 3), axis=1))",s.rolling(3).sum()[2::3],2.15,15.6
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.sum(np.array(s).reshape(len(s)/3,3), axis = 1))",s.rolling(3).sum()[2::3],2.17,15.6
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.bincount(np.arange(s.size)//3, s))",s.rolling(3).sum()[2::3],5.44,15.6
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(np.add.reduceat(s.values, np.arange(0, s.shape[0], 3)))","pd.Series(np.sum(np.array(s).reshape(-1, 3), axis=1))",1.45,2.15
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(s.values.reshape(-1,3).sum(1))",s.rolling(3).sum()[2::3],1.62,15.6
41486008,answer,41485471,"python,loops,pandas,numpy",codeblock,https://stackoverflow.com/questions/41486008,"pd.Series(s.values.reshape(-1,3).sum(1))","pd.Series(np.sum(np.array(s).reshape(-1, 3), axis=1))",1.62,2.15
41509267,answer,41509244,"python,pandas",codeblock,https://stackoverflow.com/questions/41509267,"[l.lower().replace('-', ' ').replace(',',' ') for l in df.columns]","df.columns.str.lower().str.replace('-|,', ' ')",0.00526,0.284
41514608,answer,41513324,"python,pandas",codeblock,https://stackoverflow.com/questions/41514608,df.loc[(df.index < start_remove) | (df.index > end_remove)],df.query('index < @start_remove or index > @end_remove'),4.94,15.2
41514608,answer,41513324,"python,pandas",codeblock,https://stackoverflow.com/questions/41514608,"df.loc[df.index.difference(df.index[df.index.slice_indexer(start_remove, end_remove)])]",df.query('index < @start_remove or index > @end_remove'),4.05,15.2
41514608,answer,41513324,"python,pandas",codeblock,https://stackoverflow.com/questions/41514608,"df.loc[df.index.difference(df.index[df.index.slice_indexer(start_remove, end_remove)])]",df.loc[(df.index < start_remove) | (df.index > end_remove)],4.05,4.94
41534318,answer,41534270,"python,pandas,dataframe,graphlab,sframe",codeblock,https://stackoverflow.com/questions/41534318,"(df.groupby(['user_id','action'])['count'].mean().unstack(fill_value=0))","(df.pivot_table('count', 'user_id', 'action', fill_value=0))",5.5,35.9
41547828,answer,41547753,"python,pandas,scipy,scikit-learn,sparse-matrix",codeblock,https://stackoverflow.com/questions/41547828,"(s.dropna().str.split(', ').apply(f).fillna(0).astype(int))","s.str.get_dummies(sep=', ')",2950,76000
41551976,answer,41551925,"python,pandas,duplicates",codeblock,https://stackoverflow.com/questions/41551976,(df[df['States'].ne(df['Region'])]),(df[df['States'] != df['Region']]),23.7,88.6
41555615,answer,41555400,"python-3.x,pandas,time-series,hdf5",codeblock,https://stackoverflow.com/questions/41555615,"store.select('XAU', where=""index >= '1980-04-04' and index<= '1980-05-01'"")","store.select('XAU', where=index[index.isin(dates)].index)",253,8130
41556097,answer,41556020,"python,pandas,if-statement,condition,multiple-columns",codeblock,https://stackoverflow.com/questions/41556097,"df['col51'] = np.where(df['col1'] <3, df['col2'], np.where((df['col1'] <7) & (df['col1'] >=3 ), df['col3'], df['col4']))","df[""col52""] = df.apply(lambda x: col52(x), axis=1)",1.25,552
41556097,answer,41556020,"python,pandas,if-statement,condition,multiple-columns",codeblock,https://stackoverflow.com/questions/41556097,"df['col51'] = np.where(df['col1'] <3, df['col2'], np.where((df['col1'] <7) & (df['col1'] >=3 ), df['col3'], df['col4']))","df[""col52""] = df.apply(lambda x: col52(x), axis=1)",2.5,5360
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] / 100.0","df.iloc[:, 2:6].div(100)",205,221
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] * 0.01","df.iloc[:, 2:6].div(100)",180,221
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] / 100.0","df.iloc[:, 2:6] / 100",205,219
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] * 0.01","df.iloc[:, 2:6] / 100",180,219
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] * 0.01","df.iloc[:, 2:6] / 100.0",180,205
41585092,answer,41584896,"python,pandas",codeblock,https://stackoverflow.com/questions/41585092,"df.iloc[:, 2:6] / 100","df.iloc[:, 2:6].div(100)",219,221
41586448,answer,41586114,numpy,codeblock,https://stackoverflow.com/questions/41586448,"[i[0] for i in np.core.defchararray.split(desc, sep=' ')]",pd.Series(desc).str.split().str[0].values,0.0138,0.509
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"np.add.reduceat(x,list(range(0,100,10)))","np.add.reduceat(x,np.r_[0:100:10])",0.0119,0.0312
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"x.reshape(-1,10).sum(axis=1)","np.add.reduceat(x,np.r_[0:100:10])",0.0115,0.0312
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"np.add.reduceat(x,np.arange(0,100,10))","np.add.reduceat(x,list(range(0,100,10)))",0.00669,0.0119
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"np.add.reduceat(x,np.arange(0,100,10))","x.reshape(-1,10).sum(axis=1)",0.00669,0.0115
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"x.reshape(-1,10).sum(axis=1)","np.add.reduceat(x,list(range(0,100,10)))",0.0115,0.0119
41597480,answer,41595807,"python,numpy,range,slice,numpy-ufunc",codeblock,https://stackoverflow.com/questions/41597480,"np.add.reduceat(x,np.arange(0,100,10))","np.add.reduceat(x,np.r_[0:100:10])",0.00669,0.0312
41599078,answer,41599051,pandas,codeblock,https://stackoverflow.com/questions/41599078,(df.mean(level='Month')),(df.groupby(level='Month')['Visits'].mean().to_frame()),115,118
41603410,answer,41603334,"python,list,numpy,optimization",codeblock,https://stackoverflow.com/questions/41603410,a[a!=0].mean(),a[a.nonzero()].mean(),4.59,9.82
41609814,answer,41609670,"python,pandas",codeblock,https://stackoverflow.com/questions/41609814,"(df.groupby(['LeafId','pidx','pidy']).agg({'count':'sum'}).reset_index())","(df.groupby(['LeafId','pidx','pidy'], as_index=False)['count'].sum())",775,933
41609814,answer,41609670,"python,pandas",codeblock,https://stackoverflow.com/questions/41609814,"(df.groupby(['LeafId','pidx','pidy']).agg({'count':'sum'}).reset_index())","(df.groupby(['LeafId','pidx','pidy'], as_index=False)['count'].sum())",466,544
41610147,answer,41609980,"python,pandas,dataframe,time-series",codeblock,https://stackoverflow.com/questions/41610147,s[::60],s[s.minute == 59],0.0275,0.639
41618472,answer,41618448,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41618472,"np.where(np.isinf(df['a']/df['b']) | pd.isnull(df['a']/df['b']), (1 + df['a']) / (1 + df['b']), df['a']/df['b'])","df.apply(lambda x: CalcRatio(x['a'],x['b']), axis=1)",1.32,225
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,"np.frompyfunc(Decimal,1,1)(np.arange(2000))",np.array([Decimal(str(i)) for i in np.arange(2000)]),0.752,17.1
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,"np.frompyfunc(Decimal,1,1)(np.arange(2000))",np.array([Decimal(i) for i in range(2000)]),0.752,7.39
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,np.array([Decimal(i) for i in range(2000)]),np.array([Decimal(str(i)) for i in np.arange(2000)]),7.39,17.1
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,np.array([Decimal(i.item()) for i in np.arange(2000)]),np.array([Decimal(str(i)) for i in np.arange(2000)]),11.3,17.1
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,"np.frompyfunc(Decimal,1,1)(np.arange(2000))",np.array([Decimal(i.item()) for i in np.arange(2000)]),0.752,11.3
41621314,answer,41620289,"python,arrays,numpy,iteration",codeblock,https://stackoverflow.com/questions/41621314,np.array([Decimal(i) for i in range(2000)]),np.array([Decimal(i.item()) for i in np.arange(2000)]),7.39,11.3
41624095,answer,41617110,"python,numpy,casting",codeblock,https://stackoverflow.com/questions/41624095,np.all((data >= type_info.min) & (data <= type_info.max)),"all(np.can_cast(item, np.uint8) for item in np.nditer(data))",6745.51,51006.5
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,(w.gt(.2).astype(np.uint8)),(w.applymap(lambda x: 1 if x>0.2 else 0)),1.02,334
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(np.uint8)),(w.applymap(lambda x: 1 if x>0.2 else 0)),1.35,334
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,(w.gt(.2).astype(np.uint8)),((w > .2).astype(np.uint8)),1.02,1.35
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,(w.gt(.2).astype(np.uint8)),((w > .2).astype(np.short)),1.02,1.8
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(np.uint8)),((w > .2).astype(np.short)),1.35,1.8
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(int)),(w.applymap(lambda x: 1 if x>0.2 else 0)),2.11,334
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,(w.gt(.2).astype(np.uint8)),((w > .2).astype(int)),1.02,2.11
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(np.short)),(w.applymap(lambda x: 1 if x>0.2 else 0)),1.8,334
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(np.short)),((w > .2).astype(int)),1.8,2.11
41628329,answer,41627300,pandas,codeblock,https://stackoverflow.com/questions/41628329,((w > .2).astype(np.uint8)),((w > .2).astype(int)),1.35,2.11
41633697,answer,41633639,"python,pandas",codeblock,https://stackoverflow.com/questions/41633697,"(df.groupby([df.ID, df.url, df.date, (df.url != df.url.shift()).cumsum().rename('tmp')], sort=False)['active_seconds'].sum().reset_index(level='tmp', drop=True).reset_index())","(df.assign(g=df.ID.ne(df.ID.shift()).cumsum()).pivot_table('active_seconds', ['g', 'ID', 'url', 'date'], None, 'sum').reset_index([1, 2, 3]).reset_index(drop=True))",3.62,5.02
41634640,answer,41634490,"performance,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/41634640,"np.tensordot(X_train, rgb2yuv_matrix, axes=([-1],[1]))","X_train.reshape(-1,3).dot(rgb2yuv_matrix.T).reshape(X_train.shape)",22,22.6
41640530,answer,22414152,"python,arrays,numpy,multidimensional-array,initialization",codeblock,https://stackoverflow.com/questions/41640530,numpy.empty(10000)* numpy.nan,numpy.array([numpy.nan]*10000),0.0065,0.273
41640530,answer,22414152,"python,arrays,numpy,multidimensional-array,initialization",codeblock,https://stackoverflow.com/questions/41640530,"numpy.full(10000, numpy.nan)",numpy.empty(10000)* numpy.nan,0.00542,0.0065
41640530,answer,22414152,"python,arrays,numpy,multidimensional-array,initialization",codeblock,https://stackoverflow.com/questions/41640530,"numpy.full(10000, numpy.nan)",numpy.array([numpy.nan]*10000),0.00542,0.273
41655255,answer,41653830,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/41655255,"np.searchsorted(a,s1,'right') - np.searchsorted(a,s0,'right')",[np.sum( (a > s0[i]) & (a <= s1[i]) ) for i in range(len(s0))],0.559,4440
41660321,answer,41660032,"python,pandas,dataframe,merge",codeblock,https://stackoverflow.com/questions/41660321,"df4[0] = df2.iloc[df2.index.searchsorted(df4.index, side='right')-1].values","df3.update(pd.concat([df3, df2], axis=1).ffill().iloc[:, 1])",0.744,2.13
41660836,answer,41660002,"python,pandas,dataframe,slice",codeblock,https://stackoverflow.com/questions/41660836,"(df[~df['Group'].isin(df.loc[df['Morph'].isin(['U',np.nan]), 'Group'].unique())])","(df.groupby('Group').filter(lambda x: (~x.Morph.isin(['U',np.nan]).any() )))",372,34700
41678874,answer,20250771,"python,dictionary,pandas,remap",sentence,"if your dictionary has more than a couple of keys, using map can be much faster than replace.",map,replace,,
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].values[0])","(df.loc[df.biz_id.eq(123).idxmax(), 'biz_name'])",0.37,0.517
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].values[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].tolist()[0])",0.37,0.384
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df.biz_id.eq(123).idxmax(), 'biz_name'])",(df.query('biz_id == 123')['biz_name'].iloc[0]),0.517,1.75
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].values[0])",(df.query('biz_id == 123')['biz_name'].iloc[0]),0.37,1.75
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].tolist()[0])",(df.query('biz_id == 123')['biz_name'].iloc[0]),0.384,1.75
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].iat[0])","(df.loc[df.biz_id.eq(123).idxmax(), 'biz_name'])",0.391,0.517
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].tolist()[0])","(df.loc[df.biz_id.eq(123).idxmax(), 'biz_name'])",0.384,0.517
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].tolist()[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].iat[0])",0.384,0.391
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].iat[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].iloc[0])",0.391,0.399
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].iloc[0])",(df.query('biz_id == 123')['biz_name'].iloc[0]),0.399,1.75
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].tolist()[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].iloc[0])",0.384,0.399
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].values[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].iat[0])",0.37,0.391
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].iloc[0])","(df.loc[df.biz_id.eq(123).idxmax(), 'biz_name'])",0.399,0.517
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].values[0])","(df.loc[df['biz_id'] == 123, 'biz_name'].iloc[0])",0.37,0.399
41690785,answer,41690769,"python,pandas",codeblock,https://stackoverflow.com/questions/41690785,"(df.loc[df['biz_id'] == 123, 'biz_name'].iat[0])",(df.query('biz_id == 123')['biz_name'].iloc[0]),0.391,1.75
41806149,answer,41806079,"python,python-3.x,pandas,vlookup",codeblock,https://stackoverflow.com/questions/41806149,main_df['header_1'].map(lookup_df.set_index('header_1')['header_2']),"pd.merge(main_df, lookup_df, how='left', on=['header_1'])",35.7,73.1
41806149,answer,41806079,"python,python-3.x,pandas,vlookup",codeblock,https://stackoverflow.com/questions/41806149,main_df['header_1'].map(lookup_df.set_index('header_1')['header_2'].to_dict()),"pd.merge(main_df, lookup_df, how='left', on=['header_1'])",35.1,73.1
41806149,answer,41806079,"python,python-3.x,pandas,vlookup",codeblock,https://stackoverflow.com/questions/41806149,main_df['header_1'].map(lookup_df.set_index('header_1')['header_2'].to_dict()),main_df['header_1'].map(lookup_df.set_index('header_1')['header_2']),35.1,35.7
41818674,answer,41818607,"python,arrays,numpy,broadcast,dimensions",codeblock,https://stackoverflow.com/questions/41818674,"np.repeat(a[:,:,None], 3, axis = 2)","np.repeat(a.ravel(), 3).reshape(4,4,3)",0.00164,0.0019
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform('count') > 120]),(df[df.groupby('pidx').pidx.transform(len) > 120]),104,685
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform('size') > 120]),(df[df.groupby('pidx').pidx.transform('count') > 120]),102,104
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform('count') > 120]),(df.groupby('pidx').filter(lambda x: len(x) > 120)),104,1170
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform(len) > 120]),(df.groupby('pidx').filter(lambda x: len(x) > 120)),685,1170
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform('size') > 120]),(df.groupby('pidx').filter(lambda x: len(x) > 120)),102,1170
41821495,answer,41821430,"python,pandas",codeblock,https://stackoverflow.com/questions/41821495,(df[df.groupby('pidx').pidx.transform('size') > 120]),(df[df.groupby('pidx').pidx.transform(len) > 120]),102,685
41826718,answer,41826019,pandas,sentence,"timings, count is decently faster than isnull.sum()",count,isnull.sum(),,
41826718,answer,41826019,pandas,codeblock,https://stackoverflow.com/questions/41826718,1 - df.count()/len(df.index),df.isnull().sum()/df.shape[0],0.542,2.87
41826756,answer,41825978,"python,pandas",codeblock,https://stackoverflow.com/questions/41826756,"(df.sort_values('score',ascending = False).groupby('pidx').head(2))","(df.set_index(['mainid','pidy']).groupby('pidx')['score'].nlargest(2).reset_index())",309,7110
41834102,answer,41833909,"python,date,pandas",codeblock,https://stackoverflow.com/questions/41834102,"pd.DataFrame(np.tile(df,(4,1)), columns= df.columns)",pd.concat([df]*4),0.142,0.621
41834102,answer,41833909,"python,date,pandas",codeblock,https://stackoverflow.com/questions/41834102,"pd.DataFrame(np.tile(df,(400,1)), columns= df.columns)",pd.concat([df]*400),0.152,37.5
41846145,answer,41846113,pandas,codeblock,https://stackoverflow.com/questions/41846145,"pd.Series(['aa'] * 50000 + ['bb'] * 50000 + [None] * 10000, name='fruit', index=['a'+ str(i) for i in range(1,110001)])","pd.Series(['aa'] * 50000 + ['bb'] * 50000 + [None] * 10000, name='fruit', index=range(1,110001)).rename_axis('a{}'.format)",76,84.9
41860946,answer,41860594,"python,python-3.x,pandas,numpy,list-comprehension",codeblock,https://stackoverflow.com/questions/41860946,"pd.DataFrame([[y[0] for y in x] for x in outputdata], columns=Molecule)","(pd.DataFrame(outputdata, columns=Molecule).apply(lambda x: x.str[0]))",1.04,4.59
41861865,answer,41861846,"python,pandas,dataframe,transpose",codeblock,https://stackoverflow.com/questions/41861865,"(pd.DataFrame(df.numFruits.values.reshape(1,-1), index=['Market 1 Order'], columns=df.fruits.values))","(pd.DataFrame([df.numFruits.values], ['Market 1 Order'], df.fruits.values))",0.424,2400
41861865,answer,41861846,"python,pandas,dataframe,transpose",codeblock,https://stackoverflow.com/questions/41861865,(df.rename(columns={'numFruits':'Market 1 Order'}).set_index('fruits').rename_axis(None).T),"(pd.DataFrame([df.numFruits.values], ['Market 1 Order'], df.fruits.values))",1.94,2400
41861865,answer,41861846,"python,pandas,dataframe,transpose",codeblock,https://stackoverflow.com/questions/41861865,"(pd.DataFrame(df.numFruits.values.reshape(1,-1), index=['Market 1 Order'], columns=df.fruits.values))",(df.rename(columns={'numFruits':'Market 1 Order'}).set_index('fruits').rename_axis(None).T),0.424,1.94
41867310,answer,20644536,"python,pandas",codeblock,https://stackoverflow.com/questions/41867310,np.square(df),"np.power(df, 2)",0.085,0.0856
41868303,answer,41864980,"python,numpy,matrix,mahalanobis",codeblock,https://stackoverflow.com/questions/41868303,"np.einsum('jil,jil->ij',np.tensordot(diff, L, axes=(2,0)), diff)","np.einsum('jik,kl,jil->ij', diff, L, diff)",0.472,7.81
41868675,answer,41865295,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/41868675,"(arr == np.arange(3,0,-1)[:,None]).T.astype(np.int8)","np.take(mapping, arr,axis=0)",0.0441,0.073
41873250,answer,41873198,"python,arrays,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/41873250,"np.column_stack((lat.ravel(),long.ravel(),val.ravel()))","pd.DataFrame(arr,columns=('lat','long','val'))",0.0124,0.217
41874556,answer,41874452,"python,numpy",codeblock,https://stackoverflow.com/questions/41874556,"np.einsum('ijklm->ijkm',x.reshape(m,n,r,3,-1))/3.0","x.reshape(m,n,r,3,-1).mean(axis=-2)",0.214,0.43
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,"a.where(b!=0, 0)","a.mask(b==0,0)",1.37,1.47
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,"a.mask(b==0,0)","a.where(b!=0, b)",1.47,1.82
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,"a.where(b!=0, 0)","a.where(b!=0, b)",1.37,1.82
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,a[b==0] = 0,"a.where(b!=0, b)",1.49,1.82
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,"a.where(b!=0, 0)",a[b==0] = 0,1.37,1.49
41879547,answer,41879244,"python,pandas",codeblock,https://stackoverflow.com/questions/41879547,"a.mask(b==0,0)",a[b==0] = 0,1.47,1.49
41883440,answer,41875803,"python,numpy",codeblock,https://stackoverflow.com/questions/41883440,"np.diff(np.concatenate(([0], t)))","np.diff(np.hstack((0, t)))",0.0231,0.0312
41883440,answer,41875803,"python,numpy",codeblock,https://stackoverflow.com/questions/41883440,"np.diff(np.hstack((0, t)))","np.ediff1d(t, to_begin=t[0])",0.0312,0.092
41883440,answer,41875803,"python,numpy",codeblock,https://stackoverflow.com/questions/41883440,"np.diff(np.concatenate(([0], t)))","np.ediff1d(t, to_begin=t[0])",0.0231,0.092
41888241,answer,41888080,"python,pandas,numpy,dataframe",sentence,"as expected, using loc is considerably faster than append (about 14x):",loc,append,,
41890162,answer,41890029,"python,pandas",codeblock,https://stackoverflow.com/questions/41890162,"pd.concat([df, pd.DataFrame(D, index=df.index)], axis=1)",df.assign(**D),875,1220
41920427,answer,41920367,"python,arrays,numpy,split",codeblock,https://stackoverflow.com/questions/41920427,"b[np.arange(b.shape[0])[:,None], np.argpartition(b,M,axis=1)[:,:M]].sum(1)","b[np.arange(b.shape[0])[:,None], b.argsort(1)[:,:M]].sum(1)",3.57,14.2
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'],df['a'].loc[:],0.00817,0.0265
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'].loc[:],"df.loc[:, 'a']",0.0265,0.126
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df.loc[df.a < 0.5]['a'],df[df.a < 0.5]['a'],45.8,45.8
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'],df.loc[:]['a'],0.00817,0.0259
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df.loc[:]['a'],"df.loc[:, 'a']",0.0259,0.126
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df.loc[:]['a'],df[:]['a'],0.0259,0.436
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'].loc[:],df[:]['a'],0.0265,0.436
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,"df[['a','b']]","df.loc[:, ['a','b']]",22,22.6
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,"df.loc[:, 'a']",df[:]['a'],0.126,0.436
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'],df[:]['a'],0.00817,0.436
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df.loc[:]['a'],df['a'].loc[:],0.0259,0.0265
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,"df.loc[df.a < 0.5, 'a']",df[df.a < 0.5]['a'],37,45.8
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,"df.loc[df.a < 0.5, 'a']",df.loc[df.a < 0.5]['a'],37,45.8
41920860,answer,41920808,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/41920860,df['a'],"df.loc[:, 'a']",0.00817,0.126
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,"(df.loc[:, df.iloc[0].notnull()])",(df[df.columns[df.notnull().iloc[0]]]),0.635,0.995
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,(df[df.columns[df.iloc[0].notnull()]]),(df[df.columns[df.notnull().iloc[0]]]),0.82,0.995
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,"(df.loc[:, df.iloc[0].notnull()])",(df[df.columns[df.iloc[0].notnull()]]),0.635,0.82
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,"(df.loc[:, df.iloc[0].notnull()])",(df[df.columns[df.notnull().iloc[0]]]),4.14,7.07
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,(df[df.columns[df.iloc[0].notnull()]]),(df[df.columns[df.notnull().iloc[0]]]),4.3,7.07
41943730,answer,41943699,pandas,codeblock,https://stackoverflow.com/questions/41943730,"(df.loc[:, df.iloc[0].notnull()])",(df[df.columns[df.iloc[0].notnull()]]),4.14,4.3
41951236,answer,41951223,"python,pandas",codeblock,https://stackoverflow.com/questions/41951236,"(df.groupby(['doctor name','gender']).size().unstack(level=0, fill_value=0))","(pd.crosstab(df.gender, df['doctor name']))",141,215
41951236,answer,41951223,"python,pandas",codeblock,https://stackoverflow.com/questions/41951236,"(pd.crosstab(df.gender, df['doctor name']))","(pd.pivot_table(df, index='gender', columns='doctor name', aggfunc=len, fill_value=0))",215,251
41951236,answer,41951223,"python,pandas",codeblock,https://stackoverflow.com/questions/41951236,"(df.groupby(['doctor name','gender']).size().unstack(level=0, fill_value=0))","(pd.pivot_table(df, index='gender', columns='doctor name', aggfunc=len, fill_value=0))",141,251
41951236,answer,41951223,"python,pandas",codeblock,https://stackoverflow.com/questions/41951236,"(df.groupby(['doctor name','gender']).size())",(df.groupby(['doctor name']).gender.value_counts()),141,254
41959759,answer,41957574,"python,numpy,tensorflow,theano,numba",codeblock,https://stackoverflow.com/questions/41959759,np.count_nonzero((abcd <= data2a) & (abcd >= data2b)),"np.where(((abcd <= data2a) & (abcd >= data2b)), 1, 0).sum()",0.0288,0.0818
41974832,answer,41974798,"python,python-3.x,pandas,indexing,series",codeblock,https://stackoverflow.com/questions/41974832,"(pd.Series(pd.factorize(s)[0] + 1, s.index))",(s.rank(method='dense').astype(int)),13.9,536
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,series.map(dictionary.get),"series.map(lambda x: dictionary.get(x,x))",0.124,0.15
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,series.map(dictionary.get),series.map(dictionary),0.124,5.45
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,series.map(dictionary.get),series.replace(dictionary),0.124,1230
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,"series.map(lambda x: dictionary.get(x,x))",series.map(dictionary),0.15,5.45
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,"series.map(lambda x: dictionary.get(x,x))",series.replace(dictionary),0.15,1230
41987136,answer,41985566,"python,performance,pandas,dictionary",codeblock,https://stackoverflow.com/questions/41987136,series.map(dictionary),series.replace(dictionary),5.45,1230
42009415,answer,41998147,"python,machine-learning,scipy,scikit-learn,sparse-matrix",codeblock,https://stackoverflow.com/questions/42009415,"A[:,:1000:50]","A[:,:1000:50].copy()",0.00056,0.0525
42017825,answer,42017574,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/42017825,"item_sale_avg['Price Category2'] = pd.cut(item_sale_avg['Sales'], bins=[-np.inf,500, 1500, np.inf], labels=['low','medium','high'], right=False)",item_sale_avg['Price Category1'] = item_sale_avg['Sales'].map(lambda price: 'low' if price < 500 else 'medium' if price < 1500 else 'high'),9.17,125
42017825,answer,42017574,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/42017825,"item_sale_avg['Price Category2'] = pd.cut(item_sale_avg['Sales'], bins=[-np.inf,500, 1500, np.inf], labels=['low','medium','high'], right=False)","item_sale_avg['Price Category'] = np.where(item_sale_avg.Sales < 500, 'low',  np.where(item_sale_avg.Sales >= 1500, 'high', 'medium'))",9.17,70.4
42017825,answer,42017574,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/42017825,"item_sale_avg['Price Category'] = np.where(item_sale_avg.Sales < 500, 'low',  np.where(item_sale_avg.Sales >= 1500, 'high', 'medium'))",item_sale_avg['Price Category1'] = item_sale_avg['Sales'].map(lambda price: 'low' if price < 500 else 'medium' if price < 1500 else 'high'),70.4,125
42036542,answer,13550376,"python,arrays,image,numpy,python-imaging-library",codeblock,https://stackoverflow.com/questions/42036542,"np.fromstring(im.tobytes(), dtype=np.uint8)","np.array(im.getdata(), dtype=np.uint8)",0.23,114
42054293,answer,42054132,"python,pandas",codeblock,https://stackoverflow.com/questions/42054293,df.inputs.values.tolist(),df.inputs.tolist(),0.00552,0.0115
42055374,answer,22649693,"python,pandas",codeblock,https://stackoverflow.com/questions/42055374,df[df.values.sum(axis=1) != 0],df[(df.sum(axis=1) != 0)],0.217,0.495
42055374,answer,22649693,"python,pandas",codeblock,https://stackoverflow.com/questions/42055374,bdf[(bdf.sum(axis=1) != 0)],bdf[(bdf.T != 0).any()],1.09,1.63
42055374,answer,22649693,"python,pandas",codeblock,https://stackoverflow.com/questions/42055374,bdf[bdf.values.sum(axis=1) != 0],bdf[(bdf.T != 0).any()],0.517,1.63
42055374,answer,22649693,"python,pandas",codeblock,https://stackoverflow.com/questions/42055374,bdf[bdf.values.sum(axis=1) != 0],bdf[(bdf.sum(axis=1) != 0)],0.517,1.09
42064642,answer,42064624,"python,list,pandas,row,min",codeblock,https://stackoverflow.com/questions/42064642,df['Min1'] = [min(x) for x in df.Lists.values.tolist()],df['Min2'] = [min(x) for x in df.Lists.tolist()],137,142
42064642,answer,42064624,"python,list,pandas,row,min",codeblock,https://stackoverflow.com/questions/42064642,df['Min1'] = [min(x) for x in df.Lists.values.tolist()],df['Min4'] = df.Lists.apply(lambda x: min(x)),137,170
42064642,answer,42064624,"python,list,pandas,row,min",codeblock,https://stackoverflow.com/questions/42064642,df['Min2'] = [min(x) for x in df.Lists.tolist()],df['Min4'] = df.Lists.apply(lambda x: min(x)),142,170
42101326,answer,42101082,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/42101326,"np.take(a,full_idx)","a[np.arange(m)[:,None], idx]",0.486,1.42
42136116,answer,42135733,"python,performance,python-2.7,numpy,vectorization",codeblock,https://stackoverflow.com/questions/42136116,"np.bincount(ind, val, minlength=empty.size)","np.add.at(empty, ind, val)",0.00205,0.00432
42168760,answer,42168103,"python,pandas",sentence,"df.itertuples tends to be slightly faster than df.iterrows, but the difference is minor.",df.itertuples,df.iterrows,,
42172950,answer,42170786,"python,numpy",codeblock,https://stackoverflow.com/questions/42172950,"np.einsum('ijji',abig)","np.trace(np.trace(abig,0,0,3))",0.0302,12.4
42181943,answer,42181860,"python,pandas,dataframe,kaggle",codeblock,https://stackoverflow.com/questions/42181943,"np.where(df.Age.values < 16, 'Child', df.Sex.values)","df.apply(lambda x: 'Child' if x['Age'] < 16 else x['Sex'], axis=1)",3.06,5730
42185645,answer,42184499,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42185645,"np.argpartition(a,range(5))[:5]",a.argsort()[:5],0.112,0.888
42185645,answer,42184499,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42185645,a.argsort(),"np.argpartition(a,range(a.size-1))[:5]",0.893,105
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,(pd.get_dummies(df.set_index('ID').stack()).groupby(level=0).max().astype(int)),(pd.get_dummies(df.set_index('ID').T.unstack()).groupby(level=0).sum().astype(int)),26.3,27.9
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,(pd.get_dummies(df.set_index('ID').T.unstack()).groupby(level=0).sum().astype(int)),"(df.set_index('ID').apply(lambda x: pd.Series(dict(zip(x, [1]*len(df.columns)))), axis=1).fillna(0).astype(int))",27.9,3950
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,(pd.get_dummies(df.set_index('ID').stack()).groupby(level=0).max().astype(int)),"(pd.get_dummies(df.set_index('ID'), prefix_sep='', prefix='').groupby(axis=1, level=0).max())",26.3,26.4
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,(pd.get_dummies(df.set_index('ID').stack()).groupby(level=0).max().astype(int)),"(df.set_index('ID').apply(lambda x: pd.Series(dict(zip(x, [1]*len(df.columns)))), axis=1).fillna(0).astype(int))",26.3,3950
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,"(pd.get_dummies(df.set_index('ID'), prefix_sep='', prefix='').groupby(axis=1, level=0).max())","(df.set_index('ID').apply(lambda x: pd.Series(dict(zip(x, [1]*len(df.columns)))), axis=1).fillna(0).astype(int))",26.4,3950
42197666,answer,42196972,"python,python-3.x,pandas,dataframe,reshape",codeblock,https://stackoverflow.com/questions/42197666,"(pd.get_dummies(df.set_index('ID'), prefix_sep='', prefix='').groupby(axis=1, level=0).max())",(pd.get_dummies(df.set_index('ID').T.unstack()).groupby(level=0).sum().astype(int)),26.4,27.9
42241686,answer,42241286,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/42241686,(img==1).any(axis=2)*255,"np.where(np.logical_or.reduce(img==1, axis=-1), 255, 0)",19.1,22.3
42249579,answer,42249512,"pandas,optimization,categorical-data",codeblock,https://stackoverflow.com/questions/42249579,"pd.Categorical.from_codes(mask, ['outer','inner'])","pd.Categorical(np.where(mask, 'inner', 'outer'))",0.139,0.196
42260496,answer,42260173,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/42260496,df.a.str.startswith('t'),df['a'].map(lambda x: x.startswith('t')),75.7,76.5
42287297,answer,42287162,"python,arrays,numpy,matrix,condition",codeblock,https://stackoverflow.com/questions/42287297,"np.in1d(A, L).reshape(A.shape).astype(int)","np.apply_along_axis(np.in1d, 1, A, L).astype(int)",6.4,21.5
42287297,answer,42287162,"python,arrays,numpy,matrix,condition",codeblock,https://stackoverflow.com/questions/42287297,"np.in1d(A, L).reshape(A.shape).astype(int)","np.apply_along_axis(np.in1d, 0, A, L).astype(int)",6.4,35.1
42287297,answer,42287162,"python,arrays,numpy,matrix,condition",codeblock,https://stackoverflow.com/questions/42287297,"np.apply_along_axis(np.in1d, 1, A, L).astype(int)","np.apply_along_axis(np.in1d, 0, A, L).astype(int)",21.5,35.1
42302493,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302493,"np.mgrid[:a, :b].swapaxes(2, 0).swapaxes(0, 1)","np.mgrid[:a, :b].transpose(1,2,0)",0.181,0.182
42302493,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302493,"np.mgrid[:a, :b].swapaxes(2, 0).swapaxes(0, 1)","np.mgrid[:a, :b].transpose(1,2,0)",7.17,7.47
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.moveaxis(np.indices((4,5)), 0, -1)","np.mgrid[:4, :5].swapaxes(2, 0).swapaxes(0, 1)",0.0111,0.0171
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.moveaxis(np.indices((4,5)), 0, -1)","np.mgrid[:4,:5].transpose(1,2,0)",0.0111,0.017
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.mgrid[:400, :500].swapaxes(2, 0).swapaxes(0, 1)","np.mgrid[:400,:500].transpose(1,2,0)",1.01,1.03
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.moveaxis(np.indices((400,500)), 0, -1)","np.mgrid[:400,:500].transpose(1,2,0)",0.351,1.03
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.mgrid[:4,:5].transpose(1,2,0)","np.mgrid[:4, :5].swapaxes(2, 0).swapaxes(0, 1)",0.017,0.0171
42302983,answer,42302348,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/42302983,"np.moveaxis(np.indices((400,500)), 0, -1)","np.mgrid[:400, :500].swapaxes(2, 0).swapaxes(0, 1)",0.351,1.01
42310449,answer,42309353,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/42310449,M*M.T,MA@MA.T,2.44,56.3
42310449,answer,42309353,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/42310449,MA@MA.T,M*M.T,56.3,175
42310449,answer,42309353,"python,numpy,dot-product",codeblock,https://stackoverflow.com/questions/42310449,MA@MA.T,M*M.T,60.4,64
42315349,answer,42315146,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/42315349,"np.einsum('...i,...i ->...', a, a)",(a*a).sum(axis=-1),0.944,3.63
42315349,answer,42315146,"python,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/42315349,"np.einsum('...i,...i ->...', a, a)",(a*a).sum(axis=-1),0.00559,0.00911
42315752,answer,42315541,"python,numpy",codeblock,https://stackoverflow.com/questions/42315752,np.inf,float('inf'),3.79E-05,0.000232
42329016,answer,42328934,"python,numpy",codeblock,https://stackoverflow.com/questions/42329016,"np.array([j for x, y in zip(arr - 0.2, arr + 0.25) for j in np.arange(x,y,0.1)])","np.array([j for i in arr for j in np.arange(i-0.2, i+0.25, 0.1)])",250,615
42329016,answer,42328934,"python,numpy",codeblock,https://stackoverflow.com/questions/42329016,"np.array([arr + i for i in np.arange(-0.2, 0.25, 0.1)]).T.ravel()","np.array([j for i in arr for j in np.arange(i-0.2, i+0.25, 0.1)])",1.93,615
42329016,answer,42328934,"python,numpy",codeblock,https://stackoverflow.com/questions/42329016,"np.array([arr + i for i in np.arange(-0.2, 0.25, 0.1)]).T.ravel()","np.array([j for x, y in zip(arr - 0.2, arr + 0.25) for j in np.arange(x,y,0.1)])",1.93,250
42334249,answer,42333689,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/42334249,"(inputx[:,None] == np.unique(inputx)).view(np.int8)","(inputx[:,None] == np.unique(inputx)).astype(np.int8)",92.5,98.4
42346386,answer,42346323,"python,pandas",codeblock,https://stackoverflow.com/questions/42346386,"(df.groupby(['p1','p2','p3']).p4.apply(lambda x: x.tolist()))","(df.groupby(['p1','p2','p3']).p4.apply(list))",18.4,22.6
42373694,answer,42373654,"python,numpy,mapping,where",codeblock,https://stackoverflow.com/questions/42373694,"np.searchsorted(array2, array1)","np.where(np.in1d(array2, array1))",0.04,0.483
42419055,answer,42419003,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/42419055,(df.values**2).sum(0),(df**2).sum(0),0.0402,0.518
42458673,answer,42458179,"python,numpy,reshape",codeblock,https://stackoverflow.com/questions/42458673,"np.hstack([X.reshape(-1, 1), Y.reshape(-1, 1)])","np.stack((X.ravel(), Y.ravel()), axis=-1)",4.77,4.89
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.values[:] = np.core.defchararray.replace(df.values.astype(str), ' ', '_')","df.stack().str.replace(' ', '_').unstack()",0.0784,2.29
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.values[:] = np.core.defchararray.replace(df.values.astype(str), ' ', '_')","df.replace(' ', '_', regex=True)",0.0784,0.932
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.replace(' ', '_', regex=True)","df.stack().str.replace(' ', '_').unstack()",0.932,2.29
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.stack().str.replace(' ', '_').unstack()","df.values[:] = np.core.defchararray.replace(df.values.astype(str), ' ', '_')",99.2,181
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.stack().str.replace(' ', '_').unstack()","df.replace(' ', '_', regex=True)",99.2,4140
42462626,answer,42462530,"python,pandas",codeblock,https://stackoverflow.com/questions/42462626,"df.values[:] = np.core.defchararray.replace(df.values.astype(str), ' ', '_')","df.replace(' ', '_', regex=True)",181,4140
42484373,answer,42483959,"python,pandas",codeblock,https://stackoverflow.com/questions/42484373,(df.CITY.str.startswith('BH')),(df.CITY.str.contains('^BH')),151,254
42488633,answer,42488536,"python,arrays,numpy,dimension",codeblock,https://stackoverflow.com/questions/42488633,"np.broadcast_to(array1, (20, 20, 2, 4))","np.tile(array1, (20, 20, 1, 1))",0.00278,0.00801
42535482,answer,42535180,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42535482,(pd.DataFrame(df['card'].values.tolist())),(df['card'].apply(pd.Series)),6.72,1260
42537953,answer,42534970,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/42537953,Bs.dot(As),sparse.csr_matrix(B).dot(sparse.csr_matrix(A)).A,19,94.1
42537953,answer,42534970,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/42537953,As.dot(B),As.dot(Bs),5.82,10
42542452,answer,42542026,"python,pandas,dataframe,subtraction",codeblock,https://stackoverflow.com/questions/42542452,"df.subtract(df2, fill_value=0).reindex_like(df).astype(int)",(df-df2).combine_first(df).reindex_like(df).astype(int),3.63,8.69
42563278,answer,42563209,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42563278,df.groupby('franchise')['items'].value_counts().unstack(fill_value=0),"(df.groupby(""franchise"")['items'].apply(Counter).unstack(fill_value=0).astype(int))",2.71,4.18
42563278,answer,42563209,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42563278,"df.groupby(['franchise', 'items']).size().unstack(fill_value=0)","(df.groupby(""franchise"")['items'].apply(Counter).unstack(fill_value=0).astype(int))",2.73,4.18
42563278,answer,42563209,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42563278,df.groupby('franchise')['items'].value_counts().unstack(fill_value=0),"df.groupby(['franchise', 'items']).size().unstack(fill_value=0)",2.71,2.73
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,"np.tensordot(b,a,axes=((1,1)))","np.einsum('ij,kj->ki',a,b)",170,7590
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,b.dot(a.T),"np.tensordot(b,a,axes=((1,1)))",169,170
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,b.dot(a.T),"np.einsum('ij,kj->ki',a,b)",169,7590
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,"np.tensordot(b,a,axes=((1,1)))",a.dot(b.T).T,170,234
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,a.dot(b.T).T,"np.einsum('ij,kj->ki',a,b)",234,7590
42588792,answer,42588757,"performance,python-2.7,numpy,vectorization,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/42588792,b.dot(a.T),a.dot(b.T).T,169,234
42609730,answer,42609658,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42609730,"(df.loc[df.TICKET.duplicated(keep=False), 'Client'].value_counts())",(df.groupby('TICKET').filter(lambda x: len(x) > 1)['Client'].value_counts()),0.769,2.55
42609730,answer,42609658,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42609730,"(df.loc[df.TICKET.duplicated(keep=False), 'Client'].value_counts())",(df.groupby('TICKET').filter(lambda x: len(x) > 1)['Client'].value_counts()),54.8,282
42613567,answer,42613467,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/42613567,df[(df > 95).any(1)],df[df.T[(df.T > 95)].any()],8480,13000
42628606,answer,42628577,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/42628606,df.astype(np.float64),"df.apply(lambda x: x.astype(np.float64), axis=0)",288,748
42628606,answer,42628577,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/42628606,"df.apply(lambda x: x.astype(np.float64), axis=0)","df.apply(lambda x: x.astype(np.float64), axis=1)",748,2950
42628606,answer,42628577,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/42628606,df.astype(np.float64),"df.apply(lambda x: x.astype(np.float64), axis=1)",288,2950
42631281,answer,42628577,"python,performance,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/42631281,pd.DataFrame(df.values.astype(np.float64)),df.astype(np.float64),42.5,121
42646329,answer,42646111,"python,numpy",codeblock,https://stackoverflow.com/questions/42646329,np.sum(a)/float(len(a)),np.average(a),0.00436,0.0072
42653857,answer,42652023,"python,arrays,sorting,numpy,unique",codeblock,https://stackoverflow.com/questions/42653857,~((slices[1:] == slices[:-1]).any()),np.diff(slices).all(),6.12,20.6
42653857,answer,42652023,"python,arrays,sorting,numpy,unique",codeblock,https://stackoverflow.com/questions/42653857,~((slices[1:] == slices[:-1]).any()),~np.any(np.diff(slices) == 0),6.12,18.5
42653857,answer,42652023,"python,arrays,sorting,numpy,unique",codeblock,https://stackoverflow.com/questions/42653857,~np.any(np.diff(slices) == 0),np.diff(slices).all(),18.5,20.6
42691073,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42691073,"np.sum(a.dot(b), axis = 0)","np.einsum('ij,jk->k',a,b)",5.5,71.8
42691232,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42691232,"numpy.sum(a@b, axis=0)","numpy.einsum(""ij,jk->k"", a, b)",12.8,87.2
42691232,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42691232,"numpy.sum(a, axis=0)@b","numpy.sum(a@b, axis=0)",0.3,12.8
42691232,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42691232,"numpy.sum(a, axis=0)@b","numpy.einsum(""ij,jk->k"", a, b)",0.3,87.2
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a)","np.sum(a,0)",0.173,0.312
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c2=np.sum(a,axis=0).dot(b)","c3=np.einsum('ij,jk->k',a,b)",0.432,170
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c4=np.einsum('j,jk->k', np.einsum('ij->j', a), b)","c1=np.sum(a.dot(b), axis=0)",0.353,27.7
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c1=np.sum(a.dot(b), axis=0)","c3=np.einsum('ij,jk->k',a,b)",27.7,170
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c2=np.sum(a,axis=0).dot(b)","c1=np.sum(a.dot(b), axis=0)",0.432,27.7
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c4=np.einsum('j,jk->k', np.einsum('ij->j', a), b)","c2=np.sum(a,axis=0).dot(b)",0.353,0.432
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"c4=np.einsum('j,jk->k', np.einsum('ij->j', a), b)","c3=np.einsum('ij,jk->k',a,b)",0.353,170
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a) @b","c1=np.sum(a.dot(b), axis=0)",0.304,27.7
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a) @b","c2=np.sum(a,axis=0).dot(b)",0.304,0.432
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a) @b","c3=np.einsum('ij,jk->k',a,b)",0.304,170
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",sentence,einsum is actually faster than np.sum!,einsum,np.sum,,
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a) @b","c4=np.einsum('j,jk->k', np.einsum('ij->j', a), b)",0.304,0.353
42701891,answer,42690970,"python,numpy,matrix-multiplication,dot-product",codeblock,https://stackoverflow.com/questions/42701891,"np.einsum('ij->j', a) @b","c2=np.sum(a,axis=0).dot(b)",51.5,59.5
42717221,answer,42716658,"python,pandas",codeblock,https://stackoverflow.com/questions/42717221,"np.where(df['Val_x'].notnull(), df['Val_x'], df['Val_y'])","df['Val_y'].where(df['Val_y'].notnull(), df['Val_x'])",31,98.9
42717221,answer,42716658,"python,pandas",codeblock,https://stackoverflow.com/questions/42717221,"np.where(df['Val_x'].notnull(), df['Val_x'], df['Val_y'])",df['Val_x'].fillna(df['Val_y']),31,127
42717221,answer,42716658,"python,pandas",codeblock,https://stackoverflow.com/questions/42717221,"df['Val_y'].where(df['Val_y'].notnull(), df['Val_x'])",df['Val_x'].fillna(df['Val_y']),98.9,127
42732392,answer,42732175,"python,arrays,performance,numpy,indexing",codeblock,https://stackoverflow.com/questions/42732392,"X.take(idx2, axis=0).shape","X[idx2,:].shape",0.00366,0.00558
42740947,answer,42740524,"python,pandas,select",codeblock,https://stackoverflow.com/questions/42740947,df[df['ticker'].isin(sp500)],"pd.merge(df, s)",42.4,50.2
42766684,answer,42766654,"python,pandas,data-analysis",codeblock,https://stackoverflow.com/questions/42766684,(df.groupby('city')['difference'].transform(np.sum)),(df.groupby('city')['difference'].transform('sum')),561,570
42766684,answer,42766654,"python,pandas,data-analysis",codeblock,https://stackoverflow.com/questions/42766684,(df.groupby('city')['difference'].transform(sum)),(df.groupby('city')['difference'].transform('sum')),567,570
42766684,answer,42766654,"python,pandas,data-analysis",codeblock,https://stackoverflow.com/questions/42766684,(df.groupby('city')['difference'].transform(np.sum)),(df.groupby('city')['difference'].transform(sum)),561,567
42768755,answer,42767816,"python,performance,numpy,cython,scientific-computing",codeblock,https://stackoverflow.com/questions/42768755,numpy.array(example.my_uniform(10000)),numpy.random.uniform(size=10000),0.0854,0.13
42768755,answer,42767816,"python,performance,numpy,cython,scientific-computing",codeblock,https://stackoverflow.com/questions/42768755,numpy.random.normal(size=10000),numpy.array(example.my_gaussian(10000)),0.393,0.542
42768755,answer,42767816,"python,performance,numpy,cython,scientific-computing",codeblock,https://stackoverflow.com/questions/42768755,numpy.array(example.my_gaussian_fast(10000)),numpy.random.normal(size=10000),0.266,0.393
42768755,answer,42767816,"python,performance,numpy,cython,scientific-computing",codeblock,https://stackoverflow.com/questions/42768755,numpy.array(example.my_gaussian_fast(10000)),numpy.array(example.my_gaussian(10000)),0.266,0.542
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['new1'] = df[cols].values.sum(axis=1),df['new2'] = df[cols].astype(str).sum(axis=1).astype(int).astype(str),6.5,68.6
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['new1'] = df[cols].values.sum(axis=1),"df['new'] = df[cols].astype(str).apply(''.join, axis=1)",6.5,386
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['concat'] = pd.Series(df[cols].fillna('').values.tolist()).str.join(''),df['new2'] = df[cols].astype(str).sum(axis=1).astype(int).astype(str),17.4,68.6
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['new1'] = df[cols].values.sum(axis=1),df['concat'] = pd.Series(df[cols].fillna('').values.tolist()).str.join(''),6.5,17.4
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['concat'] = pd.Series(df[cols].fillna('').values.tolist()).str.join(''),"df['new'] = df[cols].astype(str).apply(''.join, axis=1)",17.4,386
42787017,answer,42786804,"python,pandas",codeblock,https://stackoverflow.com/questions/42787017,df['new2'] = df[cols].astype(str).sum(axis=1).astype(int).astype(str),"df['new'] = df[cols].astype(str).apply(''.join, axis=1)",68.6,386
42787766,answer,42786781,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/42787766,"np.cross(a, np.array(np.meshgrid(x,y,z)).transpose(2,1,3,0)).reshape(-1,3).T","[np.cross(a, r) for r in product(x, y, z)]",16,7340
42849006,answer,42847989,"python,algorithm,performance,pandas,join",codeblock,https://stackoverflow.com/questions/42849006,"pd.DataFrame(np.random.randn(100, 100)).sum()","pd.DataFrame(np.random.randn(100, 100)).apply(lambda row: sum(row), axis=1)",1.2,7.63
42862472,answer,28663856,"python,numpy,multidimensional-array,count",codeblock,https://stackoverflow.com/questions/42862472,"np.bincount(choices, minlength=np.size(choices))","[ np.sum(choices == k) for k in range(min(choices), max(choices)+1) ]",0.0163,2.67
42871122,answer,42870125,"python,numpy",codeblock,https://stackoverflow.com/questions/42871122,"np.tensordot(randos,lookup_arr,axes=((-2,-1),(0,1)))","np.tensordot(np.array(randos).reshape(-1,4),lookup, axes=((-1),(0)))",0.0333,0.037
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.column_stack([a, b])","np.vstack((a, b)).T",0.0095,0.0147
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.array([a, b]).T","np.concatenate((a[:,None], b[:,None]), axis=1)",0.00444,0.0056
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.concatenate((a[:,None], b[:,None]), axis=1)","np.column_stack([a, b])",0.0056,0.0095
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.array([a, b]).T","np.vstack((a, b)).T",0.00444,0.0147
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.array([a, b]).T","np.column_stack([a, b])",0.00444,0.0095
42912402,answer,42909716,"python,numpy,matrix,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/42912402,"np.concatenate((a[:,None], b[:,None]), axis=1)","np.vstack((a, b)).T",0.0056,0.0147
42916378,answer,42916330,"python,arrays,performance,numpy,multidimensional-array",sentence,you can also use np.where but it's slower than np.count_nonzero(),np.count_nonzero(),np.where,,
42961967,answer,42961930,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/42961967,"np.logical_or( a!=0, b!=0)","~np.logical_and( a==0, b==0)",0.0628,0.0684
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.hstack((x, y, z))","np.reshape((x,y,z),(3,4)).T",0.016,0.0216
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.column_stack((x, y, z))","np.c_[x, y, z]",0.00918,0.0559
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.column_stack((x, y, z))","np.reshape((x,y,z),(3,4)).T",0.00918,0.0216
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.array([x.squeeze(), y.squeeze(), z.squeeze()]).T","np.c_[x, y, z]",0.00736,0.0559
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.column_stack((x, y, z))","np.hstack((x, y, z))",0.00918,0.016
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.array([x.squeeze(), y.squeeze(), z.squeeze()]).T","np.reshape((x,y,z),(3,4)).T",0.00736,0.0216
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.array([x.squeeze(), y.squeeze(), z.squeeze()]).T","np.hstack((x, y, z))",0.00736,0.016
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.array([x.squeeze(), y.squeeze(), z.squeeze()]).T","np.column_stack((x, y, z))",0.00736,0.00918
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.reshape((x,y,z),(3,4)).T","np.c_[x, y, z]",0.0216,0.0559
42965216,answer,42963862,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/42965216,"np.hstack((x, y, z))","np.c_[x, y, z]",0.016,0.0559
42992709,answer,38078029,"python,list,pandas,unpack",codeblock,https://stackoverflow.com/questions/42992709,"pd.DataFrame({ ""l1"": np.repeat(df.l1.values, df.l2.str.len()), ""l2"": list(chain.from_iterable(df.l2))})","pd.DataFrame([(left, right) for outer in zip(l1, l2) for left, right in zip_longest(*outer, fillvalue=outer[0])])",1.41,2.57
42992709,answer,38078029,"python,list,pandas,unpack",codeblock,https://stackoverflow.com/questions/42992709,"(pd.DataFrame({ ""l1"": np.repeat(df.l1.values, df.l2.str.len()), ""l2"": list(chain.from_iterable(df.l2))}))","(pd.DataFrame([(left, right) for outer in zip(l1, l2) for left, right in zip_longest(*outer, fillvalue=outer[0])]))",84.6,242
43006022,answer,43005012,"python,pandas",codeblock,https://stackoverflow.com/questions/43006022,"dfMod[""weekIndex""] = dfMod[""day""].map(d)","dfMod[""weekIndex1""] = dfMod[""day""].apply(lambda x: d[x])",22.7,141
43009606,answer,43008527,"python,arrays,numpy,iteration,subtraction",codeblock,https://stackoverflow.com/questions/43009606,subs[mask],subs[idx],4.15,10.9
43012324,answer,43012242,"python,pandas,datetime,numpy",codeblock,https://stackoverflow.com/questions/43012324,"df.date.apply(lambda s: dt.strptime(s,f))",pd.to_datetime(df.date),0.369,0.771
43019369,answer,43019241,"python,pandas",codeblock,https://stackoverflow.com/questions/43019369,"df[""a""].str.split().str.len().sum()",df.a.str.extractall('(\S+)').count()[0],0.447,1.28
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"any([np.array_equal(h, arr) for arr in g.values()])","np.any([np.array_equal(h, arr) for arr in g.values()])",0.0489,0.0691
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"np.any((np.array_equal(h, arr) for arr in g.values()))","any((np.array_equal(h, arr) for arr in g.values()))",0.0185,0.0356
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"any((np.array_equal(h, arr) for arr in g.values()))","any([np.array_equal(h, arr) for arr in g.values()])",0.0356,0.0489
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"np.any((np.array_equal(h, arr) for arr in g.values()))","np.any([np.array_equal(h, arr) for arr in g.values()])",0.0185,0.0691
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"np.any((np.array_equal(h, arr) for arr in g.values()))","any([np.array_equal(h, arr) for arr in g.values()])",0.0185,0.0489
43057331,answer,43056079,"python-2.7,numpy,dictionary,matrix",codeblock,https://stackoverflow.com/questions/43057331,"any((np.array_equal(h, arr) for arr in g.values()))","np.any([np.array_equal(h, arr) for arr in g.values()])",0.0356,0.0691
43069412,answer,43069340,"python,pandas",codeblock,https://stackoverflow.com/questions/43069412,"df['Type'] = np.where(df.Number.pow(2).lt(40), 'number1', 'number2')","df['Type2'] = df.apply(f, axis=1)",1.63,127
43069412,answer,43069340,"python,pandas",codeblock,https://stackoverflow.com/questions/43069412,"df['Type'] = np.where(df.Number.pow(2).lt(40), 'number1', 'number2')",df['Type1'] = 'number' + (1 + ((df.Number**2)>40).astype(int)).astype(str),1.63,13.5
43069412,answer,43069340,"python,pandas",codeblock,https://stackoverflow.com/questions/43069412,df['Type1'] = 'number' + (1 + ((df.Number**2)>40).astype(int)).astype(str),"df['Type2'] = df.apply(f, axis=1)",13.5,127
43075859,answer,43075747,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/43075859,df.b.ffill(inplace = True),df['b'] = df.groupby('a')['b'].transform(lambda x: x.fillna(method='ffill')),0.311,2.34
43075859,answer,43075747,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/43075859,df.b.ffill(inplace = True),df['b'] = df.groupby('a')['b'].fillna(method='ffill'),0.311,4.41
43075859,answer,43075747,"python,pandas,missing-data",codeblock,https://stackoverflow.com/questions/43075859,df['b'] = df.groupby('a')['b'].transform(lambda x: x.fillna(method='ffill')),df['b'] = df.groupby('a')['b'].fillna(method='ffill'),2.34,4.41
43079218,answer,43079057,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43079218,df.set_index('Group').ne(0).groupby(level=0).sum().astype(int).reset_index(),"df.pivot_table(index='Group', aggfunc=np.count_nonzero)",6.24,19.2
43079218,answer,43079057,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43079218,df.set_index('Group').ne(0).groupby(level=0).sum().astype(int).reset_index(),"df.pivot_table(index='Group', aggfunc=np.count_nonzero)",22.4,43
43099299,answer,43098926,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43099299,"df['event1'] = np.where(df.color == 'red', 1, np.nan)","df.loc[df.color == 'red', 'event'] = 1",23.6,25.4
43103280,answer,43103212,"python,pandas,datetime,indexing",codeblock,https://stackoverflow.com/questions/43103280,df.groupby(pd.TimeGrouper('1D')).mean(),"df.groupby(pd.Grouper(level=0, freq='1D')).mean()",6,6.48
43103280,answer,43103212,"python,pandas,datetime,indexing",codeblock,https://stackoverflow.com/questions/43103280,df.groupby(df.index.date).mean(),df.groupby(df.index.strftime('%Y%m%d')).mean(),1070,2600
43134244,answer,43134198,"python,list,pandas",codeblock,https://stackoverflow.com/questions/43134244,"pd.DataFrame(genre_list.values.tolist(), index=genre_list.index).replace({None:np.nan})",df1 = genre_list.apply(pd.Series),15.7,1960
43141231,answer,43141160,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43141231,df['label'].map(ord),df['label'].apply(ord),1,1.02
43141231,answer,43141160,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43141231,df['label'].map(ord),df['label'].apply(ord),0.123,0.146
43150816,answer,43150019,"python,pandas,parsing,nlp",codeblock,https://stackoverflow.com/questions/43150816,"df['text'].str.findall('\w{4,}').str.join(' ')","df.text.apply(lambda i: ' '.join(filter(lambda j: len(j) > 3, i.split())))",44.8,79.3
43150816,answer,43150019,"python,pandas,parsing,nlp",codeblock,https://stackoverflow.com/questions/43150816,"df.text.apply(lambda i: ' '.join(filter(lambda j: len(j) > 3, i.split())))","df['text'].str.split().map(lambda sl: "" "".join(s for s in sl if len(s) > 3))",79.3,87.2
43150816,answer,43150019,"python,pandas,parsing,nlp",codeblock,https://stackoverflow.com/questions/43150816,"df['text'].str.findall('\w{4,}').str.join(' ')","df['text'].str.split().map(lambda sl: "" "".join(s for s in sl if len(s) > 3))",44.8,87.2
43164805,answer,43164015,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/43164805,pd.DataFrame(df.payload.apply(json.loads).values.tolist())[required],pd.DataFrame(df.payload.apply(ast.literal_eval).values.tolist())[required],379,1980
43164805,answer,43164015,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/43164805,"pd.read_json('[{}]'.format(df.payload.str.cat(sep=',')))[required]",pd.DataFrame(df.payload.apply(ast.literal_eval).values.tolist())[required],528,1980
43164805,answer,43164015,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/43164805,pd.DataFrame(df.payload.apply(json.loads).values.tolist())[required],"pd.read_json('[{}]'.format(df.payload.str.cat(sep=',')))[required]",379,528
43182241,answer,43181583,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/43182241,"pd.DataFrame(df.columns[np.argsort(-df.values, axis=1)][:,[0,1,-1]], index=df.index, columns=['largest','second largest','smallest'])","df.apply(f ,axis=1)",0.974,3910
43182241,answer,43181583,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/43182241,"df.apply(lambda x: x.sort_values().index.to_series().iloc[0], axis=1)","df.apply(lambda x: x.sort_values(ascending=False).index.to_series().iloc[0], axis=1)",2470,2510
43182241,answer,43181583,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/43182241,"df.apply(lambda x: x.sort_values(ascending=False).index.to_series().iloc[0], axis=1)",[df.T.sort_values(by=k).T.keys()[-1] for k in df.T.keys()],2510,6420
43182241,answer,43181583,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/43182241,"df.apply(lambda x: x.sort_values().index.to_series().iloc[0], axis=1)",[df.T.sort_values(by=k).T.keys()[-1] for k in df.T.keys()],2470,6420
43184133,answer,43184106,"python,pandas",codeblock,https://stackoverflow.com/questions/43184133,"df[df['letter'].isin(df.loc[df['number'] == 0, 'letter'])]",df[df['letter'].isin(df[df['number'] == 0]['letter'])],0.657,0.815
43184184,answer,21761256,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/43184184,"np.concatenate((a[:300], [66], a[300:]))","np.insert(a, 300, 66)",0.00173,0.00772
43184184,answer,21761256,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/43184184,"np.concatenate((a[:2], [66], a[2:]))","np.insert(a, 2, 66)",0.00143,0.00686
43209910,answer,43209701,"python,pandas",codeblock,https://stackoverflow.com/questions/43209910,"(pd.concat([df.drop('genre',axis=1), pd.DataFrame(df.genre.values.tolist()).add_prefix('genre_')], axis=1))","(pd.concat([df.drop(['genre'],axis=1),df['genre'].apply(pd.Series).rename(columns={0:'genre_0',1:'genre_1',2:'genre_2',3:'genre_3'})],axis=1))",3.4,757
43218055,answer,43217946,"python,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43218055,"df.GO.replace(Dic, regex=True)","df[['GO']].replace({'GO':Dic}, regex=True)",876,895
43218055,answer,43217946,"python,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43218055,"df.GO.replace(Dic, regex=True)","df.GO.map(lambda x: next(Dic[k] for k in Dic if re.search(k, x)))",876,1570
43218055,answer,43217946,"python,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43218055,"df[['GO']].replace({'GO':Dic}, regex=True)","df.GO.map(lambda x: next(Dic[k] for k in Dic if re.search(k, x)))",895,1570
43218055,answer,43217946,"python,pandas,dictionary,dataframe",sentence,"intereseting observation - in older pandas versions, Series.map() method was almost always faster compared to DataFrame.replace() and Series.str.replace() methods.",Series.map(),DataFrame.replace(),,
43281246,answer,43281023,"python,sorting,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/43281246,"np.einsum('ijk,ijk->ij',a,a).argsort()","np.argsort(np.linalg.norm(a, axis=-1))",0.0197,0.0635
43281246,answer,43281023,"python,sorting,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/43281246,"np.einsum('ijk,ijk->ij',a,a).argsort()","np.argsort(np.linalg.norm(a, axis=-1))",22.6,88.6
43282039,answer,10922231,"python,performance,numpy,python-3.x",codeblock,https://stackoverflow.com/questions/43282039,sum(x),np.sum(y),0.0141,0.0143
43305460,answer,43305401,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43305460,"pd.isnull([1,2])","pd.DataFrame([1,2]).isnull()",0.00919,0.202
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"b.dot(Solver.reshape(4,-1).T).reshape(-1,2)","np.einsum('ijk,lk->lij',Solver, b).reshape(-1,2)",0.06,0.147
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"np.tensordot(b, Solver, axes=((-1),(-1))).reshape(-1,2)","np.einsum('ijk,lk->lij',Solver, b).reshape(-1,2)",0.0675,0.147
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"np.matmul(Solver, b.T).transpose(2,0,1).reshape(-1,2)","np.einsum('ijk,lk->lij',Solver, b).reshape(-1,2)",0.0751,0.147
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"np.tensordot(b, Solver, axes=((-1),(-1))).reshape(-1,2)","np.matmul(Solver, b.T).transpose(2,0,1).reshape(-1,2)",0.0675,0.0751
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"b.dot(Solver.reshape(4,-1).T).reshape(-1,2)","np.matmul(Solver, b.T).transpose(2,0,1).reshape(-1,2)",0.06,0.0751
43333367,answer,43332965,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/43333367,"b.dot(Solver.reshape(4,-1).T).reshape(-1,2)","np.tensordot(b, Solver, axes=((-1),(-1))).reshape(-1,2)",0.06,0.0675
43334174,answer,43334040,"python,numpy",codeblock,https://stackoverflow.com/questions/43334174,"np.concatenate((A, B), 1)","np.c_[A, B]",0.0031,0.0487
43334174,answer,43334040,"python,numpy",codeblock,https://stackoverflow.com/questions/43334174,"np.hstack((A,B))","np.c_[A, B]",0.0125,0.0487
43334174,answer,43334040,"python,numpy",codeblock,https://stackoverflow.com/questions/43334174,"np.concatenate((A, B), 1)","np.hstack((A,B))",0.0031,0.0125
43338408,answer,43337736,"python,numpy",codeblock,https://stackoverflow.com/questions/43338408,"a - b.reshape((-1,1))","np.subtract.outer(a, b)",2.46,2.52
43362446,answer,43359479,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/43362446,"pd.to_datetime(df['time'].str.extract(pat, expand=True))",df.time.apply(my_to_datetime),475,4100
43372844,answer,43372049,"python,numpy",codeblock,https://stackoverflow.com/questions/43372844,"np.concatenate([a[np.newaxis, :, :]]*n)",np.stack([a]*n),0.0107,0.0411
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,(df.reindex_axis(idx)),"(df.loc[['z', 'x', 'y'], :])",0.252,0.542
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,(df.reindex_axis(idx)),(df.reindex(idx)),0.252,0.271
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,"(df.reindex(columns=cols, index=idx))","(df.loc[['z', 'x', 'y'], ['d', 'a', 'b', 'c']])",0.402,0.653
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,(df.reindex(idx)),"(df.loc[['z', 'x', 'y'], :])",0.271,0.542
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,(df.reindex(idx)),"(df.loc[['z', 'x', 'y']])",0.271,0.418
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,"(df.loc[['z', 'x', 'y']])","(df.loc[['z', 'x', 'y'], :])",0.418,0.542
43384414,answer,43384397,"python,pandas",codeblock,https://stackoverflow.com/questions/43384414,(df.reindex_axis(idx)),"(df.loc[['z', 'x', 'y']])",0.252,0.418
43388413,answer,43387467,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/43388413,df['start_date_time1'] = df['start_date_time'].values.astype('<M8[m]'),"df['start_date_time'] = df['start_date_time'] - pd.to_timedelta(df['start_date_time'].dt.second, unit='s')",0.638,5.83
43388413,answer,43387467,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/43388413,"df['start_date_time'] = df['start_date_time'] - pd.to_timedelta(df['start_date_time'].dt.second, unit='s')",df['start_date_time2'] = df['start_date_time'].apply(lambda t: t.replace(second=0)),5.83,83.4
43388413,answer,43387467,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/43388413,df['start_date_time1'] = df['start_date_time'].values.astype('<M8[m]'),df['start_date_time2'] = df['start_date_time'].apply(lambda t: t.replace(second=0)),0.638,83.4
43426929,answer,43426866,"python,arrays,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43426929,"(df[df['ease'] == 1].groupby([""date"", ""tags""]).size().unstack(level=0, fill_value=0).reindex(index=df.tags.unique(), columns=df.date.unique(), fill_value=0).sort_index().sort_index(axis=1))","(df.groupby([""date"", ""tags""]).agg({""ease"": lambda x: (x == 1).sum()}).ease.unstack(level=0).fillna(0))",5.74,1940
43438036,answer,43437657,"python,pandas",codeblock,https://stackoverflow.com/questions/43438036,df['ma'] = data['pop'].rolling(5).mean(),df['ma_2'] = data.rolling(5).mean()['pop'],0.497,2.6
43465240,answer,43462944,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43465240,"exampleDF['sex'].mask(exampleDF['age'] < 15, 'child')","exampleDF[['age','sex']].apply(lambda x: 'child' if x['age'] < 15 else x['sex'],axis=1)",0.589,104
43465240,answer,43462944,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43465240,"exampleDF['sex'].mask(exampleDF['age'] < 15, 'child')","exampleDF[['age','sex']].apply(lambda x: 'child' if x['age'] < 15 else x['sex'],axis=1)",1.23,1030
43465240,answer,43462944,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43465240,"exampleDF['sex'].mask(exampleDF['age'] < 15, 'child')","exampleDF[['age','sex']].apply(lambda x: 'child' if x['age'] < 15 else x['sex'],axis=1)",0.517,0.867
43489223,answer,43489200,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/43489223,(np.isnan(df.values).all()),(df.isnull().all().all()),1.23,10
43489223,answer,43489200,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/43489223,(np.isnan(df.values).all()),(df.isnull().values.all()),1.23,1.46
43489223,answer,43489200,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/43489223,(df.isnull().values.all()),(df.isnull().all().all()),1.46,10
43497856,answer,43497772,"python,numpy,indexing",codeblock,https://stackoverflow.com/questions/43497856,"np.in1d(x, list(interesting_numbers))",x_mask = np.array([xi in interesting_numbers for xi in x]),0.0411,1.44
43506070,answer,43504899,"python,numpy,scipy,fft,correlation",codeblock,https://stackoverflow.com/questions/43506070,"fc = np.roll(ifft2(fft2(a).conj()*fft2(a)).real, (a.shape[0] - 1)//2, axis=(0,1))","c = correlate2d(a, a, boundary='wrap', mode='same')",3.19,3200
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,(~(pd.isnull(df.A) | pd.isnull(df.B))).idxmax(),"(~pd.isnull(df[['A','B']]).any(1)).argmax()",1.37,4.74
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,(~(pd.isnull(df.A) | pd.isnull(df.B))).idxmax(),"(~pd.isnull(df[['A','B']]).any(1)).idxmax()",1.37,4.73
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,df.index[(~(np.isnan(df.A.values) | np.isnan(df.B.values))).argmax()],"df[['A','B']].notnull().all(axis=1).idxmax()",0.169,4.91
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,df.index[(~(np.isnan(df.A.values) | np.isnan(df.B.values))).argmax()],(~(pd.isnull(df.A) | pd.isnull(df.B))).idxmax(),0.169,1.37
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,"(~pd.isnull(df[['A','B']]).any(1)).argmax()","df[['A','B']].notnull().all(axis=1).idxmax()",4.74,4.91
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,"(~pd.isnull(df[['A','B']]).any(1)).idxmax()","(~pd.isnull(df[['A','B']]).any(1)).argmax()",4.73,4.74
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,df.index[(~(np.isnan(df.A.values) | np.isnan(df.B.values))).argmax()],"(~pd.isnull(df[['A','B']]).any(1)).idxmax()",0.169,4.73
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,df.index[(~(np.isnan(df.A.values) | np.isnan(df.B.values))).argmax()],"(~pd.isnull(df[['A','B']]).any(1)).argmax()",0.169,4.74
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,(~(pd.isnull(df.A) | pd.isnull(df.B))).idxmax(),"df[['A','B']].notnull().all(axis=1).idxmax()",1.37,4.91
43518020,answer,43517993,"python,pandas,dataframe,multiple-columns",codeblock,https://stackoverflow.com/questions/43518020,"(~pd.isnull(df[['A','B']]).any(1)).idxmax()","df[['A','B']].notnull().all(axis=1).idxmax()",4.73,4.91
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df['C'] = df['C'].mask(df.B == 'b', df['C'].replace('yes', 'no'))","df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b','C'].str.replace('yes','no')",10.1,48.4
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b', 'C'].replace('yes','no')","df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b','C'].str.replace('yes','no')",14.1,48.4
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.C = np.where(df.B.values == 'b', df.C.replace('yes', 'no'), df.C.values)","df.loc[df['B']=='b', 'C'] = df['C'].str.replace('yes','no')",4.74,79.5
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df['C'] = df['C'].mask(df.B == 'b', df['C'].replace('yes', 'no'))","df.loc[df['B']=='b', 'C'] = df['C'].str.replace('yes','no')",10.1,79.5
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df['C'] = df['C'].mask(df.B == 'b', df['C'].replace('yes', 'no'))","df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b', 'C'].replace('yes','no')",10.1,14.1
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b','C'].str.replace('yes','no')","df.loc[df['B']=='b', 'C'] = df['C'].str.replace('yes','no')",48.4,79.5
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.C = np.where(df.B.values == 'b', df.C.replace('yes', 'no'), df.C.values)","df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b', 'C'].replace('yes','no')",4.74,14.1
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.C = np.where(df.B.values == 'b', df.C.replace('yes', 'no'), df.C.values)","df['C'] = df['C'].mask(df.B == 'b', df['C'].replace('yes', 'no'))",4.74,10.1
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.C = np.where(df.B.values == 'b', df.C.replace('yes', 'no'), df.C.values)","df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b','C'].str.replace('yes','no')",4.74,48.4
43555852,answer,43555834,"python,pandas",codeblock,https://stackoverflow.com/questions/43555852,"df.loc[df['B']=='b', 'C'] = df.loc[df['B']=='b', 'C'].replace('yes','no')","df.loc[df['B']=='b', 'C'] = df['C'].str.replace('yes','no')",14.1,79.5
43612836,answer,43612806,"python,numpy",codeblock,https://stackoverflow.com/questions/43612836,arr[1::2] = arr[::2],"arr[::2].repeat(2,axis=0)",0.928,1.26
43612855,answer,43612806,"python,numpy",codeblock,https://stackoverflow.com/questions/43612855,arr[1::2] = arr[::2],"arr[::2].repeat(2,axis=0)",0.655,0.913
43616324,answer,43606592,"python-2.7,numpy,h5py",codeblock,https://stackoverflow.com/questions/43616324,x2=arr[x],"x1=np.vectorize(my_dict.get, otypes=['uint8'])(x)",3.48,161
43631724,answer,43631690,"python,pandas",codeblock,https://stackoverflow.com/questions/43631724,df.columns[df.columns.str.contains('first')],df.filter(like='first').columns,11.9,117
43632224,answer,43631988,"python,numpy,dictionary",codeblock,https://stackoverflow.com/questions/43632224,"np.repeat(list(a), [len(i) for i in a.values()])","np.repeat(list(a.keys()), list(map(len, a.values())))",9.12,9.18
43651821,answer,43626883,"python,pandas",codeblock,https://stackoverflow.com/questions/43651821,"df.set_value(10,10,11)",df[10][10]=7,0.00394,0.0895
43657795,answer,43657747,"python,numpy",codeblock,https://stackoverflow.com/questions/43657795,"np.sort(np.argpartition(X[:,3],3)[:3])","np.sort(X[:,3].argsort()[:3])",0.29,7.59
43694129,answer,43693947,"python,python-3.x,pandas,date-range",codeblock,https://stackoverflow.com/questions/43694129,"df['new'] = df.apply(lambda x : np.where(pd.date_range(x['Start'], x['End']).weekday < 5, 16, 24).sum(), axis=1)","df['oncall_hours'] =  df.apply(lambda x: pd.date_range(x['Start'], x['End']).to_series().dt.weekday.map(mapping).sum(), axis=1)",166,531
43731214,answer,43731159,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43731214,"pd.DataFrame({'id': df1['id'].repeat(df1['x,y'].str.len()), 'x,y': df1['x,y'].sum() })","pd.DataFrame(df1['x,y'].values.tolist(), index=df1['id']).stack().reset_index(level=1, drop=True).reset_index(name='x,y')",0.712,1.49
43731214,answer,43731159,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43731214,"pd.DataFrame({'id': np.repeat(df1['id'].values, df1['x,y'].str.len()), 'x,y': df1['x,y'].values.sum()})","pd.DataFrame(df1['x,y'].values.tolist(), index=df1['id']).stack().reset_index(level=1, drop=True).reset_index(name='x,y')",0.562,1.49
43731214,answer,43731159,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43731214,"pd.DataFrame({'id': np.repeat(df1['id'].values, df1['x,y'].str.len()), 'x,y': df1['x,y'].values.sum()})","pd.DataFrame({'id': df1['id'].repeat(df1['x,y'].str.len()), 'x,y': df1['x,y'].sum() })",0.562,0.712
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(20).apply(list).values.tolist()),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",231,16400
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame( num2bin(df.some_int.values, 20))","df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",11.4,16400
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame( num2bin(df.some_int.values, 20))","pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",11.4,343
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])","df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",343,16400
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame(df['some_int'].apply(lambda x: list('{:020b}'.format(x))).values.tolist()),11.4,222
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(20).apply(list).values.tolist()),"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",231,343
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].apply(lambda x: list('{:020b}'.format(x))).values.tolist()),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",222,16400
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].apply(lambda x: list('{:020b}'.format(x))).values.tolist()),"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",222,343
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame([list('{:020b}'.format(x)) for x in df['some_int'].values]),11.4,232
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame([list('{:020b}'.format(x)) for x in df['some_int'].values]),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",232,16400
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].apply(lambda x: list('{:020b}'.format(x))).values.tolist()),pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(20).apply(list).values.tolist()),222,231
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].apply(lambda x: list('{:020b}'.format(x))).values.tolist()),pd.DataFrame([list('{:020b}'.format(x)) for x in df['some_int'].values]),222,232
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(20).apply(list).values.tolist()),11.4,231
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(20).apply(list).values.tolist()),pd.DataFrame([list('{:020b}'.format(x)) for x in df['some_int'].values]),231,232
43738635,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43738635,pd.DataFrame([list('{:020b}'.format(x)) for x in df['some_int'].values]),"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",232,343
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame( num2bin(df.some_int.values, 20))","pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",5.64,193
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame(df['some_int'].apply(lambda x: list('{:20b}'.format(x))).values.tolist()),pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(4).apply(list).values.tolist()),132,198
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame([list('{:20b}'.format(x)) for x in df['some_int'].values]),pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(4).apply(list).values.tolist()),154,198
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame( num2bin(df.some_int.values, 20))","df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",5.64,11800
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])","df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",193,11800
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame(df['some_int'].apply(lambda x: list('{:20b}'.format(x))).values.tolist()),5.64,132
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame(df['some_int'].apply(lambda x: list('{:20b}'.format(x))).values.tolist()),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",132,11800
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame([list('{:20b}'.format(x)) for x in df['some_int'].values]),5.64,154
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame(df['some_int'].apply(lambda x: list('{:20b}'.format(x))).values.tolist()),"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",132,193
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame([list('{:20b}'.format(x)) for x in df['some_int'].values]),"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",154,193
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame(df['some_int'].apply(lambda x: list('{:20b}'.format(x))).values.tolist()),pd.DataFrame([list('{:20b}'.format(x)) for x in df['some_int'].values]),132,154
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame( num2bin(df.some_int.values, 20))",pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(4).apply(list).values.tolist()),5.64,198
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(4).apply(list).values.tolist()),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",198,11800
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,"pd.DataFrame([list(np.binary_repr(x, width=20)) for x in df.some_int.values])",pd.DataFrame(df['some_int'].astype(int).apply(bin).str[2:].str.zfill(4).apply(list).values.tolist()),193,198
43739679,answer,43738541,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/43739679,pd.DataFrame([list('{:20b}'.format(x)) for x in df['some_int'].values]),"df.some_int.apply(lambda x: pd.Series(list(np.binary_repr(x, width=20))))",154,11800
43741194,answer,43741004,"python,pandas",codeblock,https://stackoverflow.com/questions/43741194,df.set_index('arrivalDate').price.groupby(pd.TimeGrouper('W')).sum().dropna(),df.set_index('arrivalDate').price.resample('W').sum().dropna(),1.72,1.86
43756040,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/43756040,np.sum(~np.isnan(data)),sum(~np.isnan(data)),140,154
43756040,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/43756040,data.size - np.count_nonzero(np.isnan(data)),sum(~np.isnan(data)),67.5,154
43756040,answer,21778118,"python,numpy,matrix,nan",codeblock,https://stackoverflow.com/questions/43756040,data.size - np.count_nonzero(np.isnan(data)),np.sum(~np.isnan(data)),67.5,140
43761049,answer,43760838,"python,pandas",codeblock,https://stackoverflow.com/questions/43761049,"[','.join(x) for x in map(sorted, zip(df['term_x'], df['term_y']))]","df.apply(lambda x: str(sorted([x.term_x,x.term_y])), axis=1)",121,6620
43774305,answer,43773695,"python,pandas,vlookup",codeblock,https://stackoverflow.com/questions/43774305,"df_loc['status_jez'] = df_loc['site'].map(df_status.sort_values(['site','status']).drop_duplicates(['site']).set_index('site')['status'])",df_loc.assign(status_pir=df_loc.site.map(df_status.loc[(df_status.status == 'ACTIVE').groupby(df_status.site).idxmax()].set_index('site').status)),67.3,3370
43774305,answer,43773695,"python,pandas,vlookup",codeblock,https://stackoverflow.com/questions/43774305,"df_loc['status_jez'] = df_loc['site'].map(df_status.sort_values(['site','status']).drop_duplicates(['site']).set_index('site')['status'])","pd.merge(df_loc,df_status.sort_values(['site','status']).groupby(by='site').first().reset_index(),how='left')",67.3,114
43774305,answer,43773695,"python,pandas,vlookup",codeblock,https://stackoverflow.com/questions/43774305,"pd.merge(df_loc,df_status.sort_values(['site','status']).groupby(by='site').first().reset_index(),how='left')",df_loc.assign(status_pir=df_loc.site.map(df_status.loc[(df_status.status == 'ACTIVE').groupby(df_status.site).idxmax()].set_index('site').status)),114,3370
43776567,answer,43776297,"python,list,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43776567,"{i:df.apply(lambda x: x.str[i-1] if type(x.iat[0]) == list else x) for i in range(1,7)}",{(i+1):df.applymap(lambda x: x[i] if type(x) == list else x) for i in range(6)},447,881
43776567,answer,43776297,"python,list,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43776567,"{i:df.assign(B=df['B'].str[i-1], C=df['C'].str[i-1]) for i in range(1,N+1)}",{(i+1):df.applymap(lambda x: x[i] if type(x) == list else x) for i in range(6)},420,881
43776567,answer,43776297,"python,list,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/43776567,"{i:df.assign(B=df['B'].str[i-1], C=df['C'].str[i-1]) for i in range(1,N+1)}","{i:df.apply(lambda x: x.str[i-1] if type(x.iat[0]) == list else x) for i in range(1,7)}",420,447
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)",df.reset_index(drop=True),0.00807,0.0833
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,df.reset_index(drop=True),"df.set_index(np.arange(1, len(df)+1))",0.0833,0.114
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = np.arange(1, len(df.index) + 1)",df.reset_index(drop=True),0.0269,0.0833
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)","df.set_index(np.arange(1, len(df)+1))",0.00824,0.238
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = np.arange(1, len(df.index) + 1)","df.set_index(np.arange(1, len(df)+1))",0.0628,0.238
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)",df.reset_index(drop=True),0.00824,0.109
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = np.arange(1, len(df.index) + 1)",df.reset_index(drop=True),0.0628,0.109
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,df.reset_index(drop=True),"df.set_index(np.arange(1, len(df)+1))",0.109,0.238
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)","df.index = np.arange(1, len(df.index) + 1)",0.00807,0.0269
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)","df.set_index(np.arange(1, len(df)+1))",0.00807,0.114
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = np.arange(1, len(df.index) + 1)","df.set_index(np.arange(1, len(df)+1))",0.0269,0.114
43780264,answer,43780243,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43780264,"df.index = pd.RangeIndex(1, len(df.index) + 1)","df.index = np.arange(1, len(df.index) + 1)",0.00824,0.0628
43788309,answer,43788170,pandas,codeblock,https://stackoverflow.com/questions/43788309,"s[contains_list(s, [1, 2, 3])]","s[pd.DataFrame(s.values.tolist(), index=s.index).isin([1,2,3]).all(1)]",1.01,2.22
43788309,answer,43788170,pandas,codeblock,https://stackoverflow.com/questions/43788309,"s[contains_list(s, [1, 2, 3])]","s[s.apply(tuple) == (1, 2, 3)]",1.01,1.07
43788309,answer,43788170,pandas,codeblock,https://stackoverflow.com/questions/43788309,"s[s.apply(tuple) == (1, 2, 3)]","s[pd.DataFrame(s.values.tolist(), index=s.index).isin([1,2,3]).all(1)]",1.07,2.22
43790447,answer,43789621,"python,pandas,dataframe,etl,petl",codeblock,https://stackoverflow.com/questions/43790447,"df.astype(str).stack().map({'True':True, 'False':False}).unstack()",df.astype(str).applymap(to_boolean),1880,13300
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,df1.assign(price2=df1['unique_id'].map(df2.set_index('unique_id')['price'])),"df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",0.892,1.18
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,df1.assign(price2=df1['unique_id'].map(df2.set_index('unique_id')['price'])),"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')",138,168
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,df1.assign(price2=df1['unique_id'].map(df2.set_index('unique_id')['price'])),"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')",0.892,1.02
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')","df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",1.02,1.18
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,df1.assign(price2=df1['unique_id'].map(df2.set_index('unique_id')['price'])),"df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",138,243
43791054,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791054,"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')","df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",168,243
43791091,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791091,df1['price2'] = df1['unique_id'].map(df2.set_index('unique_id')['price']),"df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",168,373
43791091,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791091,"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')","df1.merge(df2, on='unique_id', suffixes=['', '2'], how='left')",252,373
43791091,answer,43791017,"pandas,dataframe,merge,boolean",codeblock,https://stackoverflow.com/questions/43791091,df1['price2'] = df1['unique_id'].map(df2.set_index('unique_id')['price']),"df1.join(df2.set_index('unique_id'), on='unique_id', rsuffix='2')",168,252
43797523,answer,43796966,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43797523,"df.set_index(['A','B'])['value'].fillna(s).reset_index()","df.fillna(df.join(s.rename('value'), on=['A', 'B'], lsuffix='_'))",2.06,3.56
43797568,answer,43795118,"python,csv,pandas",codeblock,https://stackoverflow.com/questions/43797568,"(df.groupby([dt.datetime.strftime(e, '%Y-%m %H:%M:%S') for e in df.index])['Amount'].sum().to_frame())",(df.groupby(df.index.strftime('%Y-%m %H:%M:%S'))[['Amount']].sum()),663,792
43800230,answer,43800126,"numpy,theano,matrix-multiplication,numpy-broadcasting,numpy-einsum",codeblock,https://stackoverflow.com/questions/43800230,"np.einsum('ijk,ijk->ik', prob, cases)[:,None,:]","( cases * prob ).sum( axis=1-axis, keepdims=True )",44.1,101
43800230,answer,43800126,"numpy,theano,matrix-multiplication,numpy-broadcasting,numpy-einsum",codeblock,https://stackoverflow.com/questions/43800230,"np.matmul(prob.transpose(2,0,1), cases.T).T","( cases * prob ).sum( axis=1-axis, keepdims=True )",44,101
43800230,answer,43800126,"numpy,theano,matrix-multiplication,numpy-broadcasting,numpy-einsum",codeblock,https://stackoverflow.com/questions/43800230,"np.matmul(prob.transpose(2,0,1), cases.T).T","np.einsum('ijk,ijk->ik', prob, cases)[:,None,:]",44,44.1
43808048,answer,43807525,"python,pandas,dataframe,subset,aggregation",codeblock,https://stackoverflow.com/questions/43808048,df[[i for i in df.columns if 'b' in i]],"df[df.columns.difference(['a','c'])]",0.394,0.598
43821453,answer,432112,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/43821453,np.argmax(a==0),np.where(a==0)[0][0],0.254,0.314
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,"np.array(alist, np.float16)","np.fromiter(alist, dtype=np.float16, count=10000)",0.506,0.55
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,np.array(alist),"np.fromiter(alist, dtype=np.float16, count=10000)",0.412,0.55
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,"np.array(alist, np.float64)","np.fromiter(alist, dtype=np.float16, count=10000)",0.413,0.55
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,np.array(alist),"np.array(alist, np.float16)",0.412,0.506
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,"np.array(alist, np.float64)","np.array(alist, np.float16)",0.413,0.506
43824125,answer,43822778,"python-3.x,numpy,valueerror",codeblock,https://stackoverflow.com/questions/43824125,np.array(alist),"np.array(alist, np.float64)",0.412,0.413
43827107,answer,43826739,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43827107,"pd.DataFrame(np.repeat(df.values,[3,3], axis = 0))",pd.concat([df] * 3).sort_index(),0.235,1.26
43830626,answer,43830545,"python,python-3.x,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/43830626,df.groupby('id').value.cummax(),df.groupby('id').value.apply(lambda x: x.cummax()),4.09,15.8
43837666,answer,43833484,"python,pandas",codeblock,https://stackoverflow.com/questions/43837666,df[df.XNGS.values.astype(bool)],(df.replace({'XNGS': {'': np.nan}}).dropna(subset=['XNGS'])),0.192,1.39
43837666,answer,43833484,"python,pandas",codeblock,https://stackoverflow.com/questions/43837666,df[df.XNGS.values.astype(bool)],(df.replace({'XNGS': {'': np.nan}}).dropna(subset=['XNGS'])),2.11,10.5
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.iloc[:,2:5].loc[df['a'] > 0.5,]","df.loc[df['a'] > 0.5,].iloc[:,2:5]",1.75,2.14
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.loc[df['a'] > 0.5,].iloc[:,2:5]","df.ix[df['a'] > 0.5,2:5]",2.14,2.14
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.iloc[:,2:5].loc[df['a'] > 0.5,]","df.ix[df['a'] > 0.5,2:5]",1.75,2.14
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.ix[df['a'] > 0.5,2:5]","df.loc[df['a'] > 0.5, df.columns[2:5]]",2.14,2.64
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.ix[df['a'] > 0.5,2:5]","df.iloc[np.where(df['a'] > 0.5)[0],2:5]",2.14,9.91
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.loc[df['a'] > 0.5,].iloc[:,2:5]","df.loc[df['a'] > 0.5, df.columns[2:5]]",2.14,2.64
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.loc[df['a'] > 0.5,].iloc[:,2:5]","df.iloc[np.where(df['a'] > 0.5)[0],2:5]",2.14,9.91
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.iloc[:,2:5].loc[df['a'] > 0.5,]","df.loc[df['a'] > 0.5, df.columns[2:5]]",1.75,2.64
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.iloc[:,2:5].loc[df['a'] > 0.5,]","df.iloc[np.where(df['a'] > 0.5)[0],2:5]",1.75,9.91
43843483,answer,43838999,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/43843483,"df.loc[df['a'] > 0.5, df.columns[2:5]]","df.iloc[np.where(df['a'] > 0.5)[0],2:5]",2.64,9.91
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=np.core.defchararray.split(df.col1.values.astype(str), ','))","df.assign(col1=df['col1'].str.split(','))",0.204,0.327
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=np.core.defchararray.split(df.col1.values.astype(str), ','))","df.assign(col1=[x.split(',') for x in df['col1'].values.tolist()])",0.204,0.21
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=[x.split(',') for x in df['col1'].values.tolist()])","df.assign(col1=df['col1'].str.split(','))",0.21,0.327
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=df['col1'].str.split(','))","df.assign(col1=np.core.defchararray.split(df.col1.values.astype(str), ','))",13.5,19.6
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=[x.split(',') for x in df['col1'].values.tolist()])","df.assign(col1=np.core.defchararray.split(df.col1.values.astype(str), ','))",11.5,19.6
43854282,answer,43853714,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43854282,"df.assign(col1=[x.split(',') for x in df['col1'].values.tolist()])","df.assign(col1=df['col1'].str.split(','))",11.5,13.5
43854366,answer,43854092,"python,arrays,numpy,vector,vectorization",codeblock,https://stackoverflow.com/questions/43854366,"Y[cdist(U,X).argmin(1)]","Y[pairwise.pairwise_distances_argmin(U,X)]",0.0556,0.0911
43864937,answer,43864855,"python,image,numpy",codeblock,https://stackoverflow.com/questions/43864937,"img.swapaxes(-2,-1)[...,::-1,:]","np.rot90(img,axes=(-2,-1))",0.00048,0.00419
43865892,answer,43865806,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43865892,"(pd.DataFrame({k:v[:min_length] for k,v in data_dict.items()}))","(pd.DataFrame({k:pd.Series(v[:min_length]) for k,v in data_dict.items()}))",0.52,0.937
43865892,answer,43865806,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43865892,"(pd.DataFrame({k:v[:min_length] for k,v in data_dict.items()}))","(pd.DataFrame.from_dict(data_dict,orient='index').T.dropna())",0.52,16700
43865892,answer,43865806,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/43865892,"(pd.DataFrame({k:pd.Series(v[:min_length]) for k,v in data_dict.items()}))","(pd.DataFrame.from_dict(data_dict,orient='index').T.dropna())",0.937,16700
43874705,answer,43874690,"python,pandas",codeblock,https://stackoverflow.com/questions/43874705,"(pd.DataFrame({'a':np.repeat(df.index, len(df.columns)), 'b':np.tile(df.columns, len(df.index)), 'c':df.values.ravel()}))",(df.stack().reset_index()),0.436,1.26
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,pd.read_csv(r'c:/tmp/test.csv'),"pd.read_hdf(r'c:/tmp/test_tab.h5','a')",4480,5650
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,"pd.read_hdf(r'c:/tmp/test_fix.h5','a')",pd.read_csv(r'c:/tmp/test.csv'),1240,4480
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,pd.read_csv(r'c:/tmp/test.csv'),"pd.read_hdf(r'c:/tmp/test_tab_idx.h5','a')",4480,5600
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,"pd.read_hdf(r'c:/tmp/test_fix.h5','a')","pd.read_hdf(r'c:/tmp/test_tab.h5','a')",1240,5650
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,"pd.read_hdf(r'c:/tmp/test_fix.h5','a')","pd.read_hdf(r'c:/tmp/test_tab_idx.h5','a')",1240,5600
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,"pd.read_hdf(r'c:/tmp/test_tab_idx.h5','a', where=""n2 <= 100000 and n1 > 500000 and n3 < 50000"")","pd.read_hdf(r'c:/tmp/test_tab_idx.h5','a', where=""n2 <= 100000 and n1 > 500000"")",379,763
43874995,answer,43871626,"python,performance,python-3.x,pandas,hdf",codeblock,https://stackoverflow.com/questions/43874995,"pd.read_hdf(r'c:/tmp/test_tab_idx.h5','a')","pd.read_hdf(r'c:/tmp/test_tab.h5','a')",5600,5650
43938946,answer,43938807,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/43938946,(df.groupby('user_id').transform('any').astype(int)),(df.groupby('user_id').transform(lambda x: 1 if x.any() else 0)),84,514
43951041,answer,43950791,"python,performance,pandas",codeblock,https://stackoverflow.com/questions/43951041,pd.DataFrame(my_series.values.tolist()),pd.DataFrame(list(my_series)),0.516,0.55
43953768,answer,43953684,"python,arrays,python-2.7,numpy,concatenation",codeblock,https://stackoverflow.com/questions/43953768,"np.column_stack((a1,a2,a3))","np.stack((a1,a2,a3),axis=1)",14.1,14.2
43953768,answer,43953684,"python,arrays,python-2.7,numpy,concatenation",codeblock,https://stackoverflow.com/questions/43953768,"np.transpose([a1,a2,a3])","np.stack((a1,a2,a3),axis=1)",10.7,14.2
43953768,answer,43953684,"python,arrays,python-2.7,numpy,concatenation",codeblock,https://stackoverflow.com/questions/43953768,"np.transpose([a1,a2,a3])","np.column_stack((a1,a2,a3))",10.7,14.1
44000656,answer,44000492,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44000656,"np.indices((points)).T.reshape(-1,2)","np.transpose(np.nonzero(np.ones(points[::-1])))[:,::-1]",0.0161,0.0186
44000656,answer,44000492,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44000656,"np.indices((points)).T.reshape(-1,2)","np.transpose(np.nonzero(np.ones(points[::-1])))[:,::-1]",1.26,2.14
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,(df[df['b'] > 10].groupby('id').head(1)),"(df.query(""b > 10"").groupby('id').head(1))",90,107
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False).first())",(df[df['b'] > 10].groupby('id').head(1)),67.6,90
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False).first())","df.query(""b > 10"").groupby('id', as_index=False).first()",67.6,83.3
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False, sort=False).first())","(df[df['b'] > 10].groupby('id', as_index=False).first())",62.9,67.6
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"df.query(""b > 10"").groupby('id', as_index=False).first()","(df.query(""b > 10"").groupby('id').head(1))",83.3,107
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False, sort=False).first())","(df.query(""b > 10"").groupby('id').head(1))",62.9,107
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"df.query(""b > 10"").groupby('id', as_index=False).first()",(df[df['b'] > 10].groupby('id').head(1)),83.3,90
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False, sort=False).first())",(df[df['b'] > 10].groupby('id').head(1)),62.9,90
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False, sort=False).first())","df.query(""b > 10"").groupby('id', as_index=False).first()",62.9,83.3
44028065,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44028065,"(df[df['b'] > 10].groupby('id', as_index=False).first())","(df.query(""b > 10"").groupby('id').head(1))",67.6,107
44030664,answer,44028015,"python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/44030664,"(df[df['b'] > 10].groupby('id', as_index=False, sort=False).first())","df.query(""b > 10"").groupby('id').head(1)",30.1,44.8
44058398,answer,44058097,"python,pandas,optimization,indexing",codeblock,https://stackoverflow.com/questions/44058398,"d2[d2.index.values==""Paris""]",d2.loc[['Paris']],0.156,0.475
44070652,answer,44069539,"arrays,python-2.7,numpy",codeblock,https://stackoverflow.com/questions/44070652,"np.array([np.array(i)[:,None] for i in a])","np.r_[list(map(lambda x: np.asarray(x).reshape(-1,1),a))]",9.94,15.2
44093790,answer,44093746,"python,pandas",codeblock,https://stackoverflow.com/questions/44093790,df.Column.apply('{:03d}'.format),df.Column.apply(lambda x: str(x).zfill(3)),5.03,5.36
44093790,answer,44093746,"python,pandas",codeblock,https://stackoverflow.com/questions/44093790,df.Column.apply(lambda x: str(x).zfill(3)),df.Column.astype(str).str.zfill(3),5.36,17.5
44093790,answer,44093746,"python,pandas",codeblock,https://stackoverflow.com/questions/44093790,df.Column.apply('{:03d}'.format),df.Column.astype(str).str.zfill(3),5.03,17.5
44142801,answer,44142591,"python,pandas,numpy,scipy",codeblock,https://stackoverflow.com/questions/44142801,"pd.DataFrame(s.values.reshape(-1,2), index=idx[0], columns=idx[1])",s.unstack(level=1),0.0473,0.444
44151765,answer,44151600,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/44151765,"np.array([0., 1., 0.]) * np.ones(10)[:, None]","np.repeat([0., 1., 0.], 10, axis=0).reshape(3, -1).T",0.0113,0.0113
44151765,answer,44151600,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/44151765,"np.asarray([ 0.,  1.,  0.]*10).reshape(10,-1)","np.array([0., 1., 0.]) * np.ones(10)[:, None]",0.00451,0.0113
44151765,answer,44151600,"python,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/44151765,"np.asarray([ 0.,  1.,  0.]*10).reshape(10,-1)","np.repeat([0., 1., 0.], 10, axis=0).reshape(3, -1).T",0.00451,0.0113
44197347,answer,44196861,"python,pandas",codeblock,https://stackoverflow.com/questions/44197347,[w[1][:w[0]] for w in df.values],"df.apply(lambda x: get_first_k_letters(x['word'], x['k']), axis=1)",52.5,4040
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,"df.query('name.str.slice(0,1)==""J""')",df[df.name.str.startswith('J')],482,571
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,"df.query(""name.str.startswith('J')"", engine='python')","df.query(""name.str.startswith('J').values"")",583,587
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,df[df.name.str.startswith('J')],"df.query(""name.str.startswith('J')"", engine='python')",571,583
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,"df.query('name.str.slice(0,1)==""J""')","df.query(""name.str.startswith('J')"", engine='python')",482,583
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,df[df.name.str.startswith('J')],"df.query(""name.str.startswith('J').values"")",571,587
44230449,answer,44230272,"python,string,pandas",codeblock,https://stackoverflow.com/questions/44230449,"df.query('name.str.slice(0,1)==""J""')","df.query(""name.str.startswith('J').values"")",482,587
44264838,answer,44264459,"python,numpy,optimization,linear-algebra",codeblock,https://stackoverflow.com/questions/44264838,"np.einsum('ij,ij',t[:,None]-t, P)",np.sum(((t[np.newaxis]).T - t) *P),49.7,86.9
44268780,answer,44268659,"python,pandas,indexing,append",codeblock,https://stackoverflow.com/questions/44268780,"df.loc['new_name', :] = ['someage', 'someheight', 'someweight', 'somehaircolor']","df.append(pd.DataFrame({'Age': 'someage', 'height': 'someheight','weight':'someweight','haircolor': 'somehaircolor'}, index=['some_person']))",0.408,2.59
44271565,answer,44270983,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44271565,"pd.DataFrame(np.column_stack(list(zip(*data))), columns=list('ABCZ'))","pd.DataFrame([e[0].tolist()+[e[1]] for e in data],columns=['A','B','C','Z'])",0.13,0.446
44271565,answer,44270983,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44271565,"pd.DataFrame(np.column_stack(list(zip(*data))), columns=list('ABCZ'))","pd.DataFrame([np.append(*row) for row in data], columns=list('ABCZ'))",0.13,0.46
44271565,answer,44270983,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44271565,"pd.DataFrame([e[0].tolist()+[e[1]] for e in data],columns=['A','B','C','Z'])","pd.DataFrame([np.append(*row) for row in data], columns=list('ABCZ'))",0.446,0.46
44273656,answer,44273533,"python,pandas",codeblock,https://stackoverflow.com/questions/44273656,df.assign(B=(df.A.values == 'a').astype(int)),df.assign(B=df.A.eq('a').astype(int)),0.306,0.55
44277057,answer,44276950,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/44277057,np.sign(x) * ne.evaluate('log(1+abs(x))'),np.sign(x) * np.log(1+abs(x)),1.66,3.26
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"pd.Series([[float(x) for x in v.strip('()').split(', ')] for v in g.values.tolist()], g.index, name=g.name)","pd.Series([literal_eval(v) for v in g.values.tolist()], g.index, name=g.name)",0.0653,0.119
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"pd.Series([[float(x) for x in v.strip('()').split(', ')] for v in g.values.tolist()], g.index, name=g.name)","g.apply(lambda x: [float(y) for y in x.strip('()').split(', ')])",0.0653,0.107
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"g.apply(lambda x: [float(y) for y in x.strip('()').split(', ')])","pd.Series([literal_eval(v) for v in g.values.tolist()], g.index, name=g.name)",0.107,0.119
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"pd.Series([[float(x) for x in v.strip('()').split(', ')] for v in g.values.tolist()], g.index, name=g.name)",g.apply(literal_eval),0.0653,0.158
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"pd.Series([literal_eval(v) for v in g.values.tolist()], g.index, name=g.name)",g.apply(literal_eval),0.119,0.158
44317353,answer,44316980,"python,arrays,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44317353,"g.apply(lambda x: [float(y) for y in x.strip('()').split(', ')])",g.apply(literal_eval),0.107,0.158
44318878,answer,44318844,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/44318878,df_1.replace(m),"df_1.stack().map(lambda x: m.get(x, x)).unstack()",0.792,0.925
44318878,answer,44318844,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/44318878,df_2.set_index('num').name,df_2.set_index('num').name.to_dict(),0.325,0.376
44318878,answer,44318844,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/44318878,df_1.replace(m),"df_1.applymap(lambda x: m.get(x, x))",0.792,0.959
44318878,answer,44318844,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/44318878,"df_1.stack().map(lambda x: m.get(x, x)).unstack()","df_1.applymap(lambda x: m.get(x, x))",0.925,0.959
44319325,answer,44319318,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44319325,mob.quantity / mob.groupby('country').quantity.transform('sum'),mob.groupby('country').quantity.transform(lambda x: x / x.sum()),1.03,1.53
44319325,answer,44319318,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44319325,mob.quantity.values / mob.groupby('country').quantity.transform('sum').values,mob.quantity / mob.groupby('country').quantity.transform('sum'),0.956,1.03
44319325,answer,44319318,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44319325,mob.quantity.values / mob.groupby('country').quantity.transform('sum').values,mob.groupby('country').quantity.transform(lambda x: x / x.sum()),0.956,1.53
44319780,answer,44317517,"python,numpy,matrix,vector,transpose",sentence,"repeat is faster than tile, and reshape is nearly costless:",repeat,tile,,
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)","pd.crosstab(df['My_ID'], df['My_CAT'])",14.2,96.7
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),"pd.crosstab(df['My_ID'], df['My_CAT'])",25.5,96.7
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),"pd.crosstab(df['My_ID'], df['My_CAT'])",25.4,96.7
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),14.2,25.5
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),14.2,25.4
44321506,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321506,df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),25.4,25.5
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),"pd.crosstab(df['My_ID'], df['My_CAT'])",1.2,5.21
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)","pd.crosstab(df['My_ID'], df['My_CAT'])",1.23,5.21
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),15.6,19.9
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),10.7,19.9
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),10.7,15.6
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),"pd.crosstab(df['My_ID'], df['My_CAT'])",19.9,82.6
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),"pd.crosstab(df['My_ID'], df['My_CAT'])",15.6,82.6
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)","pd.crosstab(df['My_ID'], df['My_CAT'])",10.7,82.6
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),1.2,1.23
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",1.23,1.23
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,pd.get_dummies(df.My_CAT).groupby(df.My_ID).sum(),"df.groupby(['My_ID','My_CAT']).size().unstack(fill_value=0)",1.2,1.23
44321518,answer,44321487,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44321518,df.groupby('My_ID').My_CAT.value_counts().unstack(fill_value=0),"pd.crosstab(df['My_ID'], df['My_CAT'])",1.23,5.21
44322390,answer,44322361,"python,pandas,dataframe,filtering,grouping",codeblock,https://stackoverflow.com/questions/44322390,(df.groupby('userName').filter(lambda x: len(x) > 1000)),(df[df.groupby('userName')['userName'].transform(len) > 1000]),468,661
44322390,answer,44322361,"python,pandas,dataframe,filtering,grouping",codeblock,https://stackoverflow.com/questions/44322390,(df[df.groupby('userName')['userName'].transform('size') > 1000]),(df.groupby('userName').filter(lambda x: len(x) > 1000)),96.9,468
44322390,answer,44322361,"python,pandas,dataframe,filtering,grouping",codeblock,https://stackoverflow.com/questions/44322390,(df[df.groupby('userName')['userName'].transform('size') > 1000]),(df[df.groupby('userName')['userName'].transform(len) > 1000]),96.9,661
44348630,answer,44345340,"python,performance,numpy,matrix,matrix-inverse",codeblock,https://stackoverflow.com/questions/44348630,np.linalg.inv(X),"c = np.linalg.inv(np.linalg.cholesky(X)); np.dot(c.T,c)",0.255,0.414
44388621,answer,44388358,"numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/44388621,"np.multiply(A.T,np.diag(B))",A.T*B,0.0362,24.1
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,"df1.B - df1.A.map(dict(zip(df2.A, df2.B)))",df1.B - df1.A.map(df2.set_index('A').B),0.492,0.718
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,"df1.B - df1.A.map(dict(zip(df2.A.values, df2.B.values)))",df1.B - df1.A.map(df2.set_index('A').B),0.459,0.718
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,"df1.B - df1.A.map(dict(zip(df2.A.values, df2.B.values)))","df1.B - df1.A.map(dict(zip(df2.A, df2.B)))",0.459,0.492
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,df1.B - df1.A.map(df2.set_index('A').B),"df1.B - df1.A.map(dict(zip(df2.A, df2.B)))",114,359
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,df1.B - df1.A.map(df2.set_index('A').B),"df1.B - df1.A.map(dict(zip(df2.A.values, df2.B.values)))",114,354
44421386,answer,44421186,"python,pandas",codeblock,https://stackoverflow.com/questions/44421386,"df1.B - df1.A.map(dict(zip(df2.A.values, df2.B.values)))","df1.B - df1.A.map(dict(zip(df2.A, df2.B)))",354,359
44423719,answer,44423246,"python,numpy",codeblock,https://stackoverflow.com/questions/44423719,np.any(arr),any(arr),0.0312,0.215
44468970,answer,44468702,"arrays,performance,list,numpy",codeblock,https://stackoverflow.com/questions/44468970,"np.array(inp, dtype=int)",np.array(inp),311,315
44469993,answer,44468702,"arrays,performance,list,numpy",codeblock,https://stackoverflow.com/questions/44469993,arr8.sum(),sum(alist),6.93,74.4
44487991,answer,44487889,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44487991,"np.compress(i, a, axis=0)",a[i],24.1,59.8
44491546,answer,44487889,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44491546,"a.take(np.nonzero(b)[0], axis=0).shape","a.compress(b, axis=0).shape",14.3,14.3
44491546,answer,44487889,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44491546,"np.take(a,idx, axis=0).shape","a[idx,:].shape",9.9,14.6
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('A & B & C & D & E & F & G & H'),df.all(1),6.89,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('A & B & C & D & E & F & G & H'),df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),6.89,8.71
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('A & B & C & D & E & F & G & H'),"pd.Series(df.values.all(1), df.index)",6.89,19.4
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),df.all(1),8.71,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),"pd.Series(df.values.all(1), df.index)",8.71,19.4
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')","A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')",2.85,2.91
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),"A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H",8.71,11.1
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H","pd.Series(df.values.all(1), df.index)",11.1,19.4
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H",df.all(1),11.1,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')","A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H",2.91,11.1
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')","A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H",2.85,11.1
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')",df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),2.91,8.71
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')",df.eval('((A & B) & (C & D)) & ((E & F) & (G & H))'),2.85,8.71
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"pd.Series(df.values.all(1), df.index)",df.all(1),19.4,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')","pd.Series(df.values.all(1), df.index)",2.91,19.4
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')",df.eval('A & B & C & D & E & F & G & H'),2.85,6.89
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,df.eval('A & B & C & D & E & F & G & H'),"A, B, C, D, E, F, G, H = (v for k, v in df.items()); A & B & C & D & E & F & G & H",6.89,11.1
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')","pd.Series(df.values.all(1), df.index)",2.85,19.4
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')",df.all(1),2.91,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = (v for k, v in df.items()); ne.evaluate('A & B & C & D & E & F & G & H')",df.all(1),2.85,100
44510586,answer,44510470,"python,pandas,numpy,optimization",codeblock,https://stackoverflow.com/questions/44510586,"A, B, C, D, E, F, G, H = [df[c].values for c in df]; ne.evaluate('A & B & C & D & E & F & G & H')",df.eval('A & B & C & D & E & F & G & H'),2.91,6.89
44545990,answer,44545921,"python,pandas",codeblock,https://stackoverflow.com/questions/44545990,"(pd.concat([DF1, DF2[DF2.columns.difference(DF1.columns)]], axis = 1))","(pd.concat([DF1, DF2], axis = 1).T.drop_duplicates().T)",1.12,1400
44545990,answer,44545921,"python,pandas",codeblock,https://stackoverflow.com/questions/44545990,"(pd.concat([DF1, DF2[DF2.columns.difference(DF1.columns)]], axis = 1))","(pd.concat([DF1, DF2], axis = 1).T.drop_duplicates().T)",0.979,122
44549343,answer,44548582,"python-2.7,pandas,dataframe,truncate",codeblock,https://stackoverflow.com/questions/44549343,[row[:2] for row in df['Mar'].tolist()],df['Mar'].apply(lambda x: x[:2]),940,1250
44549343,answer,44548582,"python-2.7,pandas,dataframe,truncate",codeblock,https://stackoverflow.com/questions/44549343,[row[:2] for row in df['Mar'].tolist()],df['Mar'].str[:2],940,1230
44549343,answer,44548582,"python-2.7,pandas,dataframe,truncate",codeblock,https://stackoverflow.com/questions/44549343,df['Mar'].str[:2],df['Mar'].apply(lambda x: x[:2]),1230,1250
44553732,answer,44553073,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44553732,df['2'].gt(0).groupby(df['1']).mean(),df.groupby('1')['2'].agg(lambda x: (x > 0).sum() / x.size),0.697,1
44553732,answer,44553073,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44553732,"(lambda w, g, f, u: pd.Series(g(f, w) / g(f)))(df['2'].values > 0, np.bincount, *pd.factorize(df['1'].values))",df['2'].gt(0).groupby(df['1']).mean(),0.117,0.697
44553732,answer,44553073,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44553732,"(lambda w, g, f, u: pd.Series(g(f, w) / g(f)))(df['2'].values > 0, np.bincount, *pd.factorize(df['1'].values))",df.groupby('1')['2'].agg(lambda x: (x > 0).sum() / x.size),0.117,1
44555397,answer,44555293,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44555397,"np.logical_and.accumulate(a, axis=0)",a.cumprod(0).astype(bool),0.0856,0.138
44561701,answer,44561649,pandas,codeblock,https://stackoverflow.com/questions/44561701,"(df.iloc[:, ~df.columns.duplicated()])","(df.loc[:, ~df.columns.duplicated()])",0.338,0.346
44578081,answer,44578004,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44578081,df.query('B == 30'),df[df.B == 30],27100,31400
44578081,answer,44578004,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44578081,df.query('B == 30'),df[df.B.values == 30],27100,31600
44578081,answer,44578004,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44578081,df[df.B == 30],df[df.B.values == 30],31400,31600
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,df2.assign(E=(lambda s: df2['C'].map(s) - df2['D'].map(s))(df1.set_index('A')['B'])),"df2.assign(E=df2.replace(dict(zip(df1.A, df1.B))).eval('C - D'))",17.7,10600
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,df2.assign(E=(lambda s: df2['C'].map(s) - df2['D'].map(s))(df1.set_index('A')['B'])),"df2.assign(E=df2.replace(df1.A.values, df1.B).eval('C - D'))",17.7,11100
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,"df2.assign(E=df2.replace(dict(zip(df1.A, df1.B))).eval('C - D'))","df2.assign(E=df2.replace(df1.A.values, df1.B).eval('C - D'))",10600,11100
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,df2.assign(E=(lambda s: df2['C'].map(s) - df2['D'].map(s))(df1.set_index('A')['B'])),"df2.assign(E=df2.replace(df1.A.values, df1.B).eval('C - D'))",1.25,2.31
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,"df2.assign(E=df2.replace(df1.A.values, df1.B).eval('C - D'))","df2.assign(E=df2.replace(dict(zip(df1.A, df1.B))).eval('C - D'))",2.31,2.44
44580157,answer,44579323,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44580157,df2.assign(E=(lambda s: df2['C'].map(s) - df2['D'].map(s))(df1.set_index('A')['B'])),"df2.assign(E=df2.replace(dict(zip(df1.A, df1.B))).eval('C - D'))",1.25,2.44
44633369,answer,44633314,"python,arrays,string,numpy,for-loop",codeblock,https://stackoverflow.com/questions/44633369,y = np.arange(73293).astype(np.str),y = [str(x) for x in np.arange(73293)],8.77,87.3
44667584,answer,44666608,"pandas,dataframe,creation",codeblock,https://stackoverflow.com/questions/44667584,"(pd.DataFrame(np.repeat(s.values, len(idx)).reshape(len(idx), -1), index=idx, columns=s.index))",(pd.DataFrame(index=idx).assign(**s)),3.94,332
44667584,answer,44666608,"pandas,dataframe,creation",codeblock,https://stackoverflow.com/questions/44667584,"(pd.DataFrame(np.repeat(s.values, len(idx)).reshape(len(idx), -1), index=idx, columns=s.index))","pd.DataFrame([s]*len(idx),idx,s.index)",3.94,82.9
44667584,answer,44666608,"pandas,dataframe,creation",codeblock,https://stackoverflow.com/questions/44667584,"pd.DataFrame([s]*len(idx),idx,s.index)",(pd.DataFrame(index=idx).assign(**s)),82.9,332
44745074,answer,44745062,"python,arrays,pandas,numpy",codeblock,https://stackoverflow.com/questions/44745074,"(orders[~np.in1d(orders.user_id.values, users_to_remove)])",(orders[~orders.user_id.isin(users_to_remove)]),14600,16900
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,np.array([np.rot90(i) for i in a]),"f=np.vectorize(np.rot90, signature='(n,m)->(k,l)')





f(a)",0.04,0.196
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,np.array([np.rot90(i) for i in a]),"np.vectorize(np.rot90, signature='(n,m)->(k,l)')(a)",0.04,0.234
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,"np.array(list(map(np.rot90, a)))","f=np.vectorize(np.rot90, signature='(n,m)->(k,l)')





f(a)",0.0411,0.196
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,"f=np.vectorize(np.rot90, signature='(n,m)->(k,l)')





f(a)","np.vectorize(np.rot90, signature='(n,m)->(k,l)')(a)",0.196,0.234
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,"np.array(list(map(np.rot90, a)))","np.vectorize(np.rot90, signature='(n,m)->(k,l)')(a)",0.0411,0.234
44752552,answer,44746576,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/44752552,np.array([np.rot90(i) for i in a]),"np.array(list(map(np.rot90, a)))",0.04,0.0411
44753790,answer,44753778,"python,pandas",codeblock,https://stackoverflow.com/questions/44753790,(np.concatenate(df['column'].values).tolist()),df.column.sum(),22.7,1340
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,A.ravel().dot(B.ravel()),"np.sum(np.multiply(A, B))",19.5,52.2
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,"np.einsum('ij,ij',A,B)",A.ravel().dot(B.ravel()),19,19.5
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,"np.einsum('ij,ij',A,B)","np.tensordot(A,B, axes=((0,1),(0,1)))",19,19.5
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,A.ravel().dot(B.ravel()),"np.tensordot(A,B, axes=((0,1),(0,1)))",19.5,19.5
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,"np.einsum('ij,ij',A,B)","np.sum(np.multiply(A, B))",19,52.2
44763949,answer,44763910,"python,arrays,function,numpy",codeblock,https://stackoverflow.com/questions/44763949,"np.tensordot(A,B, axes=((0,1),(0,1)))","np.sum(np.multiply(A, B))",19.5,52.2
44764767,answer,44759527,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44764767,x=dl.flat[idx],x=dl[fidx],0.312,0.447
44766815,answer,44765244,"python,pandas",codeblock,https://stackoverflow.com/questions/44766815,burst_veldirection_velspeed.groupby(pd.TimeGrouper(freq='10Min')).apply(circ_mean2),burst_veldirection_velspeed.groupby(pd.TimeGrouper(freq='10Min')).apply(circ_mean),10.4,80.3
44766815,answer,44765244,"python,pandas",codeblock,https://stackoverflow.com/questions/44766815,burst_veldirection_velspeed.groupby(pd.TimeGrouper(freq='10Min')).apply(circ_mean2),burst_veldirection_velspeed.groupby(pd.TimeGrouper(freq='10Min')).apply(circ_mean),709,6650
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'])])",(df.groupby('OID').filter(lambda x: ~((x['ResponseType']=='no') |  (x['ResponseType']=='no2')).any() )),67.2,114000
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'].unique())])","(df[~df['OID'].isin(df[df['ResponseType'].isin(['no', 'no2'])]['OID'])])",69.5,91.5
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'].unique())])",(df.groupby('OID').filter(lambda x: ~((x['ResponseType']=='no') |  (x['ResponseType']=='no2')).any() )),69.5,114000
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'])])","(df[~df['OID'].isin(df[df['ResponseType'].isin(['no', 'no2'])]['OID'])])",67.2,91.5
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'])])","(df[~df['OID'].isin(df.loc[df['ResponseType'].isin(['no','no2']), 'OID'].unique())])",67.2,69.5
44779465,answer,44779421,"python,pandas,dataframe,filter",codeblock,https://stackoverflow.com/questions/44779465,"(df[~df['OID'].isin(df[df['ResponseType'].isin(['no', 'no2'])]['OID'])])",(df.groupby('OID').filter(lambda x: ~((x['ResponseType']=='no') |  (x['ResponseType']=='no2')).any() )),91.5,114000
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,"(df[~df.apply(sorted, 1).duplicated()])",(df[~df.T.apply(sorted).T.duplicated()]),1090,1560
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,"(df[~df.apply(sorted, 1).duplicated()])","(df[~df.apply(lambda x: x.sort_values().values, axis=1).duplicated()])",1090,2890
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,"(df[~pd.DataFrame(np.sort(df.values, axis=1), index=df.index, columns=df.columns).duplicated()])",(df[~df.T.apply(sorted).T.duplicated()]),3.25,1560
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,"(df[~pd.DataFrame(np.sort(df.values, axis=1), index=df.index, columns=df.columns).duplicated()])","(df[~df.apply(lambda x: x.sort_values().values, axis=1).duplicated()])",3.25,2890
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,"(df[~pd.DataFrame(np.sort(df.values, axis=1), index=df.index, columns=df.columns).duplicated()])","(df[~df.apply(sorted, 1).duplicated()])",3.25,1090
44794306,answer,44792969,pandas,codeblock,https://stackoverflow.com/questions/44794306,(df[~df.T.apply(sorted).T.duplicated()]),"(df[~df.apply(lambda x: x.sort_values().values, axis=1).duplicated()])",1560,2890
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df.drop(np.where(df['a'].isnull() | df['e'].isnull())[0]),"df.drop(np.where(df[['a','e']].isnull().any(1))[0])",65.5,97.1
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[df['a'].notnull() & df['e'].notnull()],df.drop(np.where(df['a'].isnull() | df['e'].isnull())[0]),39.9,65.5
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[df['a'].notnull() & df['e'].notnull()],df[~(df['a'].isnull() | df['e'].isnull())],39.9,46.6
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,"df[df[['a','e']].notnull().all(1)]","df.drop(np.where(df[['a','e']].isnull().any(1))[0])",72,97.1
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df.drop(np.where(df['a'].isnull() | df['e'].isnull())[0]),"df[df[['a','e']].notnull().all(1)]",65.5,72
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[df['a'].notnull() & df['e'].notnull()],"df[df[['a','e']].notnull().all(1)]",39.9,72
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[~(df['a'].isnull() | df['e'].isnull())],df.drop(np.where(df['a'].isnull() | df['e'].isnull())[0]),46.6,65.5
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[~(df['a'].isnull() | df['e'].isnull())],"df.drop(np.where(df[['a','e']].isnull().any(1))[0])",46.6,97.1
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[~(df['a'].isnull() | df['e'].isnull())],"df[df[['a','e']].notnull().all(1)]",46.6,72
44803397,answer,44803007,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/44803397,df[df['a'].notnull() & df['e'].notnull()],"df.drop(np.where(df[['a','e']].isnull().any(1))[0])",39.9,97.1
44808257,answer,44808148,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/44808257,"np.partition(a, 10, axis=-1)","np.argpartition(a, 10, axis=-1)",43.6,49.6
44838893,answer,44837809,"python,pandas",codeblock,https://stackoverflow.com/questions/44838893,(pd.DataFrame(df['proficiencies'].values.tolist()).mean().to_dict()),(df.proficiencies.apply(pd.Series).mean().to_dict()),4,453
44839228,answer,44838478,"python,pandas",codeblock,https://stackoverflow.com/questions/44839228,"(pd.Series(np.sum(df.fillna('').values, axis=1), index=df.index))",(df.fillna('').sum(axis=1)),1.5,4.08
44839228,answer,44838478,"python,pandas",codeblock,https://stackoverflow.com/questions/44839228,"(pd.Series(df.fillna('').values.sum(axis=1), index=df.index))",(df.fillna('').sum(axis=1)),1.49,4.08
44839228,answer,44838478,"python,pandas",codeblock,https://stackoverflow.com/questions/44839228,"(pd.Series(df.fillna('').values.sum(axis=1), index=df.index))","(pd.Series(np.sum(df.fillna('').values, axis=1), index=df.index))",1.49,1.5
44840615,answer,44840513,"python,string,pandas,concatenation,series",codeblock,https://stackoverflow.com/questions/44840615,matches['url1'] = 'http://www.example.org' + matches['column1'] + '/' + matches['id'].map(lambda x : x[-3:] if (('M' in x) or ('-0' in x)) else x[-4:]) + '/xyz.pdf',"matches['url'] = 'http://www.example.org' + matches['column1'] + '/' + np.where(matches['id'].str.contains('M|-0'), matches['id'].str[-3:], matches['id'].str[-4:]) + '/xyz.pdf'",22.1,50.9
44840615,answer,44840513,"python,string,pandas,concatenation,series",codeblock,https://stackoverflow.com/questions/44840615,"matches['url'] = 'http://www.example.org' + matches['column1'] + '/' + np.where(matches['id'].str.contains('M|-0'), matches['id'].str[-3:], matches['id'].str[-4:]) + '/xyz.pdf'","matches['url2'] = matches.apply(lambda x: 'http://www.example.org{}/{}/xyz.pdf'.format(x['column1'], x['id'][-3:] if (('M' in x['id']) or ('-0' in x['id'])) else x['id'][-4:]), axis=1)",50.9,1070
44840615,answer,44840513,"python,string,pandas,concatenation,series",codeblock,https://stackoverflow.com/questions/44840615,matches['url1'] = 'http://www.example.org' + matches['column1'] + '/' + matches['id'].map(lambda x : x[-3:] if (('M' in x) or ('-0' in x)) else x[-4:]) + '/xyz.pdf',"matches['url2'] = matches.apply(lambda x: 'http://www.example.org{}/{}/xyz.pdf'.format(x['column1'], x['id'][-3:] if (('M' in x['id']) or ('-0' in x['id'])) else x['id'][-4:]), axis=1)",22.1,1070
44912222,answer,44911103,"python,pandas,match",codeblock,https://stackoverflow.com/questions/44912222,"df['C'] = np.where((np.isnan(df.C))&(df.A==df1.A)&(df.B==df1.B),df1.D,df.C)","df.set_index(['A', 'B'])['C'].fillna(df1.set_index(['A', 'B'])['D']).reset_index()",1.3,5.92
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.iloc[np.where(df.A.values=='foo')],df.loc[df['A'] == 'foo'],0.38,0.745
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.iloc[np.where(df.A.values=='foo')],df.loc[df['A'].isin(['foo'])],0.38,0.562
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.iloc[np.where(df.A.values=='foo')],df[df.A=='foo'],0.38,0.796
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.loc[df['A'] == 'foo'],df[df.A=='foo'],0.745,0.796
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.loc[df['A'] == 'foo'],"df.query('(A==""foo"")')",0.745,1.71
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.loc[df['A'].isin(['foo'])],"df.query('(A==""foo"")')",0.562,1.71
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.iloc[np.where(df.A.values=='foo')],"df.query('(A==""foo"")')",0.38,1.71
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df[df.A=='foo'],"df.query('(A==""foo"")')",0.796,1.71
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.loc[df['A'].isin(['foo'])],df[df.A=='foo'],0.562,0.796
44931669,answer,17071871,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44931669,df.loc[df['A'].isin(['foo'])],df.loc[df['A'] == 'foo'],0.562,0.745
44932614,answer,44931981,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44932614,"pd.DataFrame(np.array(data).reshape(-1, len(data)), columns=label)","pd.DataFrame([data], columns=label)",3.83,1700
44932614,answer,44931981,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/44932614,"pd.DataFrame(np.array(data).reshape(-1, len(data)), columns=label)","pd.DataFrame([data], columns=label)",1.06,178
44934646,answer,44930324,"pandas,timedelta",codeblock,https://stackoverflow.com/questions/44934646,df['timestamp'].dt.hour * 4 + df['timestamp'].dt.minute // 15 + 1,df.timestamp.apply(lambda ts: 1 + ts.hour * 4 + ts.minute // 15),20.2,301
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=pd.cut(df.a, [-np.inf,2,4,np.inf], labels=[0,1,2], right=False))","df.assign(res=pd.np.where(df.a < 2, 0, pd.np.where((df.a >= 2) & (df.a < 4), 1, 2)))",0.53,1.06
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=np.array([2, 4]).searchsorted(df.a.values, side='right'))","df.assign(res=pd.Series([2, 4]).searchsorted(df.a, side='right'))",0.337,0.443
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=pd.Series([2, 4]).searchsorted(df.a, side='right'))","df.assign(res=pd.np.where(df.a < 2, 0, pd.np.where((df.a >= 2) & (df.a < 4), 1, 2)))",0.443,1.06
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=pd.Series([2, 4]).searchsorted(df.a, side='right'))","df.assign(res=pd.cut(df.a, [-np.inf,2,4,np.inf], labels=[0,1,2], right=False))",0.443,0.53
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=np.array([2, 4]).searchsorted(df.a.values, side='right'))","df.assign(res=pd.cut(df.a, [-np.inf,2,4,np.inf], labels=[0,1,2], right=False))",0.337,0.53
44936431,answer,44936088,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/44936431,"df.assign(res=np.array([2, 4]).searchsorted(df.a.values, side='right'))","df.assign(res=pd.np.where(df.a < 2, 0, pd.np.where((df.a >= 2) & (df.a < 4), 1, 2)))",0.337,1.06
44945652,answer,44934879,pandas,codeblock,https://stackoverflow.com/questions/44945652,DataFrame(np.asarray(samples)),DataFrame(samples),30.9,2290
44953127,answer,44953069,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/44953127,df[[s.startswith('r') and (len(s) == 6) and s[1:].isdigit() for s in df.a.values.tolist()]],df[df.a.str.match('^r\d{5}$')],22.8,33.8
44953127,answer,44953069,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/44953127,df[[s.startswith('r') and (len(s) == 6) and s[1:].isdigit() for s in df.a.values.tolist()]],df[df.a.str.contains('^r\d{5}$')],22.8,34.8
44953127,answer,44953069,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/44953127,df[df.a.str.match('^r\d{5}$')],df[df.a.str.contains('^r\d{5}$')],33.8,34.8
44960703,answer,44960614,"python,pandas",codeblock,https://stackoverflow.com/questions/44960703,"for idx in range(0, len(fp)): fp.values[idx, 0] = idx","for idx in range(0, len(fp)): fp.iloc[idx, 0] = idx",1190,189000
44962047,answer,44961631,numpy,codeblock,https://stackoverflow.com/questions/44962047,"stacked.shape[-1] - stacked[...,::-1].argmax(-1) - 1","(stacked == stacked.max(-1,keepdims=1)).cumsum(-1).argmax(-1)",281,659
44973680,answer,44973484,"python,pandas,numpy,dataframe,vectorization",codeblock,https://stackoverflow.com/questions/44973680,"1-cdist(query.values[None], corpus.values.T, 'cosine')","corpus.apply(lambda x:1-cosine(query, x), axis=0)",3.2,352
44974045,answer,44973981,"python,pandas,dataframe,addition",codeblock,https://stackoverflow.com/questions/44974045,"sum([df1, df2, df3, df4])","pd.concat(dict(enumerate([df1, df2, df3, df4]))).sum(level=1)",0.591,3.61
44974045,answer,44973981,"python,pandas,dataframe,addition",codeblock,https://stackoverflow.com/questions/44974045,"sum([df1, df2, df3, df4])","pd.concat(dict(enumerate([df1, df2, df3, df4]))).sum(level=1)",3.94,60000
45000770,answer,45000635,"pandas,dataframe",codeblock,https://stackoverflow.com/questions/45000770,"df.loc[df.Contact.str.contains(""email"")]","df.loc[df.Contact == ""email""]",0.646,0.75
45002137,answer,44765229,"python,algorithm,numpy,cython,cythonize",codeblock,https://stackoverflow.com/questions/45002137,"myclip.clip(clippy.sP, clippy.cP)","clippy.clip(clippy.sP, clippy.cP)",0.0471,0.126
45019690,answer,45019576,"python,numpy",codeblock,https://stackoverflow.com/questions/45019690,((a == 1) & (a.cumsum(axis=0) == 1)).astype(int),"((a.argmax(0) == np.arange(a.shape[0])[:,None]).astype(int))*a.any(0)",5.19,7.73
45020281,answer,45020225,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45020281,"df.assign(New=[[x, y] for x, y in zip(df.Jan, df.Feb)])","df.assign(New=df.apply(lambda x: [x['Jan'], x['Feb']], axis=1))",1.59,152
45020281,answer,45020225,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45020281,"df.assign(New=[[x, y] for x, y in zip(df.Jan, df.Feb)])","df.assign(New=df[['Feb', 'Jan']].values.tolist())",1.59,2.76
45020281,answer,45020225,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45020281,"df.assign(New=df[['Feb', 'Jan']].values.tolist())","df.assign(New=df.apply(lambda x: [x['Jan'], x['Feb']], axis=1))",2.76,152
45020676,answer,45020225,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45020676,"df.assign(New=df[['Feb', 'Jan']].values.tolist())","df.assign(New=df.apply(lambda x: [x['Jan'], x['Feb']], axis=1))",0.947,61.7
45022156,answer,45021963,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45022156,"np.where(x > 0, 1.0, 0.0)","np.heaviside(x, 0)",0.658,1.31
45022156,answer,45021963,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45022156,(x>0).astype(x.dtype),"np.where(x > 0, 1.0, 0.0)",0.172,0.658
45022156,answer,45021963,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45022156,(x>0).astype(x.dtype),"np.heaviside(x, 0)",0.172,1.31
45041599,answer,45041526,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45041599,(df[df.A.isin(df[df.B == 'yes'].drop_duplicates('A').A)].C),(df[df.A.isin(df[df.B == 'yes'].A)].drop_duplicates('A').C),185,226
45048514,answer,45048478,"python,performance,numpy,scipy,vectorization",codeblock,https://stackoverflow.com/questions/45048514,"np.angle(flow[...,0] + flow[...,1] * 1j, deg=True)","np.apply_along_axis(calcAngle, axis=2, arr=flow)",47.6,8270
45048884,answer,45048478,"python,performance,numpy,scipy,vectorization",codeblock,https://stackoverflow.com/questions/45048884,"np.rad2deg(np.arctan2(flow[:,:,1], flow[:,:,0]))","np.angle(flow[...,0] + flow[...,1] * 1j, deg=True)",35.4,44.5
45085073,answer,45080403,"python,pandas,fill,zero",codeblock,https://stackoverflow.com/questions/45085073,"np.where((df.Val.values==0)&(df.Val.shift(-1)!=0),df.Val.shift(),df.Val)","df.loc[(df.Val == 0) & (df.Val.shift(-1) != 0), 'val'] = df.Val.shift(1)",0.671,2.01
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,"pd.DataFrame(np.logical_xor(df.values,1).astype(int), columns=df.columns, index=df.index)","(df.replace({0:1, 1:0}))",350,5080
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,"pd.DataFrame(np.logical_xor(df.values,1).astype(int), columns=df.columns, index=df.index)","(np.logical_xor(df,1).astype(int))",350,1420
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,"(np.logical_xor(df,1).astype(int))",((~df.astype(bool)).astype(int)),1420,1810
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,"pd.DataFrame(np.logical_xor(df.values,1).astype(int), columns=df.columns, index=df.index)",((~df.astype(bool)).astype(int)),350,1810
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,"(np.logical_xor(df,1).astype(int))","(df.replace({0:1, 1:0}))",1420,5080
45094959,answer,45094948,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45094959,((~df.astype(bool)).astype(int)),"(df.replace({0:1, 1:0}))",1810,5080
45118399,answer,1550130,"python,matlab,numpy,octave,linear-algebra",sentence,np.broadcast_to is even faster than np.tile:,np.broadcast_to,np.tile,,
45118399,answer,1550130,"python,matlab,numpy,octave,linear-algebra",codeblock,https://stackoverflow.com/questions/45118399,"np.broadcast_to(x, (6,9))","np.tile(x, (6,1))",0.0036,0.0084
45127678,answer,45127442,"python,performance,pandas,group-by,apply",codeblock,https://stackoverflow.com/questions/45127678,df.groupby('id')['name'].transform(lambda x: x.eq(searchString).any().astype(int)),"df.groupby('id').apply(lambda x: customFunction(x,searchString))",53.5,92.4
45152599,answer,45152534,"python,pandas",codeblock,https://stackoverflow.com/questions/45152599,df.columns.values.tolist(),df.columns.tolist(),0.0795,0.173
45161520,answer,45161355,"python,python-3.x,pandas,dataframe,data-analysis",codeblock,https://stackoverflow.com/questions/45161520,"df.groupby('userId', as_index=False)['tag'].max()",df.groupby('userId').max()['tag'],2.43,5.69
45169298,answer,45168334,"python,pandas",codeblock,https://stackoverflow.com/questions/45169298,df['result'] = df.key.map(dict),s.groupby(s).transform(lambda g: factorial(g.name)),2.22,3.92
45193636,answer,45193131,"python,pandas",codeblock,https://stackoverflow.com/questions/45193636,"(pd.DataFrame(df.index[np.argsort(-df.values, axis=0)[-1:-1-N:-1]], columns=df.columns))",(df.apply(lambda x: pd.Series(x.nsmallest(N).index))),0.159,3.52
45211343,answer,45201789,"python,python-3.x,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/45211343,"x.flat[::x.shape[1]+1].A1 * err[:,None]","np.diagonal(x)*err[:,np.newaxis]",37.7,66.8
45227919,answer,45227793,"python,numpy",codeblock,https://stackoverflow.com/questions/45227919,"(d[:,None,...]*r).sum(axis=(2,3,4))","[np.tensordot(d[i],r[i], axes=((0, 1, 2), (1, 2, 3))) for i in





range(6)]",0.0166,0.145
45227919,answer,45227793,"python,numpy",codeblock,https://stackoverflow.com/questions/45227919,"np.einsum('aijk,abijk->ab',d,r)","[np.tensordot(d[i],r[i], axes=((0, 1, 2), (1, 2, 3))) for i in





range(6)]",0.00722,0.145
45227919,answer,45227793,"python,numpy",codeblock,https://stackoverflow.com/questions/45227919,"np.einsum('aijk,abijk->ab',d,r)","(d[:,None,...]*r).sum(axis=(2,3,4))",0.00722,0.0166
45241300,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45241300,dict_data[key],df[df.val==key],0.577001,17583.4
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,"df.iloc[random.randint(0, 10**4)]","df.loc[random.randint(0, 10**4)]",0.262,12.3
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,df.loc[df.a > 0.9],"df.query(""a > 0.9"")",2.93,7.78
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,df.loc[df.a > 0.9],"df.query(""a > 0.9"")",2.95,7.81
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,df.loc[df.a > 0.9],"df.query(""a > 0.9"")",2.96,7.84
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,"df.iloc[random.randint(0, 10**4)]","df.loc[random.randint(0, 10**4)]",0.275,0.331
45243141,answer,45240803,"python,pandas,search,dataframe,time-complexity",codeblock,https://stackoverflow.com/questions/45243141,"df.iloc[random.randint(0, 10**4)]","df.loc[random.randint(0, 10**4)]",0.262,0.478
45269352,answer,45268244,"python-2.7,pandas,dataframe,time-series",codeblock,https://stackoverflow.com/questions/45269352,pd.get_dummies(df.set_index('time')['letter']),df.set_index('time').letter.str.get_dummies(),10.9,914
45272980,answer,45271336,"python,pandas",codeblock,https://stackoverflow.com/questions/45272980,"pd.DataFrame([[u, t] + l for u, td in datastore.items() for t, l in td.items()], columns='users timets x y z k'.split())","pd.DataFrame.from_dict(datastore, 'index').stack().rename_axis(['users', 'times']).apply(pd.Series, index=list('xyzk')).reset_index()",0.556,2.72
45299066,answer,45298960,"python,arrays,numpy,numpy-broadcasting,pytorch",codeblock,https://stackoverflow.com/questions/45299066,a[np.arange(M)%a.shape[0]],"np.resize(a,(M,a.shape[1]))",15.2,24.1
45299066,answer,45298960,"python,arrays,numpy,numpy-broadcasting,pytorch",codeblock,https://stackoverflow.com/questions/45299066,a[np.arange(M)%a.shape[0]],"np.take(a,np.arange(M)%a.shape[0],axis=0)",15.2,16.2
45299066,answer,45298960,"python,arrays,numpy,numpy-broadcasting,pytorch",codeblock,https://stackoverflow.com/questions/45299066,"np.take(a,np.arange(M)%a.shape[0],axis=0)","np.resize(a,(M,a.shape[1]))",16.2,24.1
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),12.8,214
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),9.2,24.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),9.2,12.8
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),9.2,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),9.2,214
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),9.2,15.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),214,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month1'] = df['purchase_date'].values.astype('datetime64[M]'),"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",9.2,28.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),12.8,15.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),15.9,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),15.9,24.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",15.9,28.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month2'] = df['purchase_date'].dt.floor('d') - pd.offsets.MonthBegin(1),df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),15.9,214
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),12.8,24.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",12.8,28.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),24.9,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),28.9,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",24.9,28.9
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month5'] = df['purchase_date'].dt.normalize() - pd.offsets.MonthBegin(1),df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),24.9,214
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,df['month3'] = (df['purchase_date'] - pd.offsets.MonthBegin(1)).dt.floor('d'),df['month4'] = df['purchase_date'].dt.to_period('M').dt.to_timestamp(),12.8,399
45304665,answer,45304531,"python,pandas,dataframe,datetime64",codeblock,https://stackoverflow.com/questions/45304665,"df['month'] = df['purchase_date'] - pd.offsets.MonthBegin(1, normalize=True)",df['month6']= pd.to_datetime(df.purchase_date.astype(str).str[0:7]+'-01'),28.9,214
45308528,answer,45296766,"python,numpy",codeblock,https://stackoverflow.com/questions/45308528,"np.frompyfunc(my_func,1,1)(test_arr)",np.array([my_func(x) for x in test_arr]),0.00568,0.00896
45310740,answer,45310470,"python,list,pandas,dataframe,indexing",sentence,"you're almost there... just use enumerate to loop with indices, and df.isnull().values.any() (faster than df.isnull().any().max()) to test:",df.isnull().values.any(),df.isnull().any().max(),,
45312468,answer,38725355,"python,performance,pandas,eval",sentence,"long story short, it appears that df.eval() tends to be slower than pd.eval() because under the hood it's just pd.eval() with extra steps, and these steps are non-trivial.",pd.eval(),df.eval(),,
45333854,answer,45333683,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45333854,"df.loc[df.ID1.isin(df[df.Account == '94500'].ID2),""Match""] = True",df['Match'] = df['ID1'].apply(lambda x: any((df['ID2']==x) & (df['Account']=='94500'))),1.48,4.21
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,np.nansum((short_a1-short_a2)**2),"np.nansum([(a-b)**2 for a,b in zip(short_l1 , short_l2)])",0.00907,0.0091
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,"np.nansum([(a-b)**2 for a,b in zip(short_l1 , short_l2)])",np.nansum((np.array(short_l1)-np.array(short_l2))**2),0.0091,0.012
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,np.nansum((np.array(long_l1)-np.array(long_l2))**2),"np.nansum([(a-b)**2 for a,b in zip(long_l1 , long_l2)])",0.498,1.32
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,np.nansum((long_a1-long_a2)**2),"np.nansum([(a-b)**2 for a,b in zip(long_l1 , long_l2)])",0.0487,1.32
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,np.nansum((long_a1-long_a2)**2),np.nansum((np.array(long_l1)-np.array(long_l2))**2),0.0487,0.498
45335287,answer,45335181,"python,list,numpy,enumerate",codeblock,https://stackoverflow.com/questions/45335287,np.nansum((short_a1-short_a2)**2),np.nansum((np.array(short_l1)-np.array(short_l2))**2),0.00907,0.012
45354076,answer,45352714,"python,pandas",codeblock,https://stackoverflow.com/questions/45354076,df.a[df.c],df[df.c].a,0.387,0.437
45354076,answer,45352714,"python,pandas",codeblock,https://stackoverflow.com/questions/45354076,"df.loc[df.c, 'a']",df[df.c].a,0.21,0.437
45354076,answer,45352714,"python,pandas",codeblock,https://stackoverflow.com/questions/45354076,"df.loc[df.c, 'a']",df.a[df.c],0.21,0.387
45364242,answer,45363311,"python,pandas,jupyter-notebook",codeblock,https://stackoverflow.com/questions/45364242,"pd.DataFrame(list(chain.from_iterable(df.groups.values)), columns=['Group']).Group.value_counts()","pd.DataFrame(list(chain.from_iterable(df.groups.values))).groupby(0, as_index=False).sum().rename(columns={0:'Group', 1:'Count'})",0.899,5.5
45423128,answer,45423096,"python,pandas",codeblock,https://stackoverflow.com/questions/45423128,"pd.read_csv(pd.io.common.StringIO(y), header=None)","pd.DataFrame([l.split(',') for l in y.split('\n')]).astype(int)",125,200
45423303,answer,45422898,"python,arrays,python-2.7,pandas,numpy",codeblock,https://stackoverflow.com/questions/45423303,"mesh = pd.DataFrame(np.column_stack(list(map(np.ravel, np.meshgrid(*map(np.arange, im.shape), indexing=""ij""))) + [im.ravel()]), columns=[""mode"", ""x"", ""y"", ""z"", ""val""])","loop = pd.DataFrame([index + (x,) for index, x in np.ndenumerate(im)], columns=[""mode"", ""x"", ""y"", ""z"", ""val""])",2070,62000
45428123,answer,45428094,"python,pandas",codeblock,https://stackoverflow.com/questions/45428123,df.opportunity_status.eq('Closed Won').groupby(df.client_id).any().reset_index(),"df.groupby('client_id', as_index=False).opportunity_status.agg(lambda x: x.eq('Closed Won').any())",2.06,4.84
45430296,answer,45429440,"python,pandas",codeblock,https://stackoverflow.com/questions/45430296,"np.append(0, np.diff(df.index.values)) != 1",df.index.to_series().diff() != 1,0.0331,0.26
45430296,answer,45429440,"python,pandas",codeblock,https://stackoverflow.com/questions/45430296,df.index.to_series().diff() != 1,"[True] + [(i[0]+1) != i[1] for i in zip(df.index.tolist(), df.index.tolist()[1:])]",0.26,4.19
45430296,answer,45429440,"python,pandas",codeblock,https://stackoverflow.com/questions/45430296,"np.append(0, np.diff(df.index.values)) != 1","[True] + [(i[0]+1) != i[1] for i in zip(df.index.tolist(), df.index.tolist()[1:])]",0.0331,4.19
45445245,answer,45436741,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/45445245,"M = sparse.random(10,10,.2,format='csr')





M[-1,:] = np.arange(10)","M = sparse.random(10,10,.2,format='csr')





M1=M.tolil(); M1[-1,:] = np.arange(10); M = M1.tocsr()",0.204,0.444
45445245,answer,45436741,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/45445245,"M = sparse.random(10,10,.2,format='lil')





M[-1,:] = np.arange(10)","M = sparse.random(10,10,.2,format='csr')





M1=M.tolil(); M1[-1,:] = np.arange(10); M = M1.tocsr()",0.162,0.444
45445245,answer,45436741,"python,scipy,sparse-matrix",codeblock,https://stackoverflow.com/questions/45445245,"M = sparse.random(10,10,.2,format='lil')





M[-1,:] = np.arange(10)","M = sparse.random(10,10,.2,format='csr')





M[-1,:] = np.arange(10)",0.162,0.204
45446581,answer,45446516,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45446581,df[df.id.str.contains('^[^a-zA-Z]')],df[-df.id.str[0].str.isalpha()],0.418,0.576
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"df * np.arange(1, df.shape[1]+1)","(df.mul(list(range(1, len(df.columns)+1))))",21,38.7
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"df * np.arange(1, df.shape[1]+1)","pd.DataFrame(df.values * np.arange(1, len(df.columns)+1), index=df.index, columns=df.columns)",21,25.1
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"pd.DataFrame(df.values * np.arange(1, len(df.columns)+1), index=df.index, columns=df.columns)","df.replace({col: {1: n} for n, col in enumerate(df.columns[1:], 2)})",25.1,1390
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"pd.DataFrame(df.values * np.arange(1, len(df.columns)+1), index=df.index, columns=df.columns)","(df.mul(list(range(1, len(df.columns)+1))))",25.1,38.7
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"(df.mul(list(range(1, len(df.columns)+1))))","df.replace({col: {1: n} for n, col in enumerate(df.columns[1:], 2)})",38.7,1390
45462720,answer,45462637,"python,list,pandas",codeblock,https://stackoverflow.com/questions/45462720,"df * np.arange(1, df.shape[1]+1)","df.replace({col: {1: n} for n, col in enumerate(df.columns[1:], 2)})",21,1390
45462833,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45462833,"arr[:, :, :, :, :, 4]","arr.take(4, axis=5)",0.00229,18.6
45462833,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45462833,"arr[(slice(None), )*5 + (4, )]","arr.take(4, axis=5)",0.00272,18.6
45462833,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45462833,"arr[:, :, :, :, :, 4]","arr[(slice(None), )*5 + (4, )]",0.00229,0.00272
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"arr[:, :, :, :, :, 4]","np.rollaxis(arr, 5)[4]",0.00054,0.00341
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"arr[(slice(None), )*5 + (4, )]","arr.take(4, axis=5)",0.000731,4.44
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"arr[(slice(None), )*5 + (4, )]","np.rollaxis(arr, 5)[4]",0.000731,0.00341
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"arr[:, :, :, :, :, 4]","arr.take(4, axis=5)",0.00054,4.44
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"np.rollaxis(arr, 5)[4]","arr.take(4, axis=5)",0.00341,4.44
45463291,answer,45462551,"python,arrays,numpy,multidimensional-array,indexing",codeblock,https://stackoverflow.com/questions/45463291,"arr[:, :, :, :, :, 4]","arr[(slice(None), )*5 + (4, )]",0.00054,0.000731
45469180,answer,45469042,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/45469180,"df.assign(F=list(starmap(a_sum, df[['ColA', 'ColB']].values)))","df.assign(F=df.apply(lambda row: a_sum(row.ColA, row.ColB), axis=1))",5.01,90.7
45469595,answer,45469417,"python,pandas,sorting",codeblock,https://stackoverflow.com/questions/45469595,df.iloc[np.argsort([x.get('age') for x in df.Stats.values.tolist()])],df.iloc[np.argsort([x.get('age') for x in df.Stats])],0.207,0.225
45469595,answer,45469417,"python,pandas,sorting",codeblock,https://stackoverflow.com/questions/45469595,df.iloc[np.argsort([x.get('age') for x in df.Stats.values.tolist()])],df.iloc[pd.DataFrame(df.Stats.values.tolist()).age.argsort()],0.207,0.756
45469595,answer,45469417,"python,pandas,sorting",codeblock,https://stackoverflow.com/questions/45469595,df.iloc[np.argsort([x.get('age') for x in df.Stats])],df.iloc[pd.DataFrame(df.Stats.values.tolist()).age.argsort()],0.225,0.756
45482356,answer,45481517,"python,python-2.7,performance,numpy,sum",codeblock,https://stackoverflow.com/questions/45482356,"np.add.reduceat(a, np.r_[0, np.cumsum(b)[:-1]])","[part.sum() for part in np.split(a, np.cumsum(b))[:-1]]",0.293,44.6
45517074,answer,45516690,"python,matlab,scipy,anaconda,sparse-matrix",codeblock,https://stackoverflow.com/questions/45517074,A.dot(x)    # sparse with dense,Ad.dot(x)    # dense with dense,0.137,1.03
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.get_dummies(y).astype(bool),pd.DataFrame({x: [x==l for l in labels] for x in set(labels)}),0.476,0.58
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.DataFrame({x: [x==l for l in labels] for x in set(labels)}),pd.DataFrame({x : (y == x) for x in y.unique()}),0.58,1.15
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.get_dummies(y).astype(bool),pd.DataFrame({x: [x==l for l in labels] for x in set(labels)}),0.875,4.97
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.get_dummies(y).astype(bool),pd.DataFrame({x : (y == x) for x in y.unique()}),0.875,1.32
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.get_dummies(y).astype(bool),pd.DataFrame({x : (y == x) for x in y.unique()}),0.476,1.15
45562907,answer,45562651,"python,pandas,optimization",codeblock,https://stackoverflow.com/questions/45562907,pd.DataFrame({x : (y == x) for x in y.unique()}),pd.DataFrame({x: [x==l for l in labels] for x in set(labels)}),1.32,4.97
45568323,answer,45548951,"python,python-2.7,numpy,random,numba",codeblock,https://stackoverflow.com/questions/45568323,np.random.poisson(lam=n*pop_n/np.sum(pop_n)),"poisson(n, pop_n)",203,203
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))","(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))",20.6,39.8
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))","(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",20.6,138
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),7.04,658
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))","(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",39.8,138
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),20.6,6680
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),39.8,6680
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),138,6680
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),16.8,658
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))","(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",7.04,16.8
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))","(df.join(df['services'].apply(lambda x: ""|"".join(x)).str.get_dummies()))",4.66,16.8
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))","(df.join(pd.get_dummies(pd.DataFrame(df['services'].values.tolist()), prefix='', prefix_sep='').groupby(axis=1, level=0).max()))",4.66,7.04
45570774,answer,45570632,"python,pandas",codeblock,https://stackoverflow.com/questions/45570774,"(df.join(pd.DataFrame(mlb.fit_transform(df['services']),columns=mlb.classes_, index=df.index)))",(df.join(df.services.apply(lambda x: pd.Series({y:1 for y in x})).fillna(0).astype(int))),4.66,658
45576510,answer,45573265,"python,performance,numpy,average,mean",codeblock,https://stackoverflow.com/questions/45576510,arr.mean(axis=0),"np.ma.average(arr, axis=0)",1.84,2.96
45577558,answer,45577477,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45577558,data.columns = pd.RangeIndex(len(data.columns)),data.columns = np.arange(len(data.columns)),0.0144,0.0452
45579959,answer,45579857,"python,pandas",codeblock,https://stackoverflow.com/questions/45579959,df_test.Col1.isin(df2.Col2),"pd.Series(np.in1d(df_test.Col1, df2.Col2), name='Col1')",1.44,2.92
45579959,answer,45579857,"python,pandas",codeblock,https://stackoverflow.com/questions/45579959,"pd.Series(np.in1d(df_test.Col1, df2.Col2), name='Col1')",df_test.Col1.apply(lambda x: x in df2.Col2),2.92,601
45579959,answer,45579857,"python,pandas",codeblock,https://stackoverflow.com/questions/45579959,df_test.Col1.isin(df2.Col2),df_test.Col1.apply(lambda x: x in df2.Col2),1.44,601
45614794,answer,45614447,"python,numpy,nan,inf",codeblock,https://stackoverflow.com/questions/45614794,a[np.isnan(a-a)] = -999,"a[np.logical_or(np.isnan(a), np.isinf(a))] = -999",0.0117,0.0514
45614794,answer,45614447,"python,numpy,nan,inf",codeblock,https://stackoverflow.com/questions/45614794,a[np.isnan(a-a)] = -999,a[np.isnan(a) | np.isinf(a)] = -999,0.0117,0.0514
45614794,answer,45614447,"python,numpy,nan,inf",codeblock,https://stackoverflow.com/questions/45614794,"a[np.logical_or(np.isnan(a), np.isinf(a))] = -999",a[np.isnan(a) | np.isinf(a)] = -999,0.0514,0.0514
45621321,answer,43489200,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/45621321,df.isnull().values.all(),df.isnull().all().all(),0.112,0.271
45621321,answer,43489200,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/45621321,df.isnull().values.all(),df.isnull().all().all(),26.6,40.8
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df.groupby('ID').filter(lambda x: s.isin(x['Hour']).all())),(df.loc[df.groupby('ID').Hour.transform(lambda x: set(x) & test_set == test_set)]),211,356
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df.groupby('ID').filter(lambda x: s.isin(x['Hour']).all())),(df[df['ID'].map(df.groupby(by='ID')['Hour'].apply(set)) >= set(testVector)]),211,462
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df[df.groupby('ID')['Hour'].transform(lambda x: s.isin(x).all())]),(df[df['ID'].map(df.groupby(by='ID')['Hour'].apply(set)) >= set(testVector)]),300,462
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df[df.groupby('ID')['Hour'].transform(lambda x: s.isin(x).all())]),(df.loc[df.groupby('ID').Hour.transform(lambda x: set(x) & test_set == test_set)]),300,356
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df.loc[df.groupby('ID').Hour.transform(lambda x: set(x) & test_set == test_set)]),(df[df['ID'].map(df.groupby(by='ID')['Hour'].apply(set)) >= set(testVector)]),356,462
45632839,answer,45632675,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45632839,(df.groupby('ID').filter(lambda x: s.isin(x['Hour']).all())),(df[df.groupby('ID')['Hour'].transform(lambda x: s.isin(x).all())]),211,300
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(df.Col1.apply(pd.Series)),80.3,238000
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",(df.Col1.apply(pd.Series)),2910,238000
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),(df.Col1.apply(pd.Series)),90.5,238000
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",90.5,2910
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",80.3,2910
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(df.Col1.apply(pd.Series)),1.26,1580
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",(df.Col1.apply(pd.Series)),29,1580
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(pd.DataFrame(df.Col1.tolist())),0.694,0.705
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",0.694,3.51
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(df.Col1.apply(pd.Series)),0.694,159
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",0.705,3.51
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(pd.DataFrame(df.Col1.tolist())),80.3,90.5
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),(pd.DataFrame(df.Col1.tolist())),1.26,1.37
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),(df.Col1.apply(pd.Series)),0.705,159
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.values.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",1.26,29
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",1.37,29
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,(pd.DataFrame(df.Col1.tolist())),(df.Col1.apply(pd.Series)),1.37,1580
45646690,answer,45645847,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45646690,"(df.Col1.apply(lambda x: ','.join(str(y) for y in x)).str.split(',', expand=True))",(df.Col1.apply(pd.Series)),3.51,159
45648761,answer,45648668,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45648761,(A > 0.5).astype(int),"np.where(A > 0.5, 1, 0)",3.47,7.58
45653366,answer,45652569,"python,numpy,set",codeblock,https://stackoverflow.com/questions/45653366,"1 - numpy.bincount(list(s), minlength=nwords)","numpy.asarray( [ int(x not in words)  for x in range(0,nwords) ] )",0.00397,0.00617
45671263,answer,45671195,"python,pandas",codeblock,https://stackoverflow.com/questions/45671263,df['new'] = df['numbers'] + df['other_numbers'].mask(df.index.duplicated()).ffill().astype(int),df.assign(new1=df.groupby('key')['other_numbers'].transform('first')+df['numbers']),34.8,64.7
45685390,answer,45685254,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/45685390,df.assign(id=(df['LastName'] + '_' + df['FirstName']).astype('category').cat.codes),"df.assign(id=df.groupby(['LastName','FirstName']).ngroup())",0.848,1.22
45685390,answer,45685254,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/45685390,"df2.assign(id=df2.groupby(['LastName','FirstName']).ngroup())",df2.assign(id=(df2['LastName'] + '_' + df2['FirstName']).astype('category').cat.codes),3.1,5.22
45689161,answer,45688994,"python,pandas,date,dataframe",codeblock,https://stackoverflow.com/questions/45689161,pd.to_datetime(df['date']) + pd.tseries.offsets.QuarterEnd(0),"df.assign(q_date=[pd.Period(d, freq='Q').end_time for d in df['date']])",913,1840
45689161,answer,45688994,"python,pandas,date,dataframe",codeblock,https://stackoverflow.com/questions/45689161,pd.to_datetime(df['date']) + pd.tseries.offsets.QuarterEnd(0),"df.assign(q_date=[pd.Period(d, freq='Q').end_time for d in df['date']])",9130,18500
45692117,answer,20490274,"python,indexing,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45692117,df.index = pd.RangeIndex(len(df.index)),df1 = df.reset_index(drop=True),0.00784,0.105
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.where(a.A.ne(9) | a.D.ne(2)),a.where(~(a.A.eq(9) & a.D.eq(2))),316,318
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.where(a.A.ne(9) | a.D.ne(2)),a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),316,355
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.where(~(a.A.eq(9) & a.D.eq(2))),a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),318,355
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.mask((a['A'] == 9) & (a['D'] == 2)),a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),316,355
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.where(a.A.ne(9) | a.D.ne(2)),27.6,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.mask((a['A'] == 9) & (a['D'] == 2)),a.where(~(a.A.eq(9) & a.D.eq(2))),316,318
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.mask((a['A'] == 9) & (a['D'] == 2)),27.6,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",27.6,90.5
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),25.8,355
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.where(a.A.ne(9) | a.D.ne(2)),a.mask((a['A'] == 9) & (a['D'] == 2)),316,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.where(a.A.ne(9) | a.D.ne(2)),25.8,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.where(~(a.A.eq(9) & a.D.eq(2))),25.8,318
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.mask((a['A'] == 9) & (a['D'] == 2)),25.8,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.where(~(a.A.eq(9) & a.D.eq(2))),27.6,318
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",25.8,90.5
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,25.8,27.6
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",a.where(~(a.A.eq(9) & a.D.eq(2))),90.5,318
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",a.where(a.A.ne(9) | a.D.ne(2)),90.5,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),90.5,355
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,"a.mul(np.where((a.A==9)&(a.D==2),np.nan,1),0)",a.mask((a['A'] == 9) & (a['D'] == 2)),90.5,316
45694833,answer,45694786,"python,pandas",codeblock,https://stackoverflow.com/questions/45694833,a.loc[(a['A'] == 9) & (a['D'] == 2)] = np.nan,a[a.A.ne(9) | a.D.ne(2)].reindex(a.index),27.6,355
45695288,answer,24870953,"python,performance,pandas,iteration",sentence,"another option is to use to_records(), which is faster than both itertuples and iterrows.",to_records(),itertuples,,
45709941,answer,45709488,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45709941,"np.logical_or.reduce([df[c].str.contains('setup') for c in ['k1', 'k2']])","df[['k1', 'k2']].apply(lambda x: x.str.contains('setup')).any(1)",59.5,88.4
45709941,answer,45709488,"python,string,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45709941,"np.logical_or.reduce([df[c].str.contains('setup') for c in ['k1', 'k2']])","df[['k1', 'k2']].apply(lambda x: x.str.contains('setup')).any(1)",0.421,2.01
45719789,answer,45719738,"python-3.x,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45719789,df[df.groupby('Patient')['Score'].transform('first').ge(28)],"df.groupby('Patient').filter(lambda x: x.iloc[0, df.columns.get_loc('Score')] >= 28)",16.8,49.9
45721713,answer,45721669,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45721713,"df.sort_values(['EFFECTIVE DT','SYSDATE']).groupby('EFFECTIVE DT').tail(2).sort_index()","df.sort_values(['EFFECTIVE DT','SYSDATE'], ascending=[True,False]).groupby('EFFECTIVE DT').head(2).sort_index()",23.3,25.4
45721713,answer,45721669,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45721713,"df.sort_values(['EFFECTIVE DT','SYSDATE']).groupby('EFFECTIVE DT').tail(2).sort_index()","df.groupby('EFFECTIVE DT', group_keys=False, sort=False).apply(pd.DataFrame.nlargest, n=2, columns='SYSDATE')",23.3,2610
45721713,answer,45721669,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45721713,"df.sort_values(['EFFECTIVE DT','SYSDATE'], ascending=[True,False]).groupby('EFFECTIVE DT').head(2).sort_index()","df.groupby('EFFECTIVE DT', group_keys=False, sort=False).apply(pd.DataFrame.nlargest, n=2, columns='SYSDATE')",25.4,2610
45731475,answer,45731261,"python,pandas,dataframe,pandas-groupby",codeblock,https://stackoverflow.com/questions/45731475,"(df1.add(df2, fill_value=0).div(pd.Series(np.concatenate([df1.columns, df2.columns])).value_counts()))","(pd.concat([df1,df2]).mean(level = 0))",161,895
45731475,answer,45731261,"python,pandas,dataframe,pandas-groupby",codeblock,https://stackoverflow.com/questions/45731475,"(pd.concat([df1,df2]).mean(level = 0))","(pd.concat([df1,df2], axis=1).fillna(0).groupby(level=0, axis=1).mean())",895,952
45731475,answer,45731261,"python,pandas,dataframe,pandas-groupby",codeblock,https://stackoverflow.com/questions/45731475,"(df1.add(df2, fill_value=0).div(pd.Series(np.concatenate([df1.columns, df2.columns])).value_counts()))","(pd.concat([df1,df2], axis=1).fillna(0).groupby(level=0, axis=1).mean())",161,952
45756883,answer,45756839,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45756883,df['city'] + '_' + df['date'] + '_' + df['place'].astype(str),"df[['city', 'date', 'place']].astype(str).apply('_'.join, 1)",9,84
45756883,answer,45756839,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45756883,df['city'] + '_' + df['date'] + '_' + df['place'].astype(str),"df[['city', 'date', 'place']].astype(str).transform('_'.join, 1)",9,83
45756883,answer,45756839,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45756883,"df[['city', 'date', 'place']].astype(str).transform('_'.join, 1)","df[['city', 'date', 'place']].astype(str).apply('_'.join, 1)",83,84
45757512,answer,45756854,"python,numpy",codeblock,https://stackoverflow.com/questions/45757512,~np.isfinite(arr),np.isnan(arr - arr),3.73,12.5
45759219,answer,45758945,"python,numpy,scipy,vectorization",codeblock,https://stackoverflow.com/questions/45759219,"x = np.zeros(10000); x[0] = 10000; find_fix_point_recursive(f, x)","x = np.zeros(10000); x[0] = 10000; find_fix_point(f, x)",0.141,1.04
45801635,answer,45801583,"python,pandas,indexing,dummy-variable",codeblock,https://stackoverflow.com/questions/45801635,"np.where((df.index  >= '2010-01-02 03:00:00') & (df.index <= '2010-01-02 05:00:00'), 1, 0)",((df.index  >= '2010-01-02 03:00:00') & (df.index <= '2010-01-02 05:00:00')).astype(int),1.52,1.58
45817430,answer,45817271,"python,pandas,dataframe,nan,missing-data",codeblock,https://stackoverflow.com/questions/45817430,df2[(df2.T != 'n').any()],"df2.replace('n',np.nan).dropna(how = 'all')",0.449,0.985
45822435,answer,45822330,pandas,codeblock,https://stackoverflow.com/questions/45822435,my_df.groupby('new').old.sum().reset_index(),"my_df.reset_index().groupby('index').agg({'new':'first','old':'sum'})",0.817,1.33
45836132,answer,45835993,"python,pandas,numpy,dataframe,reduce",codeblock,https://stackoverflow.com/questions/45836132,df_test.groupby('a')['values'].apply(np.hstack),df_test.groupby('a')['values'].sum(),219,4440
45856155,answer,45855904,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/45856155,"pd.DataFrame(indices_merged_arr(array), columns=['x', 'y', 'value'])","df = pd.DataFrame(np.hstack((np.indices(arr.shape).reshape(2, arr.size).T,arr.reshape(-1, 1))), columns=['x', 'y', 'value'])",0.229,15.3
45857632,answer,45857465,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45857632,"df = pd.DataFrame(np.hstack((np.indices(arr.shape).reshape(2, arr.size).T,arr.reshape(-1, 1))), columns=['x', 'y', 'value'])","pd.DataFrame(indices_merged_arr_eric(arr), columns=['x', 'y', 'value'], dtype=np.float32)",4.97,5.59
45857632,answer,45857465,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45857632,"pd.DataFrame(indices_merged_arr_divakar(arr), columns=['x', 'y', 'value'])","df = pd.DataFrame(np.hstack((np.indices(arr.shape).reshape(2, arr.size).T,arr.reshape(-1, 1))), columns=['x', 'y', 'value'])",3.82,4.97
45857632,answer,45857465,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45857632,"pd.DataFrame(indices_merged_arr_divakar(arr), columns=['x', 'y', 'value'])","pd.DataFrame(indices_merged_arr_eric(arr), columns=['x', 'y', 'value'], dtype=np.float32)",3.82,5.59
45901074,answer,45901018,"python,pandas",codeblock,https://stackoverflow.com/questions/45901074,"pd.DataFrame.from_items(zip(s.index, s.values))",s.apply(lambda x:pd.Series(x)).T,0.669,1.37
45901074,answer,45901018,"python,pandas",codeblock,https://stackoverflow.com/questions/45901074,"pd.DataFrame.from_items(zip(s.index, s.values)).T",s.apply(lambda x:pd.Series(x)),0.919,1.26
45914206,answer,45913064,"arrays,python-3.x,numpy,boolean,vectorization",codeblock,https://stackoverflow.com/questions/45914206,"np.take(np.array([[0,1],[1,0]]), vec, axis=0)","np.stack((vec, vec ^ 1), axis=1)",31,50.2
45927357,answer,45927228,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45927357,df.shape,df.values.shape,0.00158,0.00578
45927357,answer,45927228,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45927357,df.shape,"len(df), len(df.columns)",0.00158,0.00165
45927357,answer,45927228,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45927357,"len(df), len(df.columns)",df.values.shape,0.00165,0.00578
45943255,answer,45942435,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45943255,"np.unique([y for x in df['1'].values.tolist() for y in x.strip('[]').split(', ')])","pd.unique([y for x in df['1'].values.tolist() for y in x.strip('[]').split(', ')])",0.0175,0.0578
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,"indexed_data.iloc[0:100000, indexed_data.columns.get_loc('var')]","indexed_data.loc[indexed_data.index[0:100000], 'var']",0.155,7.36
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].iloc[0:100000],indexed_data['var'][0:100000],0.0621,0.0823
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].iloc[0:100000],"indexed_data.iloc[0:100000, indexed_data.columns.get_loc('var')]",0.0621,0.155
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].iloc[0:100000],"indexed_data.loc[indexed_data.index[0:100000], 'var']",0.0621,7.36
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].values[0:100000],indexed_data['var'].iloc[0:100000],0.00535,0.0621
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'][0:100000],"indexed_data.iloc[0:100000, indexed_data.columns.get_loc('var')]",0.0823,0.155
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'][0:100000],"indexed_data.loc[indexed_data.index[0:100000], 'var']",0.0823,7.36
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].values[0:100000],indexed_data['var'][0:100000],0.00535,0.0823
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].values[0:100000],"indexed_data.iloc[0:100000, indexed_data.columns.get_loc('var')]",0.00535,0.155
45983830,answer,45983801,"python,pandas",codeblock,https://stackoverflow.com/questions/45983830,indexed_data['var'].values[0:100000],"indexed_data.loc[indexed_data.index[0:100000], 'var']",0.00535,7.36
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,(df.change > 0).astype(int),df.change.gt(0).astype(int),0.276,0.351
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,"np.where(df_test.change > 0.0, 1, 0)",df_test.change.gt(0).astype(int),0.328,0.425
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,(df_test.change > 0).astype(int),df_test.change.gt(0).astype(int),0.377,0.425
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,"np.where(df_test.change > 0.0, 1, 0)",(df_test.change > 0).astype(int),0.328,0.377
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,"np.where(df.change > 0.0, 1, 0)",df.change.gt(0).astype(int),0.209,0.351
45990957,answer,45990893,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45990957,"np.where(df.change > 0.0, 1, 0)",(df.change > 0).astype(int),0.209,0.276
45993212,answer,45993202,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45993212,(df.cumprod()),(df.apply(np.cumprod)),0.15,1.23
45993212,answer,45993202,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45993212,(df.cumprod()),(np.cumprod(df)),0.15,0.165
45993212,answer,45993202,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/45993212,(np.cumprod(df)),(df.apply(np.cumprod)),0.165,1.23
45995088,answer,45994973,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/45995088,"np.diff(np.flatnonzero(np.concatenate(([True], a[1:]!= a[:-1], [True] ))))","np.diff(np.r_[0,np.flatnonzero(np.diff(a))+1,a.size])",1.21,2.13
46004266,answer,45999814,"python,numpy",codeblock,https://stackoverflow.com/questions/46004266,np.array([blackbox_fn(i) for i in np.arange(1000)]),np.stack(fpy(np.arange(1000).ravel())),6.44,6.71
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],df[df.groupby('A').A.transform(len)>3],1.29,2.05
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df[df.groupby('A').A.transform(len)>3],0.283,2.05
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df.groupby('A').filter(lambda x: x.size > 3),df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],1.25,1.29
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.groupby('A').A.transform(len)>3],df.groupby('A').filter(lambda x: x.size > 3),1.62,2.41
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df.groupby('A').filter(lambda x: x.size > 3),0.283,1.25
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df.groupby('A').filter(lambda x: x.size > 3),df[df.groupby('A').A.transform(len)>3],1.25,2.05
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],0.283,1.29
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],0.348,1.62
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],df[df.groupby('A').A.transform(len)>3],1.62,1.62
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df[df.groupby('A').A.transform(len)>3],0.348,1.62
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(df.A.value_counts()[df.A.value_counts()>=4].index)],df.groupby('A').filter(lambda x: x.size > 3),1.62,2.41
46007703,answer,46007571,"python,pandas,numpy,conditional",codeblock,https://stackoverflow.com/questions/46007703,df[df.A.isin(np.flatnonzero(np.bincount(df.A)>=4))],df.groupby('A').filter(lambda x: x.size > 3),0.348,2.41
46018526,answer,46018000,"python,performance,numpy,matrix",codeblock,https://stackoverflow.com/questions/46018526,"np.dot(pseudo, pseudo)","(pseudo[:,:,None]*pseudo[None,:,:]).sum(axis=1)",0.0639,0.0757
46018526,answer,46018000,"python,performance,numpy,matrix",codeblock,https://stackoverflow.com/questions/46018526,"np.dot(base,base)","(base[:,:,None]*base[None,:,:]).sum(axis=1)",0.00158,0.0139
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,"(np.intersect1d(L, df['Name']).tolist())",(df.query('Name in @L').Name.unique().tolist()),1.81,2.36
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([i for i in L if i in df.Name.tolist()]),(df.query('Name in @L').Name.unique().tolist()),0.393,2.36
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([x for x in df.Name.unique() if x in L]),"(np.intersect1d(L, df['Name']).tolist())",0.182,1.81
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([i for i in L if i in df.Name.tolist()]),"(np.intersect1d(L, df['Name']).tolist())",0.393,1.81
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([x for x in df.Name.unique() if x in L]),"(df.loc[df['Name'].isin(L), 'Name'].unique().tolist())",0.182,0.774
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([i for i in L if i in df.Name.tolist()]),"(df.loc[df['Name'].isin(L), 'Name'].unique().tolist())",0.393,0.774
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([x for x in df.Name.unique() if x in L]),([i for i in L if i in df.Name.tolist()]),0.182,0.393
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,([x for x in df.Name.unique() if x in L]),(df.query('Name in @L').Name.unique().tolist()),0.182,2.36
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,"(df.loc[df['Name'].isin(L), 'Name'].unique().tolist())","(np.intersect1d(L, df['Name']).tolist())",0.774,1.81
46021626,answer,46021605,"python,list,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46021626,"(df.loc[df['Name'].isin(L), 'Name'].unique().tolist())",(df.query('Name in @L').Name.unique().tolist()),0.774,2.36
46031529,answer,46031105,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46031529,"buckets = np.zeros(255**2, dtype=np.int64)





for i in idx:





    buckets[i] += 1","buckets = np.zeros(255**2, dtype=np.uint64)





for i in idx:





    buckets[i] += 1",9.38,71.7
46031529,answer,46031105,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46031529,"buckets = np.zeros(255**2, dtype=np.int64)





np.add.at(buckets, idx, 1)","buckets = np.zeros(255**2, dtype=np.uint64)





np.add.at(buckets, idx, 1)",1.6,1.62
46043964,answer,46041811,"python,performance,numpy,indexing,numba",codeblock,https://stackoverflow.com/questions/46043964,x[idx],x[bool_mask],0.0516,1.03
46043964,answer,46041811,"python,performance,numpy,indexing,numba",codeblock,https://stackoverflow.com/questions/46043964,x[idx],x[bool_mask],1.46,2.69
46043964,answer,46041811,"python,performance,numpy,indexing,numba",codeblock,https://stackoverflow.com/questions/46043964,x[bool_mask],x[idx],8.31,14.9
46091980,answer,46091924,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46091980,(data[data['sms'].notnull()]),"(data.query(""sms == sms""))",13.8,23.6
46091980,answer,46091924,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46091980,(data.dropna(subset=['sms'])),"(data.query(""sms == sms""))",19.5,23.6
46091980,answer,46091924,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46091980,(data[data['sms'].notnull()]),(data.dropna(subset=['sms'])),13.8,19.5
46108203,answer,46107996,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46108203,"result = (np.unpackbits(fp.astype('>i4').view('4,uint8'), axis=1).T.astype(bool))",expected = (np.transpose(np.array([[b == '1' for b in list('{:32b}'.format(i & 0xffffffff))] for i in fp]))),0.0306,2.22
46164057,answer,46163849,"python,pandas,recode,anonymize",codeblock,https://stackoverflow.com/questions/46164057,df['col'] = pd.factorize(df['col'])[0] + 1,df.col.astype('category').cat.codes.add(1),0.194,0.437
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(sorted) == df,8.08,9.84
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),9.84,62
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(lambda x: sorted(x) == x),75.7,77.5
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(sorted).eq(df),75.7,81.1
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),744,6250
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),75.7,617
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(sorted).eq(df),9.84,9.96
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted).eq(df),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),801,6250
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted).eq(df),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),81.1,617
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(sorted).eq(df),8.08,9.96
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),8.08,62
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted).eq(df),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),9.96,62
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(sorted).eq(df),77.5,81.1
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),77.5,617
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(sorted).eq(df),750,801
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(sorted).eq(df),744,801
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(sorted) == df,df.applymap(lambda x: sorted(x) == x),744,750
46169921,answer,46169830,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/46169921,df.applymap(lambda x: sorted(x) == x),df.applymap(lambda x: (np.asarray(x[:-1]) <= np.asarray(x[1:]))),750,6250
46181383,answer,46181112,"python,pandas",codeblock,https://stackoverflow.com/questions/46181383,df.index[df['Node'].apply(lambda x: 330.0 in x )].tolist(),df[df.Node.apply(lambda x: True if 330.0 in x else False)].index,0.262,0.704
46181383,answer,46181112,"python,pandas",codeblock,https://stackoverflow.com/questions/46181383,df.index[df['Node'].apply(lambda x: 330.0 in x )].tolist(),"df.loc[(df['x'] == 330) | (df['y'] == 330), 'Node']",0.262,1.3
46181383,answer,46181112,"python,pandas",codeblock,https://stackoverflow.com/questions/46181383,df[df.Node.apply(lambda x: True if 330.0 in x else False)].index,"df.loc[(df['x'] == 330) | (df['y'] == 330), 'Node']",0.704,1.3
46200449,answer,46198104,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/46200449,"np.multiply.outer(a,b)","np.outer(a,b)",154,154
46200449,answer,46198104,"python,arrays,numpy,matrix",sentence,for some reason np.multiply.outer seems to be faster than np.outer for small inputs.,np.multiply.outer,np.outer,,
46200449,answer,46198104,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/46200449,"np.multiply.outer(a,b)","np.outer(a,b)",0.00327,0.00597
46200449,answer,46198104,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/46200449,"np.multiply.outer(a,b)","np.outer(a,b)",0.014,0.0155
46202841,answer,46202732,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/46202841,argsort_unique2D(a.argsort(1))+1,a.argsort(1).argsort(1)+1,67.8,115
46217718,answer,46217537,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46217718,df.groupby('id')['sex'].apply(lambda x: np.argmax(np.bincount(x))).reset_index(),df.set_index('id').groupby(level=0).sex.apply(lambda x: x.value_counts().idxmax()).reset_index(),2.48,6.71
46217718,answer,46217537,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46217718,df.groupby('id')['sex'].apply(lambda x: np.argmax(np.bincount(x))).reset_index(),df.groupby('id')['sex'].apply(lambda x: x.value_counts().index[0]).reset_index(),2.48,4.55
46217718,answer,46217537,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46217718,df.groupby('id')['sex'].apply(lambda x: x.value_counts().index[0]).reset_index(),df.set_index('id').groupby(level=0).sex.apply(lambda x: x.value_counts().idxmax()).reset_index(),4.55,6.71
46218203,answer,46217986,"python,python-3.x,pandas,split",codeblock,https://stackoverflow.com/questions/46218203,"[x.split(';', 1)[1] for x in df['item'].values]","df['item'].str.split(';', 1).str[1]",5.42,11.4
46221124,answer,46220656,"python,pandas",codeblock,https://stackoverflow.com/questions/46221124,"df.astype(str).eq(""9999-Don't Know"").values.sum()","df.stack().str.contains(""9999-Don't Know"").sum()",0.182,0.467
46238361,answer,46238307,"python,r,python-3.x,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46238361,"{k:v.loc[v.variable1!=""a"",:] for k, v  in dictionary.items()}","{k:v.query('variable1!=""a""') for k, v  in dictionary.items()}",0.593,1.83
46238361,answer,46238307,"python,r,python-3.x,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46238361,"{k:v[v.variable1!=""a""] for k, v  in dictionary.items()}","{k:v.query('variable1!=""a""') for k, v  in dictionary.items()}",0.533,1.83
46238361,answer,46238307,"python,r,python-3.x,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46238361,"{k:v[v.variable1!=""a""] for k, v  in dictionary.items()}","{k:v.loc[v.variable1!=""a"",:] for k, v  in dictionary.items()}",0.533,0.593
46239543,answer,46239123,"python,pandas,dataframe,unique",codeblock,https://stackoverflow.com/questions/46239543,"np.unique(np.hstack([d['userId'].values for d in [df1, df2, df3]])).size","pd.concat([x['userId'] for x in [df1, df2, df3]]).nunique()",0.184,0.885
46260890,answer,46260758,"python,pandas",codeblock,https://stackoverflow.com/questions/46260890,"df.foo_list.apply(lambda x: filter(None, x))",df['foo_list'].apply(lambda x : [t for t in x if t != ()]),10.2,17.1
46260890,answer,46260758,"python,pandas",codeblock,https://stackoverflow.com/questions/46260890,df['foo_list'].apply(lambda x : [t for t in x if t != ()]),"df.foo_list.apply(lambda x: filter(None, x))",0.117,0.121
46281295,answer,46281209,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/46281295,"df['B2']= np.where((df.A.cumsum()<=max_val), df.A ,0)","df['B1'] = df['A'].where(df['A'].cumsum() <= max_val, 0)",6.45,8.22
46285221,answer,46285163,"python,numpy,matrix",sentence,"but, we can use np.einsum, which in most cases (in my experience) is seen to be marginally faster than np.matmul.",np.einsum,np.matmul,,
46291330,answer,46291279,"python,pandas",codeblock,https://stackoverflow.com/questions/46291330,"df1.b.fillna(df1.a, inplace=True)",df1.b = df1.b.fillna(df1.a),0.21,0.371
46291330,answer,46291279,"python,pandas",codeblock,https://stackoverflow.com/questions/46291330,"df1.fillna(value=dict(b=df1.a), inplace=True)","df1.loc[mask, 'b'] = df1.a",0.215,1.16
46291330,answer,46291279,"python,pandas",codeblock,https://stackoverflow.com/questions/46291330,"df1.fillna(value=dict(b=df1.a), inplace=True)","df1.loc[mask, 'b'] = df1.loc[mask, 'a']",0.215,1.15
46291330,answer,46291279,"python,pandas",codeblock,https://stackoverflow.com/questions/46291330,"df1.loc[mask, 'b'] = df1.loc[mask, 'a']","df1.loc[mask, 'b'] = df1.a",1.15,1.16
46304226,answer,46302619,"arrays,numpy,indexing,where,mask",codeblock,https://stackoverflow.com/questions/46304226,"(a==0).argmin(1)[:,None] > np.arange(a.shape[1])",a.cumsum(axis=1) == 0,32.8,69
46304226,answer,46302619,"arrays,numpy,indexing,where,mask",codeblock,https://stackoverflow.com/questions/46304226,"(a==0).argmin(1)[:,None] > np.arange(a.shape[1])","np.minimum.accumulate(a == 0, axis=1)",32.8,64.9
46304226,answer,46302619,"arrays,numpy,indexing,where,mask",codeblock,https://stackoverflow.com/questions/46304226,"np.minimum.accumulate(a == 0, axis=1)",a.cumsum(axis=1) == 0,64.9,69
46327637,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327637,"x[:, [1]]","np.atleast_2d(x[:,1]).T",0.0116,0.0142
46327637,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327637,"x[:, 1, np.newaxis]","np.atleast_2d(x[:,1]).T",0.00305,0.0142
46327637,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327637,"x[:, 1, np.newaxis]","x[:, [1]]",0.00305,0.0116
46327638,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327638,"a + x[:,i].reshape(-1,1)","a + np.atleast_2d(x[:,i]).T",68.5,68.5
46327638,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327638,"a + x[:,i].reshape(-1,1)","a + x[:, i, np.newaxis]",68.5,68.7
46327638,answer,46327603,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/46327638,"a + np.atleast_2d(x[:,i]).T","a + x[:, i, np.newaxis]",68.5,68.7
46365219,answer,46364710,"python,pandas,intervals",codeblock,https://stackoverflow.com/questions/46365219,"map(lambda x: 900 in x, idx)",idx.map(lambda x: 900 in x),0.00495,0.0487
46365219,answer,46364710,"python,pandas,intervals",codeblock,https://stackoverflow.com/questions/46365219,"map(lambda x: 900 in x, idx)",idx.map(lambda x: 900 in x),29.5,30
46365219,answer,46364710,"python,pandas,intervals",codeblock,https://stackoverflow.com/questions/46365219,"map(lambda x: 900 in x, idx)",idx.map(lambda x: 900 in x),291,299
46398660,answer,46398078,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46398660,"df.groupby(lambda i: i.strip().split('(', 1)[0]).agg(['mean', 'sum', 'max'])","df.groupby(df.index.str.strip().str.split('(', 1).str[0]).agg(['mean', 'sum', 'max'])",5.06,5.7
46402781,answer,46401827,"python,pandas,dataframe,set,frozenset",codeblock,https://stackoverflow.com/questions/46402781,"pd.Series([x[0].union(x[1]) for x in zip(tokens, tokens.shift(-1).fillna(''))], index=tokens.index)","pd.concat([tokens, tokens.shift(-1).fillna('')], axis=1).apply(lambda x: x[0].union(x[1]), axis=1)",35,2200
46402781,answer,46401827,"python,pandas,dataframe,set,frozenset",codeblock,https://stackoverflow.com/questions/46402781,"pd.Series([x[0].union(x[1]) for x in zip(tokens, tokens.shift(-1).fillna(''))], index=tokens.index)","pd.Series(map(lambda x: x[0].union(x[1]), zip(tokens, tokens.shift(-1).fillna(''))), index=tokens.index)",35,40.9
46402781,answer,46401827,"python,pandas,dataframe,set,frozenset",codeblock,https://stackoverflow.com/questions/46402781,"pd.Series(map(lambda x: x[0].union(x[1]), zip(tokens, tokens.shift(-1).fillna(''))), index=tokens.index)","pd.concat([tokens, tokens.shift(-1).fillna('')], axis=1).apply(lambda x: x[0].union(x[1]), axis=1)",40.9,2200
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.upper()!=df['ReferenceValue'].str.upper()],df[df['ConfigredValue'].str.lower()!=df['ReferenceValue'].str.lower()],0.496,0.496
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.title()!=df['ReferenceValue'].str.title()],df[df['ConfigredValue'].str.lower()!=df['ReferenceValue'].str.lower()],0.495,0.496
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.len()!=df['ReferenceValue'].str.len()],df[df['ConfigredValue'].str.title()!=df['ReferenceValue'].str.title()],0.479,0.495
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.len()!=df['ReferenceValue'].str.len()],df[df['ConfigredValue'].str.upper()!=df['ReferenceValue'].str.upper()],0.479,0.496
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.title()!=df['ReferenceValue'].str.title()],df[df['ConfigredValue'].str.upper()!=df['ReferenceValue'].str.upper()],0.495,0.496
46409799,answer,46409630,"python,pandas",codeblock,https://stackoverflow.com/questions/46409799,df[df['ConfigredValue'].str.len()!=df['ReferenceValue'].str.len()],df[df['ConfigredValue'].str.lower()!=df['ReferenceValue'].str.lower()],0.479,0.496
46420943,answer,46419180,"python,pandas",sentence,use transform - faster than apply and lookup,transform,apply,,
46422847,answer,46422664,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46422847,"np.arange(4)[pd.Series([1, 2, 3]).values]","np.arange(4)[pd.Series([1, 2, 3])]",0.0611,0.111
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,(df.index == 0).cumsum(),df.index.to_series().eq(0).cumsum(),0.328,0.805
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,df.index.to_series().eq(0).cumsum(),(df.index.to_series().diff().fillna(1) < 0).cumsum(),0.42,0.623
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,(df.index == 0).cumsum(),df.index.to_series().eq(0).cumsum(),0.118,0.42
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,(df.index == 0).cumsum(),(df.index.to_series().diff().fillna(1) < 0).cumsum(),0.328,1.42
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,df.index.to_series().eq(0).cumsum(),(df.index.to_series().diff().fillna(1) < 0).cumsum(),0.805,1.42
46449794,answer,46449721,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46449794,(df.index == 0).cumsum(),(df.index.to_series().diff().fillna(1) < 0).cumsum(),0.118,0.623
46454376,answer,46454170,"python,random,boost,scipy",codeblock,https://stackoverflow.com/questions/46454376,"np.random.randint(0, 1000, 60000)","scipy.stats.randint(0,1000).rvs(60000)",0.202,59.6
46465090,answer,46464718,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/46465090,"(df.groupby('id')['store'].agg(['count',  'nunique', lambda x: (~x.duplicated(keep=False)).sum()]))","(df.groupby('id').store.agg(['count', 'nunique', lambda x: x.drop_duplicates(keep=False).size]))",4470,11000
46473702,answer,46473530,"python,pandas,nan",codeblock,https://stackoverflow.com/questions/46473702,"pd.DataFrame(np.log(df.values), df.index, df.columns)",np.log(df),0.107,0.134
46473702,answer,46473530,"python,pandas,nan",codeblock,https://stackoverflow.com/questions/46473702,np.log(df),df.applymap(np.log),0.134,0.835
46473702,answer,46473530,"python,pandas,nan",codeblock,https://stackoverflow.com/questions/46473702,"pd.DataFrame(np.log(df.values), df.index, df.columns)",df.applymap(np.log),0.107,0.835
46479754,answer,46479613,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/46479754,"df.loc[(df['amount'] >= 200000) & (df['months'] < 36), 'months'] = 36","df.assign(months=df.months.mask(df.amount.ge(2E5), np.maximum(df.months, 36)))",0.838,1.01
46486784,answer,46486271,"python,pandas,iterator,nested-loops",codeblock,https://stackoverflow.com/questions/46486784,"np.tile(df.columns, df.shape[0])[~np.isnan(df.values.ravel())]",df.stack().index.get_level_values(1),5.98,11.7
46486784,answer,46486271,"python,pandas,iterator,nested-loops",codeblock,https://stackoverflow.com/questions/46486784,"np.tile(df.columns, df.shape[0])[~np.isnan(df.values.ravel())]",df.stack().index.get_level_values(1),0.0358,0.335
46503418,answer,46503370,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46503418,"(df[df.groupby(['C', 'D'])['A'].transform(lambda x: set(x) == set(['foo']))])","(df.groupby(['C', 'D']).filter(lambda x: (x['A'] == 'foo').all()))",2540,6210
46512915,answer,46512598,"numpy,optimization,addition,absolute-value",codeblock,https://stackoverflow.com/questions/46512915,"np.abs(a, out=a)",np.abs(a),939.295,3565.49
46512930,answer,46512892,"python,arrays,numpy,reshape",codeblock,https://stackoverflow.com/questions/46512930,"df.values.reshape(2,-1,df.shape[1]).swapaxes(0,1)","np.stack(np.split(df.values, 2), axis=1)",0.00837,4.3
46512930,answer,46512892,"python,arrays,numpy,reshape",codeblock,https://stackoverflow.com/questions/46512930,"df.values.reshape(2,-1,df.shape[1]).swapaxes(0,1)","np.stack(np.split(df.values, 2), axis=1)",0.00855,0.109
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,mod(df),"df.apply(f3, axis=1)",8.37,1700
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,mod(df),"df.apply(f2, axis=1)",8.37,1660
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,"df.apply(f2, axis=1)","df.apply(f1, axis=1)",1660,1780
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,"df.apply(f3, axis=1)","df.apply(f1, axis=1)",1700,1780
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,"df.apply(f2, axis=1)","df.apply(f3, axis=1)",1660,1700
46538262,answer,46538103,"python,pandas",codeblock,https://stackoverflow.com/questions/46538262,mod(df),"df.apply(f1, axis=1)",8.37,1780
46540628,answer,46539615,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/46540628,"df['ID2'] = np.unique(df.N, return_inverse=1)[1]",df['ID1'] = df['N'].rank(method='dense').sub(1).astype(int),3.94,4.74
46547229,answer,46547168,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46547229,"df['SleepQualityGroup'] = np.digitize(df.SleepQuality, bins)",df['SleepQualityGroup'] = bins.searchsorted(df.SleepQuality),0.538,0.591
46547229,answer,46547168,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46547229,"df['SleepQualityGroup'] = np.digitize(df.SleepQuality, bins)","df['new'] = pd.cut(df['SleepQuality'],bins=[0,50 , 60, 70 , 80 , 90,100], labels=[0,1,2,3,4,5])",0.538,1.04
46547229,answer,46547168,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46547229,df['SleepQualityGroup'] = bins.searchsorted(df.SleepQuality),"df['new'] = pd.cut(df['SleepQuality'],bins=[0,50 , 60, 70 , 80 , 90,100], labels=[0,1,2,3,4,5])",0.591,1.04
46558133,answer,46558114,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46558133,"np.maximum(array1, array2)","np.where( array1 > array2, array1, array2)",1.25,5.15
46558133,answer,46558114,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46558133,"np.maximum(array1, array2)","np.max([array1, array2],axis=0)",1.25,3.31
46558133,answer,46558114,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46558133,"np.max([array1, array2],axis=0)","np.where( array1 > array2, array1, array2)",3.31,5.15
46558467,answer,46558371,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/46558467,"df.groupby(['cId', 'eId']).filter(lambda x: x['code'].isin(['af', 'da']).any())","df[df.groupby(['cId', 'eId'])['code'].transform(lambda x: x.isin(['af', 'da']).any())]",4010,4050
46558467,answer,46558371,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/46558467,"df.loc[df['code'].isin(['af', 'da']), ['cId','eId']].drop_duplicates().merge(df)","df[df.groupby(['cId', 'eId'])['code'].transform(lambda x: x.isin(['af', 'da']).any())]",15.9,4050
46558467,answer,46558371,"python,pandas,subset",codeblock,https://stackoverflow.com/questions/46558467,"df.loc[df['code'].isin(['af', 'da']), ['cId','eId']].drop_duplicates().merge(df)","df.groupby(['cId', 'eId']).filter(lambda x: x['code'].isin(['af', 'da']).any())",15.9,4010
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[[""Bin1"",""Bin2""]].values.T.flatten().tolist()","df[['Bin1', 'Bin3']].unstack().values.tolist()",6.91,9.32
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[['Bin1', 'Bin3']].values.ravel(order='A').tolist()","df[[""Bin1"",""Bin2""]].values.T.flatten().tolist()",5.86,6.91
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[['Bin1', 'Bin3']].values.ravel(order='A').tolist()","df[['Bin1', 'Bin3']].unstack().values.tolist()",5.86,9.32
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[['Bin1', 'Bin3']].unstack().values.tolist()","[it for subl in df[[""Bin1"",""Bin3""]].values.T.tolist() for it in subl]",9.32,20.3
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].values.tolist() + df['Bin3'].values.tolist(),df['Bin1'].tolist() + df['Bin3'].tolist(),2.95,4.87
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].values.tolist() + df['Bin3'].values.tolist(),"df[['Bin1', 'Bin3']].values.ravel(order='A').tolist()",2.95,5.86
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].values.tolist() + df['Bin3'].values.tolist(),"df[['Bin1', 'Bin3']].unstack().values.tolist()",2.95,9.32
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[[""Bin1"",""Bin2""]].values.T.flatten().tolist()","[it for subl in df[[""Bin1"",""Bin3""]].values.T.tolist() for it in subl]",6.91,20.3
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].values.tolist() + df['Bin3'].values.tolist(),"[it for subl in df[[""Bin1"",""Bin3""]].values.T.tolist() for it in subl]",2.95,20.3
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].tolist() + df['Bin3'].tolist(),"df[['Bin1', 'Bin3']].values.ravel(order='A').tolist()",4.87,5.86
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].tolist() + df['Bin3'].tolist(),"df[['Bin1', 'Bin3']].unstack().values.tolist()",4.87,9.32
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].values.tolist() + df['Bin3'].values.tolist(),"df[[""Bin1"",""Bin2""]].values.T.flatten().tolist()",2.95,6.91
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,"df[['Bin1', 'Bin3']].values.ravel(order='A').tolist()","[it for subl in df[[""Bin1"",""Bin3""]].values.T.tolist() for it in subl]",5.86,20.3
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].tolist() + df['Bin3'].tolist(),"[it for subl in df[[""Bin1"",""Bin3""]].values.T.tolist() for it in subl]",4.87,20.3
46585826,answer,46585640,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46585826,df['Bin1'].tolist() + df['Bin3'].tolist(),"df[[""Bin1"",""Bin2""]].values.T.flatten().tolist()",4.87,6.91
46588007,answer,46587971,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46588007,"ndf.groupby('epoch').apply(lambda x: dict(zip(x['x'], x['y'])))","ndf.groupby('epoch')[['x', 'y']].apply(lambda x: dict(x.values))",3.65,14.9
46588007,answer,46587971,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46588007,"ndf.groupby('epoch')[['x', 'y']].apply(lambda x: dict(x.values))","ndf.groupby('epoch').apply(lambda x: dict(x[['x', 'y']].values))",14.9,15.3
46588007,answer,46587971,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/46588007,"ndf.groupby('epoch').apply(lambda x: dict(zip(x['x'], x['y'])))","ndf.groupby('epoch').apply(lambda x: dict(x[['x', 'y']].values))",3.65,15.3
46654903,answer,46654734,"pandas,datetime,dataframe,merge,datetimeindex",codeblock,https://stackoverflow.com/questions/46654903,df_1.reindex(idx).assign(value_2=idx.floor('D').map(df_2.value_2.get)),"df_1.join(df_2.loc[idx.date].set_index(idx), how='outer')",1.56,2.38
46668028,answer,46667947,"python,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46668028,"[x for i, x in df.groupby(level=0, sort=False)]",[df.loc[x] for x in df.index],9.91,417
46668657,answer,46668374,"python,numpy",codeblock,https://stackoverflow.com/questions/46668657,A.T.dot(B.T).T,B.dot(A.A),0.102,0.119
46671163,answer,46670183,"python,performance,pandas,dataframe,pandas-groupby",codeblock,https://stackoverflow.com/questions/46671163,"list_df_2 = [x for i, x in df.groupby(level=0, sort=False)]",list_df_1 = [df.loc[x] for x in index],54.8,13600
46678184,answer,46678109,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46678184,"np.where(df.A == 1, 1, np.where(df.B == -1, -1, 0))","np.select([df.A == 1, df.B == -1], [1, -1])",2.86,5.25
46684122,answer,46684055,"python,pandas,dataframe,lambda",codeblock,https://stackoverflow.com/questions/46684122,"df['Age1'] = np.where((df['Group'] >= 14) & (df['Group'] <= 20) | (df['Group'] >= 34) & (df['Group'] <= 40), '65+','65-')",df['Age2'] = df['Group'].apply(lambda x: '65+' if ((x >= 14 and x <= 20) or (x >= 34 and x <= 40)) else '65-'),123,253
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.array([[i for item in w for i in item] for w in mit.windowed(a, n=3)])","np.hstack((a[:-2], a[1:-1], a[2:]))",0.0212,0.0375
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.array([list(mit.flatten(w)) for w in mit.windowed(a, n=3)])","np.hstack((a[:-2], a[1:-1], a[2:]))",0.0232,0.0375
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.array([[i for item in w for i in item] for w in mit.windowed(a, n=3)])","np.array(list(mit.windowed(b.ravel(), n=6)))",0.0212,0.0434
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.array([list(mit.flatten(w)) for w in mit.windowed(a, n=3)])","np.array(list(mit.windowed(b.ravel(), n=6)))",0.0232,0.0434
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.array([[i for item in w for i in item] for w in mit.windowed(a, n=3)])","np.array([list(mit.flatten(w)) for w in mit.windowed(a, n=3)])",0.0212,0.0232
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.hstack((b[:-2], b[1:-1], b[2:]))","np.hstack((a[:-2], a[1:-1], a[2:]))",0.0129,0.0375
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.hstack((b[:-2], b[1:-1], b[2:]))","np.array([[i for item in w for i in item] for w in mit.windowed(a, n=3)])",0.0129,0.0212
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.hstack((b[:-2], b[1:-1], b[2:]))","np.array([list(mit.flatten(w)) for w in mit.windowed(a, n=3)])",0.0129,0.0232
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.hstack((a[:-2], a[1:-1], a[2:]))","np.array(list(mit.windowed(b.ravel(), n=6)))",0.0375,0.0434
46699659,answer,15722324,"python,numpy,time-series,sliding-window",codeblock,https://stackoverflow.com/questions/46699659,"np.hstack((b[:-2], b[1:-1], b[2:]))","np.array(list(mit.windowed(b.ravel(), n=6)))",0.0129,0.0434
46704581,answer,40924332,"python,python-2.7,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46704581,pd.DataFrame(df[0].values.tolist()),df[0].apply(pd.Series),15,4060
46704581,answer,40924332,"python,python-2.7,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46704581,pd.DataFrame(df[0].values.tolist()),df[0].apply(pd.Series),161,40900
46713447,answer,23410083,"python,pandas",codeblock,https://stackoverflow.com/questions/46713447,pd.Series(df.values.ravel('F')),df['Column 1'].append(df['Column 2']).reset_index(drop=True),0.0862,0.816
46713447,answer,23410083,"python,pandas",codeblock,https://stackoverflow.com/questions/46713447,pd.Series(df.values.ravel('F')),df['Column 1'].append(df['Column 2']).reset_index(drop=True),0.0875,1.72
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,"np.intersect1d(df.columns, lst)",df.columns.intersection(lst),0.0266,0.236
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,[c for c in df.columns if c in lst],df.columns & lst,0.00254,0.231
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,[c for c in df.columns if c in lst],df.columns.intersection(lst),0.00254,0.236
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,[c for c in df.columns if c in lst],"np.intersect1d(df.columns, lst)",0.00254,0.0266
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,"np.intersect1d(df.columns, lst)",df.columns & lst,0.0266,0.231
46722054,answer,40636514,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46722054,df.columns & lst,df.columns.intersection(lst),0.231,0.236
46737480,answer,46737323,"python,pandas,pandas-groupby,cumsum",codeblock,https://stackoverflow.com/questions/46737480,df.gt(25).apply(max_consecutive),(df>25).apply(lambda x :x.groupby(x.diff().ne(0).cumsum()).cumcount()+1).mask(df<25).max(0),0.52,10.3
46738059,answer,46737323,"python,pandas,pandas-groupby,cumsum",codeblock,https://stackoverflow.com/questions/46738059,"pd.Series(max_island_len_cols(df.values>25), index=df.columns)",(df>25).apply(lambda x :x.groupby(x.diff().ne(0).cumsum()).cumcount()+1).mask(df<25).max(0),0.539,95.2
46738059,answer,46737323,"python,pandas,pandas-groupby,cumsum",codeblock,https://stackoverflow.com/questions/46738059,df.gt(25).apply(max_consecutive),(df>25).apply(lambda x :x.groupby(x.diff().ne(0).cumsum()).cumcount()+1).mask(df<25).max(0),1.81,95.2
46738059,answer,46737323,"python,pandas,pandas-groupby,cumsum",codeblock,https://stackoverflow.com/questions/46738059,"pd.Series(max_island_len_cols(df.values>25), index=df.columns)",df.gt(25).apply(max_consecutive),0.539,1.81
46739415,answer,46739385,"python,numpy",codeblock,https://stackoverflow.com/questions/46739415,"np.count_nonzero(a[:,1] & a[:,2])","np.sum(a[:,1] & a[:,2])",0.00201,0.00425
46741245,answer,37483470,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46741245,df['fruits'].str.count(' ').add(1).value_counts(sort=False),df['fruits'].str.split().apply(len).value_counts(),57.6,73.8
46741245,answer,37483470,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46741245,df['fruits'].str.count(' ').add(1).value_counts(sort=False),df['fruits'].str.split().apply(len).value_counts(),0.649,0.84
46741245,answer,37483470,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46741245,df['fruits'].str.count(' ').add(1).value_counts(sort=False),df['fruits'].str.split().apply(len).value_counts(),6.58,6.99
46745764,answer,46745617,"python,numpy,sparse-matrix",codeblock,https://stackoverflow.com/questions/46745764,X_sparse.T.multiply(b),X.T * b,0.374,44.5
46756408,answer,41680089,"python,pandas",codeblock,https://stackoverflow.com/questions/46756408,"df['D'].fillna(df.groupby(['A','B','C'])['D'].transform('mean'))","df.groupby(['A','B','C'])['D'].apply(lambda x: x.fillna(x.mean()))",3.44,5.34
46756408,answer,41680089,"python,pandas",sentence,"df['D'].fillna(df.groupby(['A','B','C'])['D'].transform('mean')) would be faster than apply","df['D'].fillna(df.groupby(['A','B','C'])['D'].transform('mean'))",apply,,
46759591,answer,46759464,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/46759591,df.apply(pd.value_counts).sum(axis=1),df.melt().value.value_counts(),2140,2500
46759949,answer,46759464,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/46759949,df.melt().value.value_counts(),df.apply(pd.value_counts).sum(),1.43,18.5
46760944,answer,46760717,"python,arrays,numpy,generator,itertools",codeblock,https://stackoverflow.com/questions/46760944,"A=np.mgrid[[slice(1,7)]*n].reshape(n,-1).T","B=np.array(list(product(range(1,7),repeat=7)))",13.9,317
46773513,answer,40938810,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/46773513,pd.DataFrame({k: 1 for k in x} for x in df.col2).fillna(0).astype(int),df['col2'].str.join('@').str.get_dummies('@'),137,395
46777067,answer,46776588,"python,windows,pandas,csv,multiprocessing",codeblock,https://stackoverflow.com/questions/46777067,"pd.to_datetime(df.StartDate, format=""%m-%d-%y %H:%M:%S"")",pd.to_datetime(df.StartDate),0.106,0.866
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,(pd.get_dummies(df.drop_duplicates().set_index('ID')).sum(level=0)),"(pd.crosstab(df.ID,df.Feature).gt(0).astype(int).add_prefix('FEATURE '))",47,383
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,(pd.get_dummies(df.drop_duplicates().set_index('ID')).sum(level=0)),(df.set_index('ID')['Feature'].str.get_dummies().add_prefix('FEATURE_').max(level=0)),47,1030
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,"(pd.crosstab(df.ID,df.Feature).gt(0).astype(int).add_prefix('FEATURE '))",(df.set_index('ID')['Feature'].str.get_dummies().add_prefix('FEATURE_').max(level=0)),383,1030
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,(df[['ID']].join(pd.get_dummies(df['Feature']).add_prefix('FEATURE_')).groupby('ID').max()),(pd.get_dummies(df.drop_duplicates().set_index('ID')).sum(level=0)),39.3,47
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,(df[['ID']].join(pd.get_dummies(df['Feature']).add_prefix('FEATURE_')).groupby('ID').max()),"(pd.crosstab(df.ID,df.Feature).gt(0).astype(int).add_prefix('FEATURE '))",39.3,383
46791675,answer,46791626,"python,pandas,encoding",codeblock,https://stackoverflow.com/questions/46791675,(df[['ID']].join(pd.get_dummies(df['Feature']).add_prefix('FEATURE_')).groupby('ID').max()),(df.set_index('ID')['Feature'].str.get_dummies().add_prefix('FEATURE_').max(level=0)),39.3,1030
46796181,answer,46796117,"python,arrays,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/46796181,bool_arr.astype(np.uint8),bool_arr.astype(int),0.000897,0.00415
46796181,answer,46796117,"python,arrays,numpy,matrix,vectorization",codeblock,https://stackoverflow.com/questions/46796181,bool_arr.astype(np.uint8),bool_arr.astype(int),3.16,21
46817077,answer,46816226,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46817077,"pd.Series(df.values[ind, np.arange(len(ind))], df.columns)","pd.Series(df.lookup(ind, df.columns), index=df.columns)",0.41,0.718
46817077,answer,46816226,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/46817077,"pd.Series(df.values[ind, np.arange(len(ind))], df.columns)","pd.Series(df.lookup(ind, df.columns), index=df.columns)",5.76,8.83
46837904,answer,32109319,"python,numpy,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/46837904,x[x<0] =0,"np.maximum(x, 0,x)",20.3,38.5
46837904,answer,32109319,"python,numpy,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/46837904,"np.maximum(x, 0,x)","np.maximum(x, 0)",38.5,241
46837904,answer,32109319,"python,numpy,machine-learning,neural-network",codeblock,https://stackoverflow.com/questions/46837904,x[x<0] =0,"np.maximum(x, 0)",20.3,241
46872361,answer,46872223,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/46872361,df[df.groupby(pd.to_datetime(df['datetime_event']).dt.floor('H')).cumcount() < 3],df.groupby(pd.to_datetime(df['datetime_event']).dt.floor('H')).head(3),15.8,15.8
46872361,answer,46872223,"python,python-2.7,pandas",codeblock,https://stackoverflow.com/questions/46872361,df.groupby(pd.to_datetime(df['datetime_event']).dt.floor('H')).head(3),df[df.groupby(pd.to_datetime(df['datetime_event']).dt.floor('H')).cumcount() < 3],14.1,14.5
46901126,answer,46900659,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46901126,"df.stack().groupby(level=0).apply(','.join)","df.apply(lambda x: ', '.join(x.dropna()), 1).replace('', np.nan)",1.41,1.6
46901126,answer,46900659,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46901126,"df.stack().groupby(level=0).apply(','.join)","df.apply(lambda x: ', '.join(x.dropna()), 1).replace('', np.nan)",1230,2100
46913321,answer,46913228,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46913321,"df[~df['customer'].isin(df.loc[df['day'] > '2017-01-01', 'customer'])]","df[~df['customer'].isin(df.loc[df['day'] > '2017-01-01', 'customer'].unique())]",0.932,0.987
46913321,answer,46913228,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46913321,df.groupby('customer').filter(lambda x: ~(x.day>'2017/1/1').any()),df.groupby('customer').filter(lambda x: x.day.le('2017/1/1').all()),397,432
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,x[(np.random.rand(len(x))*len(x)).astype(int)],"x[np.random.randint(0,len(x),len(x))]",9.81,12.5
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,"x[(np.random.rand(1000,len(x))*len(x)).astype(int)]","[np.random.choice(x, size=len(x), replace=True) for i in range(1000)]",59.7,84
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,"x[np.random.randint(0,len(x),len(x))]","np.random.choice(x, size=len(x), replace=True)",12.5,13
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,"x[(np.random.rand(1000,len(x))*len(x)).astype(int)]","x[np.random.randint(0,len(x),size=(1000,len(x)))]",59.7,76.2
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,x[(np.random.rand(len(x))*len(x)).astype(int)],"np.random.choice(x, size=len(x), replace=True)",9.81,13
46916804,answer,46916667,"python,numpy,optimization,statistics,list-comprehension",codeblock,https://stackoverflow.com/questions/46916804,"x[np.random.randint(0,len(x),size=(1000,len(x)))]","[np.random.choice(x, size=len(x), replace=True) for i in range(1000)]",76.2,84
46923414,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/46923414,df['Year'].values.astype(str) + df.quarter,df['Year'].astype(str) + df['quarter'],71.1,565
46923783,answer,46923717,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/46923783,"np.unravel_index((a==50).argmax(), a.shape)",np.argwhere(a==50)[0],0.493,2.41
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,"df.mask(df < 0, 0)",(df[df > 0].fillna(0)),5.18,7.05
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,(df.clip_lower(0)),"df.mask(df < 0, 0)",1.96,5.18
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,(df.clip_lower(0)),(df[df > 0].fillna(0)),1.96,7.05
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,(df.clip_lower(0)),"(df.applymap(lambda x: max(0.0, x)))",1.96,164
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,(df[df > 0].fillna(0)),"(df.applymap(lambda x: max(0.0, x)))",7.05,164
46970958,answer,46970671,"python,pandas,loops,loc",codeblock,https://stackoverflow.com/questions/46970958,"df.mask(df < 0, 0)","(df.applymap(lambda x: max(0.0, x)))",5.18,164
46992442,answer,46991735,"python,arrays,numpy,mesh",sentence,possibly simpler (and repeat is faster than tile):,repeat,tile,,
46996377,answer,46996365,"python,pandas,dataframe,data-analysis",codeblock,https://stackoverflow.com/questions/46996377,"df.Name.str.split(',', expand=True).stack().value_counts()","df.Name.str.get_dummies(',').sum()",1.02,1.18
46996377,answer,46996365,"python,pandas,dataframe,data-analysis",codeblock,https://stackoverflow.com/questions/46996377,"pd.value_counts(pd.np.concatenate(df.Name.str.split(',')))","df.Name.str.split(',', expand=True).stack().value_counts()",0.573,1.02
46996377,answer,46996365,"python,pandas,dataframe,data-analysis",codeblock,https://stackoverflow.com/questions/46996377,"pd.value_counts(pd.np.concatenate(df.Name.str.split(',')))","df.Name.str.get_dummies(',').sum()",0.573,1.18
46996377,answer,46996365,"python,pandas,dataframe,data-analysis",codeblock,https://stackoverflow.com/questions/46996377,"pd.value_counts(df.Name.str.cat(sep=',').split(','))","pd.Series(Counter((df['Name'].str.strip() + ',').sum().rstrip(',').split(',')))",0.483,0.498
47004782,answer,47004066,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47004782,"pd.concat([df, df.A.str.extract(r'(?=\d+H|\d+M)(?:(?P<H>\d+)H)?(?:(?P<M>\d+)M)?', expand=False).fillna(0)], axis=1)","df.assign(H=df.A.str.extract('([\d]+)H', expand=False), M=df.A.str.extract('([\d]+)M', expand=False)).fillna(0)",83.9,130
47006746,answer,47006652,"python,image,numpy,opencv",codeblock,https://stackoverflow.com/questions/47006746,"images[...,::-1,:].copy()",np.array([np.fliplr(images[i]) for i in range(3)]),0.00223,0.00576
47006746,answer,47006652,"python,image,numpy,opencv",codeblock,https://stackoverflow.com/questions/47006746,"images[...,::-1,:].copy()",np.array([np.fliplr(images[i]) for i in range(3)]),0.152,0.159
47023580,answer,47023541,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/47023580,"df.groupby(['col_a', 'col_b']).ngroups","df[['col_a', 'col_b']].drop_duplicates().shape[0]",0.625,1.01
47023822,answer,47022825,"python,pandas",codeblock,https://stackoverflow.com/questions/47023822,df['a'].map( mapDict ).fillna( 'NoKeyValue' ),"df['a'].apply( lambda r : mapDict.get( r , 'NoKeyValue' )  )",9.65,21.7
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].dt.date,df['result_date'].apply(lambda x: x.date()),474,559
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df.groupby(df['result_date'].dt.floor('D')).size(),df.groupby(df['result_date'].dt.normalize()).size(),25.9,40.2
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df.groupby(df['result_date'].dt.floor('D')).size(),df.groupby(df['result_date'].dt.date).size(),25.9,883
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].dt.date,df['result_date'].apply(lambda x: str(x.date())),474,740
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df.groupby(df['result_date'].dt.normalize()).size(),df.groupby(df['result_date'].dt.date).size(),40.2,883
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].apply(lambda x: x.date()),df['result_date'].apply(lambda x: str(x.date())),559,740
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].dt.normalize(),df['result_date'].dt.date,27.8,854
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].dt.floor('D'),df['result_date'].dt.date,13.1,854
47034240,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47034240,df['result_date'].dt.floor('D'),df['result_date'].dt.normalize(),13.1,27.8
47039287,answer,47039231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47039287,df['Total'] / df.groupby('Member')['Total'].transform('sum'),df.groupby('Member').Total.apply(lambda x : x/sum(x)),5.11,31.2
47039287,answer,47039231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47039287,df['Total'] / df['Member'].map(df.groupby('Member')['Total'].sum()),df.groupby('Member').Total.apply(lambda x : x/sum(x)),9.92,31.2
47039287,answer,47039231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47039287,df['Total'] / df.groupby('Member')['Total'].transform('sum'),df['Total'] / df['Member'].map(df.groupby('Member')['Total'].sum()),5.11,9.92
47046766,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47046766,df['result_date'].dt.normalize(),df['result_date'].dt.date,16.3,482
47046766,answer,47034229,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47046766,df.groupby(df['result_date'].dt.normalize()).size(),df.groupby(df['result_date'].dt.date).size(),24.2,506
47075008,answer,47074958,"python,pandas",codeblock,https://stackoverflow.com/questions/47075008,"df['new1'] = np.where(df['a'].str.contains('foo') & (df['b'] == 'bar'), 'yes', 'no')","df['new'] = df.apply(somefunction, axis=1)",3.25,60.7
47075008,answer,47074958,"python,pandas",codeblock,https://stackoverflow.com/questions/47075008,"df['new1'] = np.where(df['a'].str.contains('foo') & (df['b'] == 'bar'), 'yes', 'no')","df['new'] = df.apply(somefunction, axis=1)",23.5,614
47075690,answer,47074894,"python,performance,pandas,linear-regression,correlation",codeblock,https://stackoverflow.com/questions/47075690,"pd.Series(corr2_coeff_rowwise(dfa.values,dfb.values))","dfb.corrwith(dfa.iloc[0], axis=1)",1.53,4090
47075690,answer,47074894,"python,performance,pandas,linear-regression,correlation",codeblock,https://stackoverflow.com/questions/47075690,"pd.Series(corr2_coeff_rowwise(dfa.values,dfb.values))","dfb.corrwith(dfa.iloc[0], axis=1)",0.635,44.8
47080806,answer,47080410,"python,numpy,one-hot-encoding",codeblock,https://stackoverflow.com/questions/47080806,"np.array([c for c in itertools.product(a, repeat=2)])","np.array(list(itertools.product(a,a)))",0.966,0.967
47080806,answer,47080410,"python,numpy,one-hot-encoding",codeblock,https://stackoverflow.com/questions/47080806,"np.array(list(itertools.product(a,a)))","np.array([c for c in itertools.product(a, repeat=2)])",98.1,98.6
47080806,answer,47080410,"python,numpy,one-hot-encoding",codeblock,https://stackoverflow.com/questions/47080806,"np.array(list(itertools.product(a,a)))","np.array([c for c in itertools.product(a, repeat=2)])",0.0278,0.0294
47086085,answer,12307099,"python,pandas",codeblock,https://stackoverflow.com/questions/47086085,"df['b'] = np.where(df.a.values == 0, np.nan, df.b.values)","df.loc[df['a'] == 0, 'b'] = np.nan",0.685,3.11
47118796,answer,47118756,"python,pandas,dataframe,count,row",codeblock,https://stackoverflow.com/questions/47118796,df[df.groupby(['A'])['A'].transform('size') > 1000],df.groupby('A').filter(lambda x: len(x) > 1000),101,330
47118796,answer,47118756,"python,pandas,dataframe,count,row",codeblock,https://stackoverflow.com/questions/47118796,"df[df.groupby(['v1', 'v2'])['v2'].transform('size') == 6]","df.groupby(['v1', 'v2']).filter(lambda x: len(x) == 6)",176,12100
47118796,answer,47118756,"python,pandas,dataframe,count,row",codeblock,https://stackoverflow.com/questions/47118796,"df[df.groupby(['v1', 'v2']).v2.transform('count').eq(6)]","df.groupby(['v1', 'v2']).filter(lambda x: len(x) == 6)",175,12100
47118796,answer,47118756,"python,pandas,dataframe,count,row",codeblock,https://stackoverflow.com/questions/47118796,"df[df.groupby(['v1', 'v2']).v2.transform('count').eq(6)]","df[df.groupby(['v1', 'v2'])['v2'].transform('size') == 6]",175,176
47119991,answer,47119965,"python,pandas,text-mining",codeblock,https://stackoverflow.com/questions/47119991,df['matches'] = df.text_data.str.split(r'[^\w]+').apply(lambda x: list(s.intersection(x))),df['new'] = df['text_data'].apply(lambda x :  list(set([i for i in nltk.word_tokenize(x) if i in Techlist]))),165,3730
47119991,answer,47119965,"python,pandas,text-mining",codeblock,https://stackoverflow.com/questions/47119991,"df['tech_match'] = df['text_data'].str.findall('|'.join([r""\b{word}\b"".format(word=word) for word in Techlist])).apply(lambda x: list(set(x)))",df['matches'] = df.text_data.str.split(r'[^\w]+').apply(lambda x: list(s.intersection(x))),74.7,165
47119991,answer,47119965,"python,pandas,text-mining",codeblock,https://stackoverflow.com/questions/47119991,"df['tech_match'] = df['text_data'].str.findall('|'.join([r""\b{word}\b"".format(word=word) for word in Techlist])).apply(lambda x: list(set(x)))",df['new'] = df['text_data'].apply(lambda x :  list(set([i for i in nltk.word_tokenize(x) if i in Techlist]))),74.7,3730
47124032,answer,47124007,"python,pandas,numpy,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47124032,"pd.concat([df,pd.get_dummies(df.astype(str).stack()).sum(level=0).add_prefix('Sum')],1)","df.apply(lambda x : x.value_counts(),1).fillna(0)",2210,95000
47124032,answer,47124007,"python,pandas,numpy,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47124032,"df.join(pd.DataFrame({'Sum{}'.format(v):(df.values == v).sum(1) for v in [0, 1, -1]}))",df.join(pd.DataFrame({'Sum{}'.format(v):(df.values == v).sum(1) for v in np.unique(df.values)})),12.8,23.8
47124032,answer,47124007,"python,pandas,numpy,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47124032,"df.join(pd.DataFrame({'Sum{}'.format(v):df.eq(v).sum(1) for v in [1, 0, -1]}))","df.assign(**{'Sum{}'.format(v):df.eq(v).sum(1) for v in [1, 0, -1]})",39.6,39.8
47131550,answer,47131517,"python,regex,pandas,dataframe,slice",codeblock,https://stackoverflow.com/questions/47131550,df[df['Process Parameter'].str.split().apply(set) & set(keys)],"df[(find(df['Process Parameter'].values.astype(str)[:, None], keys) >= 0).any(1)]",401,487
47131550,answer,47131517,"python,regex,pandas,dataframe,slice",codeblock,https://stackoverflow.com/questions/47131550,df[df['Process Parameter'].str.findall('|'.join(keys)).astype(bool)],df[df['Process Parameter'].str.split(expand=True).isin(keys).any(1)],177,527
47131550,answer,47131517,"python,regex,pandas,dataframe,slice",codeblock,https://stackoverflow.com/questions/47131550,df[df['Process Parameter'].str.contains('|'.join(keys))],"df[df['Process Parameter'].str.extract('('+'|'.join(keys)+')',expand=False).notnull()]",140,247
47142267,answer,17690738,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/47142267,pd.Series(pd.to_datetime(dates)),"pd.Series(dates, dtype='datetime64[ns]')",426,730
47142267,answer,17690738,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/47142267,pd.Series(pd.to_datetime(dates)),pd.to_datetime(pd.Series(dates)),426,430
47142267,answer,17690738,"python,datetime,pandas",codeblock,https://stackoverflow.com/questions/47142267,pd.to_datetime(pd.Series(dates)),"pd.Series(dates, dtype='datetime64[ns]')",430,730
47153661,answer,7837722,"python,performance,for-loop,pandas",sentence,"as @joris pointed out, iterrows is much slower than itertuples and itertuples is approximately 100 times fater than iterrows, and i tested speed of both methods in a dataframe with 5027505 records the result is for iterrows, it is 1200it/s, and itertuples is 120000it/s.",itertuples,iterrows,,
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,"pd.DataFrame(np.column_stack([s] * len(df.columns)), columns=df.columns, index=df.index)",pd.DataFrame({k : s for k in df.columns}),1,2.33
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,"pd.DataFrame(np.repeat(s.values,len(df.columns)).reshape(-1,len(df.columns)), columns=df.columns, index=df.index)",pd.DataFrame({k : s for k in df.columns}),0.199,2.33
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,"pd.DataFrame(np.repeat(s.values,len(df.columns)).reshape(-1,len(df.columns)), columns=df.columns, index=df.index)","pd.DataFrame(np.column_stack([s] * len(df.columns)), columns=df.columns, index=df.index)",0.199,1
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,pd.DataFrame({k : s for k in df.columns}),"pd.concat([s] * len(df.columns), 1, keys=df.columns)",2.33,2.84
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,"pd.DataFrame(np.column_stack([s] * len(df.columns)), columns=df.columns, index=df.index)","pd.concat([s] * len(df.columns), 1, keys=df.columns)",1,2.84
47154790,answer,47154691,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/47154790,"pd.DataFrame(np.repeat(s.values,len(df.columns)).reshape(-1,len(df.columns)), columns=df.columns, index=df.index)","pd.concat([s] * len(df.columns), 1, keys=df.columns)",0.199,2.84
47157646,answer,47157613,"python,list,pandas,dataframe,flatten",codeblock,https://stackoverflow.com/questions/47157646,"pd.DataFrame(df.iloc[:, 0].tolist(), index=df.index).stack().reset_index(level=1, drop=1).to_frame().astype(int)","pd.DataFrame({0:list(chain.from_iterable(df[0].values.tolist()))}, index=df.index.repeat(df[0].str.len()))",384,388
47157646,answer,47157613,"python,list,pandas,dataframe,flatten",codeblock,https://stackoverflow.com/questions/47157646,"pd.DataFrame({0:np.concatenate(df.iloc[:, 0].values.tolist())}, index=df.index.repeat(df[0].str.len()))","pd.DataFrame(df.iloc[:, 0].tolist(), index=df.index).stack().reset_index(level=1, drop=1).to_frame().astype(int)",218,384
47157646,answer,47157613,"python,list,pandas,dataframe,flatten",codeblock,https://stackoverflow.com/questions/47157646,"pd.DataFrame({0:np.concatenate(df.iloc[:, 0].values.tolist())}, index=df.index.repeat(df[0].str.len()))","pd.DataFrame({0:list(chain.from_iterable(df[0].values.tolist()))}, index=df.index.repeat(df[0].str.len()))",218,388
47210897,answer,47209490,"numpy,scipy,hungarian-algorithm",codeblock,https://stackoverflow.com/questions/47210897,"arr[id1,:][:,id2].shape","arr[np.ix_(id1,id2)].shape",0.0525,0.0665
47214441,answer,47213453,"python,numpy",codeblock,https://stackoverflow.com/questions/47214441,(x.dot(M) * x).sum(axis=1),np.array([row.dot(M).dot(row.T) for row in x]),1590,41900
47216938,answer,47216177,"python,pandas,loops,dictionary",codeblock,https://stackoverflow.com/questions/47216938,(pd.DataFrame(list(chain.from_iterable(df['col'].values.tolist())))),(pd.DataFrame(np.concatenate(df['col']).tolist())),81.4,330
47221529,answer,47220447,"python,pandas",codeblock,https://stackoverflow.com/questions/47221529,df.to_dict('r'),df.to_dict('i').values(),822,6230
47223728,answer,47223596,"python,performance,pandas,memory-efficient",codeblock,https://stackoverflow.com/questions/47223728,"df['weeks'] = (df['date1'].values- df['date2'].values) / np.timedelta64(1, 'D') / 7",df['weeks'] = (df['date1'].subtract(df['date2'])).dt.days / 7,1.89,942
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"np.where(df.values > rowsQuantiles[:, None], True, False)",df.where((df.T > rowsQuantiles).T),136,583
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"df.add(-rowsQuantiles,0).gt(0)",df.where((df.T > rowsQuantiles).T),141,583
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,df.apply(lambda row: row > rowsQuantiles),"np.where(df.values > rowsQuantiles[:, None], True, False)",60.6,136
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"df.gt(rowsQuantiles,0)",df.where((df.T > rowsQuantiles).T),25.4,583
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,df.apply(lambda row: row > rowsQuantiles),df.where((df.T > rowsQuantiles).T),60.6,583
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"np.where(df.values > rowsQuantiles[:, None], True, False)","df.add(-rowsQuantiles,0).gt(0)",136,141
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"df.gt(rowsQuantiles,0)","np.where(df.values > rowsQuantiles[:, None], True, False)",25.4,136
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"df.gt(rowsQuantiles,0)","df.add(-rowsQuantiles,0).gt(0)",25.4,141
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,df.apply(lambda row: row > rowsQuantiles),"df.add(-rowsQuantiles,0).gt(0)",60.6,141
47230653,answer,47230546,"python,pandas,filter,slice,mask",codeblock,https://stackoverflow.com/questions/47230653,"df.gt(rowsQuantiles,0)",df.apply(lambda row: row > rowsQuantiles),25.4,60.6
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,"pd.DataFrame(np.repeat(df.values, 100000, axis=0), columns=df.columns)",pd.concat([df] * 100000).sort_index().reset_index(drop=1),17.1,14600
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,"df.iloc[np.repeat(np.arange(len(df)), 100000)].reset_index(drop=1)",pd.concat([df] * 100000).sort_index().reset_index(drop=1),22.6,14600
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,df.reindex(df.index.repeat(100000)).reset_index(drop=1),pd.concat([df] * 100000).sort_index().reset_index(drop=1),19.9,14600
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,df.reindex(df.index.repeat(100000)).reset_index(drop=1),"df.iloc[np.repeat(np.arange(len(df)), 100000)].reset_index(drop=1)",19.9,22.6
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,"pd.DataFrame(np.repeat(df.values, 100000, axis=0), columns=df.columns)","df.iloc[np.repeat(np.arange(len(df)), 100000)].reset_index(drop=1)",17.1,22.6
47253837,answer,47251471,"python,pandas",codeblock,https://stackoverflow.com/questions/47253837,"pd.DataFrame(np.repeat(df.values, 100000, axis=0), columns=df.columns)",df.reindex(df.index.repeat(100000)).reset_index(drop=1),17.1,19.9
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",607,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",557,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",529,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')",328,613
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",690,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",328,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",533,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",613,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')","pd.to_datetime(s.replace(m, regex=True), format='%d%m%Y')",613,1390
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",529,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))",328,607
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))",328,557
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",533,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)",328,529
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))",529,607
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))",529,557
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))",328,533
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))",533,607
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))",533,557
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))","pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))",557,607
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))","pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')",607,613
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))","pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')",557,613
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')",529,613
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))","pd.to_datetime(s.str[:2] + s.str[2:5].map(f) + s.str[5:], format='%d%m%Y')",533,613
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2].astype(int), year=s.str[-4:].astype(int), month=s.str[2:-4].map(m2).astype(int))))","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",328,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(f))))","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",607,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.to_datetime(pd.DataFrame(dict(day=s.str[:2], year=s.str[-4:], month=s.str[2:-4].map(m2))))","pd.to_datetime(s.str[:2] + s.str[2:5].replace(m) + s.str[5:], format='%d%m%Y')",557,690
47256933,answer,47256212,"python,pandas",codeblock,https://stackoverflow.com/questions/47256933,"pd.Series(pd.to_datetime([x[:2] + f(x[2:5]) + x[5:] for x in s.values.tolist()], format='%d%m%Y'), s.index)","pd.to_datetime(s, format='%d%m%Y', errors='coerce').fillna(pd.to_datetime(s, format='%d%b%Y', errors='coerce'))",529,533
47268119,answer,47268069,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/47268119,"np.maximum.accumulate(X,axis=1)",pd.DataFrame(X).cummax(axis=1).values,1.69,4.81
47268119,answer,47268069,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/47268119,"np.maximum.accumulate(df.values,axis=1)",df.cummax(axis=1),1.68,4.68
47336120,comment,29530232,"python,pandas,dataframe,nan",sentence,":1, also, df.isnull().values.sum() is a bit faster than df.isnull().values.flatten().sum()",df.isnull().values.sum(),df.isnull().values.flatten().sum(),,
47370096,answer,47369976,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47370096,"np.einsum('ji,jk,ki->i',x,y,x)",(x.T.dot(y)*x.T).sum(1),0.832,3.45
47370096,answer,47369976,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47370096,"np.einsum('ij,ji->i',x.T.dot(y),x)",(x.T.dot(y)*x.T).sum(1),2.6,3.45
47370096,answer,47369976,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47370096,"np.einsum('ji,jk,ki->i',x,y,x)","np.einsum('ij,ji->i',x.T.dot(y),x)",0.832,2.6
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[np.ravel_multi_index(b, a.shape)]","a[map(np.ravel, b)]",38,60.1
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a[map(np.ravel, b)]",18.7,60.1
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a[map(np.ravel, b)]",a[tuple(b)],60.1,60.7
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",27.8,38
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","np.take(a,np.ravel_multi_index(b, a.shape))",18.7,27.8
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",27.8,29.3
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",18.7,38
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",18.7,29.3
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]","a[map(np.ravel, b)]",29.3,60.1
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]","a.flat[np.ravel_multi_index(b, a.shape)]",29.3,38
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",15.7,25.8
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,a[tuple(b)],"a[map(np.ravel, b)]",6.56,6.58
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",6.31,9.17
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",6.95,8.52
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))",a[tuple(b)],18.7,60.7
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[np.ravel_multi_index(b, a.shape)]",a[tuple(b)],38,60.7
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))",a[tuple(b)],27.8,60.7
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",6.31,8.52
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a[map(np.ravel, b)]",a[tuple(b)],40,40.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))",a[tuple(b)],20,40.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","np.take(a,np.ravel_multi_index(b, a.shape))",6.31,6.95
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",6.95,9.17
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[np.ravel_multi_index(b, a.shape)]",a[tuple(b)],29.9,40.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))",a[tuple(b)],15.7,40.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]",a[tuple(b)],25.8,40.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a[map(np.ravel, b)]",20,40
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[np.ravel_multi_index(b, a.shape)]","a[map(np.ravel, b)]",29.9,40
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a[map(np.ravel, b)]",15.7,40
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]","a[map(np.ravel, b)]",25.8,40
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,a[tuple(b)],"np.take(a,np.ravel_multi_index(b, a.shape))",6.56,6.95
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,a[tuple(b)],"a.flat[np.ravel_multi_index(b, a.shape)]",6.56,9.17
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))",a[tuple(b)],6.31,6.56
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,a[tuple(b)],"a.flat[ravel_index(b, a.shape)]",6.56,8.52
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a[map(np.ravel, b)]","np.take(a,np.ravel_multi_index(b, a.shape))",6.58,6.95
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a[map(np.ravel, b)]","a.flat[np.ravel_multi_index(b, a.shape)]",6.58,9.17
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]",a[tuple(b)],29.3,60.7
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a[map(np.ravel, b)]",6.31,6.58
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]","a.flat[np.ravel_multi_index(b, a.shape)]",25.8,29.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a[map(np.ravel, b)]",27.8,60.1
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",15.7,29.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[ravel_index(b, a.shape)]",20,25.8
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,ravel_index(b, a.shape))","np.take(a,np.ravel_multi_index(b, a.shape))",15.7,20
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"np.take(a,np.ravel_multi_index(b, a.shape))","a.flat[np.ravel_multi_index(b, a.shape)]",20,29.9
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a[map(np.ravel, b)]","a.flat[ravel_index(b, a.shape)]",6.58,8.52
47370765,answer,47370718,"python,arrays,numpy,idiomatic",codeblock,https://stackoverflow.com/questions/47370765,"a.flat[ravel_index(b, a.shape)]","a.flat[np.ravel_multi_index(b, a.shape)]",8.52,9.17
47390870,answer,47390563,"python,pandas,numpy,datetime,time-series",codeblock,https://stackoverflow.com/questions/47390870,(df.rename_axis('dat').reset_index().set_index('y').groupby('dat')['loadtime'].idxmax().to_frame('y')),df.groupby(level=0).apply(lambda x : x.set_index('y').idxmax()).rename(columns={'loadtime':'y'}),870,4960
47406269,answer,47406231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47406269,pd.Series(df.index).replace(d),df.rename(d),96.7,116
47406290,answer,47406231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47406290,pd.Series(df.index).replace(d),df.rename(d),71.8,75.7
47406290,answer,47406231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47406290,pd.Series(df.index.values).replace(d),df.rename(d),75.3,75.7
47406290,answer,47406231,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47406290,pd.Series(df.index).replace(d),pd.Series(df.index.values).replace(d),71.8,75.3
47415132,answer,47415088,"python,pandas",codeblock,https://stackoverflow.com/questions/47415132,df[df.groupby('A')['B'].transform('nunique')>= THRESHOLD2],df.groupby('A').filter(lambda x: x['B'].nunique() >= THRESHOLD2),558,3050
47418496,answer,47418295,"python,pandas,datetime,dataframe",codeblock,https://stackoverflow.com/questions/47418496,pd.to_datetime(df.time),df['time'].apply(lambda x: parser.parse(x)),4.25,812
47452238,answer,47451871,"python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47452238,"df['new_feature2'] = df['x'] / df['y'] *  np.where(df['z'] > 2, 1, -1)","df['new_feature1'] = df.apply(lambda p: div(p['x'], p['y'], p['z']), axis=1)",0.595,123
47465562,answer,47465542,"python,string,pandas",codeblock,https://stackoverflow.com/questions/47465562,"df.apply(lambda x : ''.join(x),1)","df.apply(lambda x : x.str.cat(),1)",376,759
47474858,answer,47474797,"numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/47474858,((A & B) == A).all(),np.all((A * B) == A),169,170
47474858,answer,47474797,"numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/47474858,np.count_nonzero(A & B) == np.count_nonzero(A),np.all((A * B) == A),57.7,170
47474858,answer,47474797,"numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/47474858,np.count_nonzero(A & B) == np.count_nonzero(A),((A & B) == A).all(),57.7,169
47482207,answer,47392758,"python,pandas",codeblock,https://stackoverflow.com/questions/47482207,df.groupby('pk')[c].diff(-1).fillna(0),df.groupby('pk')[c].transform(lambda x: x - x.shift(1)).fillna(0),9.63,44.3
47482207,answer,47392758,"python,pandas",codeblock,https://stackoverflow.com/questions/47482207,"df.groupby('pk', as_index=False)[c].rolling(4).mean().shift(1)",df.groupby('pk')[c].rolling(4).mean().shift(1).reset_index()[c],41.7,46.5
47482207,answer,47392758,"python,pandas",sentence,"operations on numpy arrays or using numpy tend to be much faster than pandas equivalents (for example, np.sum is faster than pd.DataFrame.sum, and np.where is faster than pd.DataFrame.where, and so on).",np.where,pd.DataFrame.where,,
47482207,answer,47392758,"python,pandas",sentence,"operations on numpy arrays or using numpy tend to be much faster than pandas equivalents (for example, np.sum is faster than pd.DataFrame.sum, and np.where is faster than pd.DataFrame.where, and so on).",np.sum,pd.DataFrame.sum,,
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"pd.DataFrame(np.sort(df.values, axis=1)[:, :4], columns=np.arange(1, 5)).add_prefix('Col')","pd.DataFrame(justify(df.values, invalid_val=np.nan, axis=1, side='left')[:,:4])",5.28,6.78
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"pd.DataFrame(np.sort(df.values, axis=1)[:, :4], columns=np.arange(1, 5)).add_prefix('Col')","pd.DataFrame(mask_app(df.values)[:,:4])",5.28,8.68
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"a = df.values





pd.DataFrame(a[~np.isnan(a)].reshape(a.shape[0],-1)[:, :4], index=df.index)","pd.DataFrame(justify(df.values, invalid_val=np.nan, axis=1, side='left')[:,:4])",2.11,6.78
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"a = df.values





pd.DataFrame(a[~np.isnan(a)].reshape(a.shape[0],-1)[:, :4], index=df.index)","pd.DataFrame(np.sort(df.values, axis=1)[:, :4], columns=np.arange(1, 5)).add_prefix('Col')",2.11,5.28
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"a = df.values





pd.DataFrame(a[~np.isnan(a)].reshape(a.shape[0],-1)[:, :4], index=df.index)","pd.DataFrame(mask_app(df.values)[:,:4])",2.11,8.68
47510242,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510242,"pd.DataFrame(justify(df.values, invalid_val=np.nan, axis=1, side='left')[:,:4])","pd.DataFrame(mask_app(df.values)[:,:4])",6.78,8.68
47510424,answer,47510207,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/47510424,"pd.DataFrame(justify(df.values, invalid_val=np.nan, axis=1, side='left')[:,:4])","df.apply(sorted, key=np.isnan, axis=1).iloc[:, :4]",4.78,4050
47514069,answer,47513408,"python,pandas,where,list-comprehension,apply",codeblock,https://stackoverflow.com/questions/47514069,"np.vectorize(myfun)(df.id,df.idlist).astype(int)","df.apply(lambda  x : set([x.id]).issubset(x.idlist),1).astype(int)",0.0923,0.353
47518323,answer,47518293,"python,list,numpy,tuples",codeblock,https://stackoverflow.com/questions/47518323,np.bincount(t)[a].sum(),"np.in1d(t,a).sum()",0.503,1.18
47518323,answer,47518293,"python,list,numpy,tuples",codeblock,https://stackoverflow.com/questions/47518323,np.bincount(t)[a].sum(),"np.in1d(t,a).sum()",5.05,13.4
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,(5000 in df.index.values),(5000 in set(df.index)),0.0767,7.34
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,(5000 in df.index),(5000 in df.index.values),0.000523,0.0767
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,([i in df.index.values for i in a]),([i in set(df.index) for i in a]),208,7440
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,([i in df.index for i in a]),([i in set(df.index) for i in a]),0.636,7440
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,(5000 in df.index),(5000 in set(df.index)),0.000523,7.34
47526105,answer,47526059,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47526105,([i in df.index for i in a]),([i in df.index.values for i in a]),0.636,208
47537982,answer,47535406,"python,numpy",codeblock,https://stackoverflow.com/questions/47537982,np.array(alist),np.array(allist),0.00674,0.00992
47550203,answer,47550167,"python,pandas",codeblock,https://stackoverflow.com/questions/47550203,(df_1['C'] - df_1['B']).groupby(df_1['A']).sum().reset_index(name='sum'),"df_1.groupby(""A"").apply(lambda x : (x['C'] - x['B']).sum()).reset_index(name='sum')",3.07,175
47577139,answer,47576632,"python,pandas",codeblock,https://stackoverflow.com/questions/47577139,"df.groupby('B')['C'].transform(lambda x: np.where(x.idxmin() == x.index,1,(x[x.idxmin()] - x)))","df.apply(lambda x: df[(df.B == x.B) & (~df.C.eq(x.C))].min().C - x.C, axis=1)",1.67,4.14
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).groupby(['tenant_id']).head(1)","data_1.groupby(['tenant_id']).apply(lambda x: x.nsmallest(1, 'tenant_date')).reset_index(drop=1)",2.07,11.4
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,data_1.set_index(['tenant_class_id']).groupby(['tenant_id'])['tenant_date'].nsmallest(1).reset_index(),"data_1.groupby(['tenant_id']).apply(lambda x: x.nsmallest(1, 'tenant_date')).reset_index(drop=1)",8.64,11.4
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,data_1.loc[data_1.groupby(['tenant_id'])['tenant_date'].idxmin()],"data_1.groupby(['tenant_id']).apply(lambda x: x.nsmallest(1, 'tenant_date')).reset_index(drop=1)",2.04,11.4
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).drop_duplicates(['tenant_id'])","data_1.sort_values(['tenant_id','tenant_date']).groupby(['tenant_id']).head(1)",1.97,2.07
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).drop_duplicates(['tenant_id'])",data_1.loc[data_1.groupby(['tenant_id'])['tenant_date'].idxmin()],1.97,2.04
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).drop_duplicates(['tenant_id'])",data_1.set_index(['tenant_class_id']).groupby(['tenant_id'])['tenant_date'].nsmallest(1).reset_index(),1.97,8.64
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).drop_duplicates(['tenant_id'])","data_1.groupby(['tenant_id']).apply(lambda x: x.nsmallest(1, 'tenant_date')).reset_index(drop=1)",1.97,11.4
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,data_1.loc[data_1.groupby(['tenant_id'])['tenant_date'].idxmin()],"data_1.sort_values(['tenant_id','tenant_date']).groupby(['tenant_id']).head(1)",2.04,2.07
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,"data_1.sort_values(['tenant_id','tenant_date']).groupby(['tenant_id']).head(1)",data_1.set_index(['tenant_class_id']).groupby(['tenant_id'])['tenant_date'].nsmallest(1).reset_index(),2.07,8.64
47589055,answer,47588971,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/47589055,data_1.loc[data_1.groupby(['tenant_id'])['tenant_date'].idxmin()],data_1.set_index(['tenant_class_id']).groupby(['tenant_id'])['tenant_date'].nsmallest(1).reset_index(),2.04,8.64
47642054,answer,47642014,"python,python-3.x,numpy,pytorch",codeblock,https://stackoverflow.com/questions/47642054,"a.swapaxes(-2,-1).reshape(a.shape[0],-1)","np.reshape(a,(30,900), order='F')",0.0189,0.0284
47642054,answer,47642014,"python,python-3.x,numpy,pytorch",codeblock,https://stackoverflow.com/questions/47642054,"a.swapaxes(-2,-1).reshape(a.shape[0],-1)","np.reshape(a,(3,9), order='F')",0.00101,0.00122
47642054,answer,47642014,"python,python-3.x,numpy,pytorch",codeblock,https://stackoverflow.com/questions/47642054,"a.swapaxes(-2,-1).reshape(a.shape[0],-1)","np.reshape(a,(300,90000), order='F')",52.4,333
47646944,answer,47646789,"python,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/47646944,"np.tensordot(XYZ_2, XYZ_to_sRGB_mat_D50, axes=((2),(1)))",XYZ_2.dot(XYZ_to_sRGB_mat_D50.T),0.0731,0.45
47679040,answer,47678961,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47679040,df['values'].apply(lambda x: list(set(x))),df['values'].agg(np.unique),1.98,34.7
47680095,answer,47678961,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47680095,df['values'].apply(lambda x: list(set(x))),df['values'].agg(np.unique),0.743,6.99
47703346,answer,47703250,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47703346,df[df.std(axis=1) > 0],df[df.nunique(1)>1],1.69,2620
47703459,answer,47703250,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47703459,"df[~df.eq(df.iloc[:, 0], axis=0).all(1)]",df[df.nunique(1)>1],13,9870
47703459,answer,47703250,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47703459,df[df.std(axis=1) > 0],"df[~df.eq(df.iloc[:, 0], axis=0).all(1)]",5.62,13
47703459,answer,47703250,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47703459,df[df.std(axis=1) > 0],df[df.nunique(1)>1],5.62,9870
47737721,answer,47733520,"python,numpy",codeblock,https://stackoverflow.com/questions/47737721,"np.tensordot(B,A,axes=((2),(0)))","np.einsum('ij,kli->klj', A, B)",15.3,33.2
47737721,answer,47733520,"python,numpy",codeblock,https://stackoverflow.com/questions/47737721,"np.tensordot(B,A,axes=((2),(0)))","np.einsum('ij,kli->klj', A, B)",1.72,4.21
47744253,answer,47744109,"python,pandas",codeblock,https://stackoverflow.com/questions/47744253,"df.apply(lambda r: set(r['friend_description'].split()) & set(r['friend_definition'].split()), axis=1)","df.apply(lambda x: x.str.split(expand=False)).apply(lambda r: set(r['friend_description']) & set(r['friend_definition']),





axis=1)",3650,4630
47744253,answer,47744109,"python,pandas",codeblock,https://stackoverflow.com/questions/47744253,[set(x[0].split()) & set(x[1].split()) for x in df.values],"df.apply(lambda x: x.str.split(expand=False)).apply(lambda r: set(r['friend_description']) & set(r['friend_definition']),





axis=1)",223,4630
47744253,answer,47744109,"python,pandas",codeblock,https://stackoverflow.com/questions/47744253,[set(x[0].split()) & set(x[1].split()) for x in df.values],"df.apply(lambda r: set(r['friend_description'].split()) & set(r['friend_definition'].split()), axis=1)",223,3650
47745134,answer,47744927,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/47745134,y[mask] = np.sin(x[mask]),"np.sin(x,where=mask,out=y)",0.00469,0.00517
47758455,answer,30521994,"python,pandas",codeblock,https://stackoverflow.com/questions/47758455,"df.reindex(sorted(df.index, key=lambda x: x.lower()), copy=True)",df.iloc[df.index.str.lower().argsort()],0.794,0.85
47758593,answer,47755584,"python,performance,pandas,dataframe,memory-efficient",codeblock,https://stackoverflow.com/questions/47758593,"df.groupby(['id1','id2'],sort=False).apply(lambda x : x['vals'].shift()*((x['date'] -  pd.to_timedelta(1, unit='d')).isin(x['date'].tolist())).replace(False,np.nan))","df.groupby(['id1','id2'], as_index=False).apply(lambda x: x.assign(t_1=x.vals.resample('D').asfreq().shift(1),t_2=x.vals.resample('D').asfreq().shift(2)))",824,1380
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df.loc[df.check_churn == df.is_churn].shape[0]),sum(df['check_churn'] & df['is_churn']),23.4,54.7
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] == df['is_churn']).sum(),(df['check_churn'] & df['is_churn']).sum(),18.2,21.2
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] == df['is_churn']).sum(),(df.loc[df.check_churn == df.is_churn].shape[0]),18.2,23.4
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] == df['is_churn']).sum(),sum(df['check_churn'] & df['is_churn']),18.2,54.7
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] == df['is_churn']).sum(),(df.loc[df.check_churn == df.is_churn].shape[0]),0.414,0.708
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] == df['is_churn']).sum(),sum(df['check_churn'] & df['is_churn']),0.414,0.793
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] & df['is_churn']).sum(),(df.loc[df.check_churn == df.is_churn].shape[0]),21.2,23.4
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df['check_churn'] & df['is_churn']).sum(),sum(df['check_churn'] & df['is_churn']),21.2,54.7
47758801,answer,47758720,"python,pandas",codeblock,https://stackoverflow.com/questions/47758801,(df.loc[df.check_churn == df.is_churn].shape[0]),sum(df['check_churn'] & df['is_churn']),0.708,0.793
47759047,answer,47759009,"python,pandas",codeblock,https://stackoverflow.com/questions/47759047,"(df['date'].dt.strftime(""%m/%y"").drop_duplicates().tolist())","(df['date'].dt.strftime(""%m/%y"").unique().tolist())",466,469
47760412,answer,47760063,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/47760412,test.argsort().argsort(),test.rank(method='first').astype(int) - 1,0.146,0.234
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(list(map(lambda d: list(chain.from_iterable(d)), data)))",pd.DataFrame([np.concatenate(d) for d in data]),95.8,560
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(list(map(lambda d: list(chain.from_iterable(d)), data)))","pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))",95.8,150
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))",pd.DataFrame([np.concatenate(d) for d in data]),150,560
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),pd.DataFrame([np.concatenate(d) for d in data]),99.2,560
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),"pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))",99.2,150
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(list(map(lambda d:  list(chain.from_iterable(d)), data)))",pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),1.97,2.03
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))",pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),1.46,2.03
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),pd.DataFrame([np.concatenate(d) for d in data]),2.03,5.9
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))","pd.DataFrame(list(map(lambda d:  list(chain.from_iterable(d)), data)))",1.46,1.97
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(list(map(lambda d:  list(chain.from_iterable(d)), data)))",pd.DataFrame([np.concatenate(d) for d in data]),1.97,5.9
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(np.concatenate(list(zip(*data)), axis=1))",pd.DataFrame([np.concatenate(d) for d in data]),1.46,5.9
47769166,answer,47769111,"python,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47769166,"pd.DataFrame(list(map(lambda d: list(chain.from_iterable(d)), data)))",pd.DataFrame([[item for sublist in l for item in sublist] for l in data]),95.8,99.2
47807497,answer,47807426,"python,string,pandas,substring",codeblock,https://stackoverflow.com/questions/47807497,df.Item.str.lower().apply(lambda x: set(x).issubset('carpark')),(df.Item.str.lower().apply(set) - set('carpark')).str.len() == 0,927,1130
47827142,answer,47825514,"python,performance,numpy,for-loop,memory",codeblock,https://stackoverflow.com/questions/47827142,np.arange(len(x)),np.array(x),1.77,109
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",50.8,788
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),0.147,51.3
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),50.8,51.3
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),pd.DataFrame({'Column':np.concatenate(df.values)}),51.3,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),"df.stack().reset_index(level=1,drop=True)",51.3,788
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),"df.T.melt().drop('variable',1)",51.3,682
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),0.143,53.4
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.stack().reset_index(level=1,drop=True)",pd.DataFrame({'Column':np.concatenate(df.values)}),788,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","pd.DataFrame(df.values.reshape(-1), columns=['Column'])",0.143,0.147
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","pd.DataFrame(df.values.flatten(), columns=['Column'])",0.143,50.8
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),0.143,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",0.143,788
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","df.T.melt().drop('variable',1)",0.143,682
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),pd.DataFrame({'Column': df.values.reshape(-1)}),51.3,53.4
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),50.8,53.4
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),pd.DataFrame({'Column':np.concatenate(df.values)}),53.4,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.T.melt().drop('variable',1)",pd.DataFrame({'Column':np.concatenate(df.values)}),682,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),"df.stack().reset_index(level=1,drop=True)",53.4,788
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),"df.T.melt().drop('variable',1)",53.4,682
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","pd.DataFrame(df.values.flatten(), columns=['Column'])",0.147,50.8
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),0.147,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",0.147,788
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","df.T.melt().drop('variable',1)",0.147,682
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),50.8,4620
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])","df.T.melt().drop('variable',1)",50.8,682
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),0.147,53.4
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.T.melt().drop('variable',1)","df.stack().reset_index(level=1,drop=True)",6.94,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.T.melt().drop('variable',1)",pd.DataFrame({'Column':np.concatenate(df.values)}),6.94,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),0.144,0.825
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),pd.DataFrame({'Column': df.values.ravel()}),0.778,0.825
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),0.143,0.825
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),0.585,0.825
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),pd.DataFrame({'Column':np.concatenate(df.values)}),0.825,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),"df.stack().reset_index(level=1,drop=True)",0.825,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.ravel()}),"df.T.melt().drop('variable',1)",0.825,6.94
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),0.144,0.778
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","pd.DataFrame(df.values.ravel(), columns=['Column'])",0.143,0.144
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","pd.DataFrame(df.values.flatten(), columns=['Column'])",0.144,0.585
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),0.144,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",0.144,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])","df.T.melt().drop('variable',1)",0.144,6.94
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),0.143,0.778
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column': df.values.reshape(-1)}),0.585,0.778
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),pd.DataFrame({'Column':np.concatenate(df.values)}),0.778,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),"df.stack().reset_index(level=1,drop=True)",0.778,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,pd.DataFrame({'Column': df.values.reshape(-1)}),"df.T.melt().drop('variable',1)",0.778,6.94
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","pd.DataFrame(df.values.flatten(), columns=['Column'])",0.143,0.585
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",0.143,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])","df.T.melt().drop('variable',1)",0.143,6.94
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),0.585,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])","df.stack().reset_index(level=1,drop=True)",0.585,7.65
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.flatten(), columns=['Column'])","df.T.melt().drop('variable',1)",0.585,6.94
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.stack().reset_index(level=1,drop=True)",pd.DataFrame({'Column':np.concatenate(df.values)}),7.65,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.ravel(), columns=['Column'])",pd.DataFrame({'Column': df.values.ravel()}),0.143,51.3
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"pd.DataFrame(df.values.reshape(-1), columns=['Column'])",pd.DataFrame({'Column':np.concatenate(df.values)}),0.143,45.6
47833875,answer,47833829,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47833875,"df.T.melt().drop('variable',1)","df.stack().reset_index(level=1,drop=True)",682,788
47881062,answer,47881048,"python,pandas,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47881062,df['Data3'] = df['Data'].ge(1).astype(int),df['Data2'] = df['Data'].clip_upper(1),4.76,9.32
47881062,answer,47881048,"python,pandas,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47881062,df['Data2'] = df['Data'].clip_upper(1),df['Data3'] = df['Data'].ge(1).astype(int),0.308,0.425
47881296,answer,47881048,"python,pandas,dataframe,lambda",codeblock,https://stackoverflow.com/questions/47881296,"np.clip(df.Data.values, a_min=None, a_max=1)",df['Data'].clip_upper(1),0.0242,0.195
47892159,answer,47892097,"python,numpy",codeblock,https://stackoverflow.com/questions/47892159,"np.tensordot(rot_mats, x, axes=((2),(1))).swapaxes(1,2)","np.dot(rot_mats, x.T).transpose((0, 2, 1))",185,1820
47892159,answer,47892097,"python,numpy",codeblock,https://stackoverflow.com/questions/47892159,"np.tensordot(rot_mats, x, axes=((2),(1))).swapaxes(1,2)","np.dot(rot_mats, x.T).transpose((0, 2, 1))",0.0757,0.67
47903570,answer,47903478,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/47903570,df['last_name'].isin(L).all(),"df.loc[~df['last_name'].isin(L), 'last_name'].any()",0.421,0.562
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.groupby('a')['b'].transform('last'),df['b_new'] = df.groupby('a')['b'].transform(lambda x: x.iat[-1]),1.82,178
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.groupby('a')['b'].transform('last'),df['b_new'] = df.a.replace(df.groupby('a').b.nth(-1)),1.82,71.3
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.a.map(df.groupby('a').b.nth(-1)),df['b_new'] = df.groupby('a')['b'].transform(lambda x: x.iat[-1]),3.57,178
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.groupby('a')['b'].transform('last'),df['b_new'] = df.a.map(df.groupby('a').b.nth(-1)),1.82,3.57
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.a.map(df.groupby('a').b.nth(-1)),df['b_new'] = df.a.replace(df.groupby('a').b.nth(-1)),3.57,71.3
47924431,answer,47924400,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/47924431,df['b_new'] = df.a.replace(df.groupby('a').b.nth(-1)),df['b_new'] = df.groupby('a')['b'].transform(lambda x: x.iat[-1]),71.3,178
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"np.clip(data.values, 0.2, 0.8)","data.clip(lower=0.2, upper=0.8)",2.85,12.3
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.clip(lower=0.2, upper=0.8)","np.clip(data, a_min=0.2, a_max=0.8)",12.3,12.3
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.values.clip(0.2, 0.8)","data.clip(lower=0.2, upper=0.8)",2.85,12.3
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.values.clip(0.2, 0.8)","np.clip(data, a_min=0.2, a_max=0.8)",2.85,12.3
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"np.clip(data.values, 0.2, 0.8)","np.clip(data, a_min=0.2, a_max=0.8)",2.85,12.3
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.values.clip(0.2, 0.8)","np.clip(data.values, 0.2, 0.8)",0.00132,0.00222
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.clip(lower=0.2, upper=0.8)","np.clip(data, a_min=0.2, a_max=0.8)",0.0904,0.102
47950103,answer,47893677,"python,performance,pandas,numpy",codeblock,https://stackoverflow.com/questions/47950103,"data.values.clip(0.2, 0.8)","np.clip(data.values, 0.2, 0.8)",2.85,2.85
47954497,answer,47954401,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47954497,"np.einsum('ij,i->ji',p,w).dot(p)","np.einsum('ij,ik,i->jk',p,p,w)",0.00907,0.101
47954497,answer,47954401,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47954497,"np.einsum('ij,i->ji',p,w).dot(p)","np.tensordot(p[...,None]*p[:,None], w, axes=((0),(0)))",0.00907,0.124
47954497,answer,47954401,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47954497,"np.einsum('ij,i->ji',p,w).dot(p)","np.einsum('ij,ik,i->jk',p,p,w)",1.01,139
47954497,answer,47954401,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/47954497,"np.einsum('ij,ik,i->jk',p,p,w)","np.tensordot(p[...,None]*p[:,None], w, axes=((0),(0)))",0.101,0.124
47970923,answer,47970891,"python,pandas",codeblock,https://stackoverflow.com/questions/47970923,"df.A.replace(dict(zip(df.B.tolist(),[np.nan]*len(df))),regex=True).isnull()","df['A'].str.split(expand=True).eq(df['B'], axis=0).any(1)",49.1,87.8
47971055,answer,47970891,"python,pandas",codeblock,https://stackoverflow.com/questions/47971055,"df.A.replace(dict(zip(df.B.tolist(),[np.nan]*len(df))),regex=True).isnull()","df['A'].str.split(expand=True).eq(df['B'], axis=0).any(1)",134,185
47990817,answer,47990797,"python,pandas,math,accumulate",codeblock,https://stackoverflow.com/questions/47990817,df.a.expanding().median(),df['a'].apply(cummedian()),838,1690
48020525,answer,48020296,"python,regex,pandas,filter",codeblock,https://stackoverflow.com/questions/48020525,"data[data['BusinessDescription'].str.contains('dental', flags = re.IGNORECASE)]",data[data['BusinessDescription'].str.lower().str.contains('dental')],28.9,32.6
48030538,answer,48030350,"python,pandas",codeblock,https://stackoverflow.com/questions/48030538,"df.at['2716', 'foo1'] = 10","df.loc['2716', 'foo1'] = 10",0.0125,0.212
48053963,answer,48053220,"python-3.x,pandas,dataframe,subtraction",codeblock,https://stackoverflow.com/questions/48053963,"subdf.sub(ith_col, axis=0).multiply(subdf > 0).add(0)","df[df > 0].iloc[:,2:-1].sub(ith_col, axis=0).fillna(0)",0.688,2.97
48058130,answer,48057845,"python,arrays,numpy,optimization,matrix-multiplication",codeblock,https://stackoverflow.com/questions/48058130,"np.tensordot(data.reshape(data.shape[0],k,-1), weights[0], axes=(2,1)).reshape(-1,k**2)","data.reshape(-1,data.shape[1]//k).dot(weights[0].T).reshape(-1,k**2)",114,118
48065404,answer,48064232,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48065404,pd.Series(df.values.tolist()).mask(df.isnull().any(1)),"df.apply(lambda x : pd.Series([x.tolist()]) if ~x.isnull().any() else np.nan,1)",133,97000
48065404,answer,48064232,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48065404,[np.nan if np.isnan(v).any() else list(v[1:]) for v in df.itertuples()],"df.apply(lambda x : pd.Series([x.tolist()]) if ~x.isnull().any() else np.nan,1)",5790,97000
48065404,answer,48064232,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48065404,pd.Series(df.values.tolist()).mask(df.isnull().any(1)),[np.nan if np.isnan(v).any() else list(v[1:]) for v in df.itertuples()],133,5790
48066781,answer,48066662,"python,arrays,numpy,concatenation",codeblock,https://stackoverflow.com/questions/48066781,"b.reshape(1, 1, -1).repeat(a.shape[0], axis=0)","np.broadcast_to(b,(a.shape[0],1,len(b)))",0.000957,0.00312
48077977,answer,48076607,"python,pandas",codeblock,https://stackoverflow.com/questions/48077977,df.stack().map(d).unstack(),df.replace(d),381,661
48084814,answer,48084356,"python,pandas,generator",codeblock,https://stackoverflow.com/questions/48084814,(df.Fee / df.Costs).values,"np.array([x / y for x, y in df[['Fee', 'Costs']].values])",0.0785,0.331
48139309,answer,48139274,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/48139309,pd.Series(list(itertools.chain(*s))).astype(int),pd.Series(np.concatenate(s.values.tolist())),2.2,7.71
48139309,answer,48139274,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/48139309,pd.Series(list(itertools.chain(*s))).astype(int),pd.Series([item for sublist in s for item in sublist]).astype(int),2.2,2.55
48139309,answer,48139274,"python,pandas,time-series",codeblock,https://stackoverflow.com/questions/48139309,pd.Series([item for sublist in s for item in sublist]).astype(int),pd.Series(np.concatenate(s.values.tolist())),2.55,7.71
48142655,answer,48129713,"pandas,numpy,cython",codeblock,https://stackoverflow.com/questions/48142655,pd.unique(a),np.unique(a),9.4,82.3
48143516,answer,48143177,"python,performance,numpy,scipy",codeblock,https://stackoverflow.com/questions/48143516,"maxs = maximum_filter(a, footprint=footprint)","maxs = np.maximum.reduce([a[:-2, 1:-1], a[1:-1, 2:], a[2:, 1:-1], a[1:-1,:-2]])",858,1340
48143516,answer,48143177,"python,performance,numpy,scipy",sentence,so maximum_filter is a bit faster than using np.maximum.reduce applied to the slices.,maximum_filter,np.maximum.reduce,,
48168095,answer,48159562,"python,numpy,tensorflow,batch-processing,channel",codeblock,https://stackoverflow.com/questions/48168095,"np.einsum('ijkl->l', a)/float(np.prod(a.shape[:3]))","np.mean(a, axis=(0,1,2))",1.82,9.48
48206379,answer,29150346,"python,pandas,immutability,multi-index",codeblock,https://stackoverflow.com/questions/48206379,"df.index.set_levels(df.index.get_level_values(0).str.replace(' ',''), level=0)","pd.MultiIndex.from_tuples([(x[0].replace(' ',''), x[1]) for x in df.index])",134,394
48206379,answer,29150346,"python,pandas,immutability,multi-index",codeblock,https://stackoverflow.com/questions/48206379,"df.index.set_levels('00'+df.index.get_level_values(0), level=0)","pd.MultiIndex.from_tuples([('00'+x[0], x[1]) for x in df.index])",1.38,5.18
48206379,answer,29150346,"python,pandas,immutability,multi-index",codeblock,https://stackoverflow.com/questions/48206379,"df.index.set_levels('00'+df.index.levels[0], level=0)","pd.MultiIndex.from_tuples([('00'+x[0], x[1]) for x in df.index])",0.331,5.18
48206379,answer,29150346,"python,pandas,immutability,multi-index",codeblock,https://stackoverflow.com/questions/48206379,"df.index.set_levels('00'+df.index.levels[0], level=0)","df.index.set_levels('00'+df.index.get_level_values(0), level=0)",0.331,1.38
48251951,answer,48251534,"python,python-2.7,numpy,random",codeblock,https://stackoverflow.com/questions/48251951,"np.random.randint(0,N,size=(N,M))","np.column_stack(np.random.randint(0,N,size=N) for _ in range(M))",1320,2730
48275686,answer,48273294,"python,python-3.x,pandas,apply",sentence,"note that using agg here to aggregate data is a lot faster, because it vectorizes your operations (which is faster than a loop-like apply solution).",agg,apply,,
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,(df[~df.lid.groupby(df.lid).transform('count').gt(2000)]),(df[~df.lid.isin(df.lid.value_counts().loc[lambda x: x > 2000].index)]),93.6,137
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,(df[~df.lid.groupby(df.lid).transform('count').gt(2000)]),df.groupby('lid').filter(lambda x: len(x) <= 2000),93.6,124
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,(df[df.groupby('lid')['lid'].transform('size') <= 2000]),(df[~df.lid.isin(df.lid.value_counts().loc[lambda x: x > 2000].index)]),57.8,137
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,(df[df.groupby('lid')['lid'].transform('size') <= 2000]),(df[~df.lid.groupby(df.lid).transform('count').gt(2000)]),57.8,93.6
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,(df[df.groupby('lid')['lid'].transform('size') <= 2000]),df.groupby('lid').filter(lambda x: len(x) <= 2000),57.8,124
48275799,answer,48275775,"python,pandas",codeblock,https://stackoverflow.com/questions/48275799,df.groupby('lid').filter(lambda x: len(x) <= 2000),(df[~df.lid.isin(df.lid.value_counts().loc[lambda x: x > 2000].index)]),124,137
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,(x == 35).view(np.uint8),"np.isin(x, 35).view(np.uint8)",20.1,30.2
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,"np.isin(x, 35).astype(np.uint8)","np.asarray(np.isin(x, 35), dtype=np.uint8)",115,117
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,"np.asarray(np.isin(x, 35), dtype=np.uint8)",(x == 35).astype(np.uint8),117,126
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,"np.isin(x, 35).astype(np.uint8)",(x == 35).astype(np.uint8),115,126
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,"np.asarray(np.isin(x, 35), dtype=np.uint8)","np.where(x==35, 1, 0)",117,427
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,"np.isin(x, 35).astype(np.uint8)","np.where(x==35, 1, 0)",115,427
48309550,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48309550,(x == 35).astype(np.uint8),"np.where(x==35, 1, 0)",126,427
48311050,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48311050,(x == 35).astype(int),"np.where(x==35, 1, 0)",0.00323,0.00585
48311050,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48311050,"np.where(x==35, 1, 0)","np.isin(x, 35).astype(int)",0.00585,0.0187
48311050,answer,48308240,"python,numpy,matrix,multidimensional-array",codeblock,https://stackoverflow.com/questions/48311050,(x == 35).astype(int),"np.isin(x, 35).astype(int)",0.00323,0.0187
48313679,answer,48313532,"python,pandas,dataframe,fillna",codeblock,https://stackoverflow.com/questions/48313679,"df.loc[:, 'Q'] = df.groupby('code')['Q'].transform(lambda group: group.ffill())","df.loc[:, 'Q'] = df.groupby('code')['Q'].ffill()",2.41,3.66
48319557,answer,48318578,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48319557,np.isnan(arr),pd.isnull(arr),0.0056,0.0248
48324987,answer,48324937,"python,pandas",codeblock,https://stackoverflow.com/questions/48324987,"data[[""y"", ""y2""]] = pd.DataFrame(tup.values.tolist())","data[[""x"", ""x2""]] = tup.apply(pd.Series)",3.1,836
48348812,answer,48348095,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/48348812,"[mult.sub(lambda x: x.group(1) + ' ' + x.group(1), i) for i in s]","s.apply(lambda x: mult.sub(lambda x: x.group(1) + ' ' + x.group(1), x))",0.0146,0.148
48348812,answer,48348095,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/48348812,"[mult.sub(lambda x: x.group(1) + ' ' + x.group(1), i) for i in s]","s.str.replace('(?:two|2) (?P<race>[a-z]+) (?P<gender>(?:fe)?male)s', r'\g<race> \g<gender>, \g<race> \g<gender>')",0.0146,0.205
48348812,answer,48348095,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/48348812,"s.apply(lambda x: mult.sub(lambda x: x.group(1) + ' ' + x.group(1), x))","s.str.replace('(?:two|2) (?P<race>[a-z]+) (?P<gender>(?:fe)?male)s', r'\g<race> \g<gender>, \g<race> \g<gender>')",0.148,0.205
48362111,answer,48357722,"numpy,cython",codeblock,https://stackoverflow.com/questions/48362111,d_obj.sum(),d.sum(1),0.0124,0.0202
48362111,answer,48357722,"numpy,cython",codeblock,https://stackoverflow.com/questions/48362111,c.sum(1),c_obj.sum(),52.5,369
48362111,answer,48357722,"numpy,cython",codeblock,https://stackoverflow.com/questions/48362111,b.sum(1),b_obj.sum(),2.43,5.53
48364689,answer,48364447,"python,numpy,matrix,scipy,orthogonal",sentence,to me scipy.linalg.orth was a little bit faster than numpy.linalg.qr:,scipy.linalg.orth,numpy.linalg.qr,,
48427774,answer,48427365,"python,arrays,python-3.x,numpy",sentence,np.delete seems a bit faster than np.r_:,np.delete,np.r_,,
48429740,answer,48424130,"python,numpy",codeblock,https://stackoverflow.com/questions/48429740,A[ind][k],A[np.where(ind)[0][k]],0.00134,0.00194
48429740,answer,48424130,"python,numpy",codeblock,https://stackoverflow.com/questions/48429740,x[np.nonzero(y)].shape,x[y].shape,0.0342,0.0899
48429740,answer,48424130,"python,numpy",codeblock,https://stackoverflow.com/questions/48429740,x[idx].shape,x[np.nonzero(y)].shape,0.0133,0.0342
48429740,answer,48424130,"python,numpy",codeblock,https://stackoverflow.com/questions/48429740,x[idx].shape,x[y].shape,0.0133,0.0899
48435958,answer,6910641,"python,numpy",sentence,"method np.argpartition only returns the k largest indices, performs a local sort, and is faster than np.argsort(performing a full sort) when array is quite large.",np.argpartition,np.argsort,,
48451193,answer,48451167,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/48451193,"np.abs(A, out=A)",np.abs(A),0.647,2.9
48462916,answer,48462118,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/48462916,(df.loc[(df.index >= '2018-05-30') & (df.index <= '2027-07-03')]),(df.loc['2018-05-30':'2027-07-03']),0.502,1.43
48462916,answer,48462118,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/48462916,(df.iloc[df.index.searchsorted('2018-05-31'): df.index.searchsorted('2027-05-31')]),(df.loc[(df.index >= '2018-05-31') & (df.index < '2027-05-31')]),0.136,0.52
48462916,answer,48462118,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/48462916,"(df.truncate(before='2018-05-30', after='2027-07-03'))",(df.loc[(df.index >= '2018-05-30') & (df.index <= '2027-07-03')]),0.45,0.502
48462916,answer,48462118,"python-2.7,pandas",codeblock,https://stackoverflow.com/questions/48462916,"(df.truncate(before='2018-05-30', after='2027-07-03'))",(df.loc['2018-05-30':'2027-07-03']),0.45,1.43
48471912,answer,48471852,"python,performance,numpy,numpy-ufunc,numpy-ndarray",codeblock,https://stackoverflow.com/questions/48471912,arr.cumsum(axis=1),arrf.cumsum(axis=1),1.99,14.6
48471912,answer,48471852,"python,performance,numpy,numpy-ufunc,numpy-ndarray",codeblock,https://stackoverflow.com/questions/48471912,arrf.cumsum(axis=0),arr.cumsum(axis=0),1.96,14.6
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"r = np.einsum('ij,kj->ik', d[:, 0:4], D)","r = np.einsum('ij,kj->ik', d[:, 0:4], D, optimize=True)",2.63,2.73
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"r = d[:, 0:4].dot(D.T)","r = np.einsum('ij,kj->ik', d[:, 0:4], D)",1.56,2.63
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"torch_matmul = torch.matmul(d_tensor, DT_tensor)","r = np.einsum('ij,kj->ik', d[:, 0:4], D)",0.087,2.63
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"torch_matmul = torch.matmul(d_tensor, DT_tensor)","r = np.einsum('ij,kj->ik', d[:, 0:4], D, optimize=True)",0.087,2.73
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"r = d[:, 0:4].dot(D.T)","r = np.einsum('ij,kj->ik', d[:, 0:4], D, optimize=True)",1.56,2.73
48482089,answer,48474274,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48482089,"torch_matmul = torch.matmul(d_tensor, DT_tensor)","r = d[:, 0:4].dot(D.T)",0.087,1.56
48493011,answer,48492429,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48493011,mu.dot(sigma).dot(mu),Mu@sigma@Mu.T,0.00279,0.0171
48493011,answer,48492429,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48493011,Mu@sigma@Mu.T,Mu*sigma*Mu.T,0.0171,0.0177
48493011,answer,48492429,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/48493011,mu.dot(sigma).dot(mu),Mu*sigma*Mu.T,0.00279,0.0177
48516102,answer,48515725,"python,numpy",codeblock,https://stackoverflow.com/questions/48516102,arr.sum(axis=0).shape,"np.sum(arr,axis=0).shape",0.0176,0.0201
48516102,answer,48515725,"python,numpy",codeblock,https://stackoverflow.com/questions/48516102,"np.add.reduce(arr,axis=0).shape","np.sum(arr,axis=0).shape",0.018,0.0201
48516102,answer,48515725,"python,numpy",codeblock,https://stackoverflow.com/questions/48516102,arr.sum(axis=0).shape,"np.add.reduce(arr,axis=0).shape",0.0176,0.018
48528492,answer,48528404,"python,numpy",codeblock,https://stackoverflow.com/questions/48528492,{u:np.flatnonzero(a==u) for u in pd.Series(a).unique()},{val: np.where(a==val)[0] for val in np.unique(a)},17.9,34.4
48528492,answer,48528404,"python,numpy",codeblock,https://stackoverflow.com/questions/48528492,{u:np.flatnonzero(a==u) for u in pd.Series(a).unique()},{val: np.where(a==val)[0] for val in np.unique(a)},35.6,58
48528492,answer,48528404,"python,numpy",codeblock,https://stackoverflow.com/questions/48528492,{u:np.flatnonzero(a==u) for u in pd.Series(a).unique()},{val: np.where(a==val)[0] for val in np.unique(a)},25.3,44.9
48537227,answer,48534242,"python,performance,numpy,multidimensional-array,dot-product",codeblock,https://stackoverflow.com/questions/48537227,"np.dot(a.transpose(2,1,0).reshape(50,-1), b.reshape(-1,20))","np.dot(a.transpose(2,0,1).reshape(50,-1), b.transpose(1,0,2).reshape(-1,20))",2.99,4.39
48556595,answer,48555747,"python,arrays,numpy",sentence,"as you can see, np.array().T method is about 5 times faster than the np.column_stack().",np.array().T,np.column_stack(),,
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,df[cols] = np.array([s1.values]*len(cols)).transpose(),"df[cols] = np.broadcast_to(s1.values[:, np.newaxis], (len(df),len(cols)))",175,202
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,"df[cols] = pd.concat([s1] * len(cols), axis=1)","df[cols] = np.repeat(s1.values[:, np.newaxis], len(cols), axis=1)",53.8,208
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,df[cols] = np.array([s1.values]*len(cols)).transpose(),"df[cols] = np.repeat(s1.values[:, np.newaxis], len(cols), axis=1)",175,208
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,"df[cols] = pd.concat([s1] * len(cols), axis=1)","df[cols] = np.broadcast_to(s1.values[:, np.newaxis], (len(df),len(cols)))",53.8,202
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,"df[cols] = pd.concat([s1] * len(cols), axis=1)",df[cols] = np.array([s1.values]*len(cols)).transpose(),53.8,175
48561726,answer,48560775,pandas,codeblock,https://stackoverflow.com/questions/48561726,"df[cols] = np.broadcast_to(s1.values[:, np.newaxis], (len(df),len(cols)))","df[cols] = np.repeat(s1.values[:, np.newaxis], len(cols), axis=1)",202,208
48671315,answer,48671175,"python,numpy,matrix,numpy-broadcasting,dot-product",codeblock,https://stackoverflow.com/questions/48671315,"np.einsum('ijk,ik->ij',a,b, optimize=False)","np.einsum('ijk,ik->ij',a,b, optimize=True)",0.00566,0.073
48672380,answer,48671309,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/48672380,pd.Series(B).groupby(A).mean(),"pd.DataFrame(list(zip(A, B))).groupby(0).mean()",1.07,2.38
48672380,answer,48671309,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/48672380,pd.Series(B).groupby(A).mean(),"pd.DataFrame({'A': A, 'B': B}).groupby('A').mean()",1.07,2.66
48672380,answer,48671309,"python,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/48672380,"pd.DataFrame(list(zip(A, B))).groupby(0).mean()","pd.DataFrame({'A': A, 'B': B}).groupby('A').mean()",2.38,2.66
48673121,answer,48672540,"python,pandas,dataframe,intervals",codeblock,https://stackoverflow.com/questions/48673121,"df[df['Dates'].between(inter.left, inter.right, inclusive=True)]","df.query(""@inter.left <= Dates < @inter.right"")",3.96,9.1
48673121,answer,48672540,"python,pandas,dataframe,intervals",codeblock,https://stackoverflow.com/questions/48673121,"df[df['Dates'].between(inter.left, inter.right, inclusive=True)]",df.loc[df['Dates'].apply(lambda x: x in inter) == True],3.96,1540
48673121,answer,48672540,"python,pandas,dataframe,intervals",codeblock,https://stackoverflow.com/questions/48673121,"df.query(""@inter.left <= Dates < @inter.right"")",df.loc[df['Dates'].apply(lambda x: x in inter) == True],9.1,1540
48702981,answer,48702846,"python,pandas",codeblock,https://stackoverflow.com/questions/48702981,"pd.DataFrame(np.roll(x, 2, axis=1), columns = x.columns)","x.fillna(0).astype(int).shift(2, axis=1)",0.117,0.418
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,(df.iloc[df['experiment_a'].combine_first(df['experiment_b']).argsort()]),"(df.iloc[df.experiment_a.where(df.experiment_a.notnull(), df.experiment_b).argsort()])",333,342
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,(df.iloc[df['experiment_a'].fillna(df['experiment_b']).argsort()]),"(df.iloc[df.experiment_a.where(df.experiment_a.notnull(), df.experiment_b).argsort()])",335,342
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,(df.iloc[df['experiment_a'].combine_first(df['experiment_b']).argsort()]),(df.iloc[df['experiment_a'].fillna(df['experiment_b']).argsort()]),333,335
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,"(df.iloc[(np.where(df['experiment_a'].isnull(), df['experiment_b'], df['experiment_a'])).argsort()])","(df.iloc[df.experiment_a.where(df.experiment_a.notnull(), df.experiment_b).argsort()])",318,342
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,"(df.iloc[(np.where(df['experiment_a'].isnull(), df['experiment_b'], df['experiment_a'])).argsort()])",(df.iloc[df['experiment_a'].combine_first(df['experiment_b']).argsort()]),318,333
48705058,answer,48704922,"python,pandas",codeblock,https://stackoverflow.com/questions/48705058,"(df.iloc[(np.where(df['experiment_a'].isnull(), df['experiment_b'], df['experiment_a'])).argsort()])",(df.iloc[df['experiment_a'].fillna(df['experiment_b']).argsort()]),318,335
48717353,answer,42012339,"python,pandas,indexing,dataframe,series",codeblock,https://stackoverflow.com/questions/48717353,df['1st'].update(df['1st'].map(idxDict)),"df['1st'].replace(idxDict, inplace=True)",7.95,12.8
48727319,answer,48727096,"python,numpy,matrix,scipy,numpy-einsum",codeblock,https://stackoverflow.com/questions/48727319,"np.einsum('bdc,ac->abd', a, b,optimize=False)","np.einsum('bdc,ac->abd', a, b,optimize=True)",0.0731,0.207
48736776,answer,48736176,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/48736776,"np.sum(x*y, axis=0)",np.diag(x.T.dot(y)),0.0384,6.57
48736776,answer,48736176,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/48736776,"for i in range(len(x.T)): x[:, i].dot(y[:, i].T)",np.diag(x.T.dot(y)),1.01,6.57
48736776,answer,48736176,"python,numpy,matrix",codeblock,https://stackoverflow.com/questions/48736776,"np.sum(x*y, axis=0)","for i in range(len(x.T)): x[:, i].dot(y[:, i].T)",0.0384,1.01
48783805,answer,48783650,"python,pandas",codeblock,https://stackoverflow.com/questions/48783805,pd.DataFrame({'a': pd.Series([str(i).zfill(11) for i in concat(lst)])}),"pd.DataFrame(lst, columns=['a'])['a'].astype(str).str.zfill(11)",2060,7880
48805075,answer,48804698,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/48805075,"np.hstack((A, np.broadcast_to(A[:, -1][:, None], (A.shape[1], n))))","np.repeat(A, [1]*(A.shape[1]-1) +[n], axis=1)",3.06,12.9
48805075,answer,48804698,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/48805075,"np.hstack((A, np.tile(A[:, [-1]], n)))","np.repeat(A, [1]*(A.shape[1]-1) +[n], axis=1)",9.33,12.9
48805075,answer,48804698,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/48805075,"np.hstack((A, np.broadcast_to(A[:, -1][:, None], (A.shape[1], n))))","np.hstack((A, np.tile(A[:, [-1]], n)))",3.06,9.33
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.loc[df.col3 == 1, 'col3'] = df.col2","df.apply(lambda x: x['col2'] if x['col3']==1 else x, axis=1)",6.81,3390
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = df.col3.where(df.col3 != 1, df.col2)","df.apply(lambda x: x['col2'] if x['col3']==1 else x, axis=1)",4.8,3390
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = df.col3.mask(df.col3 == 1, df.col2)","df.apply(lambda x: x['col2'] if x['col3']==1 else x, axis=1)",4.95,3390
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = df.col3.where(df.col3 != 1, df.col2)","df.col3 = df.col3.mask(df.col3 == 1, df.col2)",4.8,4.95
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = df.col3.where(df.col3 != 1, df.col2)","df.loc[df.col3 == 1, 'col3'] = df.col2",4.8,6.81
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = np.where(df.col3 == 1, df.col2, df.col3)","df.apply(lambda x: x['col2'] if x['col3']==1 else x, axis=1)",3.97,3390
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = df.col3.mask(df.col3 == 1, df.col2)","df.loc[df.col3 == 1, 'col3'] = df.col2",4.95,6.81
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = np.where(df.col3 == 1, df.col2, df.col3)","df.col3 = df.col3.mask(df.col3 == 1, df.col2)",3.97,4.95
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = np.where(df.col3 == 1, df.col2, df.col3)","df.loc[df.col3 == 1, 'col3'] = df.col2",3.97,6.81
48821045,answer,48820989,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/48821045,"df.col3 = np.where(df.col3 == 1, df.col2, df.col3)","df.col3 = df.col3.where(df.col3 != 1, df.col2)",3.97,4.8
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.array(s.tolist())),(np.array(s.values.tolist())),19.6,19.7
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.vstack(s.values)),(np.array(s.tolist())),0.0557,0.0626
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.array(s.values.tolist())),(np.array(s.tolist())),0.0498,0.0626
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.array(s.values.tolist())),(np.vstack(s.values)),19.7,107
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.array(s.tolist())),(np.vstack(s.values)),19.6,107
48823420,answer,48823400,"python,pandas",codeblock,https://stackoverflow.com/questions/48823420,(np.array(s.values.tolist())),(np.vstack(s.values)),0.0498,0.0557
48824899,answer,48824807,"python,numpy",codeblock,https://stackoverflow.com/questions/48824899,"np.stack((a[:-1], a[1:]), axis=1)","a[[(i-1,i) for i in range(1,a.shape[0])],:]",6.8,127
48849668,answer,48849632,"python,pandas",codeblock,https://stackoverflow.com/questions/48849668,pd.Series([item for sublist in s.str.split() for item in sublist]),np.concatenate(s.str.split().values),27.5,88.2
48849668,answer,48849632,"python,pandas",codeblock,https://stackoverflow.com/questions/48849668,pd.Series(' '.join(s).split()),pd.Series(s.str.cat(sep=' ').split()),7.33,8.93
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,df['B'] = df.B.where(df.A.notnull()),"df.loc[df.A.isnull(), 'B'] = np.nan",1.04,2.88
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,"df['B'] = np.where(df.A.isnull(), np.nan, df.B)",df['B'] = df.B.mask(df.A.isnull()),0.405,3.54
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,"df.loc[df.A.isnull(), 'B'] = np.nan",df['B'] = df.B.mask(df.A.isnull()),2.88,3.54
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,df['B'] = df.B.where(df.A.notnull()),df['B'] = df.B.mask(df.A.isnull()),1.04,3.54
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,"df['B'] = np.where(df.A.isnull(), np.nan, df.B)",df['B'] = df.B.where(df.A.notnull()),0.405,1.04
48880667,answer,48880634,"python,pandas",codeblock,https://stackoverflow.com/questions/48880667,"df['B'] = np.where(df.A.isnull(), np.nan, df.B)","df.loc[df.A.isnull(), 'B'] = np.nan",0.405,2.88
48887382,answer,48886886,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/48887382,df['description'].map(multiple_replace),"df['description'].replace(rep_dict, regex=True)",72.8,88.6
48904546,answer,48904456,"python-3.x,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48904546,df.max(level = 0),df.groupby(level = 0).max(),19.5,24
48904546,answer,48904456,"python-3.x,performance,pandas,dataframe",codeblock,https://stackoverflow.com/questions/48904546,df.max(level = 0),df.groupby(level = 0).max(),8.04,8.08
48922391,answer,48921783,"python,arrays,python-2.7,numpy,vectorization",codeblock,https://stackoverflow.com/questions/48922391,"np.take(X, indx, axis=1)","X[:,indx]",22.9,69.9
48931044,answer,48918639,"python,string,pandas,dataframe,condition",sentence,itertuples() is claimed to be faster for iterating over all rows than iterrows().,itertuples(),iterrows(),,
48998049,answer,48997698,"python,arrays,numpy,optimization,indexing",codeblock,https://stackoverflow.com/questions/48998049,"X[np.arange(len(ixs)), ixs.T].T","np.array([row[ix] for row, ix in zip(X, ixs)])",0.596,11.4
48998049,answer,48997698,"python,arrays,numpy,optimization,indexing",codeblock,https://stackoverflow.com/questions/48998049,"np.array([row[ix] for row, ix in zip(X, ixs)])","X[np.arange(len(ixs)), ixs.T].T",93,133
48998049,answer,48997698,"python,arrays,numpy,optimization,indexing",codeblock,https://stackoverflow.com/questions/48998049,"np.array([row[ix] for row, ix in zip(X, ixs)])","np.fromiter((X[i, j] for i, row in enumerate(ixs) for j in row), dtype=X.dtype, count=ixs.size).reshape(ixs.shape)",0.928,1.42
48998049,answer,48997698,"python,arrays,numpy,optimization,indexing",codeblock,https://stackoverflow.com/questions/48998049,"X[np.arange(len(ixs)), ixs.T].T","np.fromiter((X[i, j] for i, row in enumerate(ixs) for j in row), dtype=X.dtype, count=ixs.size).reshape(ixs.shape)",0.0236,1.42
48998049,answer,48997698,"python,arrays,numpy,optimization,indexing",codeblock,https://stackoverflow.com/questions/48998049,"X[np.arange(len(ixs)), ixs.T].T","np.array([row[ix] for row, ix in zip(X, ixs)])",0.0236,0.928
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)","df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",210,326
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,"df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)","(df != '').astype(int).astype(str).apply(''.join, axis=1)",326,330
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)","(df != '').astype(int).astype(str).apply(''.join, axis=1)",210,330
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,(df != '').astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)",158,210
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,df.astype(bool).astype(int).astype(str).values.sum(axis=1),(df != '').astype(int).astype(str).values.sum(axis=1),155,158
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,(df != '').astype(int).astype(str).values.sum(axis=1),"(df != '').astype(int).astype(str).apply(''.join, axis=1)",158,330
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)",155,210
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",155,326
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"(df != '').astype(int).astype(str).apply(''.join, axis=1)",155,330
49003187,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49003187,(df != '').astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",158,326
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"np.append(np.where(df != """", ""1"", ""0"").astype(""S1""), np.array([[""\n""]]).astype(""S1"").repeat(df.shape[0], axis=0), axis=1).tostring().decode(""utf-8"")[:-1].split(""\n"")","np.apply_along_axis(lambda x: x.tostring().decode(""utf-8""), 1, np.where(df != """", ""1"", ""0"").astype(""S1""))",12.3,45
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"np.append(np.where(df != """", ""1"", ""0"").astype(""S1""), np.array([[""\n""]]).astype(""S1"").repeat(df.shape[0], axis=0), axis=1).tostring().decode(""utf-8"")[:-1].split(""\n"")","np.ascontiguousarray(np.where(df != """", ""1"", ""0"").astype(""S1"")).view('|S5').astype(str)",12.3,12.8
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,df.astype(bool).astype(int).astype(str).values.sum(axis=1),(df != '').astype(int).astype(str).values.sum(axis=1),28.9,29
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"np.ascontiguousarray(np.where(df != """", ""1"", ""0"").astype(""S1"")).view('|S5').astype(str)","np.apply_along_axis(lambda x: x.tostring().decode(""utf-8""), 1, np.where(df != """", ""1"", ""0"").astype(""S1""))",12.8,45
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",28.9,173
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)",28.9,159
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,(df != '').astype(int).astype(str).values.sum(axis=1),"(df != '').astype(int).astype(str).apply(''.join, axis=1)",29,168
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,(df != '').astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",29,173
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,(df != '').astype(int).astype(str).values.sum(axis=1),"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)",29,159
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"(df != '').astype(int).astype(str).apply(''.join, axis=1)","df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",168,173
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)","(df != '').astype(int).astype(str).apply(''.join, axis=1)",159,168
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,"df.astype(bool).astype(int).apply(lambda row: ''.join(str(i) for i in row), axis=1)","df.astype(bool).astype(int).astype(str).apply(''.join, axis=1)",159,173
49004036,answer,49003150,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49004036,df.astype(bool).astype(int).astype(str).values.sum(axis=1),"(df != '').astype(int).astype(str).apply(''.join, axis=1)",28.9,168
49008826,answer,49008763,"python,performance,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/49008826,df['distance1'] = pd.Series(df.index).groupby(df['group']).diff(-1).abs(),"df['distance'] = df.groupby('group').transform(lambda x: np.concatenate([np.diff(x.index), np.array([np.nan])]))",200,1740
49008826,answer,49008763,"python,performance,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/49008826,df['distance2'] = df.reset_index().groupby('group')['index'].diff(-1).abs(),"df['distance'] = df.groupby('group').transform(lambda x: np.concatenate([np.diff(x.index), np.array([np.nan])]))",201,1740
49008826,answer,49008763,"python,performance,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/49008826,df['distance1'] = pd.Series(df.index).groupby(df['group']).diff(-1).abs(),df['distance2'] = df.reset_index().groupby('group')['index'].diff(-1).abs(),200,201
49010379,answer,49010052,"python,pandas,categorical-data",codeblock,https://stackoverflow.com/questions/49010379,"(pd.DataFrame(df.columns.values[np.where(df)[1].reshape(-1, 3)]).add_prefix('cat'))","(pd.DataFrame(df.apply(lambda row: [x for x in df.columns if row[x]], axis=1).values.tolist()))",0.503,111
49033342,answer,49033311,"python,pandas",codeblock,https://stackoverflow.com/questions/49033342,df['year'].astype(str) + df['month'].astype(str).str.zfill(2),"pd.to_datetime(df.assign(day=1)).dt.strftime(""%Y%m"")",41.3,74.1
49035273,answer,25254016,"python,pandas,indexing,head",codeblock,https://stackoverflow.com/questions/49035273,df['Btime'].values[20],df['Btime'].iloc[20],0.00582,0.0292
49037210,answer,49036715,"python,numpy",codeblock,https://stackoverflow.com/questions/49037210,"new_array = np.concatenate((rand_data[:,[22]],rand_data[:, 24:27





]), axis = 1)","arr = rand_data[:,np.r_[22,24:26]]",0.015,0.0297
49057014,answer,49053252,"python,pandas,numpy,dataframe,apply",codeblock,https://stackoverflow.com/questions/49057014,"x.apply(lambda row: get_new2(row), axis=1)","x.apply(lambda row: get_new(row), axis=1)",119,159
49077066,answer,49076857,"python,python-3.x,loops,numpy",codeblock,https://stackoverflow.com/questions/49077066,"np.random.randint(97, 123, (100, 100, 100), dtype=np.uint8).view('S1')","np.random.choice(list(string.ascii_lowercase),  size=(100, 100, 100))",5.06,9.99
49077066,answer,49076857,"python,python-3.x,loops,numpy",codeblock,https://stackoverflow.com/questions/49077066,"np.random.randint(97, 123, (10, 100, 100), dtype=np.uint8).view('S1')","np.random.choice(list(string.ascii_lowercase),  size=(10, 100, 100))",0.503,0.993
49077066,answer,49076857,"python,python-3.x,loops,numpy",codeblock,https://stackoverflow.com/questions/49077066,"np.random.randint(97, 123, (10, 100, 10), dtype=np.uint8).view('S1')","np.random.choice(list(string.ascii_lowercase),  size=(10, 100, 10))",0.0534,0.116
49077066,answer,49076857,"python,python-3.x,loops,numpy",codeblock,https://stackoverflow.com/questions/49077066,"np.random.randint(97, 123, (10, 10, 10), dtype=np.uint8).view('S1')","np.random.choice(list(string.ascii_lowercase),  size=(10, 10, 10))",0.00745,0.0248
49084752,answer,49084687,"python,pandas",codeblock,https://stackoverflow.com/questions/49084752,"df[""B3""] = np.ceil(df[""A""].astype(float).div(5.0)).mul(5)","df[""B2""] = df[""A""].astype(float).div(5.0).apply(np.ceil).mul(5)",1.19,1.25
49084752,answer,49084687,"python,pandas",codeblock,https://stackoverflow.com/questions/49084752,"df[""B3""] = np.ceil(df[""A""].astype(float).div(5.0)).mul(5)","df[""B1""] = df[""A""].apply(roundup5)",1.19,35.7
49084752,answer,49084687,"python,pandas",codeblock,https://stackoverflow.com/questions/49084752,"df[""B2""] = df[""A""].astype(float).div(5.0).apply(np.ceil).mul(5)","df[""B1""] = df[""A""].apply(roundup5)",1.25,35.7
49093858,answer,49093781,"python,pandas,dask",codeblock,https://stackoverflow.com/questions/49093858,"[""%06d"" % t for t in df['time'].tolist()]",df.time.astype(str).str.zfill(6),0.0175,0.228
49100451,answer,49100244,"python,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/49100451,"np.array([a*b,b,c]).dot(xx[...,0])[:,None]","(xx *np.array([a*b,b,c])[:,None,None]).sum(0)",0.00151,0.00444
49101277,answer,49101113,"python,pandas,dataframe,tuples",codeblock,https://stackoverflow.com/questions/49101277,"df.apply(tuple, axis=1)","df.apply(lambda x: (x.A,x.B), axis=1)",378,577
49168978,answer,49168941,"python,string,pandas",codeblock,https://stackoverflow.com/questions/49168978,"df['difference'] = [i.replace(j, '') for i, j in zip(df.raw, df.preprocessed)]","df['difference'] = df.apply(lambda x: x.raw.replace(x.preprocessed, ''), 1)",186,20800
49191412,answer,49191369,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/49191412,(Top15['% Renewable'] >= Top15['% Renewable'].median(axis=0)).astype(int),"Top15.apply(func,axis=1)",0.346,595
49259581,answer,49259580,"python,python-3.x,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/49259581,df['A'].replace(d),"[d.get(i, i) for i in lst]",20.1,243
49259581,answer,49259580,"python,python-3.x,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/49259581,df['A'].map(d).fillna(df['A']).astype(int),"[d.get(i, i) for i in lst]",111,243
49259581,answer,49259580,"python,python-3.x,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/49259581,df['A'].map(d),df['A'].replace(d),84.3,1980
49259581,answer,49259580,"python,python-3.x,pandas,dictionary,dataframe",codeblock,https://stackoverflow.com/questions/49259581,df['A'].replace(d),df['A'].map(d).fillna(df['A']).astype(int),20.1,111
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.vstack((X, y)).T","np.array(list(map(lambda i: [X[i],y[i]], range(len(X)))))",0.0142,6.64
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.transpose([X,y])","np.array(list(map(lambda i: [X[i],y[i]], range(len(X)))))",0.0162,6.64
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.column_stack((X,y))","np.array(list(map(lambda i: [X[i],y[i]], range(len(X)))))",0.0192,6.64
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.array(list(zip(X, y)))","np.array(list(map(lambda i: [X[i],y[i]], range(len(X)))))",4.53,6.64
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.transpose([X,y])","np.column_stack((X,y))",0.0162,0.0192
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.column_stack((X,y))","np.array(list(zip(X, y)))",0.0192,4.53
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.vstack((X, y)).T","np.column_stack((X,y))",0.0142,0.0192
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.vstack((X, y)).T","np.transpose([X,y])",0.0142,0.0162
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.vstack((X, y)).T","np.array(list(zip(X, y)))",0.0142,4.53
49322564,answer,49322017,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49322564,"np.transpose([X,y])","np.array(list(zip(X, y)))",0.0162,4.53
49358592,answer,49358558,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/49358592,df_obctohdfc['balance_dt_flag1'] = (df_obctohdfc['balance_dt'] > timestamp).astype(int),"df_obctohdfc['balance_dt_flag2'] = df_obctohdfc.apply(f,axis=1)",0.368,91.2
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.values.astype(str),x.map(str),31,44
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.map(str),x.astype(str),44,562
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.apply(str),x.map(str),43,44
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.apply(str),x.astype(str),43,562
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.values.astype(str),x.astype(str),31,562
49375038,answer,49371629,"python,string,performance,pandas,python-internals",codeblock,https://stackoverflow.com/questions/49375038,x.values.astype(str),x.apply(str),31,43
49390385,answer,49386827,"python,arrays,numpy,multiplication",codeblock,https://stackoverflow.com/questions/49390385,"np.dot(np.array([[1],[2]]),np.array([[2,3]]))","np.dot(np.array([[1],[2]],object),np.array([[2,3]]))",0.0073,0.012
49425068,answer,49424084,"python,pandas",sentence,"first create a dictionary via df.itertuples [more efficient than df.iterrows], then use str.format to include the values seamlessly.",df.itertuples,df.iterrows,,
49439144,answer,49439103,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/49439144,"np.take(df.columns, np.argsort(df)).tolist()","df.apply(blist,axis=1)",5.45,4840
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"B.T.dot(A.swapaxes(0,1).reshape(n,-1)).reshape(n,n,-1).swapaxes(0,1)","np.tensordot(A,B,axes=(1,0)).swapaxes(1,2)",0.951,1.09
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"A.swapaxes(1,2).reshape(-1,n).dot(B).reshape(n,-1,n).swapaxes(1,2)","np.tensordot(A,B,axes=(1,0)).swapaxes(1,2)",1.03,1.09
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"B.T.dot(A.swapaxes(0,1).reshape(n,-1)).reshape(n,n,-1).swapaxes(0,1)","np.einsum('ijk,jl->ilk', A, B,optimize=True)",0.951,1.17
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"A.swapaxes(1,2).reshape(-1,n).dot(B).reshape(n,-1,n).swapaxes(1,2)","np.einsum('ijk,jl->ilk', A, B,optimize=True)",1.03,1.17
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"B.T.dot(A.swapaxes(0,1).reshape(n,-1)).reshape(n,n,-1).swapaxes(0,1)","A.swapaxes(1,2).reshape(-1,n).dot(B).reshape(n,-1,n).swapaxes(1,2)",0.951,1.03
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"B.T.dot(A.swapaxes(0,1).reshape(n,-1)).reshape(n,n,-1).swapaxes(0,1)","(A.transpose(2,0,1) @ B).transpose(1,2,0)",0.951,10.7
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"A.swapaxes(1,2).reshape(-1,n).dot(B).reshape(n,-1,n).swapaxes(1,2)","(A.transpose(2,0,1) @ B).transpose(1,2,0)",1.03,10.7
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.tensordot(A,B,axes=(1,0)).swapaxes(1,2)","(A.transpose(2,0,1) @ B).transpose(1,2,0)",1.09,10.7
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.einsum('ijk,jl->ilk', A, B,optimize=True)","(A.transpose(2,0,1) @ B).transpose(1,2,0)",1.17,10.7
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"B.T.dot(A.swapaxes(0,1).reshape(n,-1)).reshape(n,n,-1).swapaxes(0,1)","np.einsum('ijk,jl->ilk', A, B)",0.951,10.2
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.einsum('ijk,jl->ilk', A, B)","(A.transpose(2,0,1) @ B).transpose(1,2,0)",10.2,10.7
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.einsum('ijk,jl->ilk', A, B,optimize=True)","np.einsum('ijk,jl->ilk', A, B)",1.17,10.2
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.tensordot(A,B,axes=(1,0)).swapaxes(1,2)","np.einsum('ijk,jl->ilk', A, B)",1.09,10.2
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"np.tensordot(A,B,axes=(1,0)).swapaxes(1,2)","np.einsum('ijk,jl->ilk', A, B,optimize=True)",1.09,1.17
49480196,answer,49479897,"python,numpy,linear-algebra",codeblock,https://stackoverflow.com/questions/49480196,"A.swapaxes(1,2).reshape(-1,n).dot(B).reshape(n,-1,n).swapaxes(1,2)","np.einsum('ijk,jl->ilk', A, B)",1.03,10.2
49480608,answer,49480591,"python,pandas,dataframe",sentence,"note; map is magnitudes of order faster than replace, but both of them work the same.",map,replace,,
49520758,answer,49520629,"python,numpy",codeblock,https://stackoverflow.com/questions/49520758,"np.array([t.sum() for t in np.array_split(L, b)])","np.add.reduceat(L, np.linspace(0.5, L.size+0.5, b, False, dtype=int))",6.45,6.51
49521648,answer,49520629,"python,numpy",codeblock,https://stackoverflow.com/questions/49521648,"np.add.reduceat(L, np.linspace(0.5, L.size+0.5, b, False, dtype=int))","array([t.sum() for t in array_split(L, b)])",0.0159,0.26
49521648,answer,49520629,"python,numpy",codeblock,https://stackoverflow.com/questions/49521648,"np.add.reduceat(L, np.linspace(0.5, L.size+0.5, b, False, dtype=int))","array([t.sum() for t in array_split(L, b)])",0.015,0.0162
49532576,answer,49532575,"python,numpy",codeblock,https://stackoverflow.com/questions/49532576,np.tril(M2_strided(a)),np.tril(M2_indexing(a)),0.134,0.259
49532576,answer,49532575,"python,numpy",codeblock,https://stackoverflow.com/questions/49532576,np.tril(M2_strided(a)),np.tril(M2_simple(a)),0.134,0.792
49532576,answer,49532575,"python,numpy",codeblock,https://stackoverflow.com/questions/49532576,np.tril(M2_indexing(a)),np.tril(M2_simple(a)),0.259,0.792
49565215,answer,49565108,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/49565215,"df_.groupby('A', sort=False)['B'].unique().apply(list).tolist()","df_.groupby('A', sort=False)['B'].apply(list).tolist()",5.9,6.79
49574541,answer,49574502,"python-3.x,pandas,scikit-learn,sklearn-pandas",codeblock,https://stackoverflow.com/questions/49574541,"train.loc[~train['MSZoning'].isin(['RM','RL']), 'MSZoning'] =  'Others'","train['MSZoning'] = train['MSZoning'].apply(lambda x: x if x in ('RM', 'RL') else 'Others')",5.82,15
49603263,answer,49603221,"python,arrays,performance,numpy",codeblock,https://stackoverflow.com/questions/49603263,"np.zeros((10, 10))","np.zeros([10, 10])",0.000447,0.000491
49639025,answer,49638955,"python,pandas",codeblock,https://stackoverflow.com/questions/49639025,df.loc[(df['C']>=37).groupby(level='A').transform('all')],df.groupby(level='A').filter(lambda x: (x['C']>=5).all()),18.9,46.3
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,df.mask(df > 100),df[df<100],1.56,1.89
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,df.mask(df > 100),df.where(df <= 100),1.56,1.84
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"df[:] = np.where(df.values <= 100, df.values, np.nan)",df[df<100],0.957,1.89
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"pd.DataFrame(np.where(df > 100, np.nan, df), index=df.index, columns=df.columns)",df[df<100],0.683,1.89
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"df[:] = np.where(df.values <= 100, df.values, np.nan)",df.mask(df > 100),0.957,1.56
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"pd.DataFrame(np.where(df > 100, np.nan, df), index=df.index, columns=df.columns)","df[:] = np.where(df.values <= 100, df.values, np.nan)",0.683,0.957
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"pd.DataFrame(np.where(df > 100, np.nan, df), index=df.index, columns=df.columns)",df.mask(df > 100),0.683,1.56
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"pd.DataFrame(np.where(df > 100, np.nan, df), index=df.index, columns=df.columns)",df.where(df <= 100),0.683,1.84
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,"df[:] = np.where(df.values <= 100, df.values, np.nan)",df.where(df <= 100),0.957,1.84
49667042,answer,49667026,"python,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/49667042,df.where(df <= 100),df[df<100],1.84,1.89
49678710,answer,49678663,"python,pandas,dataframe,group-by",codeblock,https://stackoverflow.com/questions/49678710,df_test['time']-df_test.groupby('group')['time'].transform(min),df_test.groupby('group')['time'].transform(lambda d: d - d.min()),1.11,2.3
49697820,answer,49697577,"python,arrays,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/49697820,"{i for i in A if np.isclose(B, i, 0.1).any()}","{x for x in A for y in B if np.isclose(x, y, atol=0.1)}",0.276,1.08
49706677,answer,49702440,"python,pandas,dataframe,rounding",codeblock,https://stackoverflow.com/questions/49706677,df['New1'] = np.floor(df['High'].values * 10 ** N) / 10 ** N,df['New1'] = df['High'].map(truncate),0.22,8.27
49712760,answer,49712577,"python,pandas",codeblock,https://stackoverflow.com/questions/49712760,"pd.Series(map(frozenset,zip(df['from'],df['to']))).value_counts()","df.apply(np.sort, axis=1).groupby(['from','to']).size()",0.845,3.45
49714021,answer,49713998,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/49714021,df['A'].astype(int).map(str),"df['A'].str.replace('^0+', '')",21.6,77.2
49714038,answer,49713998,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/49714038,"df_ZIPCOUNTY_CA['county code'].str.replace('^0+', '')",df_ZIPCOUNTY_CA['county code'].astype(int).astype(str),37.1,70.8
49714038,answer,49713998,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/49714038,df_ZIPCOUNTY_CA['county code'].str.lstrip('0'),df_ZIPCOUNTY_CA['county code'].astype(int).map(str),8.9,13.3
49718891,answer,49718603,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/49718891,"test[selectMe, ...].ravel()","test[np.repeat(selectMe[:, None], 100, axis=1)]",0.0116,0.103
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.tile(df.columns, len(df)), 'b':df.values.ravel()})",df.unstack().swaplevel().sort_index(),12.6,156
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.tile(df.columns, len(df)), 'b':df.values.ravel()})","df.stack().reset_index(level=0, drop=True).rename_axis('a').reset_index(name='b')",12.6,27.8
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.tile(df.columns, len(df)), 'b':df.values.ravel()})","df.reset_index().melt(id_vars='index', var_name='product', value_name='sales')",12.6,18
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.repeat(df.columns, len(df)), 'b':df.values.T.ravel()})","pd.DataFrame({'a':np.tile(df.columns, len(df)), 'b':df.values.ravel()})",10.8,12.6
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.repeat(df.columns, len(df)), 'b':df.values.T.ravel()})",df.unstack().swaplevel().sort_index(),10.8,156
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"df.reset_index().melt(id_vars='index', var_name='product', value_name='sales')","df.stack().reset_index(level=0, drop=True).rename_axis('a').reset_index(name='b')",18,27.8
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"df.reset_index().melt(id_vars='index', var_name='product', value_name='sales')",df.unstack().swaplevel().sort_index(),18,156
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"df.stack().reset_index(level=0, drop=True).rename_axis('a').reset_index(name='b')",df.unstack().swaplevel().sort_index(),27.8,156
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.repeat(df.columns, len(df)), 'b':df.values.T.ravel()})","df.stack().reset_index(level=0, drop=True).rename_axis('a').reset_index(name='b')",10.8,27.8
49750123,answer,49750087,"python,pandas",codeblock,https://stackoverflow.com/questions/49750123,"pd.DataFrame({'a':np.repeat(df.columns, len(df)), 'b':df.values.T.ravel()})","df.reset_index().melt(id_vars='index', var_name='product', value_name='sales')",10.8,18
49815035,answer,49814881,"python,python-3.x,pandas,sorting,numpy",codeblock,https://stackoverflow.com/questions/49815035,"pd.Series(-np.sort(-tfidfmax),index=np.sort(tfidfmax.index))","tfidfmax[np.lexsort((tfidfmax.index, -tfidfmax.values))]",0.0912,0.104
49815035,answer,49814881,"python,python-3.x,pandas,sorting,numpy",codeblock,https://stackoverflow.com/questions/49815035,"pd.Series(-np.sort(-tfidfmax),index=np.sort(tfidfmax.index))","pd.Series(tfidfmax.sort_values(ascending=False),index=tfidfmax.sort_index().index)",0.0912,0.406
49815035,answer,49814881,"python,python-3.x,pandas,sorting,numpy",codeblock,https://stackoverflow.com/questions/49815035,"tfidfmax[np.lexsort((tfidfmax.index, -tfidfmax.values))]","pd.Series(tfidfmax.sort_values(ascending=False),index=tfidfmax.sort_index().index)",0.104,0.406
49830856,answer,49830069,"pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49830856,"df.loc[np.intersect1d(df.index, labels)]",df[df.index.isin(set(labels))],513,943
49830856,answer,49830069,"pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49830856,df.loc[df.index.intersection(set(labels))],"df.loc[np.intersect1d(df.index, labels)]",360,513
49830856,answer,49830069,"pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49830856,df.loc[df.index.intersection(set(labels))],df[df.index.isin(set(labels))],360,943
49863613,answer,49863401,"python,pandas,apply,duration,timedelta",codeblock,https://stackoverflow.com/questions/49863613,"pd.to_timedelta(df.Hours*3600 + df.Mins*60 + df.Secs, unit='s')","df.apply(lambda row: pd.Timedelta(hours=row.Hours, minutes=row.Mins, seconds=row.Secs), axis=1)",0.432,12
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T","numpy.add.outer(-X, X)",198.542,201.141
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)","numpy.subtract(*reversed(numpy.ix_(X, X)))",207.819,787.413
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T","numpy.add.outer(-X, X)",183.522,207.819
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)",X-np.c_[X],207.819,905.075
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T","numpy.subtract(*reversed(numpy.ix_(X, X)))",183.522,787.413
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.add.outer(-X, X)",172.939,207.819
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T",X-np.c_[X],183.522,905.075
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T","numpy.subtract(*reversed(numpy.ix_(X, X)))",198.542,206.002
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)","numpy.subtract(*reversed(numpy.ix_(X, X)))",201.141,206.002
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"X-X.reshape(-1,1)",196.646,201.627
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)",X-np.c_[X],201.627,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,X-np.c_[X],196.646,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)","numpy.subtract(*reversed(numpy.ix_(X, X)))",201.627,206.002
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.subtract(*reversed(numpy.ix_(X, X)))",196.646,206.002
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract(*reversed(numpy.ix_(X, X)))",X-np.c_[X],206.002,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T","X-X.reshape(-1,1)",198.542,201.627
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.subtract.outer(X, X).T",196.646,198.542
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T",X-np.c_[X],198.542,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)","X-X.reshape(-1,1)",201.141,201.627
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)","numpy.add.outer(-X, X)",165.208,207.819
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.add.outer(-X, X)",196.646,201.141
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)",X-np.atleast_2d(X).T,201.627,203.51
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.subtract.outer(X, X).T",172.939,183.522
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)","numpy.subtract.outer(X, X).T",165.208,183.522
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,X-np.c_[X],172.939,905.075
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)",X-np.c_[X],165.208,905.075
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)",X-np.c_[X],201.141,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)","numpy.subtract(*reversed(numpy.ix_(X, X)))",165.208,787.413
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,"numpy.subtract(*reversed(numpy.ix_(X, X)))",172.939,787.413
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.add.outer(-X, X)",X-np.atleast_2d(X).T,201.141,203.51
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract.outer(X, X).T",X-np.atleast_2d(X).T,198.542,203.51
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-np.atleast_2d(X).T,"numpy.subtract(*reversed(numpy.ix_(X, X)))",203.51,206.002
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-np.atleast_2d(X).T,X-np.c_[X],203.51,208.75
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,X-X[None].T,X-np.atleast_2d(X).T,196.646,203.51
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"X-X.reshape(-1,1)",X-X[None].T,165.208,172.939
49868943,answer,49868846,"python,arrays,numpy,matrix,indexing",codeblock,https://stackoverflow.com/questions/49868943,"numpy.subtract(*reversed(numpy.ix_(X, X)))",X-np.c_[X],787.413,905.075
49882983,answer,49880927,"python,performance,numpy,vectorization",codeblock,https://stackoverflow.com/questions/49882983,(len(b)-1-b.argsort(0).argsort(0))/float(n),"np.sum(b > b[:, None], axis=-2) / float(n)",17.6,349
49884403,answer,49879944,"python,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/49884403,MyArray[0].shape,"MyArray.take(0,axis=0).shape",0.000425,0.0106
49884403,answer,49879944,"python,performance,numpy,multidimensional-array",codeblock,https://stackoverflow.com/questions/49884403,MyArray[0].shape,"MyArray.take(0,axis=0).shape",0.000422,705
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,(ne(df)),df.query('A > 5'),494,781
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,(ne(df)),df[df.eval('A > 5')],494,770
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,df[df.A > 5],df.query('A > 5'),536,781
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,df[df.A > 5],df[df.eval('A > 5')],536,770
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,df[df.eval('A > 5')],df.query('A > 5'),770,781
49937318,answer,49936557,"python,performance,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/49937318,(ne(df)),df[df.A > 5],494,536
49973838,answer,49973811,"python,pandas,condition,multiple-conditions,fillna",codeblock,https://stackoverflow.com/questions/49973838,pd.Series(s.unique()).fillna(0).eq(0).all(),s.dropna().eq(0).all(),0.587,0.774
49973838,answer,49973811,"python,pandas,condition,multiple-conditions,fillna",codeblock,https://stackoverflow.com/questions/49973838,((s == 0) | (s.isna())).all(),s.dropna().eq(0).all(),0.574,0.774
49973838,answer,49973811,"python,pandas,condition,multiple-conditions,fillna",codeblock,https://stackoverflow.com/questions/49973838,((s == 0) | (s.isna())).all(),pd.Series(s.unique()).fillna(0).eq(0).all(),0.574,0.587
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0].tolist(),arr.view('f4'),0.00125,0.00174
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0].tolist(),arr[0].item(),0.00125,0.00127
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0],arr.view('f4'),0.000131,0.00174
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr.tolist(),arr[0].item(),0.000493,0.00127
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0],arr.tolist(),0.000131,0.000493
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0],arr[0].item(),0.000131,0.00127
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0],arr[0].tolist(),0.000131,0.00125
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0].item(),arr.view('f4'),0.00127,0.00174
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr.tolist(),arr.view('f4'),0.000493,0.00174
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr.tolist(),arr[0].tolist(),0.000493,0.00125
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0][None].view('f4'),arr[[0]].view('f4'),0.00428,0.00654
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0:1].view('f4'),arr[0][None].view('f4'),0.00263,0.00428
50032792,answer,50028309,"python,numpy,structured-array",codeblock,https://stackoverflow.com/questions/50032792,arr[0:1].view('f4'),arr[[0]].view('f4'),0.00263,0.00654
50128978,answer,50128934,"python,pandas",codeblock,https://stackoverflow.com/questions/50128978,"(pd.DataFrame(df['column1'].values.tolist(), index=df.index))",(df['column1'].apply(pd.Series)),10.1,1140
50146835,answer,50146555,"python,numpy,concatenation",codeblock,https://stackoverflow.com/questions/50146835,"np.concatenate((cat01[None], cat02[None]), 0)","np.array((cat01, cat02))",716.298,719.263
50146835,answer,50146555,"python,numpy,concatenation",codeblock,https://stackoverflow.com/questions/50146835,"np.concatenate((cat01[None], cat02[None]), 0)","np.stack((cat01, cat02))",716.298,1184.77
50146835,answer,50146555,"python,numpy,concatenation",codeblock,https://stackoverflow.com/questions/50146835,"np.array((cat01, cat02))","np.stack((cat01, cat02))",719.263,1184.77
50156014,answer,50156001,"python,performance,pandas,dataset",codeblock,https://stackoverflow.com/questions/50156014,(train.eval('tag == @label and word == @word').sum()),(((train['tag'] == label) & (train['word'] == word)).sum()),25.8,84.6
50187339,answer,50187032,"python,numpy",codeblock,https://stackoverflow.com/questions/50187339,np.argmax(x[::-1] != 1),np.argwhere(x[::-1] != 1).ravel()[0],117,631
50202149,answer,50201244,"python,numpy,3d,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/50202149,"D=np.einsum('ijklm,jklm->iklm',A,B)","E = (A.transpose(2,3,4,0,1)@B.transpose(1,2,3,0)[...,None])[...





,0].transpose(3,0,1,2)",0.066,0.0686
50202149,answer,50201244,"python,numpy,3d,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/50202149,"E = (A.transpose(2,3,4,0,1)@B.transpose(1,2,3,0)[...,None])[...





,0].transpose(3,0,1,2)","C=np.sum(A*B, axis=1)",0.0686,0.124
50202149,answer,50201244,"python,numpy,3d,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/50202149,"D=np.einsum('ijklm,jklm->iklm',A,B)","C=np.sum(A*B, axis=1)",0.066,0.124
50240780,answer,50240646,"python,pandas",sentence,"here are 2 ways: the first (with agg) is faster than the second (transform), but for the sake of having options....",agg,transform,,
50253193,answer,50249979,"python,pandas,indexing,series",codeblock,https://stackoverflow.com/questions/50253193,"l.reset_index(inplace=True, drop=True)",l.reset_index(drop=True),0.0137,22.6
50288681,answer,50288620,"python,pandas",codeblock,https://stackoverflow.com/questions/50288681,"df.mask(df.lt(df['threshold'], axis=0), 0)","df.iloc[:,1:] = df.iloc[:,1:].apply(lambda x: np.where(x > df.threshold, x, 0), axis=0)",380,449
50316673,answer,50316656,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/50316673,"df.columns = [x.replace('.','') for x in df.columns]","df.columns = df.columns.str.replace('.','')",2.53,4.4
50317201,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/50317201,"['/'.join(i) for i in zip(df['Host'],df['Protocol'],df['Port'].map(str))]","df['Host'] + ""/"" + df['Protocol'] + ""/"" + df['Port'].map(str)",35.9,39.7
50317201,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/50317201,"['/'.join(i) for i in zip(df['Host'],df['Protocol'],df['Port'].map(str))]","['/'.join(i) for i in df[['Host','Protocol','Port']].astype(str).values]",35.9,162
50317201,answer,19377969,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/50317201,"df['Host'] + ""/"" + df['Protocol'] + ""/"" + df['Port'].map(str)","['/'.join(i) for i in df[['Host','Protocol','Port']].astype(str).values]",39.7,162
50327762,answer,50327630,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/50327762,"np.where(df.index.weekday > 5, ""Weekend"", ""Weekday"")",df.index.to_series().apply(weekend),0.192,1.11
50375202,answer,50375110,"pandas,dataframe",codeblock,https://stackoverflow.com/questions/50375202,df['Classes'].map(tuple_to_dict),df['Classes'].apply(tuple_to_dict),39.2,41.2
50376135,answer,50375985,"python,pandas",codeblock,https://stackoverflow.com/questions/50376135,"np.where(df['salary']>=50, 'yes', 'no')","df['is_rich_method3'] = 'no'; df.loc[df['salary'] > 50,'is_rich_method3'] = 'yes'",0.907,7.67
50376135,answer,50375985,"python,pandas",codeblock,https://stackoverflow.com/questions/50376135,"np.where(df['salary']>=50, 'yes', 'no')","df['is_rich_method3'] = 'no'; df.loc[df['salary'] > 50,'is_rich_method3'] = 'yes'",0.281,2.26
50376349,answer,50376247,"python,pandas,dataframe",sentence,"you should find pd.Series.apply more efficient than pd.DataFrame.apply, as you are using only one series as an input.",pd.Series.apply,pd.DataFrame.apply,,
50389789,answer,50389697,"python,pandas",codeblock,https://stackoverflow.com/questions/50389789,"df.join(pd.DataFrame(df['col3'].apply(pd.io.json.loads).values.tolist(), index=df.index))",df.join(df['col3'].apply(lambda x: pd.Series(json.loads(x)))),76.4,11300
50393271,answer,50392879,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50393271,"st = np.where(np.ediff1d(a, a[-1] + 1, a[0] + 1))[0]; idx = st[:-1]; cnt = np.ediff1d(st)","_, idx_start, count = np.unique(a, return_index=True, return_counts=True)",0.0743,0.24
50394587,answer,50392879,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50394587,"st = np.where(np.ediff1d(a, a[-1] + 1, a[0] + 1))[0]; idx = st[:-1]; cnt = np.ediff1d(st)","_, idx_start, count = np.unique(a, return_index=True, return_counts=True)",0.0812,0.411
50394587,answer,50392879,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50394587,"st = np.where(np.ediff1d(a, a[-1] + 1, a[0] + 1))[0]; idx = st[:-1]; cnt = np.ediff1d(st)","_, idx_start, count = np.unique(a, return_index=True, return_counts=True)",0.792,5.34
50399219,answer,50328246,"python,pandas,dictionary,dataframe,counter",sentence,"a basic example of this pitfall that you might commonly see is using the built-in python sum on a numpy array: sum(np.arange(10**5)) is actually a bit slower than the pure python sum(range(10**5)), and both of which are of course significantly slower than np.sum(np.arange(10**5)).",sum(range(10**5)),sum(np.arange(10**5)),,
50420933,answer,50420721,"python,pandas",codeblock,https://stackoverflow.com/questions/50420933,df.timedelta.astype('timedelta64[m]'),df.timedelta.astype('timedelta64[s]').div(60),0.132,0.213
50420933,answer,50420721,"python,pandas",codeblock,https://stackoverflow.com/questions/50420933,df.timedelta.astype('timedelta64[m]'),df.timedelta.dt.total_seconds().div(60),0.132,0.215
50420933,answer,50420721,"python,pandas",codeblock,https://stackoverflow.com/questions/50420933,df.timedelta.astype('timedelta64[s]').div(60),df.timedelta.dt.total_seconds().div(60),0.213,0.215
50428721,answer,50428668,"python,arrays,numpy,vectorization",codeblock,https://stackoverflow.com/questions/50428721,"(arr[:,None]**np.arange(order+1)[:,None]).reshape(arr.shape[0],-1)","np.hstack(arr **np.arange(order+1)[:,None,None])",0.401,0.734
50433508,answer,50433473,"python,string,pandas",codeblock,https://stackoverflow.com/questions/50433508,df['mhc'].str[3:],"df['mhc'].str.replace(r'^HLA','')",35.9,162
50433508,answer,50433473,"python,string,pandas",codeblock,https://stackoverflow.com/questions/50433508,df['mhc'].str[3:],"df['mhc'].str.extract(r'HLA(.*)', expand=False)",35.9,164
50433508,answer,50433473,"python,string,pandas",codeblock,https://stackoverflow.com/questions/50433508,"df['mhc'].str.replace(r'^HLA','')","df['mhc'].str.extract(r'HLA(.*)', expand=False)",162,164
50457257,answer,50457003,"python,numpy,concatenation",sentence,list append is faster than concatenate:,append,concatenate,,
50507002,answer,50506897,"python,pandas",codeblock,https://stackoverflow.com/questions/50507002,(df[df['random'].ne(df['random'].shift()) | df['random'].ne(df['random'].shift(-1))]),df[(df['random'] != df['random'].shift()) | (df['random'] != df['random'].shift(-1))],1.16,1.28
50507574,answer,50507468,"pandas,parsing,datetime",codeblock,https://stackoverflow.com/questions/50507574,"df['dateTimeFormat2'] = pd.to_datetime(df['date'],format='%d/%m/%Y %H:%M')","df['dateTimeFormat1'] = pd.to_datetime(df['date'],dayfirst=True)",55,2940
50512537,answer,50512427,"python,pandas",codeblock,https://stackoverflow.com/questions/50512537,"df.apply(lambda x: x.drop_duplicates(), axis=1)","df.apply(pd.Series.drop_duplicates, axis=1)",435,443
50520335,answer,50519820,"python,numpy",codeblock,https://stackoverflow.com/questions/50520335,all(x == 0 for x in a),"np.all(np.equal(a, 0))",0.000615,24.2
50532664,answer,50532583,"python,numpy,numpy-ndarray",codeblock,https://stackoverflow.com/questions/50532664,np.array([x[0] for x in a]),"np.array(a)[:, 0, :]",41.1,57.6
50532664,answer,50532583,"python,numpy,numpy-ndarray",codeblock,https://stackoverflow.com/questions/50532664,np.array([x[0] for x in a]),"x = np.array(a); x.shape = len(a), 2",41.1,58.2
50532664,answer,50532583,"python,numpy,numpy-ndarray",codeblock,https://stackoverflow.com/questions/50532664,"np.array(a)[:, 0, :]","x = np.array(a); x.shape = len(a), 2",57.6,58.2
50535166,answer,50533797,"python,numpy",codeblock,https://stackoverflow.com/questions/50535166,"np.flatnonzero(a >= np.partition(a, len(a) - k)[len(a) - k])","np.sort(np.argpartition(a, len(a) - k)[len(a) - k:])",832.866,1057.78
50565051,answer,50564980,"string,pandas,for-loop,if-statement",codeblock,https://stackoverflow.com/questions/50565051,"df['Rating'] = np.select(m, [1,1,1], default=0)","df['Rating1']=df.apply(lambda row: label_race(row),axis=1)",0.215,275
50591644,answer,50591609,"python,pandas",codeblock,https://stackoverflow.com/questions/50591644,df['real_lastName'] = df['LastName'].combine_first(df['Middle']),df['real_lastName'] = df['LastName'].fillna(df['Middle']),13,16.2
50591644,answer,50591609,"python,pandas",codeblock,https://stackoverflow.com/questions/50591644,df['real_lastName'] = df['LastName'].combine_first(df['Middle']),"df['real_lastName'] = np.where(df['LastName'].isnull(), df['Middle'], df['LastName'] )",13,13.3
50591644,answer,50591609,"python,pandas",codeblock,https://stackoverflow.com/questions/50591644,"df['real_lastName'] = np.where(df['LastName'].isnull(), df['Middle'], df['LastName'] )",df['real_lastName'] = df['LastName'].fillna(df['Middle']),13.3,16.2
50663595,answer,50663164,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/50663595,pd.read_feather('small.feather'),"pd.read_hdf('small.h5', 'this_df')",0.842,23.2
50685721,answer,50685406,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/50685721,"np.sum(a, axis=0)","np.sum(b, axis=-1)",27.6,34.6
50703084,answer,50702709,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/50703084,"df[df.assign(key=df.day > 4).groupby(['cc', 'odd', 'tree1', 'tree2']).key.transform('any')]","df.groupby(['cc', 'odd', 'tree1', 'tree2']).filter(lambda x: (x['day'] > 4).any())",3.62,5.42
50703084,answer,50702709,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/50703084,"df[df.assign(key=df.day > 4).groupby(['cc', 'odd', 'tree1', 'tree2']).key.transform('any')]","df[df.day.gt(4).groupby([df.cc, df.odd, df.tree1, df.tree2]).transform('any')]",3.62,5.9
50703084,answer,50702709,"python,pandas,dataframe,group-by,pandas-groupby",codeblock,https://stackoverflow.com/questions/50703084,"df.groupby(['cc', 'odd', 'tree1', 'tree2']).filter(lambda x: (x['day'] > 4).any())","df[df.day.gt(4).groupby([df.cc, df.odd, df.tree1, df.tree2]).transform('any')]",5.42,5.9
50744448,answer,50744369,"python,pandas,lambda,split,vectorization",codeblock,https://stackoverflow.com/questions/50744448,"[x.split('~', 1)[0] for x in df['facility'].tolist()]","df['facility'].str.split('~', n=1).str[0]",132,411
50770151,answer,50769864,"python,arrays,numpy,search",codeblock,https://stackoverflow.com/questions/50770151,"np.searchsorted(arr, val)","(arr[:, None] == val).argmax(0)",0.235,861
50770151,answer,50769864,"python,arrays,numpy,search",codeblock,https://stackoverflow.com/questions/50770151,"np.nonzero(np.isin(arr, val))","np.where(np.isin(arr, val))",7.88,8.3
50770151,answer,50769864,"python,arrays,numpy,search",codeblock,https://stackoverflow.com/questions/50770151,"np.searchsorted(arr, val)","np.where(np.isin(arr, val))",0.235,8.3
50786316,answer,50786300,"python,pandas",codeblock,https://stackoverflow.com/questions/50786316,"df[""SUB""] = df.groupby(""SEQ"").NAME.transform(lambda g: g.str[: g.name])","df['SUB'] = df.apply(lambda x: x['NAME'][:x['SEQ']], axis=1)",4.23,104
50790263,answer,50789448,"python,numpy,random",codeblock,https://stackoverflow.com/questions/50790263,"np.random.randint(1,1000000, 1000000)","[random.choice(range(1,1000000)) for _ in range(1000000)]",5.14,1010
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2.replace(df1.iloc[0,0],0, inplace=True)","df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)",2.99,5.81
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2[df2 == df1.iloc[0, 0]] = 0","df2.mask(df2 == df1.iloc[0,0], 0)",1.21,1.23
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)","df2.replace(df1.iloc[0,0],0, inplace=True)",0.445,0.856
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2.replace(df1.iloc[0,0],0, inplace=True)","df2[df2 == df1.iloc[0, 0]] = 0",0.856,1.21
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2.replace(df1.iloc[0,0],0, inplace=True)","df2.mask(df2 == df1.iloc[0,0], 0)",0.856,1.23
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)","df2[df2 == df1.iloc[0, 0]] = 0",5.81,19.6
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)","df2.mask(df2 == df1.iloc[0,0], 0)",0.445,1.23
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2.replace(df1.iloc[0,0],0, inplace=True)","df2.mask(df2 == df1.iloc[0,0], 0)",2.99,22.8
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2.replace(df1.iloc[0,0],0, inplace=True)","df2[df2 == df1.iloc[0, 0]] = 0",2.99,19.6
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df2[df2 == df1.iloc[0, 0]] = 0","df2.mask(df2 == df1.iloc[0,0], 0)",19.6,22.8
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)","df2[df2 == df1.iloc[0, 0]] = 0",0.445,1.21
50793834,answer,50793654,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/50793834,"df = pd.DataFrame(np.where(df2 == df1.iloc[0,0], 0, df2),index=df2.index,columns=df2.columns)","df2.mask(df2 == df1.iloc[0,0], 0)",5.81,22.8
50798492,answer,50796440,"python,numpy",codeblock,https://stackoverflow.com/questions/50798492,"np.tensordot(B,A,axes=((1),(1))).swapaxes(0,1)","np.tensordot(A,B,axes=((1),(1))).swapaxes(1,2)",0.191,0.208
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u.lower() for u in df.url_type_txt], 'url_type']","df.loc[df.url_type_txt.str.lower().str.contains('phish'), 'url_type']",19.3,103
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u for u in df.url_type_txt], 'url_type']","df.loc[['phish' in u for u in df.url_type_txt.str.lower()], 'url_type']",10.7,41.1
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u.lower() for u in df.url_type_txt], 'url_type']","df.loc[['phish' in u for u in df.url_type_txt.str.lower()], 'url_type']",19.3,41.1
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u for u in df.url_type_txt], 'url_type']","df.loc[df.url_type_txt.str.lower().str.contains('phish'), 'url_type']",10.7,103
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u for u in df.url_type_txt.str.lower()], 'url_type']","df.loc[df.url_type_txt.str.lower().str.contains('phish'), 'url_type']",41.1,103
50805632,answer,50805426,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/50805632,"df.loc[['phish' in u for u in df.url_type_txt], 'url_type']","df.loc[['phish' in u.lower() for u in df.url_type_txt], 'url_type']",10.7,19.3
50815760,answer,50815706,"python,pandas",codeblock,https://stackoverflow.com/questions/50815760,"second_dataset['Status'] = np.where(second_dataset[""New""].isin(first_dataset[""New""]), 'Yes', 'No')",second_dataset['status_column'] = ['Yes' if x in first_dataset['New'].tolist() else 'No' for x in second_dataset['New'].tolist()],0.455,20.9
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,b = np.array(a),b = np.copy(a),0.31,0.313
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,b = np.array(a),"b = np.array(a, order='K', copy=True)",0.31,0.311
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,"b = np.array(a, order='K', copy=True)",b = np.copy(a),0.311,0.313
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,b = np.array(a),"b = np.array(a, order='K', copy=True)",0.000562,0.0011
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,"b = np.array(a, order='K', copy=True)",b = np.copy(a),0.0011,0.00121
50825480,answer,50825208,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/50825480,b = np.array(a),b = np.copy(a),0.000562,0.00121
50835195,answer,50833455,"python,pandas",codeblock,https://stackoverflow.com/questions/50835195,"df['res'] = (df['col2'].values.reshape(1,-1) < df['col1'].values.reshape(-1,1)).sum(axis=1)","df['res'] = df.apply(lambda x: np.less(vals, x['col1']).sum(), axis=1)",0.42,2.09
50835195,answer,50833455,"python,pandas",codeblock,https://stackoverflow.com/questions/50835195,"df['res'] = df.apply(lambda x: np.less(vals, x['col1']).sum(), axis=1)","df['res']=df.apply(lambda x:len(df[df['col2']<x['col1']]),axis=1)",2.09,8.57
50835195,answer,50833455,"python,pandas",codeblock,https://stackoverflow.com/questions/50835195,"df['res'] = (df['col2'].values.reshape(1,-1) < df['col1'].values.reshape(-1,1)).sum(axis=1)","df['res']=df.apply(lambda x:len(df[df['col2']<x['col1']]),axis=1)",0.42,8.57
50852707,answer,50852672,"python,pandas",codeblock,https://stackoverflow.com/questions/50852707,"df['list_score'] = df[['Score1', 'Score2']].values.tolist()","df['list_score'] = df[['Score1', 'Score2']].apply(tuple, axis=1).apply(list)",0.949,35.5
50860437,answer,50860366,"python,pandas",codeblock,https://stackoverflow.com/questions/50860437,[chr(ord('a') + x).upper() for x in df.index],df.index.to_series().apply(lambda x: chr(ord('a') + x)).str.upper(),0.0192,0.491
50882836,answer,50882796,"python,regex,pandas",codeblock,https://stackoverflow.com/questions/50882836,"df.name.str.extract(r'(.*)[\'\/\-\.]', expand=False)","df.name.str.split(r""[\'\/\-\.]"", expand=True)[0]",72.6,141
50908075,answer,50907996,"python,pandas,null",codeblock,https://stackoverflow.com/questions/50908075,s.values==-1,np.where(s.values==-1),84.1,531
50908075,answer,50907996,"python,pandas,null",codeblock,https://stackoverflow.com/questions/50908075,s.values==-1,np.where(s==-1),84.1,546
50908075,answer,50907996,"python,pandas,null",codeblock,https://stackoverflow.com/questions/50908075,(s.values==-1).sum(),(s==-1).sum(),181,1390
50908075,answer,50907996,"python,pandas,null",codeblock,https://stackoverflow.com/questions/50908075,np.where(s.values==-1),np.where(s==-1),531,546
50930479,answer,50930393,"python,pandas,numpy,logical-operators",codeblock,https://stackoverflow.com/questions/50930479,"pd.concat(conditions, axis=1).all(axis=1)",np.array(conditions).all(axis=0),34.6,99.4
50930479,answer,50930393,"python,pandas,numpy,logical-operators",codeblock,https://stackoverflow.com/questions/50930479,np.array(conditions).all(axis=0),np.logical_and.reduce(conditions),99.4,104
50930479,answer,50930393,"python,pandas,numpy,logical-operators",codeblock,https://stackoverflow.com/questions/50930479,"pd.concat(conditions, axis=1).all(axis=1)",np.logical_and.reduce(conditions),34.6,104
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,df2['value'] == df2['value'].astype(int),~(df2['value'] % 1).astype(bool),2.59,23.3
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,df2['value'] == df2['value'].astype(int),df2['value'].map(lambda x: x.is_integer()),2.59,195
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,df2['value'].values % 1 == 0.0,~(df2['value'] % 1).astype(bool),20.8,23.3
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,df2['value'] == df2['value'].astype(int),df2['value'].values % 1 == 0.0,2.59,20.8
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,~(df2['value'] % 1).astype(bool),df2['value'].map(lambda x: x.is_integer()),23.3,195
50950717,answer,50950638,"python,pandas,dataframe,floating-point,series",codeblock,https://stackoverflow.com/questions/50950717,df2['value'].values % 1 == 0.0,df2['value'].map(lambda x: x.is_integer()),20.8,195
50951590,answer,50951412,"python,pandas",sentence,"or, you can go with get_dummies since it is faster than pivot_table i.e:",get_dummies,pivot_table,,
50958479,answer,50958377,"python,pandas,csv,floating-point,series",codeblock,https://stackoverflow.com/questions/50958479,"np.isclose(s, 1.45324)",s2.astype(str) == '1.45324',5.02,79.5
50985989,answer,50985906,"python,pandas,dataframe,mean",codeblock,https://stackoverflow.com/questions/50985989,np.nanmean(df2),df2.stack().dropna().mean(),14,55.7
50990658,answer,50990437,"python,pandas",sentence,this answer claims cut is slower than apply with digitize.,apply,cut,,
50993283,answer,50993263,"python,pandas,dataframe,split,delimiter",codeblock,https://stackoverflow.com/questions/50993283,"pd.DataFrame([x.rsplit('|', 1) for x in df.col1.tolist()])","df.col1.str.rsplit('|', 1, expand=True)",128,473
50993519,answer,50991736,"python,arrays,numpy,matrix",codeblock,https://stackoverflow.com/questions/50993519,"bp = b.copy(); np.copyto(bp, a, where=bp==0)",bk = b.copy(); mask=bk==0; bk[mask] = a[mask],733.085,1314.25
51012141,answer,51012084,"python,arrays,numpy,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/51012141,(arr1 - arr2).clip(min=0),"np.maximum(0, arr1 - arr2)",0.0209,0.0223
51012141,answer,51012084,"python,arrays,numpy,multidimensional-array,numpy-ndarray",codeblock,https://stackoverflow.com/questions/51012141,(arr1 - arr2).clip(min=0),"np.maximum(0, arr1 - arr2)",0.648,0.671
51045619,answer,51045551,"python,pandas",codeblock,https://stackoverflow.com/questions/51045619,"df.sort_values(['gr','col']).drop_duplicates('gr',keep='last').index",df.groupby('gr').col.idxmax(),67.3,491
51046635,answer,51045551,"python,pandas",codeblock,https://stackoverflow.com/questions/51046635,idxmax(df),"df.sort_values(['gr', 'col'], ascending=False).drop_duplicates('gr').index",6.07,152
51070277,answer,51070234,"python,numpy,numpy-ndarray",codeblock,https://stackoverflow.com/questions/51070277,"(a[:, :, None] == vals_keep).any(2)","np.isin(a, vals_keep)",0.0126,0.022
51155781,answer,51155624,"python,performance,pandas,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/51155781,"df.loc[np.in1d(df['col1'], anyOfThese), 'gr'].unique()","df[df.groupby('gr')['col1'].transform(lambda x: np.any(np.in1d(np.array(x), anyOfThese))).astype(bool)].gr.unique()",0.325,2900
51155781,answer,51155624,"python,performance,pandas,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/51155781,"df.loc[df['col1'].isin(anyOfThese), 'gr'].unique()","df[df.groupby('gr')['col1'].transform(lambda x: np.any(np.in1d(np.array(x), anyOfThese))).astype(bool)].gr.unique()",0.746,2900
51155781,answer,51155624,"python,performance,pandas,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/51155781,"df.loc[np.in1d(df['col1'], anyOfThese), 'gr'].unique()","df.loc[df['col1'].isin(anyOfThese), 'gr'].unique()",0.325,0.746
51156019,answer,51155624,"python,performance,pandas,unique,pandas-groupby",codeblock,https://stackoverflow.com/questions/51156019,"df.loc[(df['col1'].values == 50) | (df['col1'].values == 60), 'gr'].unique()","df.loc[np.in1d(df['col1'], anyOfThese), 'gr'].unique()",1.07,1.13
51170797,answer,51170737,"python,arrays,list,numpy",codeblock,https://stackoverflow.com/questions/51170797,"np.fromiter(map(itemgetter(0), a), dtype=int)","np.array(a)[:, 0].astype(int)",4.31,15.1
51170797,answer,51170737,"python,arrays,list,numpy",codeblock,https://stackoverflow.com/questions/51170797,np.array([i[0] for i in a]).astype(int),"np.array(a)[:, 0].astype(int)",8.3,15.1
51170797,answer,51170737,"python,arrays,list,numpy",codeblock,https://stackoverflow.com/questions/51170797,"np.fromiter(map(itemgetter(0), a), dtype=int)",np.array([i[0] for i in a]).astype(int),4.31,8.3
51182428,answer,51182228,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/51182428,"df[pd.DataFrame(np.sort(df[['Name1','Name2']].values,1)).duplicated()]","df[~df[['Name1', 'Name2']].apply(frozenset, axis=1).duplicated()]",69.3,3720
51182972,answer,51182228,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/51182972,"df[pd.DataFrame(np.sort(df[['a','b']].values,1)).duplicated()]","df[~df[['a', 'b']].apply(frozenset, axis=1).duplicated()]",1260,69000
51182972,answer,51182228,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/51182972,"df[~(pd.get_dummies(df.a).add(pd.get_dummies(df.b), fill_value=0)).duplicated()]","df[~df[['a', 'b']].apply(frozenset, axis=1).duplicated()]",1800,69000
51182972,answer,51182228,"python,pandas,sorting,dataframe",codeblock,https://stackoverflow.com/questions/51182972,"df[pd.DataFrame(np.sort(df[['a','b']].values,1)).duplicated()]","df[~(pd.get_dummies(df.a).add(pd.get_dummies(df.b), fill_value=0)).duplicated()]",1260,1800
51208119,answer,16114333,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51208119,"np.diag(big_X[:, ::-1])","step = len(big_X) - 1; np.take(big_X, np.arange(step, big_X.size-1, step))",0.00215,0.1
51208119,answer,16114333,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51208119,"np.diag(X[:, ::-1])","step = len(X) - 1; np.take(X, np.arange(step, X.size-1, step))",0.00192,0.00221
51232696,answer,51232664,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51232696,"df['TIME_M1'] = pd.to_datetime(df['TIME_M'],format='%Y%m%d %H:%M:%S.%f').dt.floor('s')","df['TIME_M2'] = pd.to_datetime([x.split('.')[0] for x in df['TIME_M']], format='%Y%m%d %H:%M:%S')",28.7,69
51232696,answer,51232664,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51232696,"df['TIME_M5'] = pd.to_datetime([x[:17] for x in df['TIME_M']], format='%Y%m%d %H:%M:%S')","df['TIME_M4'] = pd.to_datetime(df['TIME_M'].str[:17], format='%Y%m%d %H:%M:%S')",45.6,58
51232696,answer,51232664,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51232696,"df['TIME_M3'] = pd.to_datetime(df['TIME_M'],format='%Y%m%d %H:%M:%S.%f').values.astype('datetime64[s]')","df['TIME_M2'] = pd.to_datetime([x.split('.')[0] for x in df['TIME_M']], format='%Y%m%d %H:%M:%S')",28.2,69
51232696,answer,51232664,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51232696,"df['TIME_M3'] = pd.to_datetime(df['TIME_M'],format='%Y%m%d %H:%M:%S.%f').values.astype('datetime64[s]')","df['TIME_M1'] = pd.to_datetime(df['TIME_M'],format='%Y%m%d %H:%M:%S.%f').dt.floor('s')",28.2,28.7
51268652,answer,51268370,"python,performance,pandas,datetime,series",codeblock,https://stackoverflow.com/questions/51268652,df['time'].dt.year.unique().tolist(),df['time'].apply(lambda x: x.year).unique().tolist(),0.739,5.9
51283004,answer,32594136,"python,arrays,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/51283004,"pd.DataFrame(s.values.tolist(), index=s.index)",s.apply(pd.Series),0.448,1.5
51293300,answer,51290791,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51293300,"array.array('l', range(num))","np.array(range(num), dtype=np.int64)",86.3,180
51293300,answer,51290791,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51293300,"np.arange(num, dtype=np.int64)","np.array(range(num), dtype=np.int64)",0.809,180
51293300,answer,51290791,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51293300,"np.arange(num, dtype=np.int64)","array.array('l', range(num))",0.809,86.3
51300282,answer,51298856,"python,numpy,indexing,histogram",sentence,"note that digitize is a bad choice for large integer input (until 1.15), and is faster and more correct as bin_in_mat = np.searchsorted(bins, a, side='left')",digitize,"bin_in_mat = np.searchsorted(bins, a, side='left')",,
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df.loc[~df['Class'].isin(['Individual', 'Group']), 'Class'] = 'Other'","df['Class2'] = np.where((df['Class'] == 'Individual') | (df['Class'] == 'Group'), df['Class'], 'Other')",97.8,120
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df['Class1'] = np.where(df['Class'].isin(['Individual','Group']), df['Class'], 'Other')","df.loc[~df['Class'].isin(['Individual', 'Group']), 'Class'] = 'Other'",25.9,97.8
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df['Class1'] = np.where(df['Class'].isin(['Individual','Group']), df['Class'], 'Other')","df['Class3'] = df['Class'].map({'Individual':'Individual', 'Group':'Group'}).fillna('Other')",25.9,95.7
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df['Class3'] = df['Class'].map({'Individual':'Individual', 'Group':'Group'}).fillna('Other')","df.loc[~df['Class'].isin(['Individual', 'Group']), 'Class'] = 'Other'",95.7,97.8
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df['Class3'] = df['Class'].map({'Individual':'Individual', 'Group':'Group'}).fillna('Other')","df['Class2'] = np.where((df['Class'] == 'Individual') | (df['Class'] == 'Group'), df['Class'], 'Other')",95.7,120
51323112,answer,51323038,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51323112,"df['Class1'] = np.where(df['Class'].isin(['Individual','Group']), df['Class'], 'Other')","df['Class2'] = np.where((df['Class'] == 'Individual') | (df['Class'] == 'Group'), df['Class'], 'Other')",25.9,120
51328191,answer,23836277,"python,string,pandas",codeblock,https://stackoverflow.com/questions/51328191,df['text1'].astype(str).str.zfill(15),[str(x).zfill(15) for x in df['text1'].values],16.8,17.6
51374881,answer,51374862,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51374881,df['Map'] = (df['Amount'].values >= 3).astype(int),df['Map'] = (df['Amount'] >= 3).astype(int),2.44,2.6
51388828,answer,51388201,"python,performance,pandas,numpy,cython",codeblock,https://stackoverflow.com/questions/51388828,df['output'] = df.label.map(lookup_dict),df['output'] = df.label.map(lookup_dict.get),69.6,261
51391806,answer,51391713,"python,numpy",sentence,save will almost always be hugely faster than savetxt.,save,savetxt,,
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,"df['ERR2'] = ((df['Id']==4) & ([tuple(x) ==(0, )  for x in df['Var1']])).astype(int)","df['ERR1'] = ((df['Id']==4) & (df['Var1'].apply(tuple)==(0, ))).astype(int)",8.98,13.1
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,"df['ERR1'] = ((df['Id']==4) & (df['Var1'].apply(tuple)==(0, ))).astype(int)",df['ERR3'] = ((df['Id']==4) & (df['Var1'].apply(set)==set([0]))).astype(int),13.1,17
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,"df['ERR1'] = ((df['Id']==4) & (df['Var1'].apply(tuple)==(0, ))).astype(int)",df['ERR4'] = ((df['Id']==4) & ([set(x) == set([0])  for x in df['Var1']])).astype(int),13.1,19.4
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,"df['ERR2'] = ((df['Id']==4) & ([tuple(x) ==(0, )  for x in df['Var1']])).astype(int)",df['ERR3'] = ((df['Id']==4) & (df['Var1'].apply(set)==set([0]))).astype(int),8.98,17
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,"df['ERR2'] = ((df['Id']==4) & ([tuple(x) ==(0, )  for x in df['Var1']])).astype(int)",df['ERR4'] = ((df['Id']==4) & ([set(x) == set([0])  for x in df['Var1']])).astype(int),8.98,19.4
51397268,answer,51397097,pandas,codeblock,https://stackoverflow.com/questions/51397268,df['ERR3'] = ((df['Id']==4) & (df['Var1'].apply(set)==set([0]))).astype(int),df['ERR4'] = ((df['Id']==4) & ([set(x) == set([0])  for x in df['Var1']])).astype(int),17,19.4
51446313,answer,51440840,"python,numpy,vector,transpose",codeblock,https://stackoverflow.com/questions/51446313,"np.outer(x,x)","np.dot(x1,x1.T)",0.0408,0.0607
51446313,answer,51440840,"python,numpy,vector,transpose",codeblock,https://stackoverflow.com/questions/51446313,x1*x1.T,"np.dot(x1,x1.T)",0.0363,0.0607
51446313,answer,51440840,"python,numpy,vector,transpose",codeblock,https://stackoverflow.com/questions/51446313,x1*x1.T,"np.outer(x,x)",0.0363,0.0408
51470660,answer,51470602,"python,pandas,combinations",codeblock,https://stackoverflow.com/questions/51470660,df.reindex(df.index.repeat(len(times))).reset_index(drop=True).assign(time=times*df.shape[0]),"pd.concat([df]*len([0,1,2])).sort_index().assign(time=[0,1,2]*len(df))",0.675,0.812
51470660,answer,51470602,"python,pandas,combinations",codeblock,https://stackoverflow.com/questions/51470660,"pd.concat([df]*len([0,1,2])).sort_index().assign(time=[0,1,2]*len(df))",df.reindex(df.index.repeat(len(times))).reset_index(drop=True).assign(time=times*df.shape[0]),5.78,237
51471115,answer,51471085,"python-3.x,list,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51471115,pd.Series([z for x in df.col.values for z in x]),df.col.apply(pd.Series).stack().reset_index(drop=True),0.0892,1.15
51482242,answer,51481884,"python,pandas,dataframe,types",codeblock,https://stackoverflow.com/questions/51482242,"df.replace(0, np.nan).min()",df[df > 0].min(),0.745,1.09
51488813,answer,51485146,"python,optimization,scipy",sentence,"possibly x.prod(axis=1) is faster than np.prod(x,axis=1) but it's an old post.",x.prod,np.prod,,
51488927,answer,51488681,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51488927,df.loc[df.state.apply(lambda x: x==[42])],"df[df.state.apply(tuple) == (42,)]",33.9,41.9
51488927,answer,51488681,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51488927,df[np.array(list(chain.from_iterable(df['state'].values))) == 42],"df[df.state.apply(tuple) == (42,)]",14.2,41.9
51488927,answer,51488681,"python,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51488927,df[np.array(list(chain.from_iterable(df['state'].values))) == 42],df.loc[df.state.apply(lambda x: x==[42])],14.2,33.9
51545737,answer,51545662,"python,pandas",codeblock,https://stackoverflow.com/questions/51545737,"pd.Series([b in a for a, b in zip(df.A, df.B)]).astype(int)","df.apply(lambda x: x['B'] in x['A'], axis=1).astype(int)",1.55,344
51571862,answer,51571422,"python,python-3.x,numpy",codeblock,https://stackoverflow.com/questions/51571862,"v,c = np.unique(x, return_counts=True); [[a]*b for (a,b) in zip(v,c)]","np.split(x,np.flatnonzero(x[:-1] != x[1:])+1)",18.2,424
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg('sum'),df.groupby('date').text.sum(),68.9,71.8
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg(lambda x: [item for z in x for item in z]),df.groupby('date').text.sum(),2.67,71.8
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg(lambda x: list(itertools.chain.from_iterable(x))),df.groupby('date').text.sum(),2.25,71.8
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg(lambda x: [item for z in x for item in z]),df.groupby('date').text.agg('sum'),2.67,68.9
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg(lambda x: list(itertools.chain.from_iterable(x))),df.groupby('date').text.agg('sum'),2.25,68.9
51576777,answer,51576723,"python,pandas",codeblock,https://stackoverflow.com/questions/51576777,df.groupby('date').text.agg(lambda x: list(itertools.chain.from_iterable(x))),df.groupby('date').text.agg(lambda x: [item for z in x for item in z]),2.25,2.67
51579968,answer,51579951,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51579968,"df[""Latest date1""] = pd.to_datetime(df[""Latest date""], format='%d.%m.%Y - %H:%M:%S')","df[""Latest date2""] = pd.to_datetime(df[""Latest date""])",163,5090
51585421,answer,51583527,"python,pandas,vectorization",codeblock,https://stackoverflow.com/questions/51585421,"np.trace(df.loc[cities, np.roll(cities, -1)])","df.stack().loc[list(zip(cities, np.roll(cities, -1)))].sum()",0.843,4.01
51585421,answer,51583527,"python,pandas,vectorization",codeblock,https://stackoverflow.com/questions/51585421,stacked = df.stack(),"df.stack().loc[list(zip(cities, np.roll(cities, -1)))].sum()",2.83,4.01
51590611,answer,51590328,"python,pandas,dataframe,set",codeblock,https://stackoverflow.com/questions/51590611,any(i in B for i in A),"np.in1d(B, A).any()",0.102,1.1
51600469,answer,51600355,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51600469,df.date.str.split().str[0],pd.to_datetime(df['date']).dt.strftime('%m/%d/%Y'),0.192,0.976
51600469,answer,51600355,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51600469,df.date.str.split().str[0],df['date'].str.extract('(\d+/\d+/\d+)'),0.192,0.322
51600469,answer,51600355,"python,pandas,datetime",codeblock,https://stackoverflow.com/questions/51600469,df['date'].str.extract('(\d+/\d+/\d+)'),pd.to_datetime(df['date']).dt.strftime('%m/%d/%Y'),0.322,0.976
51602638,answer,51602211,"python,pandas,numpy,dataframe,indexing",codeblock,https://stackoverflow.com/questions/51602638,"np.logical_and(df['val'] >= 20, df['val'] <= 60)","df['val'].between(20, 60)",36.8,59.7
51602902,answer,51602708,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/51602902,"a = np.empty((1000,1000)); a[:, :] = np.arange(1000)","np.tile(range(1000), (1000, 1))",0.445,1.43
51608672,answer,51608587,"python,pandas,numpy,dataframe,matrix",codeblock,https://stackoverflow.com/questions/51608672,"(df.values.reshape(-1,df.shape[1]//5,5).sum(2)>=3).any(1)","(df.rolling(5, min_periods=1, axis=1).sum().iloc[:, 4:] >= 3).all(axis=1)",65.3,8040
51609649,answer,51604819,"python,pandas,dataframe,pandas-groupby",codeblock,https://stackoverflow.com/questions/51609649,df[[group_key] + some_cols] = df[[group_key] + some_cols].groupby(group_key).ffill().groupby(group_key).bfill(),df1[some_cols] = df1.groupby(group_key)[some_cols].transform(ffbf),5.69,443
51616463,answer,51615969,"python,pandas,join",codeblock,https://stackoverflow.com/questions/51616463,"df.apply(lambda x: ','.join(x.dropna()),1)","df.stack().groupby(level=0).apply(','.join)",1.04,1.6
51616463,answer,51615969,"python,pandas,join",codeblock,https://stackoverflow.com/questions/51616463,"df_long.stack().groupby(level=0).apply(','.join)","df_long.apply(lambda x: ','.join(x.dropna()),1)",13.1,850
51619237,answer,51619160,"python,pandas",codeblock,https://stackoverflow.com/questions/51619237,"[i.count(j) for i, j in zip(df.Text, df.Object)]","df.apply(lambda x: x.Text.count(x.Object), axis=1)",6.71,1140
51635186,answer,51635137,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/51635186,df['new'] = df['values'].div(df.groupby('feature')['values'].transform('sum')),df['desired'] = df.groupby('feature')['values'].transform(lambda x: x / x.sum()),80.7,727
51636516,answer,51636434,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51636516,"df['d'] = np.select([df['a'] == i for i in L2], L5, df['a'])","df['a'].map(dict(zip(L2, L5))).fillna(df['a'])",11.9,54
51636516,answer,51636434,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51636516,"df['a'].map(dict(zip(L2, L5))).fillna(df['a'])","df['d'] = np.select([df['a'] == i for i in L2], L5, df['a'])",56.9,180
51655400,answer,51654821,"python,pandas,function,multiple-columns,frequency",codeblock,https://stackoverflow.com/questions/51655400,"scipy.stats.mode(df.values, 1)[0]",df.mode(1),10.8,12700
51658633,answer,13167391,"python,pandas",sentence,i have found transform to be much more efficient than filter for very large dataframes:,transform,filter,,
51658705,answer,22720349,"python,pandas",sentence,i have found transform to be much more efficient than filter for very large dataframes:,transform,filter,,
51666469,answer,51666374,"python,pandas",codeblock,https://stackoverflow.com/questions/51666469,"[p.sub('', text) for text in df['name']]","df['name'].str.replace('|'.join(To_remove_lst), '')",60,100
51684660,answer,51684046,"python,arrays,numpy",sentence,"also, it appears that numpy.in1d is faster than numpy.isin, even though the docs recommend using the latter in new code.",numpy.in1d,numpy.isin,,
51696582,answer,51691178,"python,arrays,pandas,numpy",codeblock,https://stackoverflow.com/questions/51696582,pd.Series(a0.tolist()),pd.Series(list(a0)),0.315,0.434
51698241,answer,51698093,"python,pandas,pan",codeblock,https://stackoverflow.com/questions/51698241,"""["" + df.loc[mask, 'keyword'] + ""]""",df.keyword.apply(lambda x:[x]),4.54,129
51698241,answer,51698093,"python,pandas,pan",codeblock,https://stackoverflow.com/questions/51698241,df.keyword.apply(lambda x:[x]),"""["" + df.loc[mask, 'keyword'] + ""]""",0.112,0.348
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2[~df2.index.str.endswith('_test')],df2[~(df2.index.str[-5:] == '_test')],21.7,22.1
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2.loc[[i.endswith('_test') for i in df2.index]],df2[~df2.index.str.endswith('_test')],13.3,21.7
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2.loc[[i.endswith('_test') for i in df2.index]],df2[~(df2.index.str[-5:] == '_test')],13.3,22.1
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2.loc[[i[-5:] == '_test' for i in df2.index]],df2.loc[[i.endswith('_test') for i in df2.index]],11.7,13.3
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2.loc[[i[-5:] == '_test' for i in df2.index]],df2[~(df2.index.str[-5:] == '_test')],11.7,22.1
51730324,answer,51730121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51730324,df2.loc[[i[-5:] == '_test' for i in df2.index]],df2[~df2.index.str.endswith('_test')],11.7,21.7
51732434,answer,51732306,"string,list,pandas,dataframe,text",codeblock,https://stackoverflow.com/questions/51732434,"df[""c2""]=[', '.join(chain.from_iterable(x)) for x in df[""categories""]]","df['c3'] = df[""categories""].apply(lambda x: ', '.join(str(r) for v in x for r in v))",22.1,66.7
51732434,answer,51732306,"string,list,pandas,dataframe,text",codeblock,https://stackoverflow.com/questions/51732434,"df[""c2""]=[', '.join(chain.from_iterable(x)) for x in df[""categories""]]","df[""c1""]=[', '.join(item for sublist in x for item in sublist) for x in df[""categories""]]",22.1,39
51732434,answer,51732306,"string,list,pandas,dataframe,text",codeblock,https://stackoverflow.com/questions/51732434,"df[""c1""]=[', '.join(item for sublist in x for item in sublist) for x in df[""categories""]]","df['c3'] = df[""categories""].apply(lambda x: ', '.join(str(r) for v in x for r in v))",39,66.7
51767447,answer,51766851,"python,arrays,numpy,slice,reverse",codeblock,https://stackoverflow.com/questions/51767447,"A.reshape(-1,8)[:,::-1].ravel()","A.reshape(-1,8)[:,::-1].reshape(-1)",0.00147,0.00212
51767447,answer,51766851,"python,arrays,numpy,slice,reverse",codeblock,https://stackoverflow.com/questions/51767447,"A.reshape(-1,8)[:,::-1].reshape(-1)","A.reshape(-1,8)[:,::-1].ravel()",1.01,1.11
51767447,answer,51766851,"python,arrays,numpy,slice,reverse",codeblock,https://stackoverflow.com/questions/51767447,"A.reshape(-1,8)[:,::-1].reshape(-1)","np.flip(A.reshape(-1, 8), 1).ravel()",1.01,1.11
51767447,answer,51766851,"python,arrays,numpy,slice,reverse",codeblock,https://stackoverflow.com/questions/51767447,"np.flip(A.reshape(-1, 8), 1).ravel()","A.reshape(-1,8)[:,::-1].ravel()",1.11,1.11
51784444,answer,51784386,"python,numpy",codeblock,https://stackoverflow.com/questions/51784444,"(m[:, None, :]*v[:, None]).reshape(m.shape[0], -1)","np.array([np.outer(v, m_row).flatten() for m_row in m])",0.00593,0.179
51784444,answer,51784386,"python,numpy",codeblock,https://stackoverflow.com/questions/51784444,"np.einsum('ij,k->ikj', m, v).reshape(m.shape[0], -1)","(m[:, None, :]*v[:, None]).reshape(m.shape[0], -1)",0.00544,0.00593
51784444,answer,51784386,"python,numpy",codeblock,https://stackoverflow.com/questions/51784444,"np.einsum('ij,k->ikj', m, v).reshape(m.shape[0], -1)","np.array([np.outer(v, m_row).flatten() for m_row in m])",0.00544,0.179
51806965,answer,51806731,"python,performance,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51806965,df.apply(lambda x: x ** 2),df.a.apply(lambda x: x ** 2),63.2,765
51843947,answer,51843474,"python,string,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51843947,{i: sum(i in x for x in df['Authors'].values) for i in L},"{i: df['Authors'].str.contains(i, regex=False).sum() for i in L}",235,420
51843947,answer,51843474,"python,string,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51843947,{i: sum(i in x for x in df['Authors'].values) for i in L},{i: df['Authors'].map(lambda x: i in x).sum() for i in L},235,424
51843947,answer,51843474,"python,string,pandas,dataframe,series",codeblock,https://stackoverflow.com/questions/51843947,"{i: df['Authors'].str.contains(i, regex=False).sum() for i in L}",{i: df['Authors'].map(lambda x: i in x).sum() for i in L},420,424
51901040,answer,51900910,"pandas,vectorization",codeblock,https://stackoverflow.com/questions/51901040,df.country.transform(lambda s: {s}) & df.countries.values,"df.apply(lambda x: x['country'] in x['countries'], 1)",4.53,156
51910035,answer,6991471,"python,r,statistics,numpy,scipy",sentence,"for 1d array, numpy.correlate is faster than scipy.signal.correlate, under different sizes, i see a consistent 5x peformance gain using numpy.correlate.",numpy.correlate,scipy.signal.correlate,,
51947997,answer,51947860,"python,pandas,performance,parallel-processing,execution-time",codeblock,https://stackoverflow.com/questions/51947997,"df.col3.apply(lambda x: jpp(x, set_words, 0.4))","df.col3.apply(lambda x: original(set(x), set_words, 0.4))",32.3,74
51949588,answer,51949163,"python,numpy,optimization",codeblock,https://stackoverflow.com/questions/51949588,"np.einsum('ijk,j->ik', a, b)","np.einsum('ijk,j->ik', a, b, optimize=True)",247,248
51956599,answer,51956572,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51956599,"df.replace(r'\:.*', '', regex=True)","df.c1.str.replace(r'\:.*', '')",30.8,31.2
51956599,answer,51956572,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51956599,"df.replace(r'\:.*', '', regex=True)",df['c1'].str.partition(':')[0],30.8,56.7
51956599,answer,51956572,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/51956599,"df.c1.str.replace(r'\:.*', '')",df['c1'].str.partition(':')[0],31.2,56.7
51969299,answer,51969234,"python,arrays,pandas,numpy,series",codeblock,https://stackoverflow.com/questions/51969299,np.array(s.values.tolist()).squeeze(),np.vstack(s.values),25.2,66.8
51969299,answer,51969234,"python,arrays,pandas,numpy,series",codeblock,https://stackoverflow.com/questions/51969299,np.array(s.values.tolist()).squeeze(),np.vstack(s),25.2,71.9
51969299,answer,51969234,"python,arrays,pandas,numpy,series",codeblock,https://stackoverflow.com/questions/51969299,np.vstack(s.values),np.vstack(s),66.8,71.9
51989576,answer,51989470,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51989576,"np.where(df['a'].notnull(), 'complete', 'incomplete')",df['a'].apply(lambda x: 'complete' if not np.isnan(x) else 'incomplete'),0.145,4.67
51989576,answer,51989470,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51989576,"df['a'].notnull().map({True:'complete',False:'incomplete'})",df['a'].apply(lambda x: 'complete' if not np.isnan(x) else 'incomplete'),0.667,4.67
51989576,answer,51989470,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/51989576,"np.where(df['a'].notnull(), 'complete', 'incomplete')","df['a'].notnull().map({True:'complete',False:'incomplete'})",0.145,0.667
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.at[df['sequence'].idxmax(), 'people']","df.loc[df['sequence'].idxmax(), 'people']",0.0626,0.0651
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.loc[df['sequence'].idxmax(), 'people']",df.set_index('people').sequence.idxmax(),0.0651,0.556
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.at[df['sequence'].idxmax(), 'people']",df.set_index('people').sequence.idxmax(),0.0626,0.556
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.at[df['sequence'].idxmax(), 'people']","df.loc[df['sequence'].idxmax(), 'people']",0.101,0.107
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.loc[df['sequence'].idxmax(), 'people']",df.set_index('people').sequence.idxmax(),0.107,0.816
51993139,answer,51993038,"python,pandas,max",codeblock,https://stackoverflow.com/questions/51993139,"df.at[df['sequence'].idxmax(), 'people']",df.set_index('people').sequence.idxmax(),0.101,0.816
51997521,answer,51982417,"python,pandas,performance,numpy,series",codeblock,https://stackoverflow.com/questions/51997521,"np.where(mask, twice, df[0])","df[0].mask(mask, twice)",61.4,143
52030534,answer,52030458,"python,numpy,multidimensional-array,scipy,vertex",codeblock,https://stackoverflow.com/questions/52030534,np.sqrt(pdist_squareformed_numpy_v2(a)),np.sqrt(pdist_squareformed_numpy(a)),395,812
52030534,answer,52030458,"python,numpy,multidimensional-array,scipy,vertex",codeblock,https://stackoverflow.com/questions/52030534,"cdist(a,a)",np.sqrt(pdist_squareformed_numpy(a)),309,812
52030534,answer,52030458,"python,numpy,multidimensional-array,scipy,vertex",codeblock,https://stackoverflow.com/questions/52030534,"cdist(a,a)",np.sqrt(pdist_squareformed_numpy_v2(a)),309,395
52039106,answer,52038896,"python,python-3.x,pandas,series",codeblock,https://stackoverflow.com/questions/52039106,s.mode().iloc[0],mode(s).mode[0],1.82,5.64
52039106,answer,52038896,"python,python-3.x,pandas,series",codeblock,https://stackoverflow.com/questions/52039106,s.value_counts().index[0],mode(s).mode[0],2.52,5.64
52039106,answer,52038896,"python,python-3.x,pandas,series",codeblock,https://stackoverflow.com/questions/52039106,s.mode().iloc[0],s.value_counts().index[0],1.82,2.52
52050974,answer,52048562,"python,arrays,numpy,cosine-similarity",codeblock,https://stackoverflow.com/questions/52050974,"np.sqrt(np.einsum('ij,ij->i',arr,arr)*np.einsum('j,j',vec,vec))","(np.linalg.norm(arr, axis=1) * np.linalg.norm(vec))",0.0774,0.1
52050974,answer,52048562,"python,arrays,numpy,cosine-similarity",codeblock,https://stackoverflow.com/questions/52050974,"np.sqrt(np.einsum('ij,ij->i',arr,arr)*np.einsum('j,j',vec,vec))","(np.linalg.norm(arr, axis=1) * np.linalg.norm(vec))",8.18,22.2
52062608,answer,52062496,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/52062608,"np.matmul(a,b)",a.dot(b),70.6,134
52080405,answer,52079948,"python,pandas",codeblock,https://stackoverflow.com/questions/52080405,pd.DataFrame(df['order'].values.tolist())[3],df['order'].str[3],125,185
52093468,answer,52093315,"python,pandas,split,multiple-columns",codeblock,https://stackoverflow.com/questions/52093468,"np.where(df.sum(1).str.contains('I'), 'I', '-')","df.sum(1).str.contains('I').map({False:'-',True:'I'})",69.4,83
52093468,answer,52093315,"python,pandas,split,multiple-columns",codeblock,https://stackoverflow.com/questions/52093468,['I' if 'I' in row else '-' for row in df.values.sum(1)],"df.sum(1).str.contains('I').map({False:'-',True:'I'})",9.29,83
52093468,answer,52093315,"python,pandas,split,multiple-columns",codeblock,https://stackoverflow.com/questions/52093468,['I' if 'I' in row else '-' for row in df.values.sum(1)],"np.where(df.sum(1).str.contains('I'), 'I', '-')",9.29,69.4
52110556,answer,52110530,"python,html,pandas",codeblock,https://stackoverflow.com/questions/52110556,df['important_column'].apply('<b>{}</b>?'.format),df['important_column'] = df['important_column'].apply(lambda x: '<b>' + str(x) + '</b>'),133,150
52143874,answer,52143854,"python,pandas,apply",codeblock,https://stackoverflow.com/questions/52143874,df.join(pd.get_dummies(df['Hour'].astype(str)).add_prefix('HE')),df.join(df['Hour'].astype(str).str.get_dummies().add_prefix('HE')),3.54,61.6
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr=='A'),np.sum(rr == 'A'),0.00104,0.00386
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr.view(np.uint8)==ord('A')),np.sum(rr == 'A'),0.00186,0.00386
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr=='A'),np.count_nonzero(rr.view(np.uint8)==ord('A')),0.00104,0.00186
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr.view(np.uint8)==ord('A')),np.sum(rr == 'A'),0.0402,0.734
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr.view(np.uint8)==ord('A')),np.count_nonzero(rr=='A'),0.0402,0.659
52145257,answer,52145157,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/52145257,np.count_nonzero(rr=='A'),np.sum(rr == 'A'),0.659,0.734
52210022,answer,52209730,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52210022,"films.drop_duplicates(['Movie', 'Name']).groupby(['Name']).agg({'Movie' : 'count', 'Rating' : 'mean', 'Votes' : 'sum'})","films.groupby([""Name"", ""Movie""]).first().reset_index().groupby(""Name"").agg({""Movie"": ""count"", ""Rating"": ""mean"", ""Votes"": ""sum""})",2.55,6.92
52227133,answer,52225301,"python,pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/52227133,np.concatenate(df['airline']),df['airline'].apply(pd.Series),84.9,817
52229155,answer,52228885,"python,numpy",codeblock,https://stackoverflow.com/questions/52229155,"a.reshape(2,4,3, order=""F"").swapaxes(1, 2)","np.rollaxis(a.reshape(3, 4, 2), 2)",0.0011,0.00292
52229155,answer,52228885,"python,numpy",codeblock,https://stackoverflow.com/questions/52229155,"a.reshape(-1, 2).T.reshape(-1, 3, 4)","np.rollaxis(a.reshape(3, 4, 2), 2)",0.00108,0.00292
52229155,answer,52228885,"python,numpy",codeblock,https://stackoverflow.com/questions/52229155,"a.reshape(-1, 2).T.reshape(-1, 3, 4)","a.reshape(2,4,3, order=""F"").swapaxes(1, 2)",0.00108,0.0011
52238949,answer,52232559,"python,numpy",sentence,genfromtxt is a bit faster than loadtxt:,genfromtxt,loadtxt,,
52247516,answer,52247376,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/52247516,"sum(map(len, df.keywords))",df.keywords.map(len).sum(),1.87,13.5
52247516,answer,52247376,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/52247516,"sum(map(len, df.keywords))",df.keywords.str.len().sum(),1.87,14.3
52247516,answer,52247376,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/52247516,df.keywords.map(len).sum(),df.keywords.str.len().sum(),13.5,14.3
52262792,answer,52262516,"python,numpy,multidimensional-array,boolean,boolean-logic",codeblock,https://stackoverflow.com/questions/52262792,"via_reduce = np.logical_or.reduce(x, axis=2)",via_any = x.any(axis=2),883,895
52267947,answer,52267788,"python,numpy",sentence,the reason why shuffle is slower than permutation for multidimensional array is that permutation only need to shuffle the index along the first axis.,permutation,shuffle,,
52283996,answer,52242832,"python,performance,numpy",codeblock,https://stackoverflow.com/questions/52283996,a - 3*numpy.floor(a/3),"numpy.fmod(a, 3)",79.8014,335.931
52289529,answer,52289488,"python,pandas",codeblock,https://stackoverflow.com/questions/52289529,df['new_column'] = default_value,df_new = df.assign(new_column=default_value),0.0861,0.228
52293891,answer,52293488,"python,string,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52293891,df['reason'].map(len).le(10),df['reason'].str.len().le(10),2.32,2.6
52294594,answer,52294418,"python,pandas",codeblock,https://stackoverflow.com/questions/52294594,load['print'] = load.B.gt(load.C) & load.C.eq(load.D) & load['C'].ne(0) & load['D'].ne(0),"load['print'] = load.apply(lambda x:(x.B>x.C)&(x.C==x.D)&(x.C!=0)&(x.D!=0),axis=1)",1.64,408
52297394,answer,52297308,"python,pandas,performance,datetime,series",codeblock,https://stackoverflow.com/questions/52297394,"pd.to_datetime(df['date'], infer_datetime_format=True)","pd.to_datetime(df['date'], format='%m/%d/%Y')",228,252
52297394,answer,52297308,"python,pandas,performance,datetime,series",codeblock,https://stackoverflow.com/questions/52297394,"pd.to_datetime(df['date'], format='%m/%d/%Y')",pd.to_datetime(df['date']),252,12500
52297394,answer,52297308,"python,pandas,performance,datetime,series",codeblock,https://stackoverflow.com/questions/52297394,"pd.to_datetime(df['date'], infer_datetime_format=True)",pd.to_datetime(df['date']),228,12500
52309622,answer,52309339,"python,string,pandas,search",codeblock,https://stackoverflow.com/questions/52309622,"df['matches1'] = [[k for k, v in d.items() if x in v] for x in df.mfr]",df['matches'] = df.mfr.map(lambda x: df.index[df.desc.str.contains(x)].tolist()),80.8,877
52311847,answer,52311836,"python,pandas,time",codeblock,https://stackoverflow.com/questions/52311847,df['date'].dt.to_period('M'),df['date'].dt.strftime('%Y-%m'),57,237
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values",df.groupby([1]*len(df)).first()==df.max(),0.45,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values",df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),0.45,3.55
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),1.13,3.55
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.idxmax()==df.apply(pd.Series.first_valid_index),df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),1.5,3.55
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values",df.bfill().iloc[0]==df.max(),0.45,0.824
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.bfill().iloc[0]==df.max(),"df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",0.824,1.13
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.bfill().iloc[0]==df.max(),df.idxmax()==df.apply(pd.Series.first_valid_index),0.824,1.5
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.bfill().iloc[0]==df.max(),df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),0.824,3.55
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",df.groupby([1]*len(df)).first()==df.max(),1.13,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),0.207,3.55
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.stack().reset_index(level=1).drop_duplicates('level_1').set_index('level_1')[0]==df.max(),df.groupby([1]*len(df)).first()==df.max(),3.55,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.bfill().iloc[0]==df.max(),df.groupby([1]*len(df)).first()==df.max(),0.824,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values",0.207,0.45
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),"df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",0.207,1.13
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),df.idxmax()==df.apply(pd.Series.first_valid_index),0.207,1.5
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",df.idxmax()==df.apply(pd.Series.first_valid_index),1.13,1.5
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),df.bfill().iloc[0]==df.max(),0.207,0.824
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,np.isnan(df.values).argmin(axis=0) == df.fillna(-np.inf).values.argmax(axis=0),df.groupby([1]*len(df)).first()==df.max(),0.207,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,df.idxmax()==df.apply(pd.Series.first_valid_index),df.groupby([1]*len(df)).first()==df.max(),1.5,9.78
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values",df.idxmax()==df.apply(pd.Series.first_valid_index),0.45,1.5
52349696,answer,52349507,"python,pandas,max,nan",codeblock,https://stackoverflow.com/questions/52349696,"df.values[(~np.isnan(df.values)).argmax(axis=0), np.arange(df.shape[1])] == df.max(axis=0).values","df.values[df.notnull().idxmax(), np.arange(df.shape[1])] == df.max(axis=0)",0.45,1.13
52357688,answer,52357618,"python,pandas,slice,series",codeblock,https://stackoverflow.com/questions/52357688,"[k.split(', ')[0] for k in df.Name.tolist()]","df.Name.str.split(', ').str[0]",0.178,1.09
52357688,answer,52357618,"python,pandas,slice,series",codeblock,https://stackoverflow.com/questions/52357688,"[k.split(', ')[0] for k in df.Name.tolist()]","pd.Series([k.split(', ')[0] for k in df.Name.tolist()])",0.178,0.285
52357688,answer,52357618,"python,pandas,slice,series",codeblock,https://stackoverflow.com/questions/52357688,"pd.Series([k.split(', ')[0] for k in df.Name.tolist()])","df.Name.str.split(', ').str[0]",0.285,1.09
52358353,answer,52358248,"python,pandas",codeblock,https://stackoverflow.com/questions/52358353,"np.sum(np.partition(df.values, -3)[:, -3:], 1)","np.sum(np.sort(df.values)[:,-3:],axis=1)",364,1690
52361759,answer,52360995,"python,arrays,numpy,indexing",codeblock,https://stackoverflow.com/questions/52361759,X[0],"X[0,:]",0.000172,0.000264
52361759,answer,52360995,"python,arrays,numpy,indexing",codeblock,https://stackoverflow.com/questions/52361759,X[0],"X[0,...]",0.000172,0.000175
52361759,answer,52360995,"python,arrays,numpy,indexing",codeblock,https://stackoverflow.com/questions/52361759,"X[...,1]","X[:,1]",0.000177,0.000262
52361759,answer,52360995,"python,arrays,numpy,indexing",codeblock,https://stackoverflow.com/questions/52361759,"X[0,...]","X[0,:]",0.000175,0.000264
52378197,answer,28684813,"python,arrays,numpy,slice",codeblock,https://stackoverflow.com/questions/52378197,"np.rollaxis(np.rollaxis(x, axis, 0)[s], 0, axis + 1)","x.take(np.arange(x.shape[axis])[s], axis)",0.00232,0.0285
52378197,answer,28684813,"python,arrays,numpy,slice",codeblock,https://stackoverflow.com/questions/52378197,"x[(slice(None),) * axis + (s,)]","np.rollaxis(np.rollaxis(x, axis, 0)[s], 0, axis + 1)",0.000321,0.00232
52378197,answer,28684813,"python,arrays,numpy,slice",codeblock,https://stackoverflow.com/questions/52378197,"x[(slice(None),) * axis + (s,)]","x.take(np.arange(x.shape[axis])[s], axis)",0.000321,0.0285
52418898,answer,52415921,"pandas,datetime-format,strptime,strftime",codeblock,https://stackoverflow.com/questions/52418898,pd.Timestamp('2017-01-01T00:00:00.000000000'),pd.to_datetime('2017-01-01T00:00:00.000000000'),0.00218,0.054
52420369,answer,52420357,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52420369,"df.C = np.where(['ye' in x for x in df.C], 'no', df.C.values)","df.C = np.where(df.C.str.contains('ye').values, 'no', df.C.values)",3.29,21.6
52420369,answer,52420357,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52420369,"df.loc[['ye' in x for x in df.C], 'C'] = 'no'","df.C = np.where(df.C.str.contains('ye').values, 'no', df.C.values)",5.26,21.6
52420369,answer,52420357,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52420369,"df.C = np.where(['ye' in x for x in df.C], 'no', df.C.values)","df.loc[['ye' in x for x in df.C], 'C'] = 'no'",3.29,5.26
52425935,answer,52425910,"python,pandas,filtering",codeblock,https://stackoverflow.com/questions/52425935,df[(df['date_id'] >= df['start_date']) & (df['date_id']<= df['end_date_y'])],"df.query(""start_date <= date_id <=  end_date_y"")",2.42,4.45
52425935,answer,52425910,"python,pandas,filtering",codeblock,https://stackoverflow.com/questions/52425935,df[(df['date_id'] >= df['start_date']) & (df['date_id']<= df['end_date_y'])],"df[df['date_id'].between(df['start_date'], df['end_date_y'])]",2.42,2.44
52425935,answer,52425910,"python,pandas,filtering",codeblock,https://stackoverflow.com/questions/52425935,"df[df['date_id'].between(df['start_date'], df['end_date_y'])]","df.query(""start_date <= date_id <=  end_date_y"")",2.44,4.45
52443640,answer,52441974,"python,pandas,addition",codeblock,https://stackoverflow.com/questions/52443640,"s1.add(s2.mask(s2 < 0, 0), fill_value=0)","s1.add(s2[s2 > 0], fill_value=0)",1.17,4.68
52443640,answer,52441974,"python,pandas,addition",codeblock,https://stackoverflow.com/questions/52443640,"s1.add(s2.where(s2.gt(0), 0))","s1.add(s2.mask(s2 < 0, 0), fill_value=0)",0.988,1.17
52443640,answer,52441974,"python,pandas,addition",codeblock,https://stackoverflow.com/questions/52443640,"s1.add(s2.where(s2.gt(0), 0))","s1.add(s2[s2 > 0], fill_value=0)",0.988,4.68
52464867,answer,51234097,"python,python-3.x,numpy,matrix,optimization",codeblock,https://stackoverflow.com/questions/52464867,A.ravel()[map_f],"A[mapping[:, :, 0], mappping[:, :, 1]]",2783.13,4101.24
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],"df.columns[np.argpartition(df.values, -2)[:,-2]]",0.0741,0.101
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],"df.columns[df.values.argsort(1)[:, -2]]",0.0741,0.0947
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.T.apply(lambda x: x.nlargest(2).idxmin()),df.T.apply(lambda x: x.nlargest(2)).idxmin(),39.8,53.6
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],df.T.apply(lambda x: x.nlargest(2).idxmin()),0.0741,429
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],"df.columns[np.argpartition(df.values, -2)[:,-2]]",1.11,14.6
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],"df.columns[df.values.argsort(1)[:, -2]]",1.11,52.1
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[np.argpartition(df.values, -2)[:,-2]]","df.columns[df.values.argsort(1)[:, -2]]",14.6,52.1
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,df.columns[arg_second_largest(df.values)],df.T.apply(lambda x: x.nlargest(2).idxmin()),1.11,1800
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[df.values.argsort(1)[:, -2]]","df.columns[np.argpartition(df.values, -2)[:,-2]]",0.0947,0.101
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[df.values.argsort(1)[:, -2]]",df.T.apply(lambda x: x.nlargest(2).idxmin()),52.1,1800
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[np.argpartition(df.values, -2)[:,-2]]",df.T.apply(lambda x: x.nlargest(2).idxmin()),14.6,1800
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[df.values.argsort(1)[:, -2]]",df.T.apply(lambda x: x.nlargest(2).idxmin()),0.0947,429
52464982,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52464982,"df.columns[np.argpartition(df.values, -2)[:,-2]]",df.T.apply(lambda x: x.nlargest(2).idxmin()),0.101,429
52467901,answer,52467838,"python,pandas,list,multiple-columns",codeblock,https://stackoverflow.com/questions/52467901,"s = df.ne(df.shift()).sum(1).cumsum(); df['col3'] = s.map(dict(zip(s.unique(), list1)))",df.merge(df.drop_duplicates().assign(col3=list1)),2.81,3.39
52467901,answer,52467838,"python,pandas,list,multiple-columns",codeblock,https://stackoverflow.com/questions/52467901,df.merge(df.drop_duplicates().assign(col3=list1)),"s = df.ne(df.shift()).sum(1).cumsum(); df['col3_'] = s.map(dict(zip(s.unique(), list1)))",87.6,184
52468939,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52468939,"df.columns[df.values.argsort(1)[:, -2]]",df.T.apply(lambda x: x.nlargest(2)).idxmin(),0.0363,73.2
52468939,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52468939,"df.columns[df.values.argsort(1)[:, -2]]",df.T.apply(lambda x: x.nlargest(2).idxmin()),0.0363,49.6
52468939,answer,52464947,"python,pandas,sorting,numpy,dataframe",codeblock,https://stackoverflow.com/questions/52468939,df.T.apply(lambda x: x.nlargest(2).idxmin()),df.T.apply(lambda x: x.nlargest(2)).idxmin(),49.6,73.2
52472639,answer,52472531,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/52472639,np.exp(x),"np.where(x > 0, 0, np.exp(x))",0.00122,0.00409
52478059,answer,52477801,"python,pandas",sentence,np.where is faster than pd.apply: why is np.where faster than pd.apply,np.where,pd.apply,,
52507642,answer,52507272,"python,pandas,concat",codeblock,https://stackoverflow.com/questions/52507642,[[i for i in row if i == i] for row in df.values],"df.apply(lambda row: row.dropna().tolist(), axis=1)",55.6,8250
52516454,answer,52516340,"python,pandas",codeblock,https://stackoverflow.com/questions/52516454,large.str.lower(),[x.lower() if pd.notnull(x) else x for x in large],28.2,73.3
52529431,answer,52529293,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52529431,"np.array(['Yes','No'])[np.array(['class3' in x for x in df.tags]).astype(int)]","df.tags.str.contains('class3').map({True:'Yes',False:'No'})",0.39,3.11
52529431,answer,52529293,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52529431,"np.where(df['tags'].str.contains('class3'),'yes','no')","df.tags.str.contains('class3').map({True:'Yes',False:'No'})",2.46,3.11
52529431,answer,52529293,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52529431,"np.array(['Yes','No'])[np.array(['class3' in x for x in df.tags]).astype(int)]","np.where(df['tags'].str.contains('class3'),'yes','no')",0.39,2.46
52532000,answer,52531974,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/52532000,df[df['A'] >5].index,df.loc[df['A'] >5].index,0.428,0.466
52532000,answer,52531974,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/52532000,df.index[df['A'] >5],df[df['A'] >5].index,0.208,0.428
52532000,answer,52531974,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/52532000,df.index[df['A'] >5],df.loc[df['A'] >5].index,0.208,0.466
52532000,answer,52531974,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/52532000,df.index.values[df['A'].values >5],df.index.values[df['A'] >5],0.00891,0.157
52537582,answer,52537299,"python,arrays,pandas,numpy,series",codeblock,https://stackoverflow.com/questions/52537582,df[0].iat[local_max_idx(df[1].values)],"df.iat[argrelextrema(df[1].values, np.greater)[0][-1], 0]",1.59,46.1
52553641,answer,52553605,"python,pandas",codeblock,https://stackoverflow.com/questions/52553641,df['A-Indicator']=df.groupby('Column_X')['Column_Y'].transform(lambda x: x.isin(['A']).any()),df['A-Indicator']=df.groupby('Column_X')['Column_Y'].transform(lambda x: 'A' in x.unique()),724,770
52553641,answer,52553605,"python,pandas",codeblock,https://stackoverflow.com/questions/52553641,"df['A-Indicator'] = df['Column_X'].isin(df.loc[df['Column_Y'].eq('A'), 'Column_X'].unique())",df['A-Indicator']=df.groupby('Column_X')['Column_Y'].transform(lambda x: 'A' in x.unique()),92.1,770
52553641,answer,52553605,"python,pandas",codeblock,https://stackoverflow.com/questions/52553641,"df['A-Indicator'] = df['Column_X'].isin(df.loc[df['Column_Y'].eq('A'), 'Column_X'].unique())",df['A-Indicator']=df.groupby('Column_X')['Column_Y'].transform(lambda x: x.isin(['A']).any()),92.1,724
52588470,answer,52588298,"python,pandas,performance,argmax",codeblock,https://stackoverflow.com/questions/52588470,df['probability'].values == df['probability'].values.max(),df['probability'].eq(df['probability'].max()),0.416,3.78
52591590,answer,52591538,"python,python-2.7,pandas,dataframe",codeblock,https://stackoverflow.com/questions/52591590,"df['new'] = [j.replace(i, '') for i, j in zip(df['SUFFIX'], df['COD_METEL'])]","df['RESULT'] = df.apply(lambda x: x['COD_METEL'].replace(x['SUFFIX'], ''), axis=1)",98.7,5050
52603424,answer,52603377,"python,pandas,if-statement,apply",codeblock,https://stackoverflow.com/questions/52603424,"df['Agem1']= np.select([m1, m2], ['Elder','Child'], default='Adult')",df['Agem']=df['Age'].apply(ages),0.244,0.577
52617109,answer,52616829,"python,pandas,numpy,dataframe,indexing",codeblock,https://stackoverflow.com/questions/52617109,"df.pipe(shifter, 590, 5)","df.pipe(shifter2, 590, 5)",0.381,1.92
52624267,answer,52624204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52624267,df['clip_values_v3'] = df['values'].values.clip(max=20),df['clip_values'] = df['values'].map(lambda x : 20 if x > 20 else x),2.95,193
52624267,answer,52624204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52624267,"df['clip_values_v2'] = np.where(df['values'] > 20, 20, df['values'])",df['clip_values'] = df['values'].map(lambda x : 20 if x > 20 else x),6.12,193
52624267,answer,52624204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/52624267,df['clip_values_v3'] = df['values'].values.clip(max=20),"df['clip_values_v2'] = np.where(df['values'] > 20, 20, df['values'])",2.95,6.12
52630508,answer,52629455,"python,pandas",codeblock,https://stackoverflow.com/questions/52630508,"df.groupby(""category"")[""sentence""].apply(lambda x: Counter("" "".join(x).split()).most_common(2))",df.groupby('category')['sentence'].apply(lambda x: nltk.FreqDist(nltk.tokenize.word_tokenize(' '.join(x)))),2.07,4.96
52648776,answer,52648664,"python,pandas",codeblock,https://stackoverflow.com/questions/52648776,pd.concat(dfs).groupby('ip')['seq'].apply(lambda x: tuple([z for y in x for z in y])).reset_index(),"pd.concat(dfs).groupby('ip',as_index=False).seq.sum()",7.86,15.7
52664265,answer,52662615,"pandas,numpy",codeblock,https://stackoverflow.com/questions/52664265,"np.cumprod(1 + arr, axis=0) - 1",((1 + df).cumprod(axis=0) - 1),0.0366,0.469
52664265,answer,52662615,"pandas,numpy",codeblock,https://stackoverflow.com/questions/52664265,"np.cumprod(1 + arr, axis=0) - 1",((1 + df).cumprod(axis=0) - 1),3420,3640
52664765,answer,52662615,"pandas,numpy",codeblock,https://stackoverflow.com/questions/52664765,"np.cumprod(1 + arr, axis=0) - 1",((1 + df).cumprod(axis=0) - 1),6380,6830
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"np.vectorize(divide)(df['A'], df['B'])","df.apply(lambda row: divide(*row), axis=1, raw=True)",48.1,760
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"df.apply(lambda row: divide(row['A'], row['B']), axis=1)","[divide(row['A'], row['B']) for _, row in df[['A', 'B']].iterrows()]",4830,11600
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"df.apply(lambda row: divide(*row), axis=1, raw=True)","[divide(row['A'], row['B']) for _, row in df[['A', 'B']].iterrows()]",760,11600
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"[divide(a, b) for a, b in df[['A', 'B']].itertuples(index=False)]","[divide(row['A'], row['B']) for _, row in df[['A', 'B']].iterrows()]",112,11600
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"[divide(a, b) for a, b in df[['A', 'B']].itertuples(index=False)]","df.apply(lambda row: divide(row['A'], row['B']), axis=1)",112,4830
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"[divide(a, b) for a, b in df[['A', 'B']].itertuples(index=False)]","df.apply(lambda row: divide(*row), axis=1, raw=True)",112,760
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"np.vectorize(divide)(df['A'], df['B'])","[divide(row['A'], row['B']) for _, row in df[['A', 'B']].iterrows()]",48.1,11600
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"np.vectorize(divide)(df['A'], df['B'])","[divide(a, b) for a, b in df[['A', 'B']].itertuples(index=False)]",48.1,112
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"np.vectorize(divide)(df['A'], df['B'])","df.apply(lambda row: divide(row['A'], row['B']), axis=1)",48.1,4830
52674448,answer,52673285,"python,arrays,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/52674448,"df.apply(lambda row: divide(*row), axis=1, raw=True)","df.apply(lambda row: divide(row['A'], row['B']), axis=1)",760,4830
52693439,answer,52691880,"arrays,python-2.7,list,numpy,nan",codeblock,https://stackoverflow.com/questions/52693439,"np.frompyfunc(foo,1,1)(arr)","np.frompyfunc(list.__getitem__, 2, 1)(arr + z, slice(5))",0.00849,0.0148
52729787,answer,52728493,"python,numpy,numpy-broadcasting",codeblock,https://stackoverflow.com/questions/52729787,np.linalg.det(arr.T),"np.linalg.det(np.moveaxis(arr, 2, 0))",0.0062,0.0129
52786066,answer,52783479,"python,arrays,pandas,time,numba",codeblock,https://stackoverflow.com/questions/52786066,s.ewm(alpha=0.5).mean(),"ewm(s, alpha=0.5)",0.852,82
52786066,answer,52783479,"python,arrays,pandas,time,numba",codeblock,https://stackoverflow.com/questions/52786066,"ewm(s.values, alpha=0.5)",s.ewm(alpha=0.5).mean(),0.026,0.852
52786066,answer,52783479,"python,arrays,pandas,time,numba",codeblock,https://stackoverflow.com/questions/52786066,"ewm(s.values, alpha=0.5)","ewm(s, alpha=0.5)",0.026,82
52804531,answer,52804320,"python,python-3.x,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/52804531,"pd.concat([df[df.Firstnames.eq(a) & df.Lastnames.eq(b)] for a,b in lst])","mask = df[['Firstnames', 'Lastnames']].agg(tuple, 1).isin(lst); df[mask].sort_values(by=['Firstnames', 'Lastnames'])",16.2,942
52804531,answer,52804320,"python,python-3.x,pandas,dataframe,indexing",codeblock,https://stackoverflow.com/questions/52804531,"mask = df[['Firstnames', 'Lastnames']].agg(tuple, 1).isin(lst); df[mask].sort_values(by=['Firstnames', 'Lastnames'])","pd.concat([df[df.Firstnames.eq(a) & df.Lastnames.eq(b)] for a,b in lst])",15.1,781
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,df.gender.str[7:],"df.gender.str.replace('mostly_', '')",5.42,16.1
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,"df.gender.map({'mostly_male': 'male', 'mostly_female': 'female'})","df.replace({'gender': {'mostly_': ''}}, regex=True)",1.8,12.8
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,"df.gender.map({'mostly_male': 'male', 'mostly_female': 'female'})","df.gender.str.replace('mostly_', '')",1.8,16.1
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,df.gender.str[7:],"df.replace({'gender': {'mostly_': ''}}, regex=True)",5.42,12.8
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,"df.gender.map({'mostly_male': 'male', 'mostly_female': 'female'})",df.gender.str[7:],1.8,5.42
52881935,answer,52881494,"python,python-3.x,pandas,nlp",codeblock,https://stackoverflow.com/questions/52881935,"df.replace({'gender': {'mostly_': ''}}, regex=True)","df.gender.str.replace('mostly_', '')",12.8,16.1
52907147,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52907147,"[list(map(int, i)) for i in df['A'].str.split()]","df['A'].str.split().apply(lambda x: list(map(int, x)))",80.2,93.6
52907147,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52907147,"[list(map(int, i.split())) for i in df['A']]","df['A'].str.split().apply(lambda x: list(map(int, x)))",55.6,93.6
52907147,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52907147,"[list(map(int, i.split())) for i in df['A']]","[list(map(int, i)) for i in df['A'].str.split()]",55.6,80.2
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,[int(x) for i in df['A'] for x in i.split()],"[list(map(int, i)) for i in df['A'].str.split()]",23.6,50.9
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,pd.DataFrame(nb_calc(df.A)),"df['A'].str.split().apply(lambda x: list(map(int, x)))",0.144,56.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,"[list(map(int, i)) for i in df['A'].str.split()]","df['A'].str.split().apply(lambda x: list(map(int, x)))",50.9,56.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,"[list(map(int, i.split())) for i in df['A']]","df['A'].str.split().apply(lambda x: list(map(int, x)))",35.6,56.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,"[list(map(int, i.split())) for i in df['A']]","[list(map(int, i)) for i in df['A'].str.split()]",35.6,50.9
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,[int(x) for i in df['A'] for x in i.split()],"df['A'].str.split().apply(lambda x: list(map(int, x)))",23.6,56.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,pd.DataFrame(nb_calc(df.A)),"[list(map(int, i.split())) for i in df['A']]",0.144,35.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,pd.DataFrame(nb_calc(df.A)),"[list(map(int, i)) for i in df['A'].str.split()]",0.144,50.9
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,[int(x) for i in df['A'] for x in i.split()],"[list(map(int, i.split())) for i in df['A']]",23.6,35.6
52910951,answer,52907094,"python,python-3.x,pandas,numpy",codeblock,https://stackoverflow.com/questions/52910951,pd.DataFrame(nb_calc(df.A)),[int(x) for i in df['A'] for x in i.split()],0.144,23.6
52921592,answer,52921225,"python,pandas",codeblock,https://stackoverflow.com/questions/52921592,"for i in pd.np.arange(limit.size): df1[: limit[i], i] = df1[: limit[i], i] * multiplier[i]","for i in range(limit.shape[0]): df.loc[df.index<limit[i], i] = multiplier[i] * df.loc[:, i]",0.025,3.92
52924308,answer,52924126,"python,numpy",codeblock,https://stackoverflow.com/questions/52924308,"np.take(v,-r,axis=0)",v[-r],1.45,3.06
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[df['F'].apply(lambda x: 3 in x)],df[df['F'].apply(set) >= set([3])],12.2,29
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[[3 in x for x in df['F']]],df[pd.DataFrame(df['F'].values.tolist()).eq(3).any(1)],5.57,37.4
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[[3 in x for x in df['F']]],df[df['F'].apply(set) >= set([3])],5.57,29
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[[3 in x for x in df['F']]],df[df['F'].apply(lambda x: 3 in x)],5.57,12.2
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[df['F'].apply(lambda x: 3 in x)],df[pd.DataFrame(df['F'].values.tolist()).eq(3).any(1)],12.2,37.4
52928850,answer,52928822,"python,pandas,performance,bigdata",codeblock,https://stackoverflow.com/questions/52928850,df[df['F'].apply(set) >= set([3])],df[pd.DataFrame(df['F'].values.tolist()).eq(3).any(1)],29,37.4
52940231,answer,52940086,"python,performance,loops,numpy,vectorization",codeblock,https://stackoverflow.com/questions/52940231,"np.outer(a, np.linspace(0, 1, 4))","np.array([np.linspace(0, i, 4) for i in a])",1.44,1300
52965705,answer,52965532,"python,pandas,numpy,pairwise",codeblock,https://stackoverflow.com/questions/52965705,"~np.tri(len(x1),len(x2),dtype=bool,k=-1)","np.arange(len(x1))[:,None] <= np.arange(len(x2))",0.243,0.772
52978954,answer,4455076,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/52978954,A_c1_copy.sum(),A_c1_ref.sum(),0.0128,0.248
53062101,answer,53061819,"python,numpy,optimization,dynamic-memory-allocation",codeblock,https://stackoverflow.com/questions/53062101,"useless_array = np.array(my_list); useful_array = useless_array.reshape(200,200)","my_np_array = np.array(my_list).reshape(200,200)",1.92,1.92
53062101,answer,53061819,"python,numpy,optimization,dynamic-memory-allocation",codeblock,https://stackoverflow.com/questions/53062101,"useless_array = np.array(my_list); useful_array = useless_array.reshape(200,200)","my_np_array = np.reshape(my_list,(200,200))",1.92,1.92
53062101,answer,53061819,"python,numpy,optimization,dynamic-memory-allocation",codeblock,https://stackoverflow.com/questions/53062101,"my_np_array = np.array(my_list).reshape(200,200)","my_np_array = np.reshape(my_list,(200,200))",1.92,1.92
53166859,answer,53166563,"python,numpy",sentence,using einsum which is faster in this case than conventional sum:,einsum,sum,,
53169381,answer,53169356,"python,pandas,indexing",codeblock,https://stackoverflow.com/questions/53169381,s.loc[s.index.get_level_values(1).isin(my_subset1)],s.query('second in @my_subset2'),0.866,2.19
53169636,answer,53169397,"python,pandas",sentence,or using np.where with pd.DataFrame which is faster than mask method:,np.where,mask,,
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.where(df.apply(lambda x: x.isin(nlargest(2, x)), axis=1), 0)","df.mask(~df.apply(lambda x: x.isin(x.nlargest(2)), axis=1), 0)",92.4,274
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.mask(df.rank(axis=1, method='min', ascending=False) > 2, 0)","df.where(df.apply(lambda x: x.isin(nlargest(2, x)), axis=1), 0)",2.23,92.4
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.where(np.apply_along_axis(rankdata, 1, df, method='max') > 2, 0)","df.mask(~df.apply(lambda x: x.isin(x.nlargest(2)), axis=1), 0)",45,274
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.mask(df.rank(axis=1, method='min', ascending=False) > 2, 0)","df.where(np.apply_along_axis(rankdata, 1, df, method='max') > 2, 0)",2.23,45
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.mask(df.rank(axis=1, method='min', ascending=False) > 2, 0)","df.mask(~df.apply(lambda x: x.isin(x.nlargest(2)), axis=1), 0)",2.23,274
53169744,answer,53169397,"python,pandas",codeblock,https://stackoverflow.com/questions/53169744,"df.where(np.apply_along_axis(rankdata, 1, df, method='max') > 2, 0)","df.where(df.apply(lambda x: x.isin(nlargest(2, x)), axis=1), 0)",45,92.4
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()",df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),0.268,0.77
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()",0.77,0.814
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()","df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()",0.268,0.814
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()",1.03,1.81
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()",1.03,1.07
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()","pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()",1.07,1.81
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),"df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",1.03,25.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()","df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",1.81,25.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),df[min_cols].min().tolist() + df[max_cols].max().tolist(),1.03,1.9
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df[min_cols].min().tolist() + df[max_cols].max().tolist(),"df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",1.02,18.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()","df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",0.814,18.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()",df[min_cols].min().tolist() + df[max_cols].max().tolist(),1.81,1.9
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()",df[min_cols].min().tolist() + df[max_cols].max().tolist(),0.814,1.02
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()","df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",0.268,18.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"pd.np.where(df.columns == 'd', df.max(), df.min()).tolist()",df[min_cols].min().tolist() + df[max_cols].max().tolist(),0.268,1.02
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),"df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",0.77,18.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df.apply(lambda x: x.max() if x.name == 'd' else x.min()).tolist(),df[min_cols].min().tolist() + df[max_cols].max().tolist(),0.77,1.02
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()",df[min_cols].min().tolist() + df[max_cols].max().tolist(),1.07,1.9
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,"df.agg({'a':'min','b':'min','c':'min','d':'max'}).tolist()","df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",1.07,25.7
53174806,answer,53174757,"python,python-3.x,pandas,if-statement,lambda",codeblock,https://stackoverflow.com/questions/53174806,df[min_cols].min().tolist() + df[max_cols].max().tolist(),"df.describe().loc['min','a':'c'].tolist()+df.describe().loc['max',['d']].tolist()",1.9,25.7
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = df.eq(1).dot(df.columns + ', ').str.rstrip(', ')","df['haves'] = [', '.join(df.columns[1:][idx]) for idx in df.iloc[:, 1:].eq(1).values]",2.65,86.5
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = [x.rstrip(', ') for x in df.eq(1).dot(df.columns + ', ')]","df['have'] = df.apply(lambda x: ','.join(x[x.eq(1)].index),1)",2.43,813
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = df.eq(1).dot(df.columns + ', ').str.rstrip(', ')","df['have'] = df.apply(lambda x: ','.join(x[x.eq(1)].index),1)",2.65,813
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = [x.rstrip(', ') for x in df.eq(1).dot(df.columns + ', ')]","df['haves'] = [', '.join(df.columns[1:][idx]) for idx in df.iloc[:, 1:].eq(1).values]",2.43,86.5
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = [x.rstrip(', ') for x in df.eq(1).dot(df.columns + ', ')]","df['haves'] = df.eq(1).dot(df.columns + ', ').str.rstrip(', ')",2.43,2.65
53240933,answer,53240700,"python,pandas",codeblock,https://stackoverflow.com/questions/53240933,"df['haves'] = [', '.join(df.columns[1:][idx]) for idx in df.iloc[:, 1:].eq(1).values]","df['have'] = df.apply(lambda x: ','.join(x[x.eq(1)].index),1)",86.5,813
53261482,answer,53261409,"python,pandas",codeblock,https://stackoverflow.com/questions/53261482,"pd.DataFrame([[x, j] for i, j in zip(a['var1'], a['var2']) for x in list(i)], columns=a.columns)","pd.concat([pd.Series(row['var2'], list(row['var1'])) for _, row in a.iterrows()]).reset_index()",2.82,1800
53261482,answer,53261409,"python,pandas",codeblock,https://stackoverflow.com/questions/53261482,"pd.DataFrame([[x, j] for i, j in zip(a['var1'], a['var2']) for x in list(i)], columns=a.columns)","pd.concat([pd.Series(row['var2'], list(row['var1'])) for _, row in a.iterrows()]).reset_index()",0.355,2.93
53297710,answer,53297676,"python,pandas",codeblock,https://stackoverflow.com/questions/53297710,"df['new'] = df.iloc[:,-13:].gt(0.9).sum(axis=1).astype(int)","df['new'] = df[df.columns[-13:]].apply(lambda x: x > .9, axis=1).sum(axis=1)",3.46,1570
53382988,answer,53382960,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/53382988,"np.where(a == 0, 1, 0)",(~a.astype(bool)).astype(int),1.56,1.74
53390435,answer,53389699,"python,pandas,dataframe",sentence,using fillna() is a lot slower than np.where but has the advantage of being pandas only.,np.where,fillna(),,
53395360,answer,53394523,"python,pandas,dataframe",sentence,df.index.drop(indices) is just a lot faster than ~df.index.isin(indices) (given above data with 10 million rows):,df.index.drop(indices),~df.index.isin(indices),,
53395360,answer,53394523,"python,pandas,dataframe",codeblock,df.index.drop(indices) is just a lot faster than ~df.index.isin(indices) (given above data with 10 million rows):,df.index.drop(indices),~df.index.isin(indices),388,4550
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.iloc[df.index.drop(indices)],df[~df.index.isin(indices)],32.7,41.3
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.iloc[df.index.drop(indices)],df[~df.index.isin(indices)],752,4980
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.loc[df.index.drop(indices)],df[~df.index.isin(indices)],2650,4980
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.iloc[df.index.drop(indices)],df.loc[df.index.drop(indices)],752,2650
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.iloc[dropped_index],df[boolean_mask],371,489
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df[boolean_mask],df.loc[dropped_index],489,2380
53395360,answer,53394523,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53395360,df.iloc[dropped_index],df.loc[dropped_index],371,2380
53489994,answer,53489897,"python,pandas,csv",sentence,"if you want to perform replacement on multiple columns simultaneously, you should use df.replace (it is slower than map, so use it only if you can afford to).",map,df.replace,,
53535753,answer,53535564,"python,pandas",codeblock,https://stackoverflow.com/questions/53535753,"[Points(int(row[0]),row[1]) for row in score.itertuples()]","[Points(int(row[0]),row[1]) for index, row in score.iterrows()]",3.64,259
53561900,answer,53561082,"python,numpy",codeblock,https://stackoverflow.com/questions/53561900,"arr = np.arange(N); A = np.sqrt(arr + arr[:,np.newaxis]+ arr[:,np.newaxis,np.newaxis])","A = np.sqrt(np.sum(np.ogrid[:N,:N,:N]))",0.0186,0.0585
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.nickname.eq('Y').groupby(df.name).transform('all')],"df[df['name'].isin(df.loc[df['nickname'].ne('Y'), 'name'].unique())]",27.3,28.9
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[df.nickname.ne('Y').groupby(df.name).transform('sum').astype(bool)],df.groupby('name').filter(lambda x: any(x['nickname'] != 'Y')),27.6,408
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[df.nickname.ne('Y').groupby(df.name).transform('sum').astype(bool)],"df[df['name'].isin(df.loc[df['nickname'].ne('Y'), 'name'].unique())]",27.6,28.9
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[df.nickname.ne('Y').groupby(df.name).transform('sum').astype(bool)],df[~df.assign(mask=df.nickname.eq('Y')).groupby('name').mask.transform('all')],27.6,30.3
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[df.nickname.ne('Y').groupby(df.name).transform('sum').astype(bool)],"df[df.groupby('name')['nickname'].transform('unique').astype(str) !=""['Y']""]",27.6,15600
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df.groupby('name').filter(lambda x: any(x['nickname'] != 'Y')),"df[df.groupby('name')['nickname'].transform('unique').astype(str) !=""['Y']""]",408,15600
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.nickname.eq('Y').groupby(df.name).transform('all')],df[df.nickname.ne('Y').groupby(df.name).transform('sum').astype(bool)],27.3,27.6
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.assign(mask=df.nickname.eq('Y')).groupby('name').mask.transform('all')],"df[df.groupby('name')['nickname'].transform('unique').astype(str) !=""['Y']""]",30.3,15600
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.assign(mask=df.nickname.eq('Y')).groupby('name').mask.transform('all')],df.groupby('name').filter(lambda x: any(x['nickname'] != 'Y')),30.3,408
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.nickname.eq('Y').groupby(df.name).transform('all')],"df[df.groupby('name')['nickname'].transform('unique').astype(str) !=""['Y']""]",27.3,15600
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.nickname.eq('Y').groupby(df.name).transform('all')],df.groupby('name').filter(lambda x: any(x['nickname'] != 'Y')),27.3,408
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,df[~df.nickname.eq('Y').groupby(df.name).transform('all')],df[~df.assign(mask=df.nickname.eq('Y')).groupby('name').mask.transform('all')],27.3,30.3
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,"df[df['name'].isin(df.loc[df['nickname'].ne('Y'), 'name'].unique())]","df[df.groupby('name')['nickname'].transform('unique').astype(str) !=""['Y']""]",28.9,15600
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,"df[df['name'].isin(df.loc[df['nickname'].ne('Y'), 'name'].unique())]",df[~df.assign(mask=df.nickname.eq('Y')).groupby('name').mask.transform('all')],28.9,30.3
53629764,answer,53629720,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53629764,"df[df['name'].isin(df.loc[df['nickname'].ne('Y'), 'name'].unique())]",df.groupby('name').filter(lambda x: any(x['nickname'] != 'Y')),28.9,408
53633314,answer,53632928,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/53633314,"np.where(df['A'] < j, 1, df['A'])","np.where((df['A'] >= i1) & (df['A'] < i2), 1, 2)",113,146
53633314,answer,53632928,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/53633314,"np.where(df['A'] < j, 1, 2)","np.where((df['A'] >= i1) & (df['A'] < i2), 1, df['A'])",85.5,161
53643611,answer,53643526,"python,arrays,numpy",sentence,"by my tests, np.repeat is a little faster than np.tile:",np.repeat,np.tile,,
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[df[""Spend""] > LIMIT].groupby(""Name"").size().div(df.groupby(""Name"").size(), fill_value=0)",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).mean()),6.35,328
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[df[""Spend""] > LIMIT].groupby(""Name"").size().div(df.groupby(""Name"").size(), fill_value=0)",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).sum()/s.size),6.35,400
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[df[""Spend""] > LIMIT].groupby(""Name"").size().div(df.groupby(""Name"").size(), fill_value=0)","(df[""Spend""].gt(LIMIT).groupby(df[""Name""]).sum().div(df.groupby(""Name"").size(), fill_value=0))",6.35,9.66
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"(df[""Spend""].gt(LIMIT).groupby(df[""Name""]).sum().div(df.groupby(""Name"").size(), fill_value=0))",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).sum()/s.size),9.66,400
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"(df[""Spend""].gt(LIMIT).groupby(df[""Name""]).sum().div(df.groupby(""Name"").size(), fill_value=0))",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).mean()),9.66,328
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).mean()),df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).sum()/s.size),328,400
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[""Spend""].gt(LIMIT).groupby(df[""Name""]).mean()",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).mean()),6.16,328
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[""Spend""].gt(LIMIT).groupby(df[""Name""]).mean()",df.groupby('Name')['Spend'].apply(lambda s: (s>LIMIT).sum()/s.size),6.16,400
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[""Spend""].gt(LIMIT).groupby(df[""Name""]).mean()","(df[""Spend""].gt(LIMIT).groupby(df[""Name""]).sum().div(df.groupby(""Name"").size(), fill_value=0))",6.16,9.66
53689985,answer,53689654,"python,pandas,group-by,vectorization,apply",codeblock,https://stackoverflow.com/questions/53689985,"df[""Spend""].gt(LIMIT).groupby(df[""Name""]).mean()","df[df[""Spend""] > LIMIT].groupby(""Name"").size().div(df.groupby(""Name"").size(), fill_value=0)",6.16,6.35
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,pd.DataFrame([x.split(':') for x in df.Description]).dropna(),"pd.concat([df, df.Description.str.extract('(?P<Machine>[^:]+)\s+:\s+(?P<Action>[^:]+)').fillna('')], axis=1)",4.47,22.5
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,pd.DataFrame([x.split(':') for x in df.Description]).dropna(),"df.Description.str.extract('(.*) : (.*)',expand=True)",4.47,16.6
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,pd.DataFrame([x.split(':') for x in df.Description]).dropna(),"df.Description.str.split(':',expand=True).dropna()",4.47,14.9
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,"df.Description.str.extract('(.*) : (.*)',expand=True)","pd.concat([df, df.Description.str.extract('(?P<Machine>[^:]+)\s+:\s+(?P<Action>[^:]+)').fillna('')], axis=1)",16.6,22.5
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,"df.Description.str.split(':',expand=True).dropna()","df.Description.str.extract('(.*) : (.*)',expand=True)",14.9,16.6
53695625,answer,53695005,"python,pandas",codeblock,https://stackoverflow.com/questions/53695625,"df.Description.str.split(':',expand=True).dropna()","pd.concat([df, df.Description.str.extract('(?P<Machine>[^:]+)\s+:\s+(?P<Action>[^:]+)').fillna('')], axis=1)",14.9,22.5
53725913,answer,53725762,"python,sql,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53725913,df[df[list(code_selection)].values.all(1)],df[df[list(code_selection)].all(1)],52.6,61.2
53725913,answer,53725762,"python,sql,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53725913,"df[get_mask(df.values, df.columns.get_indexer(code_selection))]",df[df[list(code_selection)].all(1)],36.1,61.2
53725913,answer,53725762,"python,sql,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53725913,"df[get_mask(df.values, df.columns.get_indexer(code_selection))]",df[df[list(code_selection)].values.all(1)],36.1,52.6
53743848,answer,53743474,"python,pandas",codeblock,https://stackoverflow.com/questions/53743848,"df.fillna(pd.DataFrame(df[cols].sum(1).div(df[cols].notnull().sum(1)).values[:,None] * np.ones([len(cols),1]).T, columns=cols))","df.combine_first(df.groupby(lambda x: x[0], axis=1).transform('mean'))",5.73,856
53762571,answer,53762144,"python,numpy,random",codeblock,https://stackoverflow.com/questions/53762571,"np.random.choice([0, 1, 1, 1], size=10000)","np.random.binomial(1, 0.75, 10000)",0.0718,0.174
53768857,answer,53768110,"python,arrays,numpy",codeblock,https://stackoverflow.com/questions/53768857,"np.array([foo(row) for row in dat],int)",np.vstack(np.char.split(dat).sum(axis=1)).astype(int),0.00874,0.061
64972099,comment,19365513,"python,pandas",sentence,df.loc[df.shape[0]] (even df.loc[len(df.index)]) is much faster than df.loc[len(df)].,df.loc[df.shape[0]],df.loc[len(df)],,
66010751,comment,39339646,"python,numpy,scipy",sentence,"for large N, np.zeros( (N,) ) + eta would be faster than np.ones( (N,) ) * eta","np.zeros( (N,) ) + eta","np.ones( (N,) ) * eta",,
76048751,comment,44527956,"python,pandas,numpy,dataframe,concatenation",sentence,df1['Date'].astype(str) is more idiomatic and should be faster compared to df1['Date'].apply(str),df1['Date'].astype(str),df1['Date'].apply(str),,
76868494,comment,24870953,"python,performance,pandas,iteration",sentence,somehow itertuples is faster than apply :(,itertuples,apply,,
93027835,comment,53063728,"python,pandas,numpy",sentence,note that np.arange() method above is 100 times faster than pd.cut() which in turn is about 20 % faster than pd.qcut().,pd.cut(),pd.qcut(),,
54411737,answer,54411711,"python,pandas",sentence,"map is faster than replace, depending on the number of columns to replace.",map,replace,,
54481286,answer,54481056,"python,pandas,numpy",sentence,using np.random.normal directly to take advantage of numpy's vector operations is much faster than using panda's apply function:,np.random.normal,apply,,
55597953,answer,55597138,"python,pandas",sentence,i'd be willing to bet that df.at() would be at least one thousand times faster than df.loc():,df.at,df.loc,,
55598723,answer,55598616,"python,pandas",sentence,"use numpy.where, it's faster than apply or itterating:",numpy.where,apply,,
55927458,answer,55927017,"python,pandas,powerbi-desktop",sentence,try using np.select which will work faster than using .loc four times.,np.select,.loc,,
56107799,answer,56105974,"pandas,numpy,filter",sentence,i've found that frompyfunc is faster than np.vectorize (though they are related):,frompyfunc,np.vectorize,,
56244780,answer,56244406,"python,pandas,numpy",sentence,normally we see that pd.read_csv is faster than genfromtxt.,pd.read_csv,genfromtxt,,
56252184,answer,56251620,"python,pandas",sentence,i tested and appears that at is faster than iat.,at,iat,,
54540816,answer,54540649,"python,numpy",sentence,in this last case the python sum is faster than than np.sum.,sum,np.sum,,
55891483,answer,55890268,"python,string,numpy,numpy-ndarray",sentence,usually frompyfunc is faster than vectorize.,frompyfunc,vectorize,,
57299067,answer,2850743,"python,vector,numpy,normalization",sentence,"for the two-dimensional case, using np.hypot(vectors[:,0],vectors[:,1]) looks to be faster than freddie witherden's np.sqrt(np.einsum('...i,...i', vectors, vectors)) for calculating the magnitudes.","np.hypot(vectors[:,0],vectors[:,1])","np.sqrt(np.einsum('...i,...i', vectors, vectors))",,
31496711,answer,31495895,"python,pandas,python-multiprocessing",codeblock,https://stackoverflow.com/questions/31496711,"df['date'] = np.array(df['date_str'], '<M8[D]')+np.array(df['seconds_past_midnight'], dtype='<m8[s]')","df['date2'] = pd.to_datetime(df['date_str']) + pd.to_timedelta(df['seconds_past_midnight'],unit='s')",94.6,188
41408038,answer,33279940,"python,pandas,text,dataframe,concatenation",codeblock,https://stackoverflow.com/questions/41408038,"', '.join(df.words)","df.words.str.cat(sep=', ')",0.014,0.0722
41408038,answer,33279940,"python,pandas,text,dataframe,concatenation",codeblock,https://stackoverflow.com/questions/41408038,"', '.join(df.words)","df.words.str.cat(sep=', ')",1.91,5.2
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1),df.col1.str.cat(sep=' '),0.796,2.71
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1.values.tolist()),df.col1.str.cat(sep=' '),0.492,2.71
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1.values.tolist()),' '.join(df.col1),0.492,0.796
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1),df.col1.str.cat(sep=' '),9.22,29.7
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1.values.tolist()),df.col1.str.cat(sep=' '),6.69,29.7
46412329,answer,46412308,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/46412329,' '.join(df.col1.values.tolist()),' '.join(df.col1),6.69,9.22
49995329,answer,20025882,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/49995329,'str' + df['col'].astype(str),"df['col'].apply(lambda x: f""str{x}"")",112,117
53608248,answer,53608142,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53608248,"df['Code'] = [''.join(f'{x.count(i)}{i}' for i in sorted(set(x),key=x.index)) for x in df['Code']]","df['Code'] = [''.join(f'{j}{i}' for i, j in Counter(x).items()) for x in df['Code']]",262,276
53608248,answer,53608142,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53608248,"df['Code'] = [''.join(f'{j}{i}' for i, j in Counter(x).items()) for x in df['Code']]","df['Code']=df['Code'].apply(lambda x: ''.join([''.join(map(str,i)) for i in Counter(x).items()]))",276,339
53608248,answer,53608142,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53608248,"df['Code'] = [''.join(f'{x.count(i)}{i}' for i in sorted(set(x),key=x.index)) for x in df['Code']]","df['Code']=df['Code'].apply(lambda x: ''.join([''.join(map(str,i)) for i in Counter(x).items()]))",262,339
53849204,answer,53849030,"python,pandas,list,dataframe",codeblock,https://stackoverflow.com/questions/53849204,"pd.DataFrame.from_dict({'A' : A, 'B' : B, 'C' : C}, orient='index').T","pd.DataFrame([pd.Series(x) for x in [A,B,C]], index=list('ABC')).T",0.977,1.23
53849204,answer,53849030,"python,pandas,list,dataframe",codeblock,https://stackoverflow.com/questions/53849204,"pd.DataFrame.from_records(list(zip_longest(A, B, C)), columns=['A', 'B', 'C'])","pd.DataFrame([pd.Series(x) for x in [A,B,C]], index=list('ABC')).T",0.545,1.23
53849204,answer,53849030,"python,pandas,list,dataframe",codeblock,https://stackoverflow.com/questions/53849204,"pd.DataFrame.from_records(list(zip_longest(A, B, C)), columns=['A', 'B', 'C'])","pd.DataFrame.from_dict({'A' : A, 'B' : B, 'C' : C}, orient='index').T",0.545,0.977
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",30.3,33.5
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",25.3,33.5
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",24.3,33.5
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]","[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]",25.3,30.3
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]",24.3,30.3
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]",24.3,25.3
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",314,333
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",243,333
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]","[pd.Series(pd.date_range(row[1].START_DATE, row[1].END_DATE)) for row in df[['START_DATE', 'END_DATE']].iterrows()]",246,333
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]",243,314
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]","[pd.date_range(row[1].START_DATE, row[1].END_DATE) for row in df[['START_DATE', 'END_DATE']].iterrows()]",246,314
53850228,answer,53850204,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/53850228,"[pd.Series(pd.date_range(s, e)) for s, e in zip(df['START_DATE'], df['END_DATE'])]","[pd.Series(pd.date_range(r.START_DATE, r.END_DATE)) for r in df.itertuples()]",243,246
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = df.stack().groupby(level=0).nunique(),df['num_uniq'] = [len(set(v[pd.notna(v)])) for v in df.values],6.34,196
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = [len(set(v[pd.notna(v)])) for v in df.values],"df['num_uniq'] = df.apply(pd.Series.nunique, axis=1)",196,679
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = df.nunique(1),df['num_uniq'] = [len(set(v[pd.notna(v)])) for v in df.values],3.21,196
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = df.stack().groupby(level=0).nunique(),"df['num_uniq'] = df.apply(pd.Series.nunique, axis=1)",6.34,679
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = df.nunique(1),df['num_uniq'] = df.stack().groupby(level=0).nunique(),3.21,6.34
53862591,answer,53862521,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/53862591,df['num_uniq'] = df.nunique(1),"df['num_uniq'] = df.apply(pd.Series.nunique, axis=1)",3.21,679
53953157,answer,53953121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53953157,np.nanmean(df_values.values[df_condition.eq('y')]),np.nanmean(df_values.where(df_condition == 'y').values),32,88
53953157,answer,53953121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53953157,np.nanmean(df_values.values[df_condition.eq('y')]),df_values[df_condition.eq('y')].stack().mean(),32,107
53953157,answer,53953121,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/53953157,np.nanmean(df_values.where(df_condition == 'y').values),df_values[df_condition.eq('y')].stack().mean(),88,107
53953464,answer,53953412,"python,pandas",codeblock,https://stackoverflow.com/questions/53953464,"pd.concat((pd.Series(v, name=k) for d in L for k, v in d.items()), axis=1)","pd.concat(map(pd.DataFrame, L), axis=1)",480,1250
54055893,answer,54055850,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/54055893,df[df.groupby('ID')['Location'].transform('nunique') > 1],df.groupby('ID').filter(lambda x: x['Location'].nunique() > 1),5.56,356
54060486,answer,54060287,"python,pandas,list",codeblock,https://stackoverflow.com/questions/54060486,df['tags'].apply(pd.Series),"df.apply(lambda x: pd.Series(x['tags']),axis=1)",681,792
54060486,answer,54060287,"python,pandas,list",codeblock,https://stackoverflow.com/questions/54060486,pd.DataFrame(df['tags'].values.tolist()),"df.apply(lambda x: pd.Series(x['tags']),axis=1)",0.715,792
54060486,answer,54060287,"python,pandas,list",codeblock,https://stackoverflow.com/questions/54060486,pd.DataFrame(df['tags'].values.tolist()),df['tags'].apply(pd.Series),0.715,681
54111644,answer,54111553,"pandas,datetime",codeblock,https://stackoverflow.com/questions/54111644,"df['desired_date1'] = pd.to_datetime(df['Date_Installed'].values.astype(np.int64) + pd.to_timedelta(df['days_from_instalation'], unit='d').values.astype(np.int64), unit='ns')","df['desired_date'] = df['Date_Installed'] + pd.to_timedelta(df['days_from_instalation'], unit='d')",0.886,1.53
54198345,answer,54196959,"python-3.x,pandas,jupyter-notebook,drop-duplicates",codeblock,https://stackoverflow.com/questions/54198345,"pd.concat({col: pd.Series(df[col].unique()) for col in df.columns}, axis=1)",df.apply(lambda col: col.drop_duplicates().reset_index(drop=True)),430,1070
54198345,answer,54196959,"python-3.x,pandas,jupyter-notebook,drop-duplicates",codeblock,https://stackoverflow.com/questions/54198345,"pd.concat({col: pd.Series(df[col].unique()) for col in df.columns}, axis=1)",df.apply(lambda col: col.drop_duplicates().reset_index(drop=True)),654,1300
54220004,answer,54219706,"python,string,pandas",codeblock,https://stackoverflow.com/questions/54220004,sum(['HS+P+SD' in x for x in df['class']]),"df['class'].str.contains('HS+P+SD', regex=False).sum()",0.123,0.41
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,"df.where(np.isfinite(df) | np.isnan(df), 1000000)","df.replace(np.inf, 1000000)",4.26,9.44
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,"df.where(np.isfinite(df), 1000000)","df.replace(np.inf, 1000000)",3.37,9.44
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,df.clip_upper(1000000),"df.replace(np.inf, 1000000)",0.605,9.44
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,"df.where(np.isfinite(df), 1000000)","df.where(np.isfinite(df) | np.isnan(df), 1000000)",3.37,4.26
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,df.clip_upper(1000000),"df.where(np.isfinite(df) | np.isnan(df), 1000000)",0.605,4.26
54275181,answer,54275153,"python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54275181,df.clip_upper(1000000),"df.where(np.isfinite(df), 1000000)",0.605,3.37
54280970,answer,54280953,"python,pandas",codeblock,https://stackoverflow.com/questions/54280970,"df.drop_duplicates(['ID', 'Type']).pivot('ID', 'Type', 'Value')","df.pivot_table(index='ID', columns='Type', values='Value', aggfunc='first')",8.63,15.2
54280970,answer,54280953,"python,pandas",codeblock,https://stackoverflow.com/questions/54280970,"df.groupby(['ID', 'Type']).Value.first().unstack(1)","df.pivot_table(index='ID', columns='Type', values='Value', aggfunc='first')",8.34,15.2
54280970,answer,54280953,"python,pandas",codeblock,https://stackoverflow.com/questions/54280970,"df.groupby(['ID', 'Type']).Value.first().unstack(1)","df.drop_duplicates(['ID', 'Type']).pivot('ID', 'Type', 'Value')",8.34,8.63
54292863,answer,54292794,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54292863,"df.iloc[:, ::-1]",df.reindex(columns=reversed(df.columns)),0.132,7.32
54292863,answer,54292794,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54292863,df[df.columns[::-1]],df.reindex(columns=reversed(df.columns)),2.84,7.32
54292863,answer,54292794,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/54292863,"df.iloc[:, ::-1]",df[df.columns[::-1]],0.132,2.84
54302952,answer,54302895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54302952,df.loc['r3'] = (df.loc['r1'] - df.loc['r2']).abs(),df.append(df.diff().dropna().abs()),0.663,1.51
54302952,answer,54302895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54302952,"df.loc[""r3""] = df.apply(lambda c: abs(c[""r1""] - c[""r2""]), axis=0)",df.append(df.diff().dropna().abs()),0.967,1.51
54302952,answer,54302895,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54302952,df.loc['r3'] = (df.loc['r1'] - df.loc['r2']).abs(),"df.loc[""r3""] = df.apply(lambda c: abs(c[""r1""] - c[""r2""]), axis=0)",0.663,0.967
54377659,answer,54377647,"python,pandas",codeblock,https://stackoverflow.com/questions/54377659,(s.index[s > 2]),"([k for k, v in s.items() if v > 2])",0.93,13.3
54377659,answer,54377647,"python,pandas",codeblock,https://stackoverflow.com/questions/54377659,(s.index[s.values > 2]),"([k for k, v in s.items() if v > 2])",0.742,13.3
54377659,answer,54377647,"python,pandas",codeblock,https://stackoverflow.com/questions/54377659,(s.index.values[s.values > 2]),"([k for k, v in s.items() if v > 2])",0.647,13.3
54377659,answer,54377647,"python,pandas",codeblock,https://stackoverflow.com/questions/54377659,(s.index.values[s.values > 2]),(s.index[s > 2]),0.647,0.93
54377659,answer,54377647,"python,pandas",codeblock,https://stackoverflow.com/questions/54377659,(s.index.values[s.values > 2]),(s.index[s.values > 2]),0.647,0.742
54377754,answer,54377732,"python,pandas",codeblock,https://stackoverflow.com/questions/54377754,(np.sum((df['factor'].values * df['value'].values))),((df['factor'] * df['value']).sum()),0.0206,0.245
54377754,answer,54377732,"python,pandas",codeblock,https://stackoverflow.com/questions/54377754,(np.nansum((df['factor'].values * df['value'].values))),((df['factor'] * df['value']).sum()),0.0333,0.235
54399214,answer,44123874,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/54399214,df2.sort_index(),df2.iloc[df2.index.argsort()],0.605,0.61
54399214,answer,44123874,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/54399214,df2.reindex(np.sort(df2.index)),df2.sort_index(),0.581,0.605
54399214,answer,44123874,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/54399214,df2.reindex(np.sort(df2.index)),df2.iloc[df2.index.argsort()],0.581,0.61
54432584,answer,54432583,"python,pandas,performance,apply",codeblock,https://stackoverflow.com/questions/54432584,df.sum(),df.apply(np.sum),0.471,2.22
54432584,answer,54432583,"python,pandas,performance,apply",codeblock,https://stackoverflow.com/questions/54432584,df.max() - df.min(),df.apply(lambda x: x.max() - x.min()),1.23,2.43
54454381,answer,54453309,"python,pandas",codeblock,https://stackoverflow.com/questions/54454381,(myseries.index.values[myseries.values].tolist()),(myseries.index[myseries].tolist()),0.113,0.178
54454381,answer,54453309,"python,pandas",codeblock,https://stackoverflow.com/questions/54454381,myseries[myseries].index.tolist(),myseries.where(myseries).dropna().index,0.456,1.14
54454381,answer,54453309,"python,pandas",codeblock,https://stackoverflow.com/questions/54454381,myseries[myseries].index.tolist(),"[i for i,j in myseries.items() if j==True]",0.456,2.13
54454381,answer,54453309,"python,pandas",codeblock,https://stackoverflow.com/questions/54454381,myseries.where(myseries).dropna().index,"[i for i,j in myseries.items() if j==True]",1.14,2.13
54464619,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464619,"df.values[df['more_numbers']==4,0]=1","df.loc[df['more_numbers']==4,'numbers']=1",0.127,0.692
54464658,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464658,"np.where(df.more_numbers == 4, 1, df.numbers)","df.loc[df.more_numbers==4,'numbers']=1",0.547,7.09
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,df['n'].values[df['m'].values == 4] = 1,"df.loc[df['m'] == 4, 'n'] = 1",0.436,1.3
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df['n'] = np.where(df['m'].values == 4, 1, df['n'])","df.loc[df['m'] == 4, 'n'] = 1",0.751,1.3
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df.iloc[df['m'].values == 4, df.columns.get_loc('n')] = 1","df.loc[df['m'] == 4, 'n'] = 1",0.88,1.3
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df.loc[df['m'] == 4, 'n'] = 1","df['n'] = df['n'].mask(df['m'].values == 4, 1)",1.3,1.34
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,df['n'].values[df['m'].values == 4] = 1,"df['n'] = np.where(df['m'].values == 4, 1, df['n'])",0.436,0.751
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,df['n'].values[df['m'].values == 4] = 1,"df.iloc[df['m'].values == 4, df.columns.get_loc('n')] = 1",0.436,0.88
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,df['n'].values[df['m'].values == 4] = 1,"df.loc[df['m'].values == 4, 'n'] = 1",0.436,1.12
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,df['n'].values[df['m'].values == 4] = 1,"df['n'] = df['n'].mask(df['m'].values == 4, 1)",0.436,1.34
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df['n'] = np.where(df['m'].values == 4, 1, df['n'])","df.iloc[df['m'].values == 4, df.columns.get_loc('n')] = 1",0.751,0.88
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df['n'] = np.where(df['m'].values == 4, 1, df['n'])","df.loc[df['m'].values == 4, 'n'] = 1",0.751,1.12
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df['n'] = np.where(df['m'].values == 4, 1, df['n'])","df['n'] = df['n'].mask(df['m'].values == 4, 1)",0.751,1.34
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df.iloc[df['m'].values == 4, df.columns.get_loc('n')] = 1","df.loc[df['m'].values == 4, 'n'] = 1",0.88,1.12
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df.iloc[df['m'].values == 4, df.columns.get_loc('n')] = 1","df['n'] = df['n'].mask(df['m'].values == 4, 1)",0.88,1.34
54464861,answer,54464580,"python,pandas,performance,numpy",codeblock,https://stackoverflow.com/questions/54464861,"df.loc[df['m'].values == 4, 'n'] = 1","df['n'] = df['n'].mask(df['m'].values == 4, 1)",1.12,1.34
54465244,answer,54465123,"python,pandas",codeblock,https://stackoverflow.com/questions/54465244,df.columns[df.values.argmax(1)],df.idxmax(axis=1),0.914,47.5
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"[['|'.join([k for k in a if k])] for a in zip(*df.fillna('').astype(str).iloc[:, 1:].values)]","df.filter(like='col').agg(lambda x: x.dropna().astype(int).astype(str).str.cat(sep='|'), axis=1)",10.8,1680
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"[['|'.join([k for k in a if k])] for a in zip(*df.fillna('').astype(str).iloc[:, 1:].values)]","df.iloc[:, 1:].apply(lambda x: '|'.join(str(el) for el in x if str(el) != 'nan'), axis=1)",10.8,87.8
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"[['|'.join([k for k in a if k])] for a in zip(*df.fillna('').astype(str).iloc[:, 1:].values)]","df.assign(new_col=['|'.join([str(int(x)) for x in r if ~np.isnan(x)]) for r in df.iloc[:,1:].values])",10.8,45.1
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"df.iloc[:, 1:].apply(lambda x: '|'.join(str(el) for el in x if str(el) != 'nan'), axis=1)","df.filter(like='col').agg(lambda x: x.dropna().astype(int).astype(str).str.cat(sep='|'), axis=1)",87.8,1680
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"df.assign(new_col=['|'.join([str(int(x)) for x in r if ~np.isnan(x)]) for r in df.iloc[:,1:].values])","df.filter(like='col').agg(lambda x: x.dropna().astype(int).astype(str).str.cat(sep='|'), axis=1)",45.1,1680
54468848,answer,54468506,"python,string,pandas,dataframe,nan",codeblock,https://stackoverflow.com/questions/54468848,"df.assign(new_col=['|'.join([str(int(x)) for x in r if ~np.isnan(x)]) for r in df.iloc[:,1:].values])","df.iloc[:, 1:].apply(lambda x: '|'.join(str(el) for el in x if str(el) != 'nan'), axis=1)",45.1,87.8
54507592,answer,54507486,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54507592,np.logical_or(*df.values.T),df.any(axis=1),4.98,50
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.hstack((S1.values[:, None], S2.values[:, None]))","arr = np.vstack((S1, S2)).T",0.133,0.176
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.hstack((S1.values[:, None], S2.values[:, None]))","arr = pd.concat([S1.reset_index(drop=True), S2.reset_index(drop=True)], axis=1).values",0.133,1.49
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.hstack((S1.values[:, None], S2.values[:, None]))","arr = np.c_[S1, S2]",0.133,0.32
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.hstack((S1.values[:, None], S2.values[:, None]))","np.array(list(zip(S1, S2)))",0.133,33
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.vstack((S1, S2)).T","arr = pd.concat([S1.reset_index(drop=True), S2.reset_index(drop=True)], axis=1).values",0.176,1.49
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.vstack((S1, S2)).T","arr = np.c_[S1, S2]",0.176,0.32
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.vstack((S1, S2)).T","np.array(list(zip(S1, S2)))",0.176,33
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.c_[S1, S2]","arr = pd.concat([S1.reset_index(drop=True), S2.reset_index(drop=True)], axis=1).values",0.32,1.49
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = pd.concat([S1.reset_index(drop=True), S2.reset_index(drop=True)], axis=1).values","np.array(list(zip(S1, S2)))",1.49,33
54608340,answer,54608224,"python,pandas,numpy,series,numpy-ndarray",codeblock,https://stackoverflow.com/questions/54608340,"arr = np.c_[S1, S2]","np.array(list(zip(S1, S2)))",0.32,33
54615927,answer,54615882,"python,arrays,pandas,numpy",codeblock,https://stackoverflow.com/questions/54615927,"arr = df.values.reshape(15, 100, 4).transpose(2, 0, 1)",df.to_xarray().to_array(),0.00331,3.18
54625087,answer,54625052,"python,pandas",codeblock,https://stackoverflow.com/questions/54625087,df[df.c1.ne(df.c1.shift()) | df.c1.ne(df.c1.shift(-1))],"df.groupby(df.c1.ne(df.c1.shift()).cumsum(), as_index=False).nth([0, -1])",1.53,3.57
54646612,answer,54646571,"pandas,loops,conditional-statements",codeblock,https://stackoverflow.com/questions/54646612,df['tar_rm'] = (df['animal'].isin(l).values | df['color'].isin(l).values).astype(int),"df['tar_rm'] = df[['animal','color']].isin(l).any(axis=1).astype(int)",0.487,2.11
54646612,answer,54646571,"pandas,loops,conditional-statements",codeblock,https://stackoverflow.com/questions/54646612,"df['tar_rm'] = np.where(df['animal'].isin(l) | df['color'].isin(l), 1, 0)","df['tar_rm'] = df[['animal','color']].isin(l).any(axis=1).astype(int)",0.805,2.11
54646612,answer,54646571,"pandas,loops,conditional-statements",codeblock,https://stackoverflow.com/questions/54646612,df['tar_rm'] = (df['animal'].isin(l).values | df['color'].isin(l).values).astype(int),"df['tar_rm'] = np.where(df['animal'].isin(l) | df['color'].isin(l), 1, 0)",0.487,0.805
54683422,answer,54682735,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/54683422,"np.frombuffer(x.tobytes(), dtype='S16')","np.fromiter((row.tobytes() for row in x), dtype='S16')",0.0028,0.614
54688919,answer,54688625,"python-3.x,pandas,performance,numpy,pandas-groupby",codeblock,https://stackoverflow.com/questions/54688919,df.groupby('group')['date'].transform('max') < np.datetime64('2017-01-30'),df.groupby('group')['date'].transform(lambda x: x.max() < np.datetime64('2017-01-30')),9.81,9050
54708804,answer,54708761,pandas,codeblock,https://stackoverflow.com/questions/54708804,"df['new1'] = np.where(df['finish'] <='2019-02-01 21:00:00', 30, 5)",df['new2'] = df['finish'].map(lambda x: 30 if x<=pd.Timestamp('2019-02-01 21:00:00') else 5),0.465,22.4
54749803,answer,54749421,"python,python-3.x,pandas,list,counter",codeblock,https://stackoverflow.com/questions/54749803,df.groupby(0)[0].transform(len),[MyList.count(i) for i in MyList],3.89,1320
54749803,answer,54749421,"python,python-3.x,pandas,list,counter",codeblock,https://stackoverflow.com/questions/54749803,df.groupby(0)[0].transform(len),[MyList.count(i) for i in MyList],1330,1360
54750003,answer,54749421,"python,python-3.x,pandas,list,counter",codeblock,https://stackoverflow.com/questions/54750003,[MyList.count(i) for i in MyList],pd.DataFrame(MyList).groupby(MyList).transform(len)[0].tolist(),413,2180
54750003,answer,54749421,"python,python-3.x,pandas,list,counter",codeblock,https://stackoverflow.com/questions/54750003,pd.DataFrame(MyList).groupby(MyList).transform(len)[0].tolist(),[MyList.count(i) for i in MyList],2440,41200
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,df1.assign(**df2.iloc[0]),"df2.iloc[[0]].reindex(df1.index, method='ffill').join(df1)",23,35.7
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,df1.assign(**df2.iloc[0]),"pd.DataFrame(df2.iloc[0].to_dict(), index=df1.index).join(df1)",23,54.7
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,df1.assign(**df2.iloc[0]),"pd.DataFrame(np.broadcast_to(df2.values, (len(df1),len(df2.columns))), columns=df2.columns, index=df1.index).join(df1)",23,27.8
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,df1.assign(**df2.iloc[0]),"df1.join(df2, how='outer').fillna(method='ffill')",23,244
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"df2.iloc[[0]].reindex(df1.index, method='ffill').join(df1)","pd.DataFrame(df2.iloc[0].to_dict(), index=df1.index).join(df1)",35.7,54.7
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"pd.DataFrame(np.broadcast_to(df2.values, (len(df1),len(df2.columns))), columns=df2.columns, index=df1.index).join(df1)","df2.iloc[[0]].reindex(df1.index, method='ffill').join(df1)",27.8,35.7
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"df2.iloc[[0]].reindex(df1.index, method='ffill').join(df1)","df1.join(df2, how='outer').fillna(method='ffill')",35.7,244
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"pd.DataFrame(np.broadcast_to(df2.values, (len(df1),len(df2.columns))), columns=df2.columns, index=df1.index).join(df1)","pd.DataFrame(df2.iloc[0].to_dict(), index=df1.index).join(df1)",27.8,54.7
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"pd.DataFrame(df2.iloc[0].to_dict(), index=df1.index).join(df1)","df1.join(df2, how='outer').fillna(method='ffill')",54.7,244
54827533,answer,54827365,"python,pandas",codeblock,https://stackoverflow.com/questions/54827533,"pd.DataFrame(np.broadcast_to(df2.values, (len(df1),len(df2.columns))), columns=df2.columns, index=df1.index).join(df1)","df1.join(df2, how='outer').fillna(method='ffill')",27.8,244
54940316,answer,54940034,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54940316,df.rolling(2).mean().iloc[1::2],df.groupby(df.index // 2).mean(),1.17,1.47
54940316,answer,54940034,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/54940316,df.groupby(df.index // 2).mean(),df.rolling(2).mean().iloc[1::2].reset_index(drop=True),23.1,25.5
54967514,answer,54967457,"python,pandas,series",codeblock,https://stackoverflow.com/questions/54967514,"(ser.apply(lambda x: isinstance(x, pd.Timestamp)))","(pd.to_datetime(ser, errors='coerce').notna())",0.434,1.01
54996120,answer,54995695,"python,string,pandas",codeblock,https://stackoverflow.com/questions/54996120,df[df.filter(like='Task').apply(lambda x: x.str.contains('Drafting')).any(axis=1)],df[df.astype(str).apply(lambda x: x.str.contains('Drafting')).any(axis=1)],88.6,128
55150182,answer,55126339,"python,pandas,series,flatten",codeblock,https://stackoverflow.com/questions/55150182,"pd.melt(df.name_array.apply(pd.Series).reset_index(), id_vars=['index'],value_name='name_array').drop('variable', axis=1).sort_values('index')","df['name_array'].apply(lambda x: pd.Series([i for i in x])).melt().drop('variable', axis=1)['value']",173,175
55153006,answer,55152600,"pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/55153006,"df.loc[~df.alpha.isin(df.loc[df.beta<=1,'alpha'])]",df.groupby('alpha').filter(lambda x: (x.beta >1).all()),0.874,2.53
55153006,answer,55152600,"pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/55153006,df[df.beta.gt(1).groupby(df.alpha).transform('all')],df.groupby('alpha').filter(lambda x: (x.beta >1).all()),2.04,2.53
55153006,answer,55152600,"pandas,pandas-groupby",codeblock,https://stackoverflow.com/questions/55153006,"df.loc[~df.alpha.isin(df.loc[df.beta<=1,'alpha'])]",df[df.beta.gt(1).groupby(df.alpha).transform('all')],0.874,2.04
55217295,answer,55215633,"python,pandas,dataframe,merge",codeblock,https://stackoverflow.com/questions/55217295,"result_2 = pd.concat([sat, fri[~fri.security.isin(sat.security)]], ignore_index=True)","result_1 = pd.concat([sat,fri],ignore_index=True).drop_duplicates(subset=['security'], keep='first')",1.19,1.82
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,df['new_column'] = df[L].values.max(axis=1).astype(bool),"df['new_column'] = np.any(df[L].values.astype(bool), axis=1)",504,544
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,"df['new_column'] = np.any(df[L].values.astype(bool), axis=1)","df['new_column'] = np.any(df[L].values, axis=1)",544,546
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,df['new_column'] = df[L].values.sum(axis=1).astype(bool),"df['new_column'] = np.any(df[L].values.astype(bool), axis=1)",428,544
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,df['new_column'] = df[L].values.max(axis=1).astype(bool),"df['new_column'] = np.any(df[L].values, axis=1)",504,546
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,df['new_column'] = df[L].values.sum(axis=1).astype(bool),df['new_column'] = df[L].values.max(axis=1).astype(bool),428,504
55221162,answer,55221129,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55221162,df['new_column'] = df[L].values.sum(axis=1).astype(bool),"df['new_column'] = np.any(df[L].values, axis=1)",428,546
55305791,answer,55303847,"python,pandas,numpy,vector,addition",codeblock,https://stackoverflow.com/questions/55305791,"df.eval(""sqrt(vx**2 + vy**2)"", engine='python')","np.linalg.norm( df[[""vx"", ""vy""]], axis=1)",144,266
55305791,answer,55303847,"python,pandas,numpy,vector,addition",codeblock,https://stackoverflow.com/questions/55305791,"df.eval(""sqrt(vx**2 + vy**2)"", engine='numexpr')","np.linalg.norm( df[[""vx"", ""vy""]], axis=1)",42,266
55360743,answer,55360559,"python,python-3.x,pandas",codeblock,https://stackoverflow.com/questions/55360743,df.text.apply(lambda x: len([i for i in x.split() if i in stop_words])),df['text'].str.split().apply(lambda x: len(set(x) & stop_words)),2270,3290
55377643,answer,55377130,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55377643,df['is_hit'].ne(df['is_hit'].shift()) & df['is_hit'],df['is_hit'] & (~df['is_hit']).shift(1),0.908,1.13
55377643,answer,55377130,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55377643,df['is_hit'].astype(int).diff() == 1,df['is_hit'] & (~df['is_hit']).shift(1),0.689,1.13
55377643,answer,55377130,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/55377643,df['is_hit'].astype(int).diff() == 1,df['is_hit'].ne(df['is_hit'].shift()) & df['is_hit'],0.689,0.908
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'].values, np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",425,537
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'], np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",442,537
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'].values, np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",532,602
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'], np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",533,602
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'].values, np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",517,557
55546554,answer,55546540,"python,pandas",codeblock,https://stackoverflow.com/questions/55546554,"df['col_1'] = np.where(df['col_1'].isin(['a', 'b']),  df['col_1'], np.nan)","df.loc[~df['col_1'].isin(['a', 'b']), 'col_1'] = np.nan",520,557
55549279,answer,55549244,"python,pandas",codeblock,https://stackoverflow.com/questions/55549279,df[df['item_id'].isin(item_ids)],df.query('item_id in {}'.format(item_ids)),174,284
55549279,answer,55549244,"python,pandas",codeblock,https://stackoverflow.com/questions/55549279,df[df['item_id'].isin(item_ids)],df.query('item_id in {}'.format(item_ids)),299,404
55549279,answer,55549244,"python,pandas",codeblock,https://stackoverflow.com/questions/55549279,df[df['item_id'].isin(item_ids)],df.query('item_id in {}'.format(item_ids)),372,480
55601595,answer,55601570,"python,pandas",codeblock,https://stackoverflow.com/questions/55601595,df.sort_values('value').groupby('year').tail(2),df.groupby('year')['value'].apply(lambda x: x.nlargest(2)).reset_index(),0.894,2.76
55654134,answer,55654105,"python,python-3.x,pandas,dataframe,min",codeblock,https://stackoverflow.com/questions/55654134,"np.min(df.values,axis=1)",df.min(axis=1),0.0344,0.314
55654134,answer,55654105,"python,python-3.x,pandas,dataframe,min",codeblock,https://stackoverflow.com/questions/55654134,"np.min(df.values,axis=1)",df.min(axis=1),0.0352,0.314
55654134,answer,55654105,"python,python-3.x,pandas,dataframe,min",codeblock,https://stackoverflow.com/questions/55654134,"np.min(df.to_numpy(),axis=1)",df.min(axis=1),0.0355,0.314
55654134,answer,55654105,"python,python-3.x,pandas,dataframe,min",codeblock,https://stackoverflow.com/questions/55654134,"np.min(df.values,axis=1)","np.min(df.to_numpy(),axis=1)",0.0352,0.0355
55661007,answer,55660993,"python,pandas",codeblock,https://stackoverflow.com/questions/55661007,df[df.astype(bool).sum(1) > len(df.columns)-2],df[(df == 0).sum(1) < 2],4.28,7.13
55661007,answer,55660993,"python,pandas",codeblock,https://stackoverflow.com/questions/55661007,"df[np.count_nonzero(df.values, axis=1) > len(df.columns)-2]",df[(df == 0).sum(1) < 2],0.997,7.13
55661007,answer,55660993,"python,pandas",codeblock,https://stackoverflow.com/questions/55661007,"df[np.count_nonzero(df.values, axis=1) > len(df.columns)-2]",df[df.astype(bool).sum(1) > len(df.columns)-2],0.997,4.28
55751917,answer,55751785,"python,pandas",codeblock,https://stackoverflow.com/questions/55751917,df.groupby(['a'])['b'].rank('min').sub(1),df.groupby('a')['b'].transform(lambda x: pd.factorize(x)[0]),1.58,3.76
55752164,answer,55751785,"python,pandas",codeblock,https://stackoverflow.com/questions/55752164,df.groupby(['a'])['b'].rank('min').sub(1),df.groupby('a')['b'].transform(lambda x: pd.factorize(x)[0]),0.845,1.77
55752164,answer,55751785,"python,pandas",codeblock,https://stackoverflow.com/questions/55752164,"np.concatenate([rankdata(x,method='min')for x in (np.split(df.b.values,np.flatnonzero(df.a.diff().fillna(0))))])-1",df.groupby(['a'])['b'].rank('min').sub(1),0.342,0.845
55752164,answer,55751785,"python,pandas",codeblock,https://stackoverflow.com/questions/55752164,"np.concatenate([rankdata(x,method='min')for x in (np.split(df.b.values,np.flatnonzero(df.a.diff().fillna(0))))])-1",df.groupby('a')['b'].transform(lambda x: pd.factorize(x)[0]),0.342,1.77
55908189,answer,55908047,"python,pandas",codeblock,https://stackoverflow.com/questions/55908189,"pd.cut(df.stack(),[0,0.5,1]).unstack()","df.apply(pd.cut, bins=[0, 0.5, 1])",1480,3110
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,(df>3).dot(df.columns).apply(list),[df.columns[x].tolist() for x in df.gt(3).values],40.8,1230
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,df.gt(3).dot(df.columns).apply(list),(df>3).dot(df.columns).apply(list),37.6,40.8
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,(df>3).dot(df.columns).apply(list),df.T.apply(lambda x: list(x[x>3].index)),40.8,16400
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,(df>3).dot(df.columns).apply(list),"df.apply(lambda x: df.columns[np.argwhere(x>3).ravel()].values
, 1)",40.8,12000
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,df.gt(3).dot(df.columns).apply(list),[df.columns[x].tolist() for x in df.gt(3).values],37.6,1230
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,[df.columns[x].tolist() for x in df.gt(3).values],df.T.apply(lambda x: list(x[x>3].index)),1230,16400
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,[df.columns[x].tolist() for x in df.gt(3).values],"df.apply(lambda x: df.columns[np.argwhere(x>3).ravel()].values
, 1)",1230,12000
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,df.gt(3).dot(df.columns).apply(list),df.T.apply(lambda x: list(x[x>3].index)),37.6,16400
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,df.gt(3).dot(df.columns).apply(list),"df.apply(lambda x: df.columns[np.argwhere(x>3).ravel()].values
, 1)",37.6,12000
55939707,answer,55938656,"python,pandas,pandas-apply",codeblock,https://stackoverflow.com/questions/55939707,"df.apply(lambda x: df.columns[np.argwhere(x>3).ravel()].values
, 1)",df.T.apply(lambda x: list(x[x>3].index)),12000,16400
56053899,answer,56051954,"pandas,list,series",codeblock,https://stackoverflow.com/questions/56053899,"pd.concat([s]*1000, axis=1).T.to_dict('l')",pd.concat([s]*1000).groupby(level=0).apply(list).to_dict(),2830,7010
56081799,answer,29550414,"python,numpy,pandas,dataframe,tuples",codeblock,https://stackoverflow.com/questions/56081799,"df.join(pd.DataFrame([*df.col], df.index, [*'gh']))","df.assign(**dict(zip('gh', df.col.str)))",0.795,1.16
56081799,answer,29550414,"python,numpy,pandas,dataframe,tuples",codeblock,https://stackoverflow.com/questions/56081799,"df.assign(**dict(zip('gh', zip(*df.col))))","df.join(pd.DataFrame([*df.col], df.index, [*'gh']))",0.635,0.795
56081799,answer,29550414,"python,numpy,pandas,dataframe,tuples",codeblock,https://stackoverflow.com/questions/56081799,"df.join(pd.DataFrame([*df.col], df.index, [*'gh']))","df.assign(**dict(zip('gh', df.col.str)))",2.33,11.4
56081799,answer,29550414,"python,numpy,pandas,dataframe,tuples",codeblock,https://stackoverflow.com/questions/56081799,"df.assign(**dict(zip('gh', zip(*df.col))))","df.join(pd.DataFrame([*df.col], df.index, [*'gh']))",2.1,2.33
56107083,answer,56106912,"python,pandas,dictionary",codeblock,https://stackoverflow.com/questions/56107083,df.set_index('0').to_dict()['1'],"{row[0]:row[1] for idx, row in df.iterrows()}",0.347,0.629
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.at[50,50]=50","df.iat[50,50]=50",0.00552,0.00706
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.set_value(50,50,50)","df.iat[50,50]=50",0.00368,0.00706
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.iat[50,50]=50","df.iloc[50,50]=50",0.00706,0.0987
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.iat[50,50]=50","df.loc[50,50]=50",0.00706,0.109
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.set_value(50,50,50)","df.at[50,50]=50",0.00368,0.00552
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.at[50,50]=50","df.iloc[50,50]=50",0.00552,0.0987
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.at[50,50]=50","df.loc[50,50]=50",0.00552,0.109
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.set_value(50,50,50)","df.iloc[50,50]=50",0.00368,0.0987
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.set_value(50,50,50)","df.loc[50,50]=50",0.00368,0.109
56252184,answer,56251620,"python,pandas",codeblock,https://stackoverflow.com/questions/56252184,"df.iloc[50,50]=50","df.loc[50,50]=50",0.0987,0.109
56424885,answer,56424672,"python,python-3.x,pandas,dataframe",codeblock,https://stackoverflow.com/questions/56424885,df.loc[df.isin([3]).any(axis=1)].index,df.loc[(df == 3).any(axis=1)].index,0.643,1.71
56473805,answer,56473593,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/56473805,s.sum(),df.sum(axis=1),0.104,0.194
56473805,answer,56473593,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/56473805,s.sum(),df.sum(axis=1),0.149,0.253
56542478,answer,56539917,"python,pandas",codeblock,https://stackoverflow.com/questions/56542478,resampled.sum(min_count=1).dropna(),(resampled.mean() * resampled.count()).dropna(),0.588,0.622
56542478,answer,56539917,"python,pandas",codeblock,https://stackoverflow.com/questions/56542478,resampled.sum(min_count=1).dropna(),resampled.sum()[resampled.count() != 0].copy(),0.588,0.96
56542478,answer,56539917,"python,pandas",codeblock,https://stackoverflow.com/questions/56542478,(resampled.mean() * resampled.count()).dropna(),resampled.sum()[resampled.count() != 0].copy(),0.622,0.96
56613812,answer,56613736,"python,pandas,python-2.7,dataframe,dictionary",codeblock,https://stackoverflow.com/questions/56613812,"{k: (a, b) for k, a, b in zip(*map(df.get, df))}",df.set_index('A').T.to_dict('list'),9.61,520
56636976,answer,56636880,"python,pandas",codeblock,https://stackoverflow.com/questions/56636976,"df['B']=(df.A.values<df.A.values[:,None]).sum(1)",df['B']=pd.Series([len(df[df['A']<value]) for value in df['A']]),1740,25400
56771212,answer,56771162,"python,pandas",codeblock,https://stackoverflow.com/questions/56771212,tpl_subset['Tmp2'] = (tpl_subset['Fullname'] + tpl_subset['Infrasp'].radd(' ').fillna('')),"tpl_subset['Tmp1'] = np.where(tpl_subset['Infrasp'].isnull(), tpl_subset['Fullname'], tpl_subset['Fullname'] + ' ' + tpl_subset['Infrasp'])",63.2,74.8
56973870,answer,56973290,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/56973870,"np.sum([df1.values,df2.values,df3.values],axis=0)","sum((df1,df2,df3))",0.0272,2.04
57045456,answer,57045101,"python,pandas,numpy,dataframe",codeblock,https://stackoverflow.com/questions/57045456,"pd.Series(sum([list(map(str.strip, i.split(','))) for i in df['col_A']], [])).value_counts()","pd.Series([x.strip() for x in df.col_A.str.split(',').sum()]).value_counts()",1.13,1.19
57073974,answer,57073490,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/57073974,"pd.Series({y: [y >= x1 and y <= x2 for x1, x2 in vals].count(True) for y in rng})","pd.Series({y: sum(y >= x1 and y <= x2 for x1, x2 in vals) for y in rng})",158,221
57073974,answer,57073490,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/57073974,"pd.Series({y: [y >= x1 and y <= x2 for x1, x2 in vals].count(True) for y in rng})","pd.DataFrame([(y, y >= x1 and y <= x2) for x1, x2 in vals for y in rng],                  columns=['d','test']).groupby('d')['test'].sum().astype(int)",158,4520
57073974,answer,57073490,"python,pandas,dataframe",codeblock,https://stackoverflow.com/questions/57073974,"pd.Series({y: sum(y >= x1 and y <= x2 for x1, x2 in vals) for y in rng})","pd.DataFrame([(y, y >= x1 and y <= x2) for x1, x2 in vals for y in rng],                  columns=['d','test']).groupby('d')['test'].sum().astype(int)",221,4520
57185653,answer,57185325,"python,pandas,numpy",codeblock,https://stackoverflow.com/questions/57185653,"np.vander(a, 100, increasing=True)[:, 1:]","a[:, None]**np.arange(1, 100)",8.37,51.4
57265739,answer,57265604,"python,pandas",codeblock,https://stackoverflow.com/questions/57265739,"[name for name, _age in age.items() if _age>10]",age.where(lambda x: x>10).dropna().index.values,0.0125,0.51
57297209,answer,57297118,"python,pandas,numpy,matrix-multiplication,series",codeblock,https://stackoverflow.com/questions/57297209,"pd.Series(b2.dot(a), index=b2.index)","pd.Series(np.matmul(b2, a), index=b2.index)",0.074,0.113
57297209,answer,57297118,"python,pandas,numpy,matrix-multiplication,series",codeblock,https://stackoverflow.com/questions/57297209,"pd.Series(np.matmul(b2.values, a), index=b2.index)","pd.Series(b2.dot(a), index=b2.index)",0.0638,0.074
57717051,answer,57716919,"python,pandas",codeblock,https://stackoverflow.com/questions/57717051,"s.filter(regex='.{4,}')",s[s.index.str.get(3).notnull()],0.17,0.258
53905759,answer,53905536,"python,numpy",codeblock,https://stackoverflow.com/questions/53905759,"pd.DataFrame(b,a).groupby(level=0).sum()",for value in np.unique(a): out[value] = np.sum(b[np.where(a==value)]),58.7,5670
54000031,answer,5927180,"python,numpy,slice,boxplot",codeblock,https://stackoverflow.com/questions/54000031,A[A.astype(bool)],A[np.nonzero(A)],781,1490
54000031,answer,5927180,"python,numpy,slice,boxplot",codeblock,https://stackoverflow.com/questions/54000031,A[A.astype(bool)],A[np.where(A)],781,1580
54000031,answer,5927180,"python,numpy,slice,boxplot",codeblock,https://stackoverflow.com/questions/54000031,A[np.nonzero(A)],A[np.where(A)],1490,1580
54220731,answer,54220249,"python,numpy,vectorization,pytorch",codeblock,https://stackoverflow.com/questions/54220731,A.astype(np.float32).dot(X),A.dot(X),10.2,27
54429460,answer,54424433,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/54429460,"np.frombuffer(bytearray(mystr, 'utf-32-le'), dtype='U1')",np.array([mystr]).view(dtype='U1'),0.0012,0.00143
54429460,answer,54424433,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/54429460,np.array([mystr]).view(dtype='U1'),"np.frombuffer(bytearray(mystr, 'utf-32-le'), dtype='U1')",0.00433,0.0109
54429460,answer,54424433,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/54429460,np.array([mystr]).view(dtype='U1'),"np.frombuffer(bytearray(mystr, 'utf-32-le'), dtype='U1')",0.672,0.732
54429734,answer,54424433,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/54429734,"numpy.frombuffer(bytearray(x, codec), dtype='U1')","numpy.fromiter(x, dtype='U1', count=len(x))",0.00279,0.122
54429734,answer,54424433,"python,arrays,string,numpy",codeblock,https://stackoverflow.com/questions/54429734,a.view(dtype=f'U{a.size}').item(),a.view(dtype=f'U{a.size}')[0],0.00214,0.00363
54540816,answer,54540649,"python,numpy",codeblock,https://stackoverflow.com/questions/54540816,[np.sum(row) for row in alist],"np.nansum(pd.DataFrame(alist), axis=1)",0.0317,0.908
54540816,answer,54540649,"python,numpy",codeblock,https://stackoverflow.com/questions/54540816,"np.frompyfunc(sum,1,1)(alist)",[np.sum(row) for row in alist],0.0129,0.0317
54540816,answer,54540649,"python,numpy",codeblock,https://stackoverflow.com/questions/54540816,"np.sum(list(itertools.zip_longest(*alist, fillvalue=0)),axis=0)","np.nansum(pd.DataFrame(alist), axis=1)",0.0252,0.908
54540816,answer,54540649,"python,numpy",codeblock,https://stackoverflow.com/questions/54540816,"np.frompyfunc(sum,1,1)(alist)","np.sum(list(itertools.zip_longest(*alist, fillvalue=0)),axis=0)",0.0129,0.0252
54540816,answer,54540649,"python,numpy",codeblock,https://stackoverflow.com/questions/54540816,"np.frompyfunc(sum,1,1)(alist)","np.nansum(pd.DataFrame(alist), axis=1)",0.0129,0.908
54795020,answer,54793881,"python,numpy",codeblock,https://stackoverflow.com/questions/54795020,max([len(v) for v in values]),np.max([len(v) for v in values]),0.000656,0.0139
55048520,answer,55048386,"numpy,numpy-einsum",codeblock,https://stackoverflow.com/questions/55048520,"np.sum((delta @ VI) * delta, axis=-1)","np.einsum('nj,jk,nk->n', delta, VI, delta)",90,7050
55108497,answer,55108268,"python,arrays,numpy,sorting",codeblock,https://stackoverflow.com/questions/55108497,a[a.dot(2**np.arange(a.shape[1])[::-1]).argsort()],a[np.lexsort(a.T[::-1])],0.192,0.23
55389551,answer,55386621,"python,numpy",codeblock,https://stackoverflow.com/questions/55389551,"np.array([i.item()*j for i,j in zip(s,a)])","np.char.multiply(s,a)",0.0134,0.0213
55389551,answer,55386621,"python,numpy",codeblock,https://stackoverflow.com/questions/55389551,s.astype(object)*a,"np.char.multiply(s,a)",0.00916,0.0213
55389551,answer,55386621,"python,numpy",codeblock,https://stackoverflow.com/questions/55389551,s.astype(object)*a,"np.array([i.item()*j for i,j in zip(s,a)])",0.00916,0.0134
55433801,answer,55433681,"python,numpy",codeblock,https://stackoverflow.com/questions/55433801,"np.einsum('ijl,ikl->ijk', x, x).shape","y = np.sum(a * b, axis=3)",0.0741,0.0909
55655966,answer,55647074,"python,numpy,broadcast",codeblock,https://stackoverflow.com/questions/55655966,"np.frompyfunc(datetime.combine, 2,1)(x,y)","np.array([datetime.combine(i,j) for i, j in zip(x,y)])",0.00539,0.0118
55931943,answer,55931915,"python,arrays,numpy,sum",codeblock,https://stackoverflow.com/questions/55931943,np.concatenate(a).sum(),(np.sum(np.concatenate(a))),0.83,0.835
55931943,answer,55931915,"python,arrays,numpy,sum",codeblock,https://stackoverflow.com/questions/55931943,np.concatenate(a).sum(),sum([np.sum(array) for array in a]),0.83,15.3
55931943,answer,55931915,"python,arrays,numpy,sum",codeblock,https://stackoverflow.com/questions/55931943,(np.sum(np.concatenate(a))),sum([np.sum(array) for array in a]),0.835,15.3
55931943,answer,55931915,"python,arrays,numpy,sum",codeblock,https://stackoverflow.com/questions/55931943,(sum(np.concatenate(a))),sum(np.sum(array) for array in a),2.28,17.4
55993934,answer,55992055,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/55993934,"np.hstack([a[i:j] for i,j in zip(sindex, eindex)])","a[np.hstack([np.arange(i,j) for i,j in zip(sindex, eindex)])]",0.0134,0.0212
55993934,answer,55992055,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/55993934,"a[np.arange(eindex[0]-sindex[0])+sindex[:,None]].ravel()","np.hstack([a[i:j] for i,j in zip(sindex, eindex)])",0.0101,0.0134
55993934,answer,55992055,"python-3.x,numpy",codeblock,https://stackoverflow.com/questions/55993934,"a[np.arange(eindex[0]-sindex[0])+sindex[:,None]].ravel()","a[np.hstack([np.arange(i,j) for i,j in zip(sindex, eindex)])]",0.0101,0.0212
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.swapaxes(arr, -1, 1)","np.transpose(arr, (0, 2, 1))",0.000456,0.000458
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.swapaxes(arr, -1, 1)","np.reshape(arr, (3, 5, 3))",0.000456,0.000635
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.swapaxes(arr, -1, 1)","np.moveaxis(arr, -1, 1)",0.000456,0.00342
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.transpose(arr, (0, 2, 1))","np.reshape(arr, (3, 5, 3))",0.000458,0.000635
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.transpose(arr, (0, 2, 1))","np.moveaxis(arr, -1, 1)",0.000458,0.00342
56099854,answer,56099793,"python,python-3.x,list,numpy,reshape",codeblock,https://stackoverflow.com/questions/56099854,"np.reshape(arr, (3, 5, 3))","np.moveaxis(arr, -1, 1)",0.000635,0.00342
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"np.tensordot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight),is_relevant,axes=(0,2))","np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant)",0.0309,0.379
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"np.tensordot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight),is_relevant,axes=(0,2))","np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant,optimize=True)",0.0309,0.145
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"is_relevant.dot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight))","np.tensordot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight),is_relevant,axes=(0,2))",0.015,0.0309
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"np.tensordot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight),is_relevant,axes=(0,2))","(values1 * values2 * weight * is_relevant[:, :, np.newaxis, np.newaxis]).sum((2, 3, 4))",0.0309,0.152
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"is_relevant.dot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight))","np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant)",0.015,0.379
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"(values1 * values2 * weight * is_relevant[:, :, np.newaxis, np.newaxis]).sum((2, 3, 4))","np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant)",0.152,0.379
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"is_relevant.dot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight))","np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant,optimize=True)",0.015,0.145
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"np.einsum('ijk,ijk,ijk,lmk->lm',values1,values2,weight,is_relevant,optimize=True)","(values1 * values2 * weight * is_relevant[:, :, np.newaxis, np.newaxis]).sum((2, 3, 4))",0.145,0.152
56190185,answer,56188763,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/56190185,"is_relevant.dot(np.einsum('ijk,ijk,ijk->k',values1,values2,weight))","(values1 * values2 * weight * is_relevant[:, :, np.newaxis, np.newaxis]).sum((2, 3, 4))",0.015,0.152
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.array(test),"np.fromiter(test, dtype=test.typecode)",63.5,626
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.asarray(test).copy(),"np.fromiter(test, dtype=test.typecode)",63.4,626
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.asarray(test),"np.fromiter(test, dtype=test.typecode)",0.00173,626
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,"np.frombuffer(test, dtype=test.typecode)","np.fromiter(test, dtype=test.typecode)",0.00107,626
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.asarray(test).copy(),np.array(test),63.4,63.5
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.asarray(test),np.array(test),0.00173,63.5
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,"np.frombuffer(test, dtype=test.typecode)",np.array(test),0.00107,63.5
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,np.asarray(test),np.asarray(test).copy(),0.00173,63.4
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,"np.frombuffer(test, dtype=test.typecode)",np.asarray(test).copy(),0.00107,63.4
56354571,answer,5674960,"python,numpy",codeblock,https://stackoverflow.com/questions/56354571,"np.frombuffer(test, dtype=test.typecode)",np.asarray(test),0.00107,0.00173
56963144,answer,56962973,"python,arrays,numpy,integer-overflow",codeblock,https://stackoverflow.com/questions/56963144,np.sum(np.abs(a.astype(np.int16) - b.astype(np.int16))),int(ne.evaluate('sum(abs(a-b))')),3.99,4.71
57115081,answer,57114874,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/57115081,"(ar >= 1.).cumsum(axis=1, dtype=bool).view('i1')","np.maximum.accumulate(ar>=1,axis=1).view('i1')",0.582,0.593
57115081,answer,57114874,"python,numpy,vectorization",codeblock,https://stackoverflow.com/questions/57115081,"np.maximum.accumulate(ar>=1,axis=1).view('i1')","(ar >= 1.).cumsum(axis=1, dtype=bool).view('i1')",77.3,77.9
57167849,answer,57167541,"python,list,numpy,cross-product",codeblock,https://stackoverflow.com/questions/57167849,"np.array(Deck13Sample,object)[None,:]+np.array(CardTypes,object)[:,None]","np.char.add(Deck13Sample,np.array(CardTypes)[:,None])",0.0215,0.0657
57299067,answer,2850743,"python,vector,numpy,normalization",codeblock,https://stackoverflow.com/questions/57299067,"np.hypot(vectors[:,0], vectors[:,1])","np.sqrt(np.einsum('...i,...i', vectors, vectors))",0.00681,0.0111
57515796,answer,57515719,"python-3.x,numpy,matrix-multiplication",codeblock,https://stackoverflow.com/questions/57515796,np.array([[i+j for j in b] for i in a]),"a.astype(object)[:,None]+ b.astype(object)",0.0109,0.0167
57539151,answer,57539006,"python,numpy",codeblock,https://stackoverflow.com/questions/57539151,"np.unique(np.hstack((array1, array2)))","np.unique(np.concatenate([np.unique(array1), np.unique(array2)]))",1.58,1.74
